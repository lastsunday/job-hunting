(function(){"use strict";var G=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wt(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function bt(r){if(r.__esModule)return r;var c=r.default;if(typeof c=="function"){var w=function t(){return this instanceof t?Reflect.construct(c,arguments,this.constructor):c.apply(this,arguments)};w.prototype=c.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(r).forEach(function(t){var k=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(w,t,k.get?k:{enumerable:!0,get:function(){return r[t]}})}),w}var st={exports:{}};(function(r,c){(function(w,t){r.exports=t()})(G,function(){var w=1e3,t=6e4,k=36e5,S="millisecond",T="second",R="minute",p="hour",E="day",L="week",g="month",Y="quarter",D="year",H="date",h="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,e={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(u){var i=["th","st","nd","rd"],n=u%100;return"["+u+(i[(n-20)%10]||i[n]||i[0])+"]"}},a=function(u,i,n){var s=String(u);return!s||s.length>=i?u:""+Array(i+1-s.length).join(n)+u},d={s:a,z:function(u){var i=-u.utcOffset(),n=Math.abs(i),s=Math.floor(n/60),o=n%60;return(i<=0?"+":"-")+a(s,2,"0")+":"+a(o,2,"0")},m:function u(i,n){if(i.date()<n.date())return-u(n,i);var s=12*(n.year()-i.year())+(n.month()-i.month()),o=i.clone().add(s,g),f=n-o<0,l=i.clone().add(s+(f?-1:1),g);return+(-(s+(n-o)/(f?o-l:l-o))||0)},a:function(u){return u<0?Math.ceil(u)||0:Math.floor(u)},p:function(u){return{M:g,y:D,w:L,d:E,D:H,h:p,m:R,s:T,ms:S,Q:Y}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(u){return u===void 0}},v="en",b={};b[v]=e;var B="$isDayjsObject",O=function(u){return u instanceof W||!(!u||!u[B])},M=function u(i,n,s){var o;if(!i)return v;if(typeof i=="string"){var f=i.toLowerCase();b[f]&&(o=f),n&&(b[f]=n,o=f);var l=i.split("-");if(!o&&l.length>1)return u(l[0])}else{var $=i.name;b[$]=i,o=$}return!s&&o&&(v=o),o||!s&&v},_=function(u,i){if(O(u))return u.clone();var n=typeof i=="object"?i:{};return n.date=u,n.args=arguments,new W(n)},y=d;y.l=M,y.i=O,y.w=function(u,i){return _(u,{locale:i.$L,utc:i.$u,x:i.$x,$offset:i.$offset})};var W=function(){function u(n){this.$L=M(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[B]=!0}var i=u.prototype;return i.parse=function(n){this.$d=function(s){var o=s.date,f=s.utc;if(o===null)return new Date(NaN);if(y.u(o))return new Date;if(o instanceof Date)return new Date(o);if(typeof o=="string"&&!/Z$/i.test(o)){var l=o.match(m);if(l){var $=l[2]-1||0,I=(l[7]||"0").substring(0,3);return f?new Date(Date.UTC(l[1],$,l[3]||1,l[4]||0,l[5]||0,l[6]||0,I)):new Date(l[1],$,l[3]||1,l[4]||0,l[5]||0,l[6]||0,I)}}return new Date(o)}(n),this.init()},i.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},i.$utils=function(){return y},i.isValid=function(){return this.$d.toString()!==h},i.isSame=function(n,s){var o=_(n);return this.startOf(s)<=o&&o<=this.endOf(s)},i.isAfter=function(n,s){return _(n)<this.startOf(s)},i.isBefore=function(n,s){return this.endOf(s)<_(n)},i.$g=function(n,s,o){return y.u(n)?this[s]:this.set(o,n)},i.unix=function(){return Math.floor(this.valueOf()/1e3)},i.valueOf=function(){return this.$d.getTime()},i.startOf=function(n,s){var o=this,f=!!y.u(s)||s,l=y.p(n),$=function(V,j){var F=y.w(o.$u?Date.UTC(o.$y,j,V):new Date(o.$y,j,V),o);return f?F:F.endOf(E)},I=function(V,j){return y.w(o.toDate()[V].apply(o.toDate("s"),(f?[0,0,0,0]:[23,59,59,999]).slice(j)),o)},x=this.$W,U=this.$M,J=this.$D,K="set"+(this.$u?"UTC":"");switch(l){case D:return f?$(1,0):$(31,11);case g:return f?$(1,U):$(0,U+1);case L:var q=this.$locale().weekStart||0,Q=(x<q?x+7:x)-q;return $(f?J-Q:J+(6-Q),U);case E:case H:return I(K+"Hours",0);case p:return I(K+"Minutes",1);case R:return I(K+"Seconds",2);case T:return I(K+"Milliseconds",3);default:return this.clone()}},i.endOf=function(n){return this.startOf(n,!1)},i.$set=function(n,s){var o,f=y.p(n),l="set"+(this.$u?"UTC":""),$=(o={},o[E]=l+"Date",o[H]=l+"Date",o[g]=l+"Month",o[D]=l+"FullYear",o[p]=l+"Hours",o[R]=l+"Minutes",o[T]=l+"Seconds",o[S]=l+"Milliseconds",o)[f],I=f===E?this.$D+(s-this.$W):s;if(f===g||f===D){var x=this.clone().set(H,1);x.$d[$](I),x.init(),this.$d=x.set(H,Math.min(this.$D,x.daysInMonth())).$d}else $&&this.$d[$](I);return this.init(),this},i.set=function(n,s){return this.clone().$set(n,s)},i.get=function(n){return this[y.p(n)]()},i.add=function(n,s){var o,f=this;n=Number(n);var l=y.p(s),$=function(U){var J=_(f);return y.w(J.date(J.date()+Math.round(U*n)),f)};if(l===g)return this.set(g,this.$M+n);if(l===D)return this.set(D,this.$y+n);if(l===E)return $(1);if(l===L)return $(7);var I=(o={},o[R]=t,o[p]=k,o[T]=w,o)[l]||1,x=this.$d.getTime()+n*I;return y.w(x,this)},i.subtract=function(n,s){return this.add(-1*n,s)},i.format=function(n){var s=this,o=this.$locale();if(!this.isValid())return o.invalidDate||h;var f=n||"YYYY-MM-DDTHH:mm:ssZ",l=y.z(this),$=this.$H,I=this.$m,x=this.$M,U=o.weekdays,J=o.months,K=o.meridiem,q=function(j,F,X,rt){return j&&(j[F]||j(s,f))||X[F].slice(0,rt)},Q=function(j){return y.s($%12||12,j,"0")},V=K||function(j,F,X){var rt=j<12?"AM":"PM";return X?rt.toLowerCase():rt};return f.replace(A,function(j,F){return F||function(X){switch(X){case"YY":return String(s.$y).slice(-2);case"YYYY":return y.s(s.$y,4,"0");case"M":return x+1;case"MM":return y.s(x+1,2,"0");case"MMM":return q(o.monthsShort,x,J,3);case"MMMM":return q(J,x);case"D":return s.$D;case"DD":return y.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return q(o.weekdaysMin,s.$W,U,2);case"ddd":return q(o.weekdaysShort,s.$W,U,3);case"dddd":return U[s.$W];case"H":return String($);case"HH":return y.s($,2,"0");case"h":return Q(1);case"hh":return Q(2);case"a":return V($,I,!0);case"A":return V($,I,!1);case"m":return String(I);case"mm":return y.s(I,2,"0");case"s":return String(s.$s);case"ss":return y.s(s.$s,2,"0");case"SSS":return y.s(s.$ms,3,"0");case"Z":return l}return null}(j)||l.replace(":","")})},i.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},i.diff=function(n,s,o){var f,l=this,$=y.p(s),I=_(n),x=(I.utcOffset()-this.utcOffset())*t,U=this-I,J=function(){return y.m(l,I)};switch($){case D:f=J()/12;break;case g:f=J();break;case Y:f=J()/3;break;case L:f=(U-x)/6048e5;break;case E:f=(U-x)/864e5;break;case p:f=U/k;break;case R:f=U/t;break;case T:f=U/w;break;default:f=U}return o?f:y.a(f)},i.daysInMonth=function(){return this.endOf(g).$D},i.$locale=function(){return b[this.$L]},i.locale=function(n,s){if(!n)return this.$L;var o=this.clone(),f=M(n,s,!0);return f&&(o.$L=f),o},i.clone=function(){return y.w(this.$d,this)},i.toDate=function(){return new Date(this.valueOf())},i.toJSON=function(){return this.isValid()?this.toISOString():null},i.toISOString=function(){return this.$d.toISOString()},i.toString=function(){return this.$d.toUTCString()},u}(),et=W.prototype;return _.prototype=et,[["$ms",S],["$s",T],["$m",R],["$H",p],["$W",E],["$M",g],["$y",D],["$D",H]].forEach(function(u){et[u[1]]=function(i){return this.$g(i,u[0],u[1])}}),_.extend=function(u,i){return u.$i||(u(i,W,_),u.$i=!0),_},_.locale=M,_.isDayjs=O,_.unix=function(u){return _(1e3*u)},_.en=b[v],_.Ls=b,_.p={},_})})(st);var mt=st.exports;const ct=wt(mt),ut="YYYY-MM-DD HH:mm:ss.SSS";function ft(r){console.log(`${ct(new Date).format(ut)} ${r}`)}function At(r){}function lt(r){console.error(`${ct(new Date).format(ut)} ${r}`),console.error(r)}const N="CONTENT_SCRIPT",P="BACKGROUND",nt="OFFSCREEN";for(var C=[],ot=0;ot<256;++ot)C.push((ot+256).toString(16).slice(1));function $t(r,c=0){return(C[r[c+0]]+C[r[c+1]]+C[r[c+2]]+C[r[c+3]]+"-"+C[r[c+4]]+C[r[c+5]]+"-"+C[r[c+6]]+C[r[c+7]]+"-"+C[r[c+8]]+C[r[c+9]]+"-"+C[r[c+10]]+C[r[c+11]]+C[r[c+12]]+C[r[c+13]]+C[r[c+14]]+C[r[c+15]]).toLowerCase()}var tt,gt=new Uint8Array(16);function _t(){if(!tt&&(tt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!tt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tt(gt)}var kt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const dt={randomUUID:kt};function St(r,c,w){if(dt.randomUUID&&!c&&!r)return dt.randomUUID();r=r||{};var t=r.random||(r.rng||_t)();return t[6]=t[6]&15|64,t[8]=t[8]&63|128,$t(t)}var Bt={exports:{}};function Dt(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var it={exports:{}};const Mt=bt(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var ht;function It(){return ht||(ht=1,function(r,c){(function(w,t){r.exports=t()})(G,function(){var w=w||function(t,k){var S;if(typeof window<"u"&&window.crypto&&(S=window.crypto),typeof self<"u"&&self.crypto&&(S=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(S=globalThis.crypto),!S&&typeof window<"u"&&window.msCrypto&&(S=window.msCrypto),!S&&typeof G<"u"&&G.crypto&&(S=G.crypto),!S&&typeof Dt=="function")try{S=Mt}catch{}var T=function(){if(S){if(typeof S.getRandomValues=="function")try{return S.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof S.randomBytes=="function")try{return S.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},R=Object.create||function(){function e(){}return function(a){var d;return e.prototype=a,d=new e,e.prototype=null,d}}(),p={},E=p.lib={},L=E.Base=function(){return{extend:function(e){var a=R(this);return e&&a.mixIn(e),(!a.hasOwnProperty("init")||this.init===a.init)&&(a.init=function(){a.$super.init.apply(this,arguments)}),a.init.prototype=a,a.$super=this,a},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var a in e)e.hasOwnProperty(a)&&(this[a]=e[a]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),g=E.WordArray=L.extend({init:function(e,a){e=this.words=e||[],a!=k?this.sigBytes=a:this.sigBytes=e.length*4},toString:function(e){return(e||D).stringify(this)},concat:function(e){var a=this.words,d=e.words,v=this.sigBytes,b=e.sigBytes;if(this.clamp(),v%4)for(var B=0;B<b;B++){var O=d[B>>>2]>>>24-B%4*8&255;a[v+B>>>2]|=O<<24-(v+B)%4*8}else for(var M=0;M<b;M+=4)a[v+M>>>2]=d[M>>>2];return this.sigBytes+=b,this},clamp:function(){var e=this.words,a=this.sigBytes;e[a>>>2]&=4294967295<<32-a%4*8,e.length=t.ceil(a/4)},clone:function(){var e=L.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var a=[],d=0;d<e;d+=4)a.push(T());return new g.init(a,e)}}),Y=p.enc={},D=Y.Hex={stringify:function(e){for(var a=e.words,d=e.sigBytes,v=[],b=0;b<d;b++){var B=a[b>>>2]>>>24-b%4*8&255;v.push((B>>>4).toString(16)),v.push((B&15).toString(16))}return v.join("")},parse:function(e){for(var a=e.length,d=[],v=0;v<a;v+=2)d[v>>>3]|=parseInt(e.substr(v,2),16)<<24-v%8*4;return new g.init(d,a/2)}},H=Y.Latin1={stringify:function(e){for(var a=e.words,d=e.sigBytes,v=[],b=0;b<d;b++){var B=a[b>>>2]>>>24-b%4*8&255;v.push(String.fromCharCode(B))}return v.join("")},parse:function(e){for(var a=e.length,d=[],v=0;v<a;v++)d[v>>>2]|=(e.charCodeAt(v)&255)<<24-v%4*8;return new g.init(d,a)}},h=Y.Utf8={stringify:function(e){try{return decodeURIComponent(escape(H.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return H.parse(unescape(encodeURIComponent(e)))}},m=E.BufferedBlockAlgorithm=L.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var a,d=this._data,v=d.words,b=d.sigBytes,B=this.blockSize,O=B*4,M=b/O;e?M=t.ceil(M):M=t.max((M|0)-this._minBufferSize,0);var _=M*B,y=t.min(_*4,b);if(_){for(var W=0;W<_;W+=B)this._doProcessBlock(v,W);a=v.splice(0,_),d.sigBytes-=y}return new g.init(a,y)},clone:function(){var e=L.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});E.Hasher=m.extend({cfg:L.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var a=this._doFinalize();return a},blockSize:16,_createHelper:function(e){return function(a,d){return new e.init(d).finalize(a)}},_createHmacHelper:function(e){return function(a,d){return new A.HMAC.init(e,d).finalize(a)}}});var A=p.algo={};return p}(Math);return w})}(it)),it.exports}(function(r,c){(function(w,t){r.exports=t(It())})(G,function(w){return function(t){var k=w,S=k.lib,T=S.WordArray,R=S.Hasher,p=k.algo,E=[],L=[];(function(){function D(A){for(var e=t.sqrt(A),a=2;a<=e;a++)if(!(A%a))return!1;return!0}function H(A){return(A-(A|0))*4294967296|0}for(var h=2,m=0;m<64;)D(h)&&(m<8&&(E[m]=H(t.pow(h,1/2))),L[m]=H(t.pow(h,1/3)),m++),h++})();var g=[],Y=p.SHA256=R.extend({_doReset:function(){this._hash=new T.init(E.slice(0))},_doProcessBlock:function(D,H){for(var h=this._hash.words,m=h[0],A=h[1],e=h[2],a=h[3],d=h[4],v=h[5],b=h[6],B=h[7],O=0;O<64;O++){if(O<16)g[O]=D[H+O]|0;else{var M=g[O-15],_=(M<<25|M>>>7)^(M<<14|M>>>18)^M>>>3,y=g[O-2],W=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;g[O]=_+g[O-7]+W+g[O-16]}var et=d&v^~d&b,u=m&A^m&e^A&e,i=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),n=(d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25),s=B+n+et+L[O]+g[O],o=i+u;B=b,b=v,v=d,d=a+s|0,a=e,e=A,A=m,m=s+o|0}h[0]=h[0]+m|0,h[1]=h[1]+A|0,h[2]=h[2]+e|0,h[3]=h[3]+a|0,h[4]=h[4]+d|0,h[5]=h[5]+v|0,h[6]=h[6]+b|0,h[7]=h[7]+B|0},_doFinalize:function(){var D=this._data,H=D.words,h=this._nDataBytes*8,m=D.sigBytes*8;return H[m>>>5]|=128<<24-m%32,H[(m+64>>>9<<4)+14]=t.floor(h/4294967296),H[(m+64>>>9<<4)+15]=h,D.sigBytes=H.length*4,this._process(),this._hash},clone:function(){var D=R.clone.call(this);return D._hash=this._hash.clone(),D}});k.SHA256=R._createHelper(Y),k.HmacSHA256=R._createHmacHelper(Y)}(Math),w.SHA256})})(Bt);function Ot(r){let c=new URL(r);return c.origin+c.pathname}const Et="EVENT_BRIDGE",at=new Map;function z(r,c,{onMessageCallback:w,invokeEnv:t}={invokeEnv:N}){let k=Ct();return new Promise((T,R)=>{try{Ht(k,{resolve:T,reject:R});let p={action:r,callbackId:k,param:c,from:N,to:P,invokeEnv:t};if(w&&w(p),t==N)""+p.from+p.to+p.action+p.invokeEnv+p.callbackId+p.error,chrome.runtime.sendMessage(p);else if(t==P){p.from=P,p.to=nt,""+p.from+p.to+p.action+p.invokeEnv+p.callbackId+p.error,chrome.runtime.sendMessage(p);try{if(window){const E=new CustomEvent(Et,{detail:p});window.dispatchEvent(E)}}catch{}}else R(`unknow invokeEnv = ${t}`)}catch(p){lt(p),R(p)}})}function Ht(r,c){at.set(r,c)}function xt(r){let c=at.get(r);return at.delete(r),c}function Ct(){return St()}const vt={batchAddOrUpdateJobBrowse:async function(r){return await z(this.batchAddOrUpdateJobBrowse.name,r)},addOrUpdateJobBrowse:async function(r){return await z(this.addOrUpdateJobBrowse.name,r)},searchJob:async function(r){return(await z(this.searchJob.name,r)).data},getJobBrowseInfoByIds:async function(r){return(await z(this.getJobBrowseInfoByIds.name,r)).data},statisticJobBrowse:async function(){return(await z(this.statisticJobBrowse.name,{})).data},statisticJobSearchGroupByAvgSalary:async function(r){return(await z(this.statisticJobSearchGroupByAvgSalary.name,r)).data},getJobByDetailUrl:async function(r,{invokeEnv:c}={invokeEnv:N}){return(await z(this.getJobByDetailUrl.name,r,{invokeEnv:c})).data},addJobBrowseDetailHistory:async function(r,{invokeEnv:c}={invokeEnv:N}){return await z(this.addJobBrowseDetailHistory.name,r,{invokeEnv:c})}},yt=()=>setInterval(chrome.runtime.getPlatformInfo,2e4);chrome.runtime.onStartup.addListener(yt),yt(),chrome.action.onClicked.addListener(()=>{chrome.tabs.create({url:"src/sidepanel/index.html"})});const pt=new Map;chrome.tabs.onUpdated.addListener(async(r,c,w)=>{if((c==null?void 0:c.status)=="complete"&&!Rt(w.id)&&w.url){let t=Ot(w.url),k=await vt.getJobByDetailUrl(t,{invokeEnv:P});k&&(ft(`save jobBrowseDetailHistory start jobId = ${k.jobId}`),await vt.addJobBrowseDetailHistory(k.jobId,{invokeEnv:P}),ft(`save jobBrowseDetailHistory success jobId = ${k.jobId}`),Tt(w.id))}});function Rt(r){return pt.has(r)}function Tt(r){pt.set(r,null)}let Z;async function Ut(r){var c,w;await((w=(c=chrome.offscreen).hasDocument)==null?void 0:w.call(c))||(Z?await Z:(Z=chrome.offscreen.createDocument({url:chrome.runtime.getURL(r),reasons:[chrome.offscreen.Reason.WORKERS||chrome.offscreen.Reason.BLOBS],justification:"To run web worker to run sqlite"}),await Z,Z=null),chrome.runtime.onMessage.addListener(async function(t,k,S){if(t){if(t.from==N&&t.to==P)k.tab&&(t.tabId=k.tab.id),""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.from=P,t.to=nt,""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,chrome.runtime.sendMessage(t);else if(t.from==nt&&t.to==P){if(""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.invokeEnv==N)t.from=P,t.to=N,""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.tabId?chrome.tabs.sendMessage(t.tabId,t):chrome.runtime.sendMessage(t);else if(t.invokeEnv==P){let T=xt(t.callbackId);T?t.error?(t.message=t.error,T.reject(t)):T.resolve(t):lt(`callbackId = ${t.callbackId} lost callback promiseHook`)}}}}))}Ut("src/offscreen/offscreen.html")})();
