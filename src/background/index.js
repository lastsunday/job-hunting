var eG=Object.defineProperty;var tG=Object.getPrototypeOf;var rG=Reflect.get;var RE=Ke=>{throw TypeError(Ke)};var nG=(Ke,at,Ut)=>at in Ke?eG(Ke,at,{enumerable:!0,configurable:!0,writable:!0,value:Ut}):Ke[at]=Ut;var H=(Ke,at,Ut)=>nG(Ke,typeof at!="symbol"?at+"":at,Ut),NE=(Ke,at,Ut)=>at.has(Ke)||RE("Cannot "+Ut),_n=(Ke,at)=>Object(at)!==at?RE('Cannot use the "in" operator on this value'):Ke.has(at),o=(Ke,at,Ut)=>(NE(Ke,at,"read from private field"),Ut?Ut.call(Ke):at.get(Ke)),y=(Ke,at,Ut)=>at.has(Ke)?RE("Cannot add the same private member more than once"):at instanceof WeakSet?at.add(Ke):at.set(Ke,Ut),_=(Ke,at,Ut,dc)=>(NE(Ke,at,"write to private field"),dc?dc.call(Ke,Ut):at.set(Ke,Ut),Ut),F=(Ke,at,Ut)=>(NE(Ke,at,"access private method"),Ut);var Du=(Ke,at,Ut,dc)=>({set _(Qx){_(Ke,at,Qx,Ut)},get _(){return o(Ke,at,dc)}}),vP=(Ke,at,Ut)=>rG(tG(Ke),Ut,at);(function(){"use strict";var iP,sP,Zs,Vi,oP,cP,Qs,qi,Gi,ii,lP,Tp,Ap,Wc,zc,eo,to,Vc,Fp,Dy,Th,Pp,Ip,LE,Ah,qc,Dp,Op,uP,ro,Fh,Mp,Gc,Ph,Rp,Np,Lp,Bp,Ih,Dh,Xc,BE,yP,Pa,Yc,Jc,Zc,$p,Qc,el,si,EP,SP,CP,TP,Oh,Mh,nn,Rh,Nh,Lh,Bh,Ry,Uh,$h,Tx,Xi,tl,Yi,jh,jp,no,rl,Hp,Wp,nl,Ln,Hh,Wh,ao,zp,hP,Kp,al,zh,Vp,il,qp,sl,Bn,Gp,ol,Xp,Ji,FP,PP,zE,Zi,Yp,Jp,Kh,Qi,oi,Ia,By,Zp,Qp,cl,Vh,em,ll,qh,io,Da,Gh,Xh,tm,rm,nm,Yh,Jh,am,ul,im,ci,hl,Zh,mn,dl,Qh,so,sm,KE,fl,pl,gn,ml,gl,wl,ed,om,td,rd,nd,IP,DP,Un,vl,oo,yl,ad,cm,id,OP,MP,lm,xl,sd,um,sa,kl,li,hm,od,cd,co,dm,ld,Uy,fm,pm,$y,bl,rw,mm,gm,ud,$n,wm,_l,El,hd,dd,vm,rS,Oa,fd,es,jy,RP,pd,An,md,lo,Sl,Ma,gd,ym,Cl,Hy,Fn,LP,BP,UP,xm,uo,nS,aS,ui,Ra,ho,an,$P,jP,HP,Ax,Fx,km,fo,wd,po,Tl,bm,mo,_m,Em,Sm,Cm,Tm,ts,Lt,WP,zP,KP,VP,qP,GP,Px,Ou,Al,vd,go,yd,xd,Am,rs,Fm,Pm,Im,Dm,Om,Mm,Rm,Nm,Lm,Bm,Um,$m,jm,Hm,Wm,zm,wo,kd,bd,Km,Vm,qm,Gm,Xm,Ym,Jm,Zm,Qm,Wy,ZP,vo,yo,xo,ko,Fl,Pl,_d,gt,Il,bo,Ed,hi,ns,_o,sn,Sd,eg,zy,Eo,Oe,QP,iS,hc,Ix,sS,Dx,nw,eI,tI,rI,oS,nI,n0,aI,iI,cS,sI,oI,Ox,cI,lS,lI,uS,tg,So,Cd,rg,oa,Dl,Td,Ol,ng,wn,ht,hS,uI,hI,dI,dS,fS,pS,fI,pI,mI,gI,a0,Co,Ad,To,mS,gS,jn,Na,Fd,Jt,Vn,Ml,wI,Mx,Ao,Rl,as,Pd,ag,di,is,ig,sg,og,Fo,wt,La,Po,Nl,Io,Id,Dd,Ft,hr,Od,Do,Md,Rd,Nd,Ll,ss,Ky,cg,lg,rt,vI,yI,xI,wS,ug,Ld,kI,bI,_I,EI,SI,vS,yS,CI,TI,xS,AI,kS,Oo,Mo,fi,Bd,Ro,Ud,dP,hg,$d,Ir,No,Dr,Bl,dg,Lo,Ul,$l,Bo,fg,jl,pg,jd,Vy,Pn,bS,_S,mg,gg,wg,vg,qy,i0,Gy,Hd,yg,Or,xg,Wd,zd,Uo,os,Zt,kg,Hl,FI,bg,_g,Eg,Sg,Cg,ES,Wl,Tg,vn,qn,cs,$o,zl,Ag,Kd,Vd,Xy,PI,jo,Fg,Pg,Ig,Dg,Ho,Qt,qd,Yy,II,pi,Kl,aw,mi,Jy,Og,Gd,Xd,Yd,Jd,Zd,ls,us,on,Vl,vr,DI,OI,MI,RI,SS,NI,LI,BI,Qd,Mg,Rg,CS,Wo,Zy,ql,ef,Qy,UI,tf,yn,Mr,Bt,Gl,rf,Hn,nf,af,sf,_e,br,$I,TS,iw,Rx,wa,AS,jI,Nx,HI,WI,Lx,s0,Mu,zI,KI,VI,qI,Di,GI,fP,gi,Xl,of,Rr,Ba,cf,pP,hs,zo,wi,FS,sw,Ng,Yl,lf,uf,ds,PS,XI,YI,Jl,IS,JI,ex,Zl,Lg,df,Bg,Ug,$g,tx,ZI,ff,vi,Ql,eu,jg,Ko,QI,Bx,pf,Hg,Wg,zg,mf,eD,tD,Vo,Kg,gf,Gt,Ux,ow,rD,nD,$x,DS,Vg,qg,Gg,qo,cn,tu,ru,la,Xg,yi,Go,nu,Je,Yg,Xo,aD,jx,Jg,Zg,mP,fs,Yo,Qg,e1,t1,r1,au,n1,wf,a1,i1,Jo,yr,OS,Ua,$a,iD,MS,RS,sD,NS,LS,oD,cD,BS,Zo,Qo,nx,lD,gP,vf,ps,yf,ec,Nr,iu,ua,xn,xi,ki,nt,kn,ha,su,bi,_i,xf,da,s1,ou,fa,Tt,Hx,US,ax,uD,hD,$S,jS,dD,fD,pD,mD,gD,o1,kf,bf,_f,tc,Ef,Sf,wD,vD,ix,yD,c1,xr,l1,u1,cu,Cf,rc,Tf,Af,h1,ms,Ff,Pf,nc,lu,bn,xD,HS,Wx,kD,bD,d1,f1,If,Df,ac,Wn,Of,p1,Mf,ja,m1,gs,uu,Pt,WS,_D,ED,SD,CD,zx,g1,zS,TD,AD,FD,Ei,Rf,kr,zn,ic,Nf,Ge,Si,Lf,ze,w1,hu,du,v1,fu,Se,KS,PD,ID,DD,OD,Kx,o0,VS,MD,RD,ND,qS,c0,As,Vx,GS,l0,u0,h0,qx,LD,BD,UD,$D,jD,Gx,sx,HD,y1,x1,k1,ws,sc,b1,pa,Oi,pu,ox,Bf,_1,mu,E1,wP,S1,cx,C1,ux,ma,Ci,Uf,WD,zD,hx,T1,A1,F1,oc,gu,cc,wu,$f,vu,cw,Ti,KD,XS,YS,P1,yu,jf,vs,ys,I1,D1,Hf,xu,dx,fx,px,VD,Wf,lc,xs,O1,Ai,zf,M1,bu,ks,R1,N1,_u,Eu,Kf,Su,L1,B1,Vf,U1,mx,XD,$1,gx,YD,j1,wx,JD,Cu,rO,QS,H1,Fi,qf,uc,W1,Gf,Xf,z1,K1,Pi,nO,aO,vx,iO,sO,Tu,V1,Lr,Wt,Kn,cO,e2,t2,r2,q1,yx,Yf,lO,uO,G1,n2,Jf,xx,hO,Zf,X1,Y1,J1,bs,Ii,Au,Fu,Qf,_s,Es,e0,t0,Ss;var Ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ut(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var a=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:function(){return r[n]}})}),e}var dc={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Ke,function(){var e=1e3,n=6e4,a=36e5,i="millisecond",s="second",c="minute",l="hour",u="day",h="week",d="month",f="quarter",m="year",w="date",p="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(C){var K=["th","st","nd","rd"],ne=C%100;return"["+C+(K[(ne-20)%10]||K[ne]||K[0])+"]"}},x=function(C,K,ne){var X=String(C);return!X||X.length>=K?C:""+Array(K+1-X.length).join(ne)+C},S={s:x,z:function(C){var K=-C.utcOffset(),ne=Math.abs(K),X=Math.floor(ne/60),oe=ne%60;return(K<=0?"+":"-")+x(X,2,"0")+":"+x(oe,2,"0")},m:function C(K,ne){if(K.date()<ne.date())return-C(ne,K);var X=12*(ne.year()-K.year())+(ne.month()-K.month()),oe=K.clone().add(X,d),q=ne-oe<0,se=K.clone().add(X+(q?-1:1),d);return+(-(X+(ne-oe)/(q?oe-se:se-oe))||0)},a:function(C){return C<0?Math.ceil(C)||0:Math.floor(C)},p:function(C){return{M:d,y:m,w:h,d:u,D:w,h:l,m:c,s,ms:i,Q:f}[C]||String(C||"").toLowerCase().replace(/s$/,"")},u:function(C){return C===void 0}},I="en",O={};O[I]=k;var E="$isDayjsObject",T=function(C){return C instanceof A||!(!C||!C[E])},P=function C(K,ne,X){var oe;if(!K)return I;if(typeof K=="string"){var q=K.toLowerCase();O[q]&&(oe=q),ne&&(O[q]=ne,oe=q);var se=K.split("-");if(!oe&&se.length>1)return C(se[0])}else{var Q=K.name;O[Q]=K,oe=Q}return!X&&oe&&(I=oe),oe||!X&&I},W=function(C,K){if(T(C))return C.clone();var ne=typeof K=="object"?K:{};return ne.date=C,ne.args=arguments,new A(ne)},U=S;U.l=P,U.i=T,U.w=function(C,K){return W(C,{locale:K.$L,utc:K.$u,x:K.$x,$offset:K.$offset})};var A=function(){function C(ne){this.$L=P(ne.locale,null,!0),this.parse(ne),this.$x=this.$x||ne.x||{},this[E]=!0}var K=C.prototype;return K.parse=function(ne){this.$d=function(X){var oe=X.date,q=X.utc;if(oe===null)return new Date(NaN);if(U.u(oe))return new Date;if(oe instanceof Date)return new Date(oe);if(typeof oe=="string"&&!/Z$/i.test(oe)){var se=oe.match(g);if(se){var Q=se[2]-1||0,R=(se[7]||"0").substring(0,3);return q?new Date(Date.UTC(se[1],Q,se[3]||1,se[4]||0,se[5]||0,se[6]||0,R)):new Date(se[1],Q,se[3]||1,se[4]||0,se[5]||0,se[6]||0,R)}}return new Date(oe)}(ne),this.init()},K.init=function(){var ne=this.$d;this.$y=ne.getFullYear(),this.$M=ne.getMonth(),this.$D=ne.getDate(),this.$W=ne.getDay(),this.$H=ne.getHours(),this.$m=ne.getMinutes(),this.$s=ne.getSeconds(),this.$ms=ne.getMilliseconds()},K.$utils=function(){return U},K.isValid=function(){return this.$d.toString()!==p},K.isSame=function(ne,X){var oe=W(ne);return this.startOf(X)<=oe&&oe<=this.endOf(X)},K.isAfter=function(ne,X){return W(ne)<this.startOf(X)},K.isBefore=function(ne,X){return this.endOf(X)<W(ne)},K.$g=function(ne,X,oe){return U.u(ne)?this[X]:this.set(oe,ne)},K.unix=function(){return Math.floor(this.valueOf()/1e3)},K.valueOf=function(){return this.$d.getTime()},K.startOf=function(ne,X){var oe=this,q=!!U.u(X)||X,se=U.p(ne),Q=function(ve,ge){var te=U.w(oe.$u?Date.UTC(oe.$y,ge,ve):new Date(oe.$y,ge,ve),oe);return q?te:te.endOf(u)},R=function(ve,ge){return U.w(oe.toDate()[ve].apply(oe.toDate("s"),(q?[0,0,0,0]:[23,59,59,999]).slice(ge)),oe)},ae=this.$W,L=this.$M,M=this.$D,ce="set"+(this.$u?"UTC":"");switch(se){case m:return q?Q(1,0):Q(31,11);case d:return q?Q(1,L):Q(0,L+1);case h:var ke=this.$locale().weekStart||0,ue=(ae<ke?ae+7:ae)-ke;return Q(q?M-ue:M+(6-ue),L);case u:case w:return R(ce+"Hours",0);case l:return R(ce+"Minutes",1);case c:return R(ce+"Seconds",2);case s:return R(ce+"Milliseconds",3);default:return this.clone()}},K.endOf=function(ne){return this.startOf(ne,!1)},K.$set=function(ne,X){var oe,q=U.p(ne),se="set"+(this.$u?"UTC":""),Q=(oe={},oe[u]=se+"Date",oe[w]=se+"Date",oe[d]=se+"Month",oe[m]=se+"FullYear",oe[l]=se+"Hours",oe[c]=se+"Minutes",oe[s]=se+"Seconds",oe[i]=se+"Milliseconds",oe)[q],R=q===u?this.$D+(X-this.$W):X;if(q===d||q===m){var ae=this.clone().set(w,1);ae.$d[Q](R),ae.init(),this.$d=ae.set(w,Math.min(this.$D,ae.daysInMonth())).$d}else Q&&this.$d[Q](R);return this.init(),this},K.set=function(ne,X){return this.clone().$set(ne,X)},K.get=function(ne){return this[U.p(ne)]()},K.add=function(ne,X){var oe,q=this;ne=Number(ne);var se=U.p(X),Q=function(L){var M=W(q);return U.w(M.date(M.date()+Math.round(L*ne)),q)};if(se===d)return this.set(d,this.$M+ne);if(se===m)return this.set(m,this.$y+ne);if(se===u)return Q(1);if(se===h)return Q(7);var R=(oe={},oe[c]=n,oe[l]=a,oe[s]=e,oe)[se]||1,ae=this.$d.getTime()+ne*R;return U.w(ae,this)},K.subtract=function(ne,X){return this.add(-1*ne,X)},K.format=function(ne){var X=this,oe=this.$locale();if(!this.isValid())return oe.invalidDate||p;var q=ne||"YYYY-MM-DDTHH:mm:ssZ",se=U.z(this),Q=this.$H,R=this.$m,ae=this.$M,L=oe.weekdays,M=oe.months,ce=oe.meridiem,ke=function(ge,te,D,he){return ge&&(ge[te]||ge(X,q))||D[te].slice(0,he)},ue=function(ge){return U.s(Q%12||12,ge,"0")},ve=ce||function(ge,te,D){var he=ge<12?"AM":"PM";return D?he.toLowerCase():he};return q.replace(v,function(ge,te){return te||function(D){switch(D){case"YY":return String(X.$y).slice(-2);case"YYYY":return U.s(X.$y,4,"0");case"M":return ae+1;case"MM":return U.s(ae+1,2,"0");case"MMM":return ke(oe.monthsShort,ae,M,3);case"MMMM":return ke(M,ae);case"D":return X.$D;case"DD":return U.s(X.$D,2,"0");case"d":return String(X.$W);case"dd":return ke(oe.weekdaysMin,X.$W,L,2);case"ddd":return ke(oe.weekdaysShort,X.$W,L,3);case"dddd":return L[X.$W];case"H":return String(Q);case"HH":return U.s(Q,2,"0");case"h":return ue(1);case"hh":return ue(2);case"a":return ve(Q,R,!0);case"A":return ve(Q,R,!1);case"m":return String(R);case"mm":return U.s(R,2,"0");case"s":return String(X.$s);case"ss":return U.s(X.$s,2,"0");case"SSS":return U.s(X.$ms,3,"0");case"Z":return se}return null}(ge)||se.replace(":","")})},K.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},K.diff=function(ne,X,oe){var q,se=this,Q=U.p(X),R=W(ne),ae=(R.utcOffset()-this.utcOffset())*n,L=this-R,M=function(){return U.m(se,R)};switch(Q){case m:q=M()/12;break;case d:q=M();break;case f:q=M()/3;break;case h:q=(L-ae)/6048e5;break;case u:q=(L-ae)/864e5;break;case l:q=L/a;break;case c:q=L/n;break;case s:q=L/e;break;default:q=L}return oe?q:U.a(q)},K.daysInMonth=function(){return this.endOf(d).$D},K.$locale=function(){return O[this.$L]},K.locale=function(ne,X){if(!ne)return this.$L;var oe=this.clone(),q=P(ne,X,!0);return q&&(oe.$L=q),oe},K.clone=function(){return U.w(this.$d,this)},K.toDate=function(){return new Date(this.valueOf())},K.toJSON=function(){return this.isValid()?this.toISOString():null},K.toISOString=function(){return this.$d.toISOString()},K.toString=function(){return this.$d.toUTCString()},C}(),N=A.prototype;return W.prototype=N,[["$ms",i],["$s",s],["$m",c],["$H",l],["$W",u],["$M",d],["$y",m],["$D",w]].forEach(function(C){N[C[1]]=function(K){return this.$g(K,C[0],C[1])}}),W.extend=function(C,K){return C.$i||(C(K,A,W),C.$i=!0),W},W.locale=P,W.isDayjs=T,W.unix=function(C){return W(1e3*C)},W.en=O[I],W.Ls=O,W.p={},W})})(dc);var Qx=dc.exports;const kt=at(Qx),u2="YYYY-MM-DD HH:mm:ss.SSS";function lt(r){console.log(`${kt(new Date).format(u2)} ${r}`)}function aG(r){}function Gn(r){console.error(`${kt(new Date).format(u2)} ${r}`),console.error(r)}const Le="CONTENT_SCRIPT",je="BACKGROUND",ek="OFFSCREEN";for(var Ur=[],tk=0;tk<256;++tk)Ur.push((tk+256).toString(16).slice(1));function _O(r,t=0){return(Ur[r[t+0]]+Ur[r[t+1]]+Ur[r[t+2]]+Ur[r[t+3]]+"-"+Ur[r[t+4]]+Ur[r[t+5]]+"-"+Ur[r[t+6]]+Ur[r[t+7]]+"-"+Ur[r[t+8]]+Ur[r[t+9]]+"-"+Ur[r[t+10]]+Ur[r[t+11]]+Ur[r[t+12]]+Ur[r[t+13]]+Ur[r[t+14]]+Ur[r[t+15]]).toLowerCase()}var uw,EO=new Uint8Array(16);function SO(){if(!uw&&(uw=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!uw))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return uw(EO)}var CO=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const h2={randomUUID:CO};function TO(r,t,e){if(h2.randomUUID&&!t&&!r)return h2.randomUUID();r=r||{};var n=r.random||(r.rng||SO)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,_O(n)}var d2={exports:{}};function d0(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rk={exports:{}};const f2=Ut(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var p2;function AO(){return p2||(p2=1,function(r,t){(function(e,n){r.exports=n()})(Ke,function(){var e=e||function(n,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof Ke<"u"&&Ke.crypto&&(i=Ke.crypto),!i&&typeof d0=="function")try{i=f2}catch{}var s=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function k(){}return function(x){var S;return k.prototype=x,S=new k,k.prototype=null,S}}(),l={},u=l.lib={},h=u.Base=function(){return{extend:function(k){var x=c(this);return k&&x.mixIn(k),(!x.hasOwnProperty("init")||this.init===x.init)&&(x.init=function(){x.$super.init.apply(this,arguments)}),x.init.prototype=x,x.$super=this,x},create:function(){var k=this.extend();return k.init.apply(k,arguments),k},init:function(){},mixIn:function(k){for(var x in k)k.hasOwnProperty(x)&&(this[x]=k[x]);k.hasOwnProperty("toString")&&(this.toString=k.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=u.WordArray=h.extend({init:function(k,x){k=this.words=k||[],x!=a?this.sigBytes=x:this.sigBytes=k.length*4},toString:function(k){return(k||m).stringify(this)},concat:function(k){var x=this.words,S=k.words,I=this.sigBytes,O=k.sigBytes;if(this.clamp(),I%4)for(var E=0;E<O;E++){var T=S[E>>>2]>>>24-E%4*8&255;x[I+E>>>2]|=T<<24-(I+E)%4*8}else for(var P=0;P<O;P+=4)x[I+P>>>2]=S[P>>>2];return this.sigBytes+=O,this},clamp:function(){var k=this.words,x=this.sigBytes;k[x>>>2]&=4294967295<<32-x%4*8,k.length=n.ceil(x/4)},clone:function(){var k=h.clone.call(this);return k.words=this.words.slice(0),k},random:function(k){for(var x=[],S=0;S<k;S+=4)x.push(s());return new d.init(x,k)}}),f=l.enc={},m=f.Hex={stringify:function(k){for(var x=k.words,S=k.sigBytes,I=[],O=0;O<S;O++){var E=x[O>>>2]>>>24-O%4*8&255;I.push((E>>>4).toString(16)),I.push((E&15).toString(16))}return I.join("")},parse:function(k){for(var x=k.length,S=[],I=0;I<x;I+=2)S[I>>>3]|=parseInt(k.substr(I,2),16)<<24-I%8*4;return new d.init(S,x/2)}},w=f.Latin1={stringify:function(k){for(var x=k.words,S=k.sigBytes,I=[],O=0;O<S;O++){var E=x[O>>>2]>>>24-O%4*8&255;I.push(String.fromCharCode(E))}return I.join("")},parse:function(k){for(var x=k.length,S=[],I=0;I<x;I++)S[I>>>2]|=(k.charCodeAt(I)&255)<<24-I%4*8;return new d.init(S,x)}},p=f.Utf8={stringify:function(k){try{return decodeURIComponent(escape(w.stringify(k)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(k){return w.parse(unescape(encodeURIComponent(k)))}},g=u.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(k){typeof k=="string"&&(k=p.parse(k)),this._data.concat(k),this._nDataBytes+=k.sigBytes},_process:function(k){var x,S=this._data,I=S.words,O=S.sigBytes,E=this.blockSize,T=E*4,P=O/T;k?P=n.ceil(P):P=n.max((P|0)-this._minBufferSize,0);var W=P*E,U=n.min(W*4,O);if(W){for(var A=0;A<W;A+=E)this._doProcessBlock(I,A);x=I.splice(0,W),S.sigBytes-=U}return new d.init(x,U)},clone:function(){var k=h.clone.call(this);return k._data=this._data.clone(),k},_minBufferSize:0});u.Hasher=g.extend({cfg:h.extend(),init:function(k){this.cfg=this.cfg.extend(k),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(k){return this._append(k),this._process(),this},finalize:function(k){k&&this._append(k);var x=this._doFinalize();return x},blockSize:16,_createHelper:function(k){return function(x,S){return new k.init(S).finalize(x)}},_createHmacHelper:function(k){return function(x,S){return new v.HMAC.init(k,S).finalize(x)}}});var v=l.algo={};return l}(Math);return e})}(rk)),rk.exports}(function(r,t){(function(e,n){r.exports=n(AO())})(Ke,function(e){return function(n){var a=e,i=a.lib,s=i.WordArray,c=i.Hasher,l=a.algo,u=[],h=[];(function(){function m(v){for(var k=n.sqrt(v),x=2;x<=k;x++)if(!(v%x))return!1;return!0}function w(v){return(v-(v|0))*4294967296|0}for(var p=2,g=0;g<64;)m(p)&&(g<8&&(u[g]=w(n.pow(p,1/2))),h[g]=w(n.pow(p,1/3)),g++),p++})();var d=[],f=l.SHA256=c.extend({_doReset:function(){this._hash=new s.init(u.slice(0))},_doProcessBlock:function(m,w){for(var p=this._hash.words,g=p[0],v=p[1],k=p[2],x=p[3],S=p[4],I=p[5],O=p[6],E=p[7],T=0;T<64;T++){if(T<16)d[T]=m[w+T]|0;else{var P=d[T-15],W=(P<<25|P>>>7)^(P<<14|P>>>18)^P>>>3,U=d[T-2],A=(U<<15|U>>>17)^(U<<13|U>>>19)^U>>>10;d[T]=W+d[T-7]+A+d[T-16]}var N=S&I^~S&O,C=g&v^g&k^v&k,K=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),ne=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),X=E+ne+N+h[T]+d[T],oe=K+C;E=O,O=I,I=S,S=x+X|0,x=k,k=v,v=g,g=X+oe|0}p[0]=p[0]+g|0,p[1]=p[1]+v|0,p[2]=p[2]+k|0,p[3]=p[3]+x|0,p[4]=p[4]+S|0,p[5]=p[5]+I|0,p[6]=p[6]+O|0,p[7]=p[7]+E|0},_doFinalize:function(){var m=this._data,w=m.words,p=this._nDataBytes*8,g=m.sigBytes*8;return w[g>>>5]|=128<<24-g%32,w[(g+64>>>9<<4)+14]=n.floor(p/4294967296),w[(g+64>>>9<<4)+15]=p,m.sigBytes=w.length*4,this._process(),this._hash},clone:function(){var m=c.clone.call(this);return m._hash=this._hash.clone(),m}});a.SHA256=c._createHelper(f),a.HmacSHA256=c._createHmacHelper(f)}(Math),e.SHA256})})(d2);var FO=d2.exports;const PO=at(FO);function IO(r){return Math.floor(Math.random()*r)}function DO(r){return r.replace(/\_(\w)/g,function(t,e){return e.toUpperCase()})}function hw(r,t){let e=Object.assign({},r),n=Object.keys(t);for(let a=0;a<n.length;a++){let i=n[a];e[DO(i)]=t[i]}return e}function f0(r,t){return new Promise(e=>setTimeout(e,r+IO(t)))}function m2(r){return kt(r).isValid()?kt(r).toDate():null}function g2(r){return r?kt(r).format("YYYY-MM-DD HH:mm:ss"):null}function OO(r){let t=new URL(r);return t.origin+t.pathname}function w2(r){return PO(r)+""}function MO(r){const t={};for(const[e,n]of r)t[e]=n;return t}class RO{constructor(){H(this,"jobId");H(this,"jobPlatform");H(this,"jobUrl");H(this,"jobName");H(this,"jobCompanyName");H(this,"jobLocationName");H(this,"jobAddress");H(this,"jobLongitude");H(this,"jobLatitude");H(this,"jobDescription");H(this,"jobDegreeName");H(this,"jobYear");H(this,"jobSalaryMin");H(this,"jobSalaryMax");H(this,"jobSalaryTotalMonth");H(this,"jobFirstPublishDatetime");H(this,"bossName");H(this,"bossCompanyName");H(this,"bossPosition");H(this,"createDatetime");H(this,"updateDatetime");H(this,"isFullCompanyName")}}const NO="EVENT_BRIDGE",nk=new Map;function De(r,t,{onMessageCallback:e,invokeEnv:n}={invokeEnv:Le}){let a=UO();return new Promise((s,c)=>{try{LO(a,{resolve:s,reject:c});let l={action:r,callbackId:a,param:t,from:Le,to:je,invokeEnv:n};if(e&&e(l),n==Le)""+l.from+l.to+l.action+l.invokeEnv+l.callbackId+l.error,chrome.runtime.sendMessage(l);else if(n==je){l.from=je,l.to=ek,""+l.from+l.to+l.action+l.invokeEnv+l.callbackId+l.error,chrome.runtime.sendMessage(l);try{if(window){const u=new CustomEvent(NO,{detail:l});window.dispatchEvent(u)}}catch{}}else c(`unknow invokeEnv = ${n}`)}catch(l){Gn(l),c(l)}})}function LO(r,t){nk.set(r,t)}function BO(r){let t=nk.get(r);return nk.delete(r),t}function UO(){return TO()}class Bu{constructor(){H(this,"pageNum");H(this,"pageSize")}}class $O extends Bu{constructor(){super(...arguments);H(this,"jobName");H(this,"jobCompanyName");H(this,"startDatetime");H(this,"endDatetime");H(this,"startDatetimeForUpdate");H(this,"endDatetimeForUpdate");H(this,"firstPublishStartDatetime");H(this,"firstPublishEndDatetime");H(this,"jobLocationName");H(this,"jobAddress");H(this,"orderByColumn");H(this,"orderBy");H(this,"hasBrowseTime");H(this,"hasCoordinate");H(this,"minLat");H(this,"maxLat");H(this,"minLng");H(this,"maxLng")}}class jO{constructor(){H(this,"companyId");H(this,"companyName");H(this,"companyDesc");H(this,"companyStartDate");H(this,"companyStatus");H(this,"companyLegalPerson");H(this,"companyUnifiedCode");H(this,"companyWebSite");H(this,"companyInsuranceNum");H(this,"companySelfRisk");H(this,"companyUnionRisk");H(this,"companyAddress");H(this,"companyScope");H(this,"companyTaxNo");H(this,"companyIndustry");H(this,"companyLicenseNumber");H(this,"companyLongitude");H(this,"companyLatitude");H(this,"sourceUrl");H(this,"sourcePlatform");H(this,"sourceRecordId");H(this,"sourceRefreshDatetime");H(this,"createDatetime");H(this,"updateDatetime")}}class HO{constructor(){H(this,"companyName");H(this,"tags")}}class WO extends Bu{constructor(){super(...arguments);H(this,"companyName");H(this,"tagIds");H(this,"startDatetimeForUpdate");H(this,"endDatetimeForUpdate");H(this,"orderByColumn");H(this,"orderBy")}}class zO extends Bu{constructor(){super(...arguments);H(this,"companyName");H(this,"startDateStartDatetime");H(this,"startDateEndDatetime");H(this,"startDatetimeForUpdate");H(this,"endDatetimeForUpdate");H(this,"orderByColumn");H(this,"orderBy");H(this,"minLat");H(this,"maxLat");H(this,"minLng");H(this,"maxLng")}}class KO extends jO{}class ak{constructor(){H(this,"accessToken");H(this,"expiresIn");H(this,"refreshToken");H(this,"refreshTokenExpiresIn");H(this,"scope");H(this,"tokenType")}}class VO extends Bu{constructor(){super(...arguments);H(this,"typeList");H(this,"statusList");H(this,"startDatetimeForCreate");H(this,"endDatetimeForCreate");H(this,"startDatetimeForUpdate");H(this,"endDatetimeForUpdate");H(this,"endRetryCount");H(this,"orderByColumn");H(this,"orderBy")}}class qO{constructor(){H(this,"id");H(this,"type");H(this,"username");H(this,"reponame");H(this,"startDatetime");H(this,"endDatetime");H(this,"dataCount");H(this,"createDatetime");H(this,"updateDatetime")}}let GO=class{constructor(){H(this,"id");H(this,"name");H(this,"sha");H(this,"encoding");H(this,"content");H(this,"size");H(this,"type");H(this,"createDatetime");H(this,"updateDatetime")}};class XO extends Bu{constructor(){super(...arguments);H(this,"userName");H(this,"repoName");H(this,"startDatetime");H(this,"endDatetime");H(this,"orderByColumn");H(this,"orderBy")}}class YO{constructor(){H(this,"id");H(this,"type");H(this,"username");H(this,"reponame");H(this,"datetime");H(this,"createDatetime");H(this,"updateDatetime")}}class JO{constructor(){H(this,"id");H(this,"type");H(this,"username");H(this,"reponame");H(this,"datetime");H(this,"dataId");H(this,"dataCount");H(this,"createDatetime");H(this,"updateDatetime")}}class ZO extends Bu{constructor(){super(...arguments);H(this,"username");H(this,"usernameList");H(this,"startDatetimeForCreate");H(this,"endDatetimeForCreate");H(this,"startDatetimeForUpdate");H(this,"endDatetimeForUpdate");H(this,"orderByColumn");H(this,"orderBy")}}const p0={batchAddOrUpdateJobBrowse:async function(r){return await De(this.batchAddOrUpdateJobBrowse.name,r)},batchAddOrUpdateJob:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.batchAddOrUpdateJob.name,r,{invokeEnv:t})},batchAddOrUpdateJobWithTransaction:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.batchAddOrUpdateJobWithTransaction.name,r,{invokeEnv:t})},addOrUpdateJobBrowse:async function(r){return await De(this.addOrUpdateJobBrowse.name,r)},searchJob:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchJob.name,r,{invokeEnv:t})).data},getJobBrowseInfoByIds:async function(r){return(await De(this.getJobBrowseInfoByIds.name,r)).data},statisticJobBrowse:async function(){return(await De(this.statisticJobBrowse.name,{})).data},statisticJobSearchGroupByAvgSalary:async function(r){return(await De(this.statisticJobSearchGroupByAvgSalary.name,r)).data},getJobByDetailUrl:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.getJobByDetailUrl.name,r,{invokeEnv:t})).data},addJobBrowseDetailHistory:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.addJobBrowseDetailHistory.name,r,{invokeEnv:t})},jobGetByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.jobGetByIds.name,r,{invokeEnv:t})).data}},Uu={getCompanyById:async function(r){return(await De(this.getCompanyById.name,r)).data},getCompanyDTOByIds:async function(r){return(await De(this.getCompanyDTOByIds.name,r)).data},companyGetByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.companyGetByIds.name,r,{invokeEnv:t})).data},statisticCompany:async function(){return(await De(this.statisticCompany.name,{})).data},searchCompany:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchCompany.name,r,{invokeEnv:t})).data},addOrUpdateCompany:async function(r){return await De(this.addOrUpdateCompany.name,r)},batchAddOrUpdateCompany:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.batchAddOrUpdateCompany.name,r,{invokeEnv:t})},batchAddOrUpdateCompanyWithTransaction:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.batchAddOrUpdateCompanyWithTransaction.name,r,{invokeEnv:t})},addOrUpdateCompanyTag:async function(r){return await De(this.addOrUpdateCompanyTag.name,r)},batchAddOrUpdateCompanyTag:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.batchAddOrUpdateCompanyTag.name,r,{invokeEnv:t})},batchAddOrUpdateCompanyTagWithTransaction:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.batchAddOrUpdateCompanyTagWithTransaction.name,r,{invokeEnv:t})},getAllCompanyTagDTOByCompanyId:async function(r){return(await De(this.getAllCompanyTagDTOByCompanyId.name,r)).data},getAllCompanyTagDTOByCompanyIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.getAllCompanyTagDTOByCompanyIds.name,r,{invokeEnv:t})).data},searchCompanyTag:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchCompanyTag.name,r,{invokeEnv:t})).data},statisticCompanyTag:async function(){return(await De(this.statisticCompanyTag.name,{})).data},deleteCompanyTagByCompanyIds:async function(r){return await De(this.deleteCompanyTagByCompanyIds.name,r)}},dw={authOauth2Login:async function(){return(await De(this.authOauth2Login.name,{})).data},authInstallAndLogin:async function(){return(await De(this.authInstallAndLogin.name,{})).data},authGetToken:async function(){return(await De(this.authGetToken.name,null)).data},authSetToken:async function(r){return await De(this.authSetToken.name,r)}},m0={getConfigByKey:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.getConfigByKey.name,r,{invokeEnv:t})).data},getAllConfig:async function({invokeEnv:r}={invokeEnv:Le}){return(await De(this.getAllConfig.name,{},{invokeEnv:r})).data},addOrUpdateConfig:async function(r,{invokeEnv:t}={invokeEnv:Le}){return await De(this.addOrUpdateConfig.name,r,{invokeEnv:t})}},QO={developerSetToken:async function(r){return await De(this.developerSetToken.name,r)},developerGetToken:async function(){return(await De(this.developerGetToken.name,{})).data}},fc={searchTask:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchTask.name,r,{invokeEnv:t})).data},searchTaskWithDetail:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchTaskWithDetail.name,r,{invokeEnv:t})).data},taskAddOrUpdate:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskAddOrUpdate.name,r,{invokeEnv:t})).data},taskDeleteById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDeleteById.name,r,{invokeEnv:t})).data},taskDeleteByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDeleteByIds.name,r,{invokeEnv:t})).data},statisticTask:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.statisticTask.name,r,{invokeEnv:t})).data}},ik={searchTaskDataUpload:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchTaskDataUpload.name,r,{invokeEnv:t})).data},taskDataUploadGetById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataUploadGetById.name,r,{invokeEnv:t})).data},taskDataUploadAddOrUpdate:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataUploadAddOrUpdate.name,r,{invokeEnv:t})).data},taskDataUploadDeleteById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataUploadDeleteById.name,r,{invokeEnv:t})).data},taskDataUploadDeleteByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataUploadDeleteByIds.name,r,{invokeEnv:t})).data},taskDataUploadGetMaxEndDatetime:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataUploadGetMaxEndDatetime.name,r,{invokeEnv:t})).data}},sk={searchTaskDataDownload:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchTaskDataDownload.name,r,{invokeEnv:t})).data},taskDataDownloadGetById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataDownloadGetById.name,r,{invokeEnv:t})).data},taskDataDownloadAddOrUpdate:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataDownloadAddOrUpdate.name,r,{invokeEnv:t})).data},taskDataDownloadDeleteById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataDownloadDeleteById.name,r,{invokeEnv:t})).data},taskDataDownloadDeleteByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataDownloadDeleteByIds.name,r,{invokeEnv:t})).data}},Xn={dbBeginTransaction:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dbBeginTransaction.name,r,{invokeEnv:t})).data},dbCommitTransaction:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dbCommitTransaction.name,r,{invokeEnv:t})).data},dbRollbackTransaction:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dbRollbackTransaction.name,r,{invokeEnv:t})).data}},v2={searchFile:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchFile.name,r,{invokeEnv:t})).data},fileGetById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.fileGetById.name,r,{invokeEnv:t})).data},fileAddOrUpdate:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.fileAddOrUpdate.name,r,{invokeEnv:t})).data},fileDeleteById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.fileDeleteById.name,r,{invokeEnv:t})).data},fileDeleteByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.fileDeleteByIds.name,r,{invokeEnv:t})).data}},ok={searchTaskDataMerge:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchTaskDataMerge.name,r,{invokeEnv:t})).data},taskDataMergeGetById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataMergeGetById.name,r,{invokeEnv:t})).data},taskDataMergeAddOrUpdate:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataMergeAddOrUpdate.name,r,{invokeEnv:t})).data},taskDataMergeDeleteById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataMergeDeleteById.name,r,{invokeEnv:t})).data},taskDataMergeDeleteByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.taskDataMergeDeleteByIds.name,r,{invokeEnv:t})).data}},eM={searchDataSharePartner:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.searchDataSharePartner.name,r,{invokeEnv:t})).data},dataSharePartnerGetById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dataSharePartnerGetById.name,r,{invokeEnv:t})).data},dataSharePartnerAddOrUpdate:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dataSharePartnerAddOrUpdate.name,r,{invokeEnv:t})).data},dataSharePartnerDeleteById:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dataSharePartnerDeleteById.name,r,{invokeEnv:t})).data},dataSharePartnerDeleteByIds:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.dataSharePartnerDeleteByIds.name,r,{invokeEnv:t})).data},statisticDataSharePartner:async function(r,{invokeEnv:t}={invokeEnv:Le}){return(await De(this.statisticDataSharePartner.name,r,{invokeEnv:t})).data}};async function tM(r,t,{invokeEnv:e}={invokeEnv:Le}){return(await De("httpFetchGetText",r,{onMessageCallback:a=>{t(()=>{y2(a.callbackId)})},invokeEnv:e})).data}async function rM(r,t,{invokeEnv:e}={invokeEnv:Le}){return(await De("httpFetchJson",r,{onMessageCallback:a=>{t&&t(()=>{y2(a.callbackId)})},invokeEnv:e})).data}async function y2(r){await De("httpFetchGetTextAbort",r)}function pc(r,t){r.from=je,r.to=Le,""+r.from+r.to+r.action+r.invokeEnv+r.callbackId+r.error;let e=JSON.parse(JSON.stringify(r));e.data=t,r.tabId?chrome.tabs.sendMessage(r.tabId,e):chrome.runtime.sendMessage(e)}function Wa(r,t){r.from=je,r.to=Le,Gn("3.[background][send]["+r.from+" -> "+r.to+"] message [action="+r.action+",invokeEnv="+r.invokeEnv+",callbackId="+r.callbackId+",error="+r.error+"]"),r.tabId?chrome.tabs.sendMessage(r.tabId,r):chrome.runtime.sendMessage(r)}class x2{constructor(){H(this,"key");H(this,"value");H(this,"createDatetime");H(this,"updateDatetime")}}const ck="Iv23liutsRB7F1OJkVIL",k2="762e843b1d346533626fe2e9362834c30ad1408c",nM="https://github.com/apps/job-hunting-github-app/installations/new",aM="https://github.com/login/oauth/authorize",b2="https://github.com/login/oauth/access_token",fw="https://api.github.com",_2="https://api.github.com/user",iM="https://github.com/lastsunday/job-hunting-github-app/blob/main/INSTALL",sM="https://api.github.com/graphql",oM="lastsunday/job-hunting-github-app",lk="https://api.github.com/repos/lastsunday/job-hunting-github-app/issues",cM="https://api.github.com/repos/lastsunday/job-hunting/traffic/clones",lM="https://api.github.com/repos/lastsunday/job-hunting/traffic/popular/paths",uM="https://api.github.com/repos/lastsunday/job-hunting/traffic/popular/referrers",hM="https://api.github.com/repos/lastsunday/job-hunting/traffic/views",E2="job-hunting-data",dM="https://api.github.com/repos/lastsunday/job-hunting/releases/latest",S2=60,fM=3e4,pM="CONFIG_KEY_DATA_SHARE_PLAN",uk=new Map,C2="KEY_GITHUB_OAUTH_TOKEN",mM={authOauth2Login:async function(r,t){try{chrome.tabs.create({url:`${aM}?client_id=${ck}`}),uk.set(r)}catch(e){Wa(r,"[background] authOauth2Login error : "+e.message)}},authInstallAndLogin:async function(r,t){try{chrome.tabs.create({url:`${nM}`}),uk.set(r)}catch(e){Wa(r,"[background] authInstallAndLogin error : "+e.message)}},authGetToken:async function(r,t){try{pc(r,await za())}catch(e){Wa(r,"[background] authGetToken error : "+e.message)}},authSetToken:async function(r,t){try{await Mi(t),pc(r,{})}catch(e){Wa(r,"[background] authSetToken error : "+e.message)}}};function gM(){return uk}async function Mi(r){let t=new x2;return t.key=C2,t.value=JSON.stringify(r),m0.addOrUpdateConfig(t,{invokeEnv:je})}async function za(){let r=new ak,t=await m0.getConfigByKey(C2,{invokeEnv:je});if(t){let e=JSON.parse(t.value);if(e)return Object.assign(r,e),r}return null}class hk{constructor(){H(this,"login");H(this,"id");H(this,"nodeId");H(this,"avatarUrl");H(this,"gravatarId");H(this,"url");H(this,"htmlUrl");H(this,"followersUrl");H(this,"followingUrl");H(this,"gistsUrl");H(this,"starredUrl");H(this,"subscriptionsUrl");H(this,"organizationsUrl");H(this,"reposUrl");H(this,"eventsUrl");H(this,"receivedEventsUrl");H(this,"type");H(this,"siteAdmin");H(this,"name");H(this,"company");H(this,"blog");H(this,"location");H(this,"email");H(this,"hireable");H(this,"bio");H(this,"twitterUsername");H(this,"publicRepos");H(this,"publicGists");H(this,"followers");H(this,"following");H(this,"createdAt");H(this,"updatedAt")}}const T2="KEY_GITHUB_USER",wM={userGet:async function(r,t){try{pc(r,await F2())}catch(e){Wa(r,"[background] userGet error : "+e.message)}},userSet:async function(r,t){try{await A2(t),pc(r,{})}catch(e){Wa(r,"[background] userSet error : "+e.message)}}};async function A2(r){let t=new x2;return t.key=T2,t.value=JSON.stringify(r),m0.addOrUpdateConfig(t,{invokeEnv:je})}async function F2(){let r=new hk,t=await m0.getConfigByKey(T2,{invokeEnv:je});if(t){let e=JSON.parse(t.value);if(e)return Object.assign(r,e),r}return null}const vM={systemTabCreate:async function(r,t){try{pc(r,await chrome.tabs.create(t))}catch(e){Wa(r,"[background] userGet error : "+e.message)}}};var dk=function(r,t){return dk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])},dk(r,t)};function Ri(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");dk(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function yM(r,t,e,n){function a(i){return i instanceof e?i:new e(function(s){s(i)})}return new(e||(e=Promise))(function(i,s){function c(h){try{u(n.next(h))}catch(d){s(d)}}function l(h){try{u(n.throw(h))}catch(d){s(d)}}function u(h){h.done?i(h.value):a(h.value).then(c,l)}u((n=n.apply(r,[])).next())})}function P2(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(u){return function(h){return l([u,h])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(e=0)),e;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,a=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){e.label=u[1];break}if(u[0]===6&&e.label<i[1]){e.label=i[1],i=u;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(u);break}i[2]&&e.ops.pop(),e.trys.pop();continue}u=t.call(r,e)}catch(h){u=[6,h],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function $u(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function mc(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),a,i=[],s;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(c){s={error:c}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return i}function ju(r,t,e){if(arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))}function Hu(r){return this instanceof Hu?(this.v=r,this):new Hu(r)}function xM(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),a,i=[];return a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a;function s(f){n[f]&&(a[f]=function(m){return new Promise(function(w,p){i.push([f,m,w,p])>1||c(f,m)})})}function c(f,m){try{l(n[f](m))}catch(w){d(i[0][3],w)}}function l(f){f.value instanceof Hu?Promise.resolve(f.value.v).then(u,h):d(i[0][2],f)}function u(f){c("next",f)}function h(f){c("throw",f)}function d(f,m){f(m),i.shift(),i.length&&c(i[0][0],i[0][1])}}function kM(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r[Symbol.asyncIterator],e;return t?t.call(r):(r=typeof $u=="function"?$u(r):r[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=r[i]&&function(s){return new Promise(function(c,l){s=r[i](s),a(c,l,s.done,s.value)})}}function a(i,s,c,l){Promise.resolve(l).then(function(u){i({value:u,done:c})},s)}}function bt(r){return typeof r=="function"}function fk(r){var t=function(n){Error.call(n),n.stack=new Error().stack},e=r(t);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var pk=fk(function(r){return function(e){r(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,a){return a+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function pw(r,t){if(r){var e=r.indexOf(t);0<=e&&r.splice(e,1)}}var g0=function(){function r(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var t,e,n,a,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var c=$u(s),l=c.next();!l.done;l=c.next()){var u=l.value;u.remove(this)}}catch(p){t={error:p}}finally{try{l&&!l.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}else s.remove(this);var h=this.initialTeardown;if(bt(h))try{h()}catch(p){i=p instanceof pk?p.errors:[p]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=$u(d),m=f.next();!m.done;m=f.next()){var w=m.value;try{O2(w)}catch(p){i=i??[],p instanceof pk?i=ju(ju([],mc(i)),mc(p.errors)):i.push(p)}}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=f.return)&&a.call(f)}finally{if(n)throw n.error}}}if(i)throw new pk(i)}},r.prototype.add=function(t){var e;if(t&&t!==this)if(this.closed)O2(t);else{if(t instanceof r){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}},r.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},r.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},r.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&pw(e,t)},r.prototype.remove=function(t){var e=this._finalizers;e&&pw(e,t),t instanceof r&&t._removeParent(this)},r.EMPTY=function(){var t=new r;return t.closed=!0,t}(),r}(),I2=g0.EMPTY;function D2(r){return r instanceof g0||r&&"closed"in r&&bt(r.remove)&&bt(r.add)&&bt(r.unsubscribe)}function O2(r){bt(r)?r():r.unsubscribe()}var M2={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},bM={setTimeout:function(r,t){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];return setTimeout.apply(void 0,ju([r,t],mc(e)))},clearTimeout:function(r){return clearTimeout(r)},delegate:void 0};function R2(r){bM.setTimeout(function(){throw r})}function Wu(){}function mw(r){r()}var mk=function(r){Ri(t,r);function t(e){var n=r.call(this)||this;return n.isStopped=!1,e?(n.destination=e,D2(e)&&e.add(n)):n.destination=CM,n}return t.create=function(e,n,a){return new gw(e,n,a)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(g0),_M=Function.prototype.bind;function gk(r,t){return _M.call(r,t)}var EM=function(){function r(t){this.partialObserver=t}return r.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(n){ww(n)}},r.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(n){ww(n)}else ww(t)},r.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(e){ww(e)}},r}(),gw=function(r){Ri(t,r);function t(e,n,a){var i=r.call(this)||this,s;if(bt(e)||!e)s={next:e??void 0,error:n??void 0,complete:a??void 0};else{var c;i&&M2.useDeprecatedNextContext?(c=Object.create(e),c.unsubscribe=function(){return i.unsubscribe()},s={next:e.next&&gk(e.next,c),error:e.error&&gk(e.error,c),complete:e.complete&&gk(e.complete,c)}):s=e}return i.destination=new EM(s),i}return t}(mk);function ww(r){R2(r)}function SM(r){throw r}var CM={closed:!0,next:Wu,error:SM,complete:Wu},wk=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ka(r){return r}function TM(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return N2(r)}function N2(r){return r.length===0?Ka:r.length===1?r[0]:function(e){return r.reduce(function(n,a){return a(n)},e)}}var dr=function(){function r(t){t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,n){var a=this,i=FM(t)?t:new gw(t,e,n);return mw(function(){var s=a,c=s.operator,l=s.source;i.add(c?c.call(i,l):l?a._subscribe(i):a._trySubscribe(i))}),i},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},r.prototype.forEach=function(t,e){var n=this;return e=L2(e),new e(function(a,i){var s=new gw({next:function(c){try{t(c)}catch(l){i(l),s.unsubscribe()}},error:i,complete:a});n.subscribe(s)})},r.prototype._subscribe=function(t){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(t)},r.prototype[wk]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return N2(t)(this)},r.prototype.toPromise=function(t){var e=this;return t=L2(t),new t(function(n,a){var i;e.subscribe(function(s){return i=s},function(s){return a(s)},function(){return n(i)})})},r.create=function(t){return new r(t)},r}();function L2(r){var t;return(t=r??M2.Promise)!==null&&t!==void 0?t:Promise}function AM(r){return r&&bt(r.next)&&bt(r.error)&&bt(r.complete)}function FM(r){return r&&r instanceof mk||AM(r)&&D2(r)}function PM(r){return bt(r==null?void 0:r.lift)}function $r(r){return function(t){if(PM(t))return t.lift(function(e){try{return r(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function _r(r,t,e,n,a){return new IM(r,t,e,n,a)}var IM=function(r){Ri(t,r);function t(e,n,a,i,s,c){var l=r.call(this,e)||this;return l.onFinalize=s,l.shouldUnsubscribe=c,l._next=n?function(u){try{n(u)}catch(h){e.error(h)}}:r.prototype._next,l._error=i?function(u){try{i(u)}catch(h){e.error(h)}finally{this.unsubscribe()}}:r.prototype._error,l._complete=a?function(){try{a()}catch(u){e.error(u)}finally{this.unsubscribe()}}:r.prototype._complete,l}return t.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}},t}(mk),DM=fk(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),B2=function(r){Ri(t,r);function t(){var e=r.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return t.prototype.lift=function(e){var n=new U2(this,this);return n.operator=e,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new DM},t.prototype.next=function(e){var n=this;mw(function(){var a,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var s=$u(n.currentObservers),c=s.next();!c.done;c=s.next()){var l=c.value;l.next(e)}}catch(u){a={error:u}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}}})},t.prototype.error=function(e){var n=this;mw(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=e;for(var a=n.observers;a.length;)a.shift().error(e)}})},t.prototype.complete=function(){var e=this;mw(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var n=e.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(e){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var n=this,a=this,i=a.hasError,s=a.isStopped,c=a.observers;return i||s?I2:(this.currentObservers=null,c.push(e),new g0(function(){n.currentObservers=null,pw(c,e)}))},t.prototype._checkFinalizedStatuses=function(e){var n=this,a=n.hasError,i=n.thrownError,s=n.isStopped;a?e.error(i):s&&e.complete()},t.prototype.asObservable=function(){var e=new dr;return e.source=this,e},t.create=function(e,n){return new U2(e,n)},t}(dr),U2=function(r){Ri(t,r);function t(e,n){var a=r.call(this)||this;return a.destination=e,a.source=n,a}return t.prototype.next=function(e){var n,a;(a=(n=this.destination)===null||n===void 0?void 0:n.next)===null||a===void 0||a.call(n,e)},t.prototype.error=function(e){var n,a;(a=(n=this.destination)===null||n===void 0?void 0:n.error)===null||a===void 0||a.call(n,e)},t.prototype.complete=function(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)},t.prototype._subscribe=function(e){var n,a;return(a=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&a!==void 0?a:I2},t}(B2),vk={now:function(){return(vk.delegate||Date).now()},delegate:void 0},OM=function(r){Ri(t,r);function t(e,n,a){e===void 0&&(e=1/0),n===void 0&&(n=1/0),a===void 0&&(a=vk);var i=r.call(this)||this;return i._bufferSize=e,i._windowTime=n,i._timestampProvider=a,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,e),i._windowTime=Math.max(1,n),i}return t.prototype.next=function(e){var n=this,a=n.isStopped,i=n._buffer,s=n._infiniteTimeWindow,c=n._timestampProvider,l=n._windowTime;a||(i.push(e),!s&&i.push(c.now()+l)),this._trimBuffer(),r.prototype.next.call(this,e)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(e),a=this,i=a._infiniteTimeWindow,s=a._buffer,c=s.slice(),l=0;l<c.length&&!e.closed;l+=i?1:2)e.next(c[l]);return this._checkFinalizedStatuses(e),n},t.prototype._trimBuffer=function(){var e=this,n=e._bufferSize,a=e._timestampProvider,i=e._buffer,s=e._infiniteTimeWindow,c=(s?1:2)*n;if(n<1/0&&c<i.length&&i.splice(0,i.length-c),!s){for(var l=a.now(),u=0,h=1;h<i.length&&i[h]<=l;h+=2)u=h;u&&i.splice(0,u+1)}},t}(B2),MM=function(r){Ri(t,r);function t(e,n){return r.call(this)||this}return t.prototype.schedule=function(e,n){return this},t}(g0),$2={setInterval:function(r,t){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];return setInterval.apply(void 0,ju([r,t],mc(e)))},clearInterval:function(r){return clearInterval(r)},delegate:void 0},RM=function(r){Ri(t,r);function t(e,n){var a=r.call(this,e,n)||this;return a.scheduler=e,a.work=n,a.pending=!1,a}return t.prototype.schedule=function(e,n){var a;if(n===void 0&&(n=0),this.closed)return this;this.state=e;var i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(a=this.id)!==null&&a!==void 0?a:this.requestAsyncId(s,this.id,n),this},t.prototype.requestAsyncId=function(e,n,a){return a===void 0&&(a=0),$2.setInterval(e.flush.bind(e,this),a)},t.prototype.recycleAsyncId=function(e,n,a){if(a===void 0&&(a=0),a!=null&&this.delay===a&&this.pending===!1)return n;n!=null&&$2.clearInterval(n)},t.prototype.execute=function(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var a=this._execute(e,n);if(a)return a;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,n){var a=!1,i;try{this.work(e)}catch(s){a=!0,i=s||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var e=this,n=e.id,a=e.scheduler,i=a.actions;this.work=this.state=this.scheduler=null,this.pending=!1,pw(i,this),n!=null&&(this.id=this.recycleAsyncId(a,n,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},t}(MM),j2=function(){function r(t,e){e===void 0&&(e=r.now),this.schedulerActionCtor=t,this.now=e}return r.prototype.schedule=function(t,e,n){return e===void 0&&(e=0),new this.schedulerActionCtor(this,t).schedule(n,e)},r.now=vk.now,r}(),NM=function(r){Ri(t,r);function t(e,n){n===void 0&&(n=j2.now);var a=r.call(this,e,n)||this;return a.actions=[],a._active=!1,a}return t.prototype.flush=function(e){var n=this.actions;if(this._active){n.push(e);return}var a;this._active=!0;do if(a=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,a){for(;e=n.shift();)e.unsubscribe();throw a}},t}(j2),LM=new NM(RM),BM=LM,gc=new dr(function(r){return r.complete()});function UM(r){return r&&bt(r.schedule)}function yk(r){return r[r.length-1]}function $M(r){return bt(yk(r))?r.pop():void 0}function w0(r){return UM(yk(r))?r.pop():void 0}function jM(r,t){return typeof yk(r)=="number"?r.pop():t}var xk=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function H2(r){return bt(r==null?void 0:r.then)}function W2(r){return bt(r[wk])}function z2(r){return Symbol.asyncIterator&&bt(r==null?void 0:r[Symbol.asyncIterator])}function K2(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function HM(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var V2=HM();function q2(r){return bt(r==null?void 0:r[V2])}function G2(r){return xM(this,arguments,function(){var e,n,a,i;return P2(this,function(s){switch(s.label){case 0:e=r.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Hu(e.read())];case 3:return n=s.sent(),a=n.value,i=n.done,i?[4,Hu(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Hu(a)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function X2(r){return bt(r==null?void 0:r.getReader)}function un(r){if(r instanceof dr)return r;if(r!=null){if(W2(r))return WM(r);if(xk(r))return zM(r);if(H2(r))return KM(r);if(z2(r))return Y2(r);if(q2(r))return VM(r);if(X2(r))return qM(r)}throw K2(r)}function WM(r){return new dr(function(t){var e=r[wk]();if(bt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function zM(r){return new dr(function(t){for(var e=0;e<r.length&&!t.closed;e++)t.next(r[e]);t.complete()})}function KM(r){return new dr(function(t){r.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,R2)})}function VM(r){return new dr(function(t){var e,n;try{for(var a=$u(r),i=a.next();!i.done;i=a.next()){var s=i.value;if(t.next(s),t.closed)return}}catch(c){e={error:c}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}t.complete()})}function Y2(r){return new dr(function(t){GM(r,t).catch(function(e){return t.error(e)})})}function qM(r){return Y2(G2(r))}function GM(r,t){var e,n,a,i;return yM(this,void 0,void 0,function(){var s,c;return P2(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),e=kM(r),l.label=1;case 1:return[4,e.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=l.sent(),a={error:c},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(i=e.return)?[4,i.call(e)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Fs(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=!1);var i=t.schedule(function(){e(),a?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(i),!a)return i}function J2(r,t){return t===void 0&&(t=0),$r(function(e,n){e.subscribe(_r(n,function(a){return Fs(n,r,function(){return n.next(a)},t)},function(){return Fs(n,r,function(){return n.complete()},t)},function(a){return Fs(n,r,function(){return n.error(a)},t)}))})}function Z2(r,t){return t===void 0&&(t=0),$r(function(e,n){n.add(r.schedule(function(){return e.subscribe(n)},t))})}function XM(r,t){return un(r).pipe(Z2(t),J2(t))}function YM(r,t){return un(r).pipe(Z2(t),J2(t))}function JM(r,t){return new dr(function(e){var n=0;return t.schedule(function(){n===r.length?e.complete():(e.next(r[n++]),e.closed||this.schedule())})})}function ZM(r,t){return new dr(function(e){var n;return Fs(e,t,function(){n=r[V2](),Fs(e,t,function(){var a,i,s;try{a=n.next(),i=a.value,s=a.done}catch(c){e.error(c);return}s?e.complete():e.next(i)},0,!0)}),function(){return bt(n==null?void 0:n.return)&&n.return()}})}function Q2(r,t){if(!r)throw new Error("Iterable cannot be null");return new dr(function(e){Fs(e,t,function(){var n=r[Symbol.asyncIterator]();Fs(e,t,function(){n.next().then(function(a){a.done?e.complete():e.next(a.value)})},0,!0)})})}function QM(r,t){return Q2(G2(r),t)}function eR(r,t){if(r!=null){if(W2(r))return XM(r,t);if(xk(r))return JM(r,t);if(H2(r))return YM(r,t);if(z2(r))return Q2(r,t);if(q2(r))return ZM(r,t);if(X2(r))return QM(r,t)}throw K2(r)}function dt(r,t){return t?eR(r,t):un(r)}function Ps(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=w0(r);return dt(r,e)}var kk=fk(function(r){return function(){r(this),this.name="EmptyError",this.message="no elements in sequence"}});function Er(r,t){return new Promise(function(e,n){var a=new gw({next:function(i){e(i),a.unsubscribe()},error:n,complete:function(){n(new kk)}});r.subscribe(a)})}function tR(r){return r instanceof Date&&!isNaN(r)}function tr(r,t){return $r(function(e,n){var a=0;e.subscribe(_r(n,function(i){n.next(r.call(t,i,a++))}))})}var rR=Array.isArray;function nR(r,t){return rR(t)?r.apply(void 0,ju([],mc(t))):r(t)}function eC(r){return tr(function(t){return nR(r,t)})}var aR=Array.isArray,iR=Object.getPrototypeOf,sR=Object.prototype,oR=Object.keys;function cR(r){if(r.length===1){var t=r[0];if(aR(t))return{args:t,keys:null};if(lR(t)){var e=oR(t);return{args:e.map(function(n){return t[n]}),keys:e}}}return{args:r,keys:null}}function lR(r){return r&&typeof r=="object"&&iR(r)===sR}function uR(r,t){return r.reduce(function(e,n,a){return e[n]=t[a],e},{})}function vw(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=w0(r),n=$M(r),a=cR(r),i=a.args,s=a.keys;if(i.length===0)return dt([],e);var c=new dr(hR(i,e,s?function(l){return uR(s,l)}:Ka));return n?c.pipe(eC(n)):c}function hR(r,t,e){return e===void 0&&(e=Ka),function(n){tC(t,function(){for(var a=r.length,i=new Array(a),s=a,c=a,l=function(h){tC(t,function(){var d=dt(r[h],t),f=!1;d.subscribe(_r(n,function(m){i[h]=m,f||(f=!0,c--),c||n.next(e(i.slice()))},function(){--s||n.complete()}))},n)},u=0;u<a;u++)l(u)},n)}}function tC(r,t,e){r?Fs(e,r,t):t()}function rC(r,t,e,n,a,i,s,c){var l=[],u=0,h=0,d=!1,f=function(){d&&!l.length&&!u&&t.complete()},m=function(p){return u<n?w(p):l.push(p)},w=function(p){i&&t.next(p),u++;var g=!1;un(e(p,h++)).subscribe(_r(t,function(v){a==null||a(v),i?m(v):t.next(v)},function(){g=!0},void 0,function(){if(g)try{u--;for(var v=function(){var k=l.shift();s||w(k)};l.length&&u<n;)v();f()}catch(k){t.error(k)}}))};return r.subscribe(_r(t,m,function(){d=!0,f()})),function(){c==null||c()}}function Sr(r,t,e){return e===void 0&&(e=1/0),bt(t)?Sr(function(n,a){return tr(function(i,s){return t(n,i,a,s)})(un(r(n,a)))},e):(typeof t=="number"&&(e=t),$r(function(n,a){return rC(n,a,r,e)}))}function nC(r){return r===void 0&&(r=1/0),Sr(Ka,r)}function dR(){return nC(1)}function bk(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return dR()(dt(r,w0(r)))}function wc(r){return new dr(function(t){un(r()).subscribe(t)})}var fR=["addListener","removeListener"],pR=["addEventListener","removeEventListener"],mR=["on","off"];function _k(r,t,e,n){if(bt(e)&&(n=e,e=void 0),n)return _k(r,t,e).pipe(eC(n));var a=mc(vR(r)?pR.map(function(c){return function(l){return r[c](t,l,e)}}):gR(r)?fR.map(aC(r,t)):wR(r)?mR.map(aC(r,t)):[],2),i=a[0],s=a[1];if(!i&&xk(r))return Sr(function(c){return _k(c,t,e)})(un(r));if(!i)throw new TypeError("Invalid event target");return new dr(function(c){var l=function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return c.next(1<u.length?u:u[0])};return i(l),function(){return s(l)}})}function aC(r,t){return function(e){return function(n){return r[e](t,n)}}}function gR(r){return bt(r.addListener)&&bt(r.removeListener)}function wR(r){return bt(r.on)&&bt(r.off)}function vR(r){return bt(r.addEventListener)&&bt(r.removeEventListener)}function Ek(r,t,e){return r===void 0&&(r=0),e===void 0&&(e=BM),new dr(function(n){var a=tR(r)?+r-e.now():r;a<0&&(a=0);var i=0;return e.schedule(function(){n.closed||(n.next(i++),n.complete())},a)})}function v0(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=w0(r),n=jM(r,1/0),a=r;return a.length?a.length===1?un(a[0]):nC(n)(dt(a,e)):gc}var iC=new dr(Wu),yR=Array.isArray;function xR(r){return r.length===1&&yR(r[0])?r[0]:r}function vc(r,t){return $r(function(e,n){var a=0;e.subscribe(_r(n,function(i){return r.call(t,i,a++)&&n.next(i)}))})}function kR(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return r=xR(r),r.length===1?un(r[0]):new dr(sC(r))}function sC(r){return function(t){for(var e=[],n=function(i){e.push(un(r[i]).subscribe(_r(t,function(s){if(e){for(var c=0;c<e.length;c++)c!==i&&e[c].unsubscribe();e=null}t.next(s)})))},a=0;e&&!t.closed&&a<r.length;a++)n(a)}}function y0(r){return $r(function(t,e){var n=null,a=!1,i;n=t.subscribe(_r(e,void 0,void 0,function(s){i=un(r(s,y0(r)(t))),n?(n.unsubscribe(),n=null,i.subscribe(e)):a=!0})),a&&(n.unsubscribe(),n=null,i.subscribe(e))})}function oC(r){return $r(function(t,e){var n=!1;t.subscribe(_r(e,function(a){n=!0,e.next(a)},function(){n||e.next(r),e.complete()}))})}function Sk(r){return r<=0?function(){return gc}:$r(function(t,e){var n=0;t.subscribe(_r(e,function(a){++n<=r&&(e.next(a),r<=n&&e.complete())}))})}function yw(){return $r(function(r,t){r.subscribe(_r(t,Wu))})}function bR(r){return tr(function(){return r})}function _R(r,t){return Sr(function(e,n){return un(r(e,n)).pipe(Sk(1),bR(e))})}function xw(r){return r===void 0&&(r=ER),$r(function(t,e){var n=!1;t.subscribe(_r(e,function(a){n=!0,e.next(a)},function(){return n?e.complete():e.error(r())}))})}function ER(){return new kk}function zu(r,t){var e=arguments.length>=2;return function(n){return n.pipe(r?vc(function(a,i){return r(a,i,n)}):Ka,Sk(1),e?oC(t):xw(function(){return new kk}))}}function SR(r,t,e){return e===void 0&&(e=1/0),$r(function(n,a){var i=t;return rC(n,a,function(s,c){return r(i,s,c)},e,function(s){i=s},!1,void 0,function(){return i=null})})}function jr(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return r.length?$r(function(e,n){sC(ju([e],mc(r)))(n)}):Ka}function kw(r){r===void 0&&(r=1/0);var t;r&&typeof r=="object"?t=r:t={count:r};var e=t.count,n=e===void 0?1/0:e,a=t.delay,i=t.resetOnSuccess,s=i===void 0?!1:i;return n<=0?Ka:$r(function(c,l){var u=0,h,d=function(){var f=!1;h=c.subscribe(_r(l,function(m){s&&(u=0),l.next(m)},void 0,function(m){if(u++<n){var w=function(){h?(h.unsubscribe(),h=null,d()):f=!0};if(a!=null){var p=typeof a=="number"?Ek(a):un(a(m,u)),g=_r(l,function(){g.unsubscribe(),w()},function(){l.complete()});p.subscribe(g)}else w()}else l.error(m)})),f&&(h.unsubscribe(),h=null,d())};d()})}function CR(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=w0(r);return $r(function(n,a){(e?bk(r,n,e):bk(r,n)).subscribe(a)})}function bw(r,t){return $r(function(e,n){var a=null,i=0,s=!1,c=function(){return s&&!a&&n.complete()};e.subscribe(_r(n,function(l){a==null||a.unsubscribe();var u=0,h=i++;un(r(l,h)).subscribe(a=_r(n,function(d){return n.next(t?t(l,d,h,u++):d)},function(){a=null,c()}))},function(){s=!0,c()}))})}function TR(r){return $r(function(t,e){un(r).subscribe(_r(e,function(){return e.complete()},Wu)),!e.closed&&t.subscribe(e)})}function _w(r,t,e){var n=bt(r)||t||e?{next:r,error:t,complete:e}:r;return n?$r(function(a,i){var s;(s=n.subscribe)===null||s===void 0||s.call(n);var c=!0;a.subscribe(_r(i,function(l){var u;(u=n.next)===null||u===void 0||u.call(n,l),i.next(l)},function(){var l;c=!1,(l=n.complete)===null||l===void 0||l.call(n),i.complete()},function(l){var u;c=!1,(u=n.error)===null||u===void 0||u.call(n,l),i.error(l)},function(){var l,u;c&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(u=n.finalize)===null||u===void 0||u.call(n)}))}):Ka}function AR(r){return{all:r=r||new Map,on:function(t,e){var n=r.get(t);n?n.push(e):r.set(t,[e])},off:function(t,e){var n=r.get(t);n&&(e?n.splice(n.indexOf(e)>>>0,1):r.set(t,[]))},emit:function(t,e){var n=r.get(t);n&&n.slice().map(function(a){a(e)}),(n=r.get("*"))&&n.slice().map(function(a){a(t,e)})}}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */Symbol.dispose??(Symbol.dispose=Symbol("dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("asyncDispose"));const He=Symbol.dispose,va=Symbol.asyncDispose;sP=He,iP=Symbol.toStringTag;const fE=class fE{constructor(){y(this,Zs,!1);y(this,Vi,[]);H(this,sP,this.dispose);H(this,iP,"DisposableStack")}get disposed(){return o(this,Zs)}dispose(){if(!o(this,Zs)){_(this,Zs,!0);for(const t of o(this,Vi).reverse())t[He]()}}use(t){return t&&o(this,Vi).push(t),t}adopt(t,e){return o(this,Vi).push({[He](){e(t)}}),t}defer(t){o(this,Vi).push({[He](){t()}})}move(){if(o(this,Zs))throw new ReferenceError("a disposed stack can not use anything new");const t=new fE;return _(t,Vi,o(this,Vi)),_(this,Zs,!0),t}};Zs=new WeakMap,Vi=new WeakMap;let rr=fE;cP=va,oP=Symbol.toStringTag;const pE=class pE{constructor(){y(this,Qs,!1);y(this,qi,[]);H(this,cP,this.dispose);H(this,oP,"AsyncDisposableStack")}get disposed(){return o(this,Qs)}async dispose(){if(!o(this,Qs)){_(this,Qs,!0);for(const t of o(this,qi).reverse())await t[va]()}}use(t){return t&&o(this,qi).push(t),t}adopt(t,e){return o(this,qi).push({[va](){return e(t)}}),t}defer(t){o(this,qi).push({[va](){return t()}})}move(){if(o(this,Qs))throw new ReferenceError("a disposed stack can not use anything new");const t=new pE;return _(t,qi,o(this,qi)),_(this,Qs,!0),t}};Qs=new WeakMap,qi=new WeakMap;let Ew=pE;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */let Ue=(lP=class{constructor(t=AR(new Map)){y(this,Gi);y(this,ii,new Map);_(this,Gi,t)}on(t,e){const n=o(this,ii).get(t);return n===void 0?o(this,ii).set(t,[e]):n.push(e),o(this,Gi).on(t,e),this}off(t,e){const n=o(this,ii).get(t)??[];if(e===void 0){for(const i of n)o(this,Gi).off(t,i);return o(this,ii).delete(t),this}const a=n.lastIndexOf(e);return a>-1&&o(this,Gi).off(t,...n.splice(a,1)),this}emit(t,e){return o(this,Gi).emit(t,e),this.listenerCount(t)>0}once(t,e){const n=a=>{e(a),this.off(t,n)};return this.on(t,n)}listenerCount(t){var e;return((e=o(this,ii).get(t))==null?void 0:e.length)||0}removeAllListeners(t){return t!==void 0?this.off(t):(this[He](),this)}[He](){for(const[t,e]of o(this,ii))for(const n of e)o(this,Gi).off(t,n);o(this,ii).clear()}},Gi=new WeakMap,ii=new WeakMap,lP);/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const cC=!!(typeof process<"u"&&process.version),Is={value:{get fs(){throw new Error("fs is not available in this environment")},get path(){throw new Error("path is not available in this environment")},get ScreenRecorder(){throw new Error("ScreenRecorder is not available in this environment")}}},lC="23.5.2";/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Ee=(r,t)=>{if(!r)throw new Error(t)};/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function Ck(r,t=!1){if(t){const e=atob(r);return Uint8Array.from(e,n=>n.codePointAt(0))}return new TextEncoder().encode(r)}function uC(r){return hC(new TextEncoder().encode(r))}function hC(r){const e=[];for(let a=0;a<r.length;a+=65534){const i=r.subarray(a,a+65534);e.push(String.fromCodePoint.apply(null,i))}const n=e.join("");return btoa(n)}function FR(r){let t=0;for(const a of r)t+=a.length;const e=new Uint8Array(t);let n=0;for(const a of r)e.set(a,n),n+=a.length;return e}/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */let Tk=null;async function PR(){return Tk||(Tk=(await Promise.resolve().then(()=>ZH)).default),Tk}const Ku=r=>cC?async(...t)=>{(await PR())(r)(t)}:(...t)=>{const e=globalThis.__PUPPETEER_DEBUG;!e||!(e==="*"||(e.endsWith("*")?r.startsWith(e):r===e))||console.log(`${r}:`,...t)};/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Ak extends Error{constructor(t,e){super(t,e),this.name=this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class Sw extends Ak{}class yc extends Ak{constructor(){super(...arguments);y(this,Tp);y(this,Ap,"")}set code(e){_(this,Tp,e)}get code(){return o(this,Tp)}set originalMessage(e){_(this,Ap,e)}get originalMessage(){return o(this,Ap)}}Tp=new WeakMap,Ap=new WeakMap;class et extends Ak{}class ya extends yc{}/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const IR={letter:{width:8.5,height:11},legal:{width:8.5,height:14},tabloid:{width:11,height:17},ledger:{width:17,height:11},a0:{width:33.1102,height:46.811},a1:{width:23.3858,height:33.1102},a2:{width:16.5354,height:23.3858},a3:{width:11.6929,height:16.5354},a4:{width:8.2677,height:11.6929},a5:{width:5.8268,height:8.2677},a6:{width:4.1339,height:5.8268}};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Re=Ku("puppeteer:error"),dC=Object.freeze({width:800,height:600}),Cw=Symbol("Source URL for Puppeteer evaluation scripts"),Kc=class Kc{constructor(){y(this,Wc);y(this,zc)}static fromCallSite(t,e){const n=new Kc;return _(n,Wc,t),_(n,zc,e.toString()),n}get functionName(){return o(this,Wc)}get siteString(){return o(this,zc)}toString(){return`pptr:${[o(this,Wc),encodeURIComponent(o(this,zc))].join(";")}`}};Wc=new WeakMap,zc=new WeakMap,H(Kc,"INTERNAL_URL","pptr:internal"),H(Kc,"parse",t=>{t=t.slice(5);const[e="",n=""]=t.split(";"),a=new Kc;return _(a,Wc,e),_(a,zc,decodeURIComponent(n)),a}),H(Kc,"isPuppeteerURL",t=>t.startsWith("pptr:"));let In=Kc;const Cr=(r,t)=>{if(Object.prototype.hasOwnProperty.call(t,Cw))return t;const e=Error.prepareStackTrace;Error.prepareStackTrace=(a,i)=>i[2];const n=new Error().stack;return Error.prepareStackTrace=e,Object.assign(t,{[Cw]:In.fromCallSite(r,n)})},fC=r=>{if(Object.prototype.hasOwnProperty.call(r,Cw))return r[Cw]},Ni=r=>typeof r=="string"||r instanceof String,DR=r=>typeof r=="number"||r instanceof Number,OR=r=>typeof r=="object"&&(r==null?void 0:r.constructor)===Object,MR=r=>typeof r=="object"&&(r==null?void 0:r.constructor)===RegExp,RR=r=>typeof r=="object"&&(r==null?void 0:r.constructor)===Date;function Fk(r,...t){if(Ni(r))return Ee(t.length===0,"Cannot evaluate a string with arguments"),r;function e(n){return Object.is(n,void 0)?"undefined":JSON.stringify(n)}return`(${r})(${t.map(e).join(",")})`}async function pC(r,t){const e=[],n=r.getReader();if(t){const a=await Is.value.fs.promises.open(t,"w+");try{for(;;){const{done:i,value:s}=await n.read();if(i)break;e.push(s),await a.writeFile(s)}}finally{await a.close()}}else for(;;){const{done:a,value:i}=await n.read();if(a)break;e.push(i)}try{const a=FR(e);return a.length===0?null:a}catch(a){return Re(a),null}}async function mC(r,t){return new ReadableStream({async pull(e){function n(c,l){return l?Uint8Array.from(atob(c),h=>h.codePointAt(0)):new TextEncoder().encode(c)}const{data:a,base64Encoded:i,eof:s}=await r.send("IO.read",{handle:t});e.enqueue(n(a,i??!1)),s&&(await r.send("IO.close",{handle:t}),e.close())}})}function NR(r){let t=null;return new Set(["alert","confirm","prompt","beforeunload"]).has(r)&&(t=r),Ee(t,`Unknown javascript dialog type: ${r}`),t}function En(r,t){return r===0?iC:Ek(r).pipe(tr(()=>{throw new Sw(`Timed out after waiting ${r}ms`,{cause:t})}))}const gC="__puppeteer_utility_world__"+lC,Tw=/^[\x20\t]*\/\/[@#] sourceURL=\s{0,10}(\S*?)\s{0,10}$/m;function wC(r){return`//# sourceURL=${r}`}const LR=500;function vC(r={},t="in"){var s,c,l,u;const e={scale:1,displayHeaderFooter:!1,headerTemplate:"",footerTemplate:"",printBackground:!1,landscape:!1,pageRanges:"",preferCSSPageSize:!1,omitBackground:!1,outline:!1,tagged:!0,waitForFonts:!0};let n=8.5,a=11;if(r.format){const h=IR[r.format.toLowerCase()];Ee(h,"Unknown paper format: "+r.format),n=h.width,a=h.height}else n=Vu(r.width,t)??n,a=Vu(r.height,t)??a;const i={top:Vu((s=r.margin)==null?void 0:s.top,t)||0,left:Vu((c=r.margin)==null?void 0:c.left,t)||0,bottom:Vu((l=r.margin)==null?void 0:l.bottom,t)||0,right:Vu((u=r.margin)==null?void 0:u.right,t)||0};return r.outline&&(r.tagged=!0),{...e,...r,width:n,height:a,margin:i}}const Pk={px:1,in:96,cm:37.8,mm:3.78};function Vu(r,t="in"){if(typeof r>"u")return;let e;if(DR(r))e=r;else if(Ni(r)){const n=r;let a=n.substring(n.length-2).toLowerCase(),i="";a in Pk?i=n.substring(0,n.length-2):(a="px",i=n);const s=Number(i);Ee(!isNaN(s),"Failed to parse parameter value: "+n),e=s*Pk[a]}else throw new Error("page.pdf() Cannot handle parameter type: "+typeof r);return e/Pk[t]}function _t(r,t){return new dr(e=>{const n=a=>{e.next(a)};return r.on(t,n),()=>{r.off(t,n)}})}function xc(r,t){return r?_k(r,"abort").pipe(tr(()=>{throw r.reason instanceof Error?(r.reason.cause=t,r.reason):new Error(r.reason,{cause:t})})):iC}function x0(r){return Sr(t=>dt(Promise.resolve(r(t))).pipe(vc(e=>e),tr(()=>t)))}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Ik=new Map([["geolocation","geolocation"],["midi","midi"],["notifications","notifications"],["camera","videoCapture"],["microphone","audioCapture"],["background-sync","backgroundSync"],["ambient-light-sensor","sensors"],["accelerometer","sensors"],["gyroscope","sensors"],["magnetometer","sensors"],["accessibility-events","accessibilityEvents"],["clipboard-read","clipboardReadWrite"],["clipboard-write","clipboardReadWrite"],["clipboard-sanitized-write","clipboardSanitizedWrite"],["payment-handler","paymentHandler"],["persistent-storage","durableStorage"],["idle-detection","idleDetection"],["midi-sysex","midiSysex"]]);let yC=class extends Ue{constructor(){super()}async waitForTarget(t,e={}){const{timeout:n=3e4,signal:a}=e;return await Er(v0(_t(this,"targetcreated"),_t(this,"targetchanged"),dt(this.targets())).pipe(x0(t),jr(xc(a),En(n))))}async pages(){return(await Promise.all(this.browserContexts().map(e=>e.pages()))).reduce((e,n)=>e.concat(n),[])}isConnected(){return this.connected}[He](){return this.process()?void this.close().catch(Re):void this.disconnect().catch(Re)}[va](){return this.process()?this.close():this.disconnect()}};/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */let Et=(qc=class{constructor(t){y(this,Ip);y(this,eo,!1);y(this,to,!1);y(this,Vc);y(this,Fp);y(this,Dy,new Promise(t=>{_(this,Fp,t)}));y(this,Th);y(this,Pp);y(this,Ah);t&&t.timeout>0&&(_(this,Pp,new Sw(t.message)),_(this,Th,setTimeout(()=>{this.reject(o(this,Pp))},t.timeout)))}static create(t){return new qc(t)}static async race(t){const e=new Set;try{const n=t.map(a=>a instanceof qc?(o(a,Th)&&e.add(a),a.valueOrThrow()):a);return await Promise.race(n)}finally{for(const n of e)n.reject(new Error("Timeout cleared"))}}resolve(t){o(this,to)||o(this,eo)||(_(this,eo,!0),F(this,Ip,LE).call(this,t))}reject(t){o(this,to)||o(this,eo)||(_(this,to,!0),F(this,Ip,LE).call(this,t))}resolved(){return o(this,eo)}finished(){return o(this,eo)||o(this,to)}value(){return o(this,Vc)}valueOrThrow(){return o(this,Ah)||_(this,Ah,(async()=>{if(await o(this,Dy),o(this,to))throw o(this,Vc);return o(this,Vc)})()),o(this,Ah)}},eo=new WeakMap,to=new WeakMap,Vc=new WeakMap,Fp=new WeakMap,Dy=new WeakMap,Th=new WeakMap,Pp=new WeakMap,Ip=new WeakSet,LE=function(t){clearTimeout(o(this,Th)),_(this,Vc,t),o(this,Fp).call(this)},Ah=new WeakMap,qc);/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */let Dk=(ro=class{constructor(){y(this,Fh,!1);y(this,Mp,[])}async acquire(t){if(!o(this,Fh))return _(this,Fh,!0),new ro.Guard(this);const e=Et.create();return o(this,Mp).push(e.resolve.bind(e)),await e.valueOrThrow(),new ro.Guard(this,t)}release(){const t=o(this,Mp).shift();if(!t){_(this,Fh,!1);return}t()}},Fh=new WeakMap,Mp=new WeakMap,H(ro,"Guard",(uP=class{constructor(e,n){y(this,Dp);y(this,Op);_(this,Dp,e),_(this,Op,n)}[He](){var e;return(e=o(this,Op))==null||e.call(this),o(this,Dp).release()}},Dp=new WeakMap,Op=new WeakMap,uP)),ro);/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class xC extends Ue{constructor(){super();y(this,Gc);y(this,Ph,0)}startScreenshot(){const e=o(this,Gc)||new Dk;return _(this,Gc,e),Du(this,Ph)._++,e.acquire(()=>{Du(this,Ph)._--,o(this,Ph)===0&&_(this,Gc,void 0)})}waitForScreenshotOperations(){var e;return(e=o(this,Gc))==null?void 0:e.acquire()}async waitForTarget(e,n={}){const{timeout:a=3e4}=n;return await Er(v0(_t(this,"targetcreated"),_t(this,"targetchanged"),dt(this.targets())).pipe(x0(e),jr(En(a))))}get closed(){return!this.browser().browserContexts().includes(this)}get id(){}[He](){return void this.close().catch(Re)}[va](){return this.close()}}Gc=new WeakMap,Ph=new WeakMap;var St;(function(r){r.Disconnected=Symbol("CDPSession.Disconnected"),r.Swapped=Symbol("CDPSession.Swapped"),r.Ready=Symbol("CDPSession.Ready"),r.SessionAttached="sessionattached",r.SessionDetached="sessiondetached"})(St||(St={}));class k0 extends Ue{constructor(){super()}parentSession(){}}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class kC{constructor(t,e,n=""){y(this,Rp);y(this,Np);y(this,Lp);H(this,"handled",!1);_(this,Rp,t),_(this,Np,e),_(this,Lp,n)}type(){return o(this,Rp)}message(){return o(this,Np)}defaultValue(){return o(this,Lp)}async accept(t){Ee(!this.handled,"Cannot accept dialog which is already handled!"),this.handled=!0,await this.handle({accept:!0,text:t})}async dismiss(){Ee(!this.handled,"Cannot dismiss dialog which is already handled!"),this.handled=!0,await this.handle({accept:!1})}}Rp=new WeakMap,Np=new WeakMap,Lp=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Aw=Symbol("_isElementHandle");/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function Yn(r){return typeof r=="object"&&r!==null&&"name"in r&&"message"in r}function bC(r,t,e){return r.message=t,r.originalMessage=e??r.originalMessage,r}function _C(r){let t=r.error.message;return r.error&&typeof r.error=="object"&&"data"in r.error&&(t+=` ${r.error.data}`),t}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const EC=new Map,BR=r=>{let t=EC.get(r);return t||(t=new Function(`return ${r}`)(),EC.set(r,t),t)};function Va(r){let t=r.toString();try{new Function(`(${t})`)}catch(e){if(e.message.includes("Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy directive"))return t;let n="function ";t.startsWith("async ")&&(n=`async ${n}`,t=t.substring(6)),t=`${n}${t}`;try{new Function(`(${t})`)}catch{throw new Error("Passed function cannot be serialized!")}}return t}const qu=(r,t)=>{let e=Va(r);for(const[n,a]of Object.entries(t))e=e.replace(new RegExp(`PLACEHOLDER\\(\\s*(?:'${n}'|"${n}")\\s*\\)`,"g"),`(${a})`);return BR(e)};/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Fw=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Ok=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});const UR=20;async function*$R(r,t){const e={stack:[],error:void 0,hasError:!1};try{const a=await Fw(e,await r.evaluateHandle(async(c,l)=>{const u=[];for(;u.length<l;){const h=await c.next();if(h.done)break;u.push(h.value)}return u},t),!1).getProperties(),i=a.values();return Fw(e,new rr,!1).defer(()=>{for(const c of i){const l={stack:[],error:void 0,hasError:!1};try{Fw(l,c,!1)[He]()}catch(u){l.error=u,l.hasError=!0}finally{Ok(l)}}}),yield*i,a.size===0}catch(n){e.error=n,e.hasError=!0}finally{Ok(e)}}async function*jR(r){let t=UR;for(;!(yield*$R(r,t));)t<<=1}async function*SC(r){const t={stack:[],error:void 0,hasError:!1};try{const e=Fw(t,await r.evaluateHandle(n=>async function*(){yield*n}()),!1);yield*jR(e)}catch(e){t.error=e,t.hasError=!0}finally{Ok(t)}}/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Oy=class Oy{constructor(t){y(this,Bp);_(this,Bp,t)}async get(t){return await o(this,Bp).call(this,t)}};Bp=new WeakMap,H(Oy,"create",t=>new Oy(t));let Dn=Oy;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Pw=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Iw=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});class Li{static get _querySelector(){if(this.querySelector)return this.querySelector;if(!this.querySelectorAll)throw new Error("Cannot create default `querySelector`.");return this.querySelector=qu(async(t,e,n)=>{const i=PLACEHOLDER("querySelectorAll")(t,e,n);for await(const s of i)return s;return null},{querySelectorAll:Va(this.querySelectorAll)})}static get _querySelectorAll(){if(this.querySelectorAll)return this.querySelectorAll;if(!this.querySelector)throw new Error("Cannot create default `querySelectorAll`.");return this.querySelectorAll=qu(async function*(t,e,n){const i=await PLACEHOLDER("querySelector")(t,e,n);i&&(yield i)},{querySelector:Va(this.querySelector)})}static async*queryAll(t,e){const n={stack:[],error:void 0,hasError:!1};try{const a=Pw(n,await t.evaluateHandle(this._querySelectorAll,e,Dn.create(i=>i.puppeteerUtil)),!1);yield*SC(a)}catch(a){n.error=a,n.hasError=!0}finally{Iw(n)}}static async queryOne(t,e){const n={stack:[],error:void 0,hasError:!1};try{const a=Pw(n,await t.evaluateHandle(this._querySelector,e,Dn.create(i=>i.puppeteerUtil)),!1);return Aw in a?a.move():null}catch(a){n.error=a,n.hasError=!0}finally{Iw(n)}}static async waitFor(t,e,n){const a={stack:[],error:void 0,hasError:!1};try{let i;const s=Pw(a,await(async()=>{if(!(Aw in t)){i=t;return}return i=t.frame,await i.isolatedRealm().adoptHandle(t)})(),!1),{visible:c=!1,hidden:l=!1,timeout:u,signal:h}=n,d=c||l?"raf":n.polling;try{const f={stack:[],error:void 0,hasError:!1};try{h==null||h.throwIfAborted();const m=Pw(f,await i.isolatedRealm().waitForFunction(async(w,p,g,v,k)=>{const S=await w.createFunction(p)(v??document,g,w);return w.checkVisibility(S,k)},{polling:d,root:s,timeout:u,signal:h},Dn.create(w=>w.puppeteerUtil),Va(this._querySelector),e,s,c?!0:l?!1:void 0),!1);if(h!=null&&h.aborted)throw h.reason;return Aw in m?await i.mainRealm().transferHandle(m):null}catch(m){f.error=m,f.hasError=!0}finally{Iw(f)}}catch(f){throw!Yn(f)||f.name==="AbortError"||(f.message=`Waiting for selector \`${e}\` failed: ${f.message}`),f}}catch(i){a.error=i,a.hasError=!0}finally{Iw(a)}}}H(Li,"querySelectorAll"),H(Li,"querySelector");class Gu{static async*map(t,e){for await(const n of t)yield await e(n)}static async*flatMap(t,e){for await(const n of t)yield*e(n)}static async collect(t){const e=[];for await(const n of t)e.push(n);return e}static async first(t){for await(const e of t)return e}}/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const HR=r=>["name","role"].includes(r),WR=/\[\s*(?<attribute>\w+)\s*=\s*(?<quote>"|')(?<value>\\.|.*?(?=\k<quote>))\k<quote>\s*\]/g,zR=r=>{const t={},e=r.replace(WR,(n,a,i,s)=>(Ee(HR(a),`Unknown aria attribute "${a}" in selector`),t[a]=s,""));return e&&!t.name&&(t.name=e),t},Up=class Up extends Li{static async*queryAll(t,e){const{name:n,role:a}=zR(e);yield*t.queryAXTree(n,a)}};H(Up,"querySelector",async(t,e,{ariaQuerySelector:n})=>await n(t,e)),H(Up,"queryOne",async(t,e)=>await Gu.first(Up.queryAll(t,e))??null);let kc=Up;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Dw extends Li{}H(Dw,"querySelector",(t,e,{cssQuerySelector:n})=>n(t,e)),H(Dw,"querySelectorAll",(t,e,{cssQuerySelectorAll:n})=>n(t,e));const KR='"use strict";var g=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var Y=Object.prototype.hasOwnProperty;var l=(t,e)=>{for(var r in e)g(t,r,{get:e[r],enumerable:!0})},J=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of B(e))!Y.call(t,n)&&n!==r&&g(t,n,{get:()=>e[n],enumerable:!(o=X(e,n))||o.enumerable});return t};var z=t=>J(g({},"__esModule",{value:!0}),t);var pe={};l(pe,{default:()=>he});module.exports=z(pe);var N=class extends Error{constructor(e,r){super(e,r),this.name=this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}},p=class extends N{};var c=class t{static create(e){return new t(e)}static async race(e){let r=new Set;try{let o=e.map(n=>n instanceof t?(n.#n&&r.add(n),n.valueOrThrow()):n);return await Promise.race(o)}finally{for(let o of r)o.reject(new Error("Timeout cleared"))}}#e=!1;#r=!1;#o;#t;#a=new Promise(e=>{this.#t=e});#n;#i;constructor(e){e&&e.timeout>0&&(this.#i=new p(e.message),this.#n=setTimeout(()=>{this.reject(this.#i)},e.timeout))}#l(e){clearTimeout(this.#n),this.#o=e,this.#t()}resolve(e){this.#r||this.#e||(this.#e=!0,this.#l(e))}reject(e){this.#r||this.#e||(this.#r=!0,this.#l(e))}resolved(){return this.#e}finished(){return this.#e||this.#r}value(){return this.#o}#s;valueOrThrow(){return this.#s||(this.#s=(async()=>{if(await this.#a,this.#r)throw this.#o;return this.#o})()),this.#s}};var L=new Map,F=t=>{let e=L.get(t);return e||(e=new Function(`return ${t}`)(),L.set(t,e),e)};var x={};l(x,{ariaQuerySelector:()=>G,ariaQuerySelectorAll:()=>b});var G=(t,e)=>globalThis.__ariaQuerySelector(t,e),b=async function*(t,e){yield*await globalThis.__ariaQuerySelectorAll(t,e)};var E={};l(E,{cssQuerySelector:()=>K,cssQuerySelectorAll:()=>Z});var K=(t,e)=>t.querySelector(e),Z=function(t,e){return t.querySelectorAll(e)};var A={};l(A,{customQuerySelectors:()=>P});var v=class{#e=new Map;register(e,r){if(!r.queryOne&&r.queryAll){let o=r.queryAll;r.queryOne=(n,i)=>{for(let s of o(n,i))return s;return null}}else if(r.queryOne&&!r.queryAll){let o=r.queryOne;r.queryAll=(n,i)=>{let s=o(n,i);return s?[s]:[]}}else if(!r.queryOne||!r.queryAll)throw new Error("At least one query method must be defined.");this.#e.set(e,{querySelector:r.queryOne,querySelectorAll:r.queryAll})}unregister(e){this.#e.delete(e)}get(e){return this.#e.get(e)}clear(){this.#e.clear()}},P=new v;var R={};l(R,{pierceQuerySelector:()=>ee,pierceQuerySelectorAll:()=>te});var ee=(t,e)=>{let r=null,o=n=>{let i=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT);do{let s=i.currentNode;s.shadowRoot&&o(s.shadowRoot),!(s instanceof ShadowRoot)&&s!==n&&!r&&s.matches(e)&&(r=s)}while(!r&&i.nextNode())};return t instanceof Document&&(t=t.documentElement),o(t),r},te=(t,e)=>{let r=[],o=n=>{let i=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT);do{let s=i.currentNode;s.shadowRoot&&o(s.shadowRoot),!(s instanceof ShadowRoot)&&s!==n&&s.matches(e)&&r.push(s)}while(i.nextNode())};return t instanceof Document&&(t=t.documentElement),o(t),r};var u=(t,e)=>{if(!t)throw new Error(e)};var y=class{#e;#r;#o;#t;constructor(e,r){this.#e=e,this.#r=r}async start(){let e=this.#t=c.create(),r=await this.#e();if(r){e.resolve(r);return}this.#o=new MutationObserver(async()=>{let o=await this.#e();o&&(e.resolve(o),await this.stop())}),this.#o.observe(this.#r,{childList:!0,subtree:!0,attributes:!0})}async stop(){u(this.#t,"Polling never started."),this.#t.finished()||this.#t.reject(new Error("Polling stopped")),this.#o&&(this.#o.disconnect(),this.#o=void 0)}result(){return u(this.#t,"Polling never started."),this.#t.valueOrThrow()}},w=class{#e;#r;constructor(e){this.#e=e}async start(){let e=this.#r=c.create(),r=await this.#e();if(r){e.resolve(r);return}let o=async()=>{if(e.finished())return;let n=await this.#e();if(!n){window.requestAnimationFrame(o);return}e.resolve(n),await this.stop()};window.requestAnimationFrame(o)}async stop(){u(this.#r,"Polling never started."),this.#r.finished()||this.#r.reject(new Error("Polling stopped"))}result(){return u(this.#r,"Polling never started."),this.#r.valueOrThrow()}},T=class{#e;#r;#o;#t;constructor(e,r){this.#e=e,this.#r=r}async start(){let e=this.#t=c.create(),r=await this.#e();if(r){e.resolve(r);return}this.#o=setInterval(async()=>{let o=await this.#e();o&&(e.resolve(o),await this.stop())},this.#r)}async stop(){u(this.#t,"Polling never started."),this.#t.finished()||this.#t.reject(new Error("Polling stopped")),this.#o&&(clearInterval(this.#o),this.#o=void 0)}result(){return u(this.#t,"Polling never started."),this.#t.valueOrThrow()}};var _={};l(_,{PCombinator:()=>H,pQuerySelector:()=>fe,pQuerySelectorAll:()=>$});var a=class{static async*map(e,r){for await(let o of e)yield await r(o)}static async*flatMap(e,r){for await(let o of e)yield*r(o)}static async collect(e){let r=[];for await(let o of e)r.push(o);return r}static async first(e){for await(let r of e)return r}};var C={};l(C,{textQuerySelectorAll:()=>m});var re=new Set(["checkbox","image","radio"]),oe=t=>t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement||t instanceof HTMLInputElement&&!re.has(t.type),ne=new Set(["SCRIPT","STYLE"]),f=t=>!ne.has(t.nodeName)&&!document.head?.contains(t),I=new WeakMap,j=t=>{for(;t;)I.delete(t),t instanceof ShadowRoot?t=t.host:t=t.parentNode},W=new WeakSet,se=new MutationObserver(t=>{for(let e of t)j(e.target)}),d=t=>{let e=I.get(t);if(e||(e={full:"",immediate:[]},!f(t)))return e;let r="";if(oe(t))e.full=t.value,e.immediate.push(t.value),t.addEventListener("input",o=>{j(o.target)},{once:!0,capture:!0});else{for(let o=t.firstChild;o;o=o.nextSibling){if(o.nodeType===Node.TEXT_NODE){e.full+=o.nodeValue??"",r+=o.nodeValue??"";continue}r&&e.immediate.push(r),r="",o.nodeType===Node.ELEMENT_NODE&&(e.full+=d(o).full)}r&&e.immediate.push(r),t instanceof Element&&t.shadowRoot&&(e.full+=d(t.shadowRoot).full),W.has(t)||(se.observe(t,{childList:!0,characterData:!0,subtree:!0}),W.add(t))}return I.set(t,e),e};var m=function*(t,e){let r=!1;for(let o of t.childNodes)if(o instanceof Element&&f(o)){let n;o.shadowRoot?n=m(o.shadowRoot,e):n=m(o,e);for(let i of n)yield i,r=!0}r||t instanceof Element&&f(t)&&d(t).full.includes(e)&&(yield t)};var k={};l(k,{checkVisibility:()=>le,pierce:()=>S,pierceAll:()=>O});var ie=["hidden","collapse"],le=(t,e)=>{if(!t)return e===!1;if(e===void 0)return t;let r=t.nodeType===Node.TEXT_NODE?t.parentElement:t,o=window.getComputedStyle(r),n=o&&!ie.includes(o.visibility)&&!ae(r);return e===n?t:!1};function ae(t){let e=t.getBoundingClientRect();return e.width===0||e.height===0}var ce=t=>"shadowRoot"in t&&t.shadowRoot instanceof ShadowRoot;function*S(t){ce(t)?yield t.shadowRoot:yield t}function*O(t){t=S(t).next().value,yield t;let e=[document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT)];for(let r of e){let o;for(;o=r.nextNode();)o.shadowRoot&&(yield o.shadowRoot,e.push(document.createTreeWalker(o.shadowRoot,NodeFilter.SHOW_ELEMENT)))}}var Q={};l(Q,{xpathQuerySelectorAll:()=>q});var q=function*(t,e,r=-1){let n=(t.ownerDocument||document).evaluate(e,t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE),i=[],s;for(;(s=n.iterateNext())&&(i.push(s),!(r&&i.length===r)););for(let h=0;h<i.length;h++)s=i[h],yield s,delete i[h]};var ue=/[-\\w\\P{ASCII}*]/u,H=(r=>(r.Descendent=">>>",r.Child=">>>>",r))(H||{}),V=t=>"querySelectorAll"in t,M=class{#e;#r=[];#o=void 0;elements;constructor(e,r){this.elements=[e],this.#e=r,this.#t()}async run(){if(typeof this.#o=="string")switch(this.#o.trimStart()){case":scope":this.#t();break}for(;this.#o!==void 0;this.#t()){let e=this.#o;typeof e=="string"?e[0]&&ue.test(e[0])?this.elements=a.flatMap(this.elements,async function*(r){V(r)&&(yield*r.querySelectorAll(e))}):this.elements=a.flatMap(this.elements,async function*(r){if(!r.parentElement){if(!V(r))return;yield*r.querySelectorAll(e);return}let o=0;for(let n of r.parentElement.children)if(++o,n===r)break;yield*r.parentElement.querySelectorAll(`:scope>:nth-child(${o})${e}`)}):this.elements=a.flatMap(this.elements,async function*(r){switch(e.name){case"text":yield*m(r,e.value);break;case"xpath":yield*q(r,e.value);break;case"aria":yield*b(r,e.value);break;default:let o=P.get(e.name);if(!o)throw new Error(`Unknown selector type: ${e.name}`);yield*o.querySelectorAll(r,e.value)}})}}#t(){if(this.#r.length!==0){this.#o=this.#r.shift();return}if(this.#e.length===0){this.#o=void 0;return}let e=this.#e.shift();switch(e){case">>>>":{this.elements=a.flatMap(this.elements,S),this.#t();break}case">>>":{this.elements=a.flatMap(this.elements,O),this.#t();break}default:this.#r=e,this.#t();break}}},D=class{#e=new WeakMap;calculate(e,r=[]){if(e===null)return r;e instanceof ShadowRoot&&(e=e.host);let o=this.#e.get(e);if(o)return[...o,...r];let n=0;for(let s=e.previousSibling;s;s=s.previousSibling)++n;let i=this.calculate(e.parentNode,[n]);return this.#e.set(e,i),[...i,...r]}},U=(t,e)=>{if(t.length+e.length===0)return 0;let[r=-1,...o]=t,[n=-1,...i]=e;return r===n?U(o,i):r<n?-1:1},de=async function*(t){let e=new Set;for await(let o of t)e.add(o);let r=new D;yield*[...e.values()].map(o=>[o,r.calculate(o)]).sort(([,o],[,n])=>U(o,n)).map(([o])=>o)},$=function(t,e){let r=JSON.parse(e);if(r.some(o=>{let n=0;return o.some(i=>(typeof i=="string"?++n:n=0,n>1))}))throw new Error("Multiple deep combinators found in sequence.");return de(a.flatMap(r,o=>{let n=new M(t,o);return n.run(),n.elements}))},fe=async function(t,e){for await(let r of $(t,e))return r;return null};var me=Object.freeze({...x,...A,...R,..._,...C,...k,...Q,...E,Deferred:c,createFunction:F,createTextContent:d,IntervalPoller:T,isSuitableNodeForTextMatching:f,MutationPoller:y,RAFPoller:w}),he=me;\n';/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class VR{constructor(){y(this,Xc);y(this,Ih,!1);y(this,Dh,new Set)}append(t){F(this,Xc,BE).call(this,()=>{o(this,Dh).add(t)})}pop(t){F(this,Xc,BE).call(this,()=>{o(this,Dh).delete(t)})}inject(t,e=!1){(o(this,Ih)||e)&&t(F(this,Xc,yP).call(this)),_(this,Ih,!1)}}Ih=new WeakMap,Dh=new WeakMap,Xc=new WeakSet,BE=function(t){t(),_(this,Ih,!0)},yP=function(){return`(() => {
      const module = {};
      ${KR}
      ${[...o(this,Dh)].map(t=>`(${t})(module.exports.default);`).join("")}
      return module.exports.default;
    })()`};const b0=new VR;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class qR{constructor(){y(this,Pa,new Map)}get(t){const e=o(this,Pa).get(t);return e?e[1]:void 0}register(t,e){var i;Ee(!o(this,Pa).has(t),`Cannot register over existing handler: ${t}`),Ee(/^[a-zA-Z]+$/.test(t),"Custom query handler names may only contain [a-zA-Z]"),Ee(e.queryAll||e.queryOne,"At least one query method must be implemented.");const n=(i=class extends Li{},H(i,"querySelectorAll",qu((s,c,l)=>l.customQuerySelectors.get(PLACEHOLDER("name")).querySelectorAll(s,c),{name:JSON.stringify(t)})),H(i,"querySelector",qu((s,c,l)=>l.customQuerySelectors.get(PLACEHOLDER("name")).querySelector(s,c),{name:JSON.stringify(t)})),i),a=qu(s=>{s.customQuerySelectors.register(PLACEHOLDER("name"),{queryAll:PLACEHOLDER("queryAll"),queryOne:PLACEHOLDER("queryOne")})},{name:JSON.stringify(t),queryAll:e.queryAll?Va(e.queryAll):String(void 0),queryOne:e.queryOne?Va(e.queryOne):String(void 0)}).toString();o(this,Pa).set(t,[a,n]),b0.append(a)}unregister(t){const e=o(this,Pa).get(t);if(!e)throw new Error(`Cannot unregister unknown handler: ${t}`);b0.pop(e[0]),o(this,Pa).delete(t)}names(){return[...o(this,Pa).keys()]}clear(){for(const[t]of o(this,Pa))b0.pop(t);o(this,Pa).clear()}}Pa=new WeakMap;const Mk=new qR;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Rk extends Li{}H(Rk,"querySelector",(t,e,{pierceQuerySelector:n})=>n(t,e)),H(Rk,"querySelectorAll",(t,e,{pierceQuerySelectorAll:n})=>n(t,e));/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Nk extends Li{}H(Nk,"querySelectorAll",(t,e,{pQuerySelectorAll:n})=>n(t,e)),H(Nk,"querySelector",(t,e,{pQuerySelector:n})=>n(t,e));var Xu={attribute:/\[\s*(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)\s*(?:(?<operator>\W?=)\s*(?<value>.+?)\s*(\s(?<caseSensitive>[iIsS]))?\s*)?\]/gu,id:/#(?<name>[-\w\P{ASCII}]+)/gu,class:/\.(?<name>[-\w\P{ASCII}]+)/gu,comma:/\s*,\s*/g,combinator:/\s*[\s>+~]\s*/g,"pseudo-element":/::(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>¶*)\))?/gu,"pseudo-class":/:(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>¶*)\))?/gu,universal:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?\*/gu,type:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)/gu},GR=new Set(["combinator","comma"]),XR=r=>{switch(r){case"pseudo-element":case"pseudo-class":return new RegExp(Xu[r].source.replace("(?<argument>¶*)","(?<argument>.*)"),"gu");default:return Xu[r]}};function YR(r,t){let e=0,n="";for(;t<r.length;t++){const a=r[t];switch(a){case"(":++e;break;case")":--e;break}if(n+=a,e===0)return n}return n}function JR(r,t=Xu){if(!r)return[];const e=[r];for(const[a,i]of Object.entries(t))for(let s=0;s<e.length;s++){const c=e[s];if(typeof c!="string")continue;i.lastIndex=0;const l=i.exec(c);if(!l)continue;const u=l.index-1,h=[],d=l[0],f=c.slice(0,u+1);f&&h.push(f),h.push({...l.groups,type:a,content:d});const m=c.slice(u+d.length+1);m&&h.push(m),e.splice(s,1,...h)}let n=0;for(const a of e)switch(typeof a){case"string":throw new Error(`Unexpected sequence ${a} found at index ${n}`);case"object":n+=a.content.length,a.pos=[n-a.content.length,n],GR.has(a.type)&&(a.content=a.content.trim()||" ");break}return e}var ZR=/(['"])([^\\\n]+?)\1/g,QR=/\\./g;function e5(r,t=Xu){if(r=r.trim(),r==="")return[];const e=[];r=r.replace(QR,(i,s)=>(e.push({value:i,offset:s}),"".repeat(i.length))),r=r.replace(ZR,(i,s,c,l)=>(e.push({value:i,offset:l}),`${s}${"".repeat(c.length)}${s}`));{let i=0,s;for(;(s=r.indexOf("(",i))>-1;){const c=YR(r,s);e.push({value:c,offset:s}),r=`${r.substring(0,s)}(${"¶".repeat(c.length-2)})${r.substring(s+c.length)}`,i=s+c.length}}const n=JR(r,t),a=new Set;for(const i of e.reverse())for(const s of n){const{offset:c,value:l}=i;if(!(s.pos[0]<=c&&c+l.length<=s.pos[1]))continue;const{content:u}=s,h=c-s.pos[0];s.content=u.slice(0,h)+l+u.slice(h+l.length),s.content!==u&&a.add(s)}for(const i of a){const s=XR(i.type);if(!s)throw new Error(`Unknown token type: ${i.type}`);s.lastIndex=0;const c=s.exec(i.content);if(!c)throw new Error(`Unable to parse content for ${i.type}: ${i.content}`);Object.assign(i,c.groups)}return n}function*Ow(r,t){switch(r.type){case"list":for(let e of r.list)yield*Ow(e,r);break;case"complex":yield*Ow(r.left,r),yield*Ow(r.right,r);break;case"compound":yield*r.list.map(e=>[e,r]);break;default:yield[r,t]}}function _0(r){let t;return Array.isArray(r)?t=r:t=[...Ow(r)].map(([e])=>e),t.map(e=>e.content).join("")}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */Xu.nesting=/&/g,Xu.combinator=/\s*(>>>>?|[\s>+~])\s*/g;const t5=/\\[\s\S]/g,r5=r=>r.length<=1?r:((r[0]==='"'||r[0]==="'")&&r.endsWith(r[0])&&(r=r.slice(1,-1)),r.replace(t5,t=>t[1]));function n5(r){let t=!0,e=!1,n=!1;const a=e5(r);if(a.length===0)return[[],t,n,!1];let i=[],s=[i];const c=[s],l=[];for(const u of a){switch(u.type){case"combinator":switch(u.content){case">>>":t=!1,l.length&&(i.push(_0(l)),l.splice(0)),i=[],s.push(">>>"),s.push(i);continue;case">>>>":t=!1,l.length&&(i.push(_0(l)),l.splice(0)),i=[],s.push(">>>>"),s.push(i);continue}break;case"pseudo-element":if(!u.name.startsWith("-p-"))break;t=!1,l.length&&(i.push(_0(l)),l.splice(0));const h=u.name.slice(3);h==="aria"&&(e=!0),i.push({name:h,value:r5(u.argument??"")});continue;case"pseudo-class":n=!0;break;case"comma":l.length&&(i.push(_0(l)),l.splice(0)),i=[],s=[i],c.push(s);continue}l.push(u)}return l.length&&i.push(_0(l)),[c,t,n,e]}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class CC extends Li{}H(CC,"querySelectorAll",(t,e,{textQuerySelectorAll:n})=>n(t,e));/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Lk extends Li{}H(Lk,"querySelectorAll",(t,e,{xpathQuerySelectorAll:n})=>n(t,e)),H(Lk,"querySelector",(t,e,{xpathQuerySelectorAll:n})=>{for(const a of n(t,e,1))return a;return null});/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const a5={aria:kc,pierce:Rk,xpath:Lk,text:CC},i5=["=","/"];function Mw(r){for(const t of[Mk.names().map(e=>[e,Mk.get(e)]),Object.entries(a5)])for(const[e,n]of t)for(const a of i5){const i=`${e}${a}`;if(r.startsWith(i))return r=r.slice(i.length),{updatedSelector:r,polling:e==="aria"?"raf":"mutation",QueryHandler:n}}try{const[t,e,n,a]=n5(r);return e?{updatedSelector:r,polling:n?"raf":"mutation",QueryHandler:Dw}:{updatedSelector:JSON.stringify(t),polling:a?"raf":"mutation",QueryHandler:Nk}}catch{return{updatedSelector:r,polling:"mutation",QueryHandler:Dw}}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var s5=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},o5=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});const E0=new WeakSet;function c5(r,t){let e=!1;if(r.prototype[He]){const n=r.prototype[He];r.prototype[He]=function(){if(E0.has(this)){E0.delete(this);return}return n.call(this)},e=!0}if(r.prototype[va]){const n=r.prototype[va];r.prototype[va]=function(){if(E0.has(this)){E0.delete(this);return}return n.call(this)},e=!0}return e&&(r.prototype.move=function(){return E0.add(this),this}),r}function Fe(r=t=>`Attempted to use disposed ${t.constructor.name}.`){return(t,e)=>function(...n){if(this.disposed)throw new Error(r(this));return t.call(this,...n)}}function Ds(r,t){return function(...e){if(!this.disposed)return r.call(this,...e)}}function xa(r,t){const e=new WeakMap;let n=-1;return function(...a){if(n===-1&&(n=a.length),n!==a.length)throw new Error("Memoized method was called with the wrong number of arguments");let i=!1,s=e;for(const c of a)s.has(c)||(i=!0,s.set(c,new WeakMap)),s=s.get(c);if(i)return r.call(this,...a)}}function l5(r=function(){return this}){return(t,e)=>{const n=new WeakMap;return async function(...a){const i={stack:[],error:void 0,hasError:!1};try{const s=r.call(this);let c=n.get(s);c||(c=new Dk,n.set(s,c));const l=s5(i,await c.acquire(),!0);return await t.call(this,...a)}catch(s){i.error=s,i.hasError=!0}finally{const s=o5(i);s&&await s}}}}const Rw=new WeakMap,TC=function(r){const t=Rw.get(this)??new Map;if(t.has(r))return;const e=r!==void 0?(n,a)=>{r.includes(n)&&this.emit(n,a)}:(n,a)=>{this.emit(n,a)};t.set(r,e),Rw.set(this,t)};function Nw(r){return({set:t,get:e},n)=>(n.addInitializer(function(){return TC.apply(this,[r])}),{set(a){const i=Rw.get(this).get(r),s=e.call(this);s!==void 0&&s.off("*",i),a!==void 0&&(a.on("*",i),t.call(this,a))},init(a){if(a===void 0)return a;TC.apply(this,[r]);const i=Rw.get(this).get(r);return a.on("*",i),a}})}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var AC=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Bk=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},u5=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},h5=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});let bc=(()=>{var c;let r=[c5],t,e=[],n,a=[],i,s;return c=class{constructor(){AC(this,a)}async evaluate(u,...h){return u=Cr(this.evaluate.name,u),await this.realm.evaluate(u,this,...h)}async evaluateHandle(u,...h){return u=Cr(this.evaluateHandle.name,u),await this.realm.evaluateHandle(u,this,...h)}async getProperty(u){return await this.evaluateHandle((h,d)=>h[d],u)}async getProperties(){const u=await this.evaluate(f=>{var p;const m=[],w=Object.getOwnPropertyDescriptors(f);for(const g in w)(p=w[g])!=null&&p.enumerable&&m.push(g);return m}),h=new Map,d=await Promise.all(u.map(f=>this.getProperty(f)));for(const[f,m]of Object.entries(u)){const w={stack:[],error:void 0,hasError:!1};try{const p=u5(w,d[f],!1);p&&h.set(m,p.move())}catch(p){w.error=p,w.hasError=!0}finally{h5(w)}}return h}[(i=[Fe()],s=[Fe()],He)](){return void this.dispose().catch(Re)}[va](){return this.dispose()}},n=c,(()=>{const u=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;Bk(c,null,i,{kind:"method",name:"getProperty",static:!1,private:!1,access:{has:h=>"getProperty"in h,get:h=>h.getProperty},metadata:u},null,a),Bk(c,null,s,{kind:"method",name:"getProperties",static:!1,private:!1,access:{has:h=>"getProperties"in h,get:h=>h.getProperties},metadata:u},null,a),Bk(null,t={value:n},r,{kind:"class",name:n.name,metadata:u},null,e),n=t.value,u&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),AC(n,e)})(),n})();/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var d5=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},xt=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},S0=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},C0=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n}),f5=function(r,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:e?"".concat(e," ",t):t})};function ft(r,t){return async function(...e){if(this.realm===this.frame.isolatedRealm())return await r.call(this,...e);let n;this.isolatedHandle?n=this.isolatedHandle:this.isolatedHandle=n=await this.frame.isolatedRealm().adoptHandle(this);const a=await r.call(n,...e);return a===n?this:a instanceof bc?await this.realm.transferHandle(a):(Array.isArray(a)&&await Promise.all(a.map(async(i,s,c)=>{i instanceof bc&&(c[s]=await this.realm.transferHandle(i))})),a instanceof Map&&await Promise.all([...a.entries()].map(async([i,s])=>{s instanceof bc&&a.set(i,await this.realm.transferHandle(s))})),a)}}let FC=(()=>{var oe,UE,$E,jE,xP,HE,WE,kP,bP,_P,ue;let r=bc,t=[],e,n,a,i,s,c,l,u,h,d,f,m,w,p,g,v,k,x,S,I,O,E,T,P,W,U,A,N,C,K,ne,X;return ue=class extends r{constructor(te){super();y(this,oe);H(this,"isolatedHandle",d5(this,t));H(this,"handle");this.handle=te,this[Aw]=!0}get id(){return this.handle.id}get disposed(){return this.handle.disposed}async getProperty(te){return await this.handle.getProperty(te)}async getProperties(){return await this.handle.getProperties()}async evaluate(te,...D){return te=Cr(this.evaluate.name,te),await this.handle.evaluate(te,...D)}async evaluateHandle(te,...D){return te=Cr(this.evaluateHandle.name,te),await this.handle.evaluateHandle(te,...D)}async jsonValue(){return await this.handle.jsonValue()}toString(){return this.handle.toString()}remoteObject(){return this.handle.remoteObject()}dispose(){return this.handle.dispose()}asElement(){return this}async $(te){const{updatedSelector:D,QueryHandler:he}=Mw(te);return await he.queryOne(this,D)}async $$(te,D){return(D==null?void 0:D.isolate)===!1?await F(this,oe,$E).call(this,te):await o(this,oe,UE).call(this,te)}async $eval(te,D,...he){const b={stack:[],error:void 0,hasError:!1};try{D=Cr(this.$eval.name,D);const ee=S0(b,await this.$(te),!1);if(!ee)throw new Error(`Error: failed to find element matching selector "${te}"`);return await ee.evaluate(D,...he)}catch(ee){b.error=ee,b.hasError=!0}finally{C0(b)}}async $$eval(te,D,...he){const b={stack:[],error:void 0,hasError:!1};try{D=Cr(this.$$eval.name,D);const ee=await this.$$(te),re=S0(b,await this.evaluateHandle((z,...ie)=>ie,...ee),!1),[j]=await Promise.all([re.evaluate(D,...he),...ee.map(z=>z.dispose())]);return j}catch(ee){b.error=ee,b.hasError=!0}finally{C0(b)}}async waitForSelector(te,D={}){const{updatedSelector:he,QueryHandler:b,polling:ee}=Mw(te);return await b.waitFor(this,he,{polling:ee,...D})}async isVisible(){return await F(this,oe,jE).call(this,!0)}async isHidden(){return await F(this,oe,jE).call(this,!1)}async toElement(te){if(!await this.evaluate((he,b)=>he.nodeName===b.toUpperCase(),te))throw new Error(`Element is not a(n) \`${te}\` element`);return this}async clickablePoint(te){const D=await F(this,oe,xP).call(this);if(!D)throw new Error("Node is either not clickable or not an Element");return te!==void 0?{x:D.x+te.x,y:D.y+te.y}:{x:D.x+D.width/2,y:D.y+D.height/2}}async hover(){await this.scrollIntoViewIfNeeded();const{x:te,y:D}=await this.clickablePoint();await this.frame.page().mouse.move(te,D)}async click(te={}){await this.scrollIntoViewIfNeeded();const{x:D,y:he}=await this.clickablePoint(te.offset);await this.frame.page().mouse.click(D,he,te)}async drag(te){await this.scrollIntoViewIfNeeded();const D=this.frame.page();if(D.isDragInterceptionEnabled()){const he=await this.clickablePoint();return te instanceof ue&&(te=await te.clickablePoint()),await D.mouse.drag(he,te)}try{D._isDragging||(D._isDragging=!0,await this.hover(),await D.mouse.down()),te instanceof ue?await te.hover():await D.mouse.move(te.x,te.y)}catch(he){throw D._isDragging=!1,he}}async dragEnter(te={items:[],dragOperationsMask:1}){const D=this.frame.page();await this.scrollIntoViewIfNeeded();const he=await this.clickablePoint();await D.mouse.dragEnter(he,te)}async dragOver(te={items:[],dragOperationsMask:1}){const D=this.frame.page();await this.scrollIntoViewIfNeeded();const he=await this.clickablePoint();await D.mouse.dragOver(he,te)}async drop(te={items:[],dragOperationsMask:1}){const D=this.frame.page();if("items"in te){await this.scrollIntoViewIfNeeded();const he=await this.clickablePoint();await D.mouse.drop(he,te)}else await te.drag(this),D._isDragging=!1,await D.mouse.up()}async dragAndDrop(te,D){const he=this.frame.page();Ee(he.isDragInterceptionEnabled(),"Drag Interception is not enabled!"),await this.scrollIntoViewIfNeeded();const b=await this.clickablePoint(),ee=await te.clickablePoint();await he.mouse.dragAndDrop(b,ee,D)}async select(...te){for(const D of te)Ee(Ni(D),'Values must be strings. Found value "'+D+'" of type "'+typeof D+'"');return await this.evaluate((D,he)=>{const b=new Set(he);if(!(D instanceof HTMLSelectElement))throw new Error("Element is not a <select> element.");const ee=new Set;if(D.multiple)for(const re of D.options)re.selected=b.has(re.value),re.selected&&ee.add(re.value);else{for(const re of D.options)re.selected=!1;for(const re of D.options)if(b.has(re.value)){re.selected=!0,ee.add(re.value);break}}return D.dispatchEvent(new Event("input",{bubbles:!0})),D.dispatchEvent(new Event("change",{bubbles:!0})),[...ee.values()]},te)}async tap(){await this.scrollIntoViewIfNeeded();const{x:te,y:D}=await this.clickablePoint();await this.frame.page().touchscreen.tap(te,D)}async touchStart(){await this.scrollIntoViewIfNeeded();const{x:te,y:D}=await this.clickablePoint();await this.frame.page().touchscreen.touchStart(te,D)}async touchMove(){await this.scrollIntoViewIfNeeded();const{x:te,y:D}=await this.clickablePoint();await this.frame.page().touchscreen.touchMove(te,D)}async touchEnd(){await this.scrollIntoViewIfNeeded(),await this.frame.page().touchscreen.touchEnd()}async focus(){await this.evaluate(te=>{if(!(te instanceof HTMLElement))throw new Error("Cannot focus non-HTMLElement");return te.focus()})}async type(te,D){await this.focus(),await this.frame.page().keyboard.type(te,D)}async press(te,D){await this.focus(),await this.frame.page().keyboard.press(te,D)}async boundingBox(){const te=await this.evaluate(he=>{if(!(he instanceof Element)||he.getClientRects().length===0)return null;const b=he.getBoundingClientRect();return{x:b.x,y:b.y,width:b.width,height:b.height}});if(!te)return null;const D=await F(this,oe,WE).call(this);return D?{x:te.x+D.x,y:te.y+D.y,height:te.height,width:te.width}:null}async boxModel(){const te=await this.evaluate(he=>{if(!(he instanceof Element)||he.getClientRects().length===0)return null;const b=he.getBoundingClientRect(),ee=window.getComputedStyle(he),re={padding:{left:parseInt(ee.paddingLeft,10),top:parseInt(ee.paddingTop,10),right:parseInt(ee.paddingRight,10),bottom:parseInt(ee.paddingBottom,10)},margin:{left:-parseInt(ee.marginLeft,10),top:-parseInt(ee.marginTop,10),right:-parseInt(ee.marginRight,10),bottom:-parseInt(ee.marginBottom,10)},border:{left:parseInt(ee.borderLeft,10),top:parseInt(ee.borderTop,10),right:parseInt(ee.borderRight,10),bottom:parseInt(ee.borderBottom,10)}},j=[{x:b.left,y:b.top},{x:b.left+b.width,y:b.top},{x:b.left+b.width,y:b.top+b.height},{x:b.left,y:b.top+b.height}],z=ye(j,re.border),ie=ye(z,re.padding),we=ye(j,re.margin);return{content:ie,padding:z,border:j,margin:we,width:b.width,height:b.height};function ye(le,be){return[{x:le[0].x+be.left,y:le[0].y+be.top},{x:le[1].x-be.right,y:le[1].y+be.top},{x:le[2].x-be.right,y:le[2].y-be.bottom},{x:le[3].x+be.left,y:le[3].y-be.bottom}]}});if(!te)return null;const D=await F(this,oe,WE).call(this);if(!D)return null;for(const he of["content","padding","border","margin"])for(const b of te[he])b.x+=D.x,b.y+=D.y;return te}async screenshot(te={}){const{scrollIntoView:D=!0,clip:he}=te,b=this.frame.page();D&&await this.scrollIntoViewIfNeeded();const ee=await F(this,oe,kP).call(this),[re,j]=await this.evaluate(()=>{if(!window.visualViewport)throw new Error("window.visualViewport is not supported.");return[window.visualViewport.pageLeft,window.visualViewport.pageTop]});return ee.x+=re,ee.y+=j,he&&(ee.x+=he.x,ee.y+=he.y,ee.height=he.height,ee.width=he.width),await b.screenshot({...te,clip:ee})}async assertConnectedElement(){const te=await this.evaluate(async D=>{if(!D.isConnected)return"Node is detached from document";if(D.nodeType!==Node.ELEMENT_NODE)return"Node is not of type HTMLElement"});if(te)throw new Error(te)}async scrollIntoViewIfNeeded(){await this.isIntersectingViewport({threshold:1})||await this.scrollIntoView()}async isIntersectingViewport(te={}){var he;const D={stack:[],error:void 0,hasError:!1};try{await this.assertConnectedElement();const b=await F(this,oe,bP).call(this);return await(S0(D,b&&await F(he=b,oe,_P).call(he),!1)??this).evaluate(async(re,j)=>{const z=await new Promise(ie=>{const we=new IntersectionObserver(ye=>{ie(ye[0].intersectionRatio),we.disconnect()});we.observe(re)});return j===1?z===1:z>j},te.threshold??0)}catch(b){D.error=b,D.hasError=!0}finally{C0(D)}}async scrollIntoView(){await this.assertConnectedElement(),await this.evaluate(async te=>{te.scrollIntoView({block:"center",inline:"center",behavior:"instant"})})}},oe=new WeakSet,UE=function(){return l.value},$E=async function(te){const{updatedSelector:D,QueryHandler:he}=Mw(te);return await Gu.collect(he.queryAll(this,D))},jE=async function(te){return await this.evaluate(async(D,he,b)=>!!he.checkVisibility(D,b),Dn.create(D=>D.puppeteerUtil),te)},xP=async function(){var ee;const te=await this.evaluate(re=>re instanceof Element?[...re.getClientRects()].map(j=>({x:j.x,y:j.y,width:j.width,height:j.height})):null);if(!(te!=null&&te.length))return null;await F(this,oe,HE).call(this,te);let D=this.frame,he;for(;he=D==null?void 0:D.parentFrame();){const re={stack:[],error:void 0,hasError:!1};try{const j=S0(re,await D.frameElement(),!1);if(!j)throw new Error("Unsupported frame type");const z=await j.evaluate(ie=>{if(ie.getClientRects().length===0)return null;const we=ie.getBoundingClientRect(),ye=window.getComputedStyle(ie);return{left:we.left+parseInt(ye.paddingLeft,10)+parseInt(ye.borderLeftWidth,10),top:we.top+parseInt(ye.paddingTop,10)+parseInt(ye.borderTopWidth,10)}});if(!z)return null;for(const ie of te)ie.x+=z.left,ie.y+=z.top;await F(ee=j,oe,HE).call(ee,te),D=he}catch(j){re.error=j,re.hasError=!0}finally{C0(re)}}const b=te.find(re=>re.width>=1&&re.height>=1);return b?{x:b.x,y:b.y,height:b.height,width:b.width}:null},HE=async function(te){const{documentWidth:D,documentHeight:he}=await this.frame.isolatedRealm().evaluate(()=>({documentWidth:document.documentElement.clientWidth,documentHeight:document.documentElement.clientHeight}));for(const b of te)p5(b,D,he)},WE=async function(){const te={x:0,y:0};let D=this.frame,he;for(;he=D==null?void 0:D.parentFrame();){const b={stack:[],error:void 0,hasError:!1};try{const ee=S0(b,await D.frameElement(),!1);if(!ee)throw new Error("Unsupported frame type");const re=await ee.evaluate(j=>{if(j.getClientRects().length===0)return null;const z=j.getBoundingClientRect(),ie=window.getComputedStyle(j);return{left:z.left+parseInt(ie.paddingLeft,10)+parseInt(ie.borderLeftWidth,10),top:z.top+parseInt(ie.paddingTop,10)+parseInt(ie.borderTopWidth,10)}});if(!re)return null;te.x+=re.left,te.y+=re.top,D=he}catch(ee){b.error=ee,b.hasError=!0}finally{C0(b)}}return te},kP=async function(){const te=await this.boundingBox();return Ee(te,"Node is either not visible or not an HTMLElement"),Ee(te.width!==0,"Node has 0 width."),Ee(te.height!==0,"Node has 0 height."),te},bP=async function(){return await this.evaluate(te=>te instanceof SVGElement)?this:null},_P=async function(){return await this.evaluateHandle(te=>te instanceof SVGSVGElement?te:te.ownerSVGElement)},(()=>{const te=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e=[Fe(),ft],n=[Fe(),ft],a=[Fe(),ft],i=[Fe(),ft],s=[Fe()],c=[ft],u=[Fe(),ft],h=[Fe(),ft],d=[Fe(),ft],f=[Fe(),ft],m=[Fe(),ft],w=[Fe(),ft],p=[Fe(),ft],g=[Fe(),ft],v=[Fe(),ft],k=[Fe(),ft],x=[Fe(),ft],S=[Fe(),ft],I=[Fe(),ft],O=[Fe(),ft],E=[Fe(),ft],T=[Fe(),ft],P=[Fe(),ft],W=[Fe(),ft],U=[Fe(),ft],A=[Fe(),ft],N=[Fe(),ft],C=[Fe(),ft],K=[Fe(),ft],ne=[Fe(),ft],X=[Fe(),ft],xt(ue,null,e,{kind:"method",name:"getProperty",static:!1,private:!1,access:{has:D=>"getProperty"in D,get:D=>D.getProperty},metadata:te},null,t),xt(ue,null,n,{kind:"method",name:"getProperties",static:!1,private:!1,access:{has:D=>"getProperties"in D,get:D=>D.getProperties},metadata:te},null,t),xt(ue,null,a,{kind:"method",name:"jsonValue",static:!1,private:!1,access:{has:D=>"jsonValue"in D,get:D=>D.jsonValue},metadata:te},null,t),xt(ue,null,i,{kind:"method",name:"$",static:!1,private:!1,access:{has:D=>"$"in D,get:D=>D.$},metadata:te},null,t),xt(ue,null,s,{kind:"method",name:"$$",static:!1,private:!1,access:{has:D=>"$$"in D,get:D=>D.$$},metadata:te},null,t),xt(ue,l={value:f5(async function(D){return await F(this,oe,$E).call(this,D)},"#$$")},c,{kind:"method",name:"#$$",static:!1,private:!0,access:{has:D=>_n(oe,D),get:D=>o(D,oe,UE)},metadata:te},null,t),xt(ue,null,u,{kind:"method",name:"waitForSelector",static:!1,private:!1,access:{has:D=>"waitForSelector"in D,get:D=>D.waitForSelector},metadata:te},null,t),xt(ue,null,h,{kind:"method",name:"isVisible",static:!1,private:!1,access:{has:D=>"isVisible"in D,get:D=>D.isVisible},metadata:te},null,t),xt(ue,null,d,{kind:"method",name:"isHidden",static:!1,private:!1,access:{has:D=>"isHidden"in D,get:D=>D.isHidden},metadata:te},null,t),xt(ue,null,f,{kind:"method",name:"toElement",static:!1,private:!1,access:{has:D=>"toElement"in D,get:D=>D.toElement},metadata:te},null,t),xt(ue,null,m,{kind:"method",name:"clickablePoint",static:!1,private:!1,access:{has:D=>"clickablePoint"in D,get:D=>D.clickablePoint},metadata:te},null,t),xt(ue,null,w,{kind:"method",name:"hover",static:!1,private:!1,access:{has:D=>"hover"in D,get:D=>D.hover},metadata:te},null,t),xt(ue,null,p,{kind:"method",name:"click",static:!1,private:!1,access:{has:D=>"click"in D,get:D=>D.click},metadata:te},null,t),xt(ue,null,g,{kind:"method",name:"drag",static:!1,private:!1,access:{has:D=>"drag"in D,get:D=>D.drag},metadata:te},null,t),xt(ue,null,v,{kind:"method",name:"dragEnter",static:!1,private:!1,access:{has:D=>"dragEnter"in D,get:D=>D.dragEnter},metadata:te},null,t),xt(ue,null,k,{kind:"method",name:"dragOver",static:!1,private:!1,access:{has:D=>"dragOver"in D,get:D=>D.dragOver},metadata:te},null,t),xt(ue,null,x,{kind:"method",name:"drop",static:!1,private:!1,access:{has:D=>"drop"in D,get:D=>D.drop},metadata:te},null,t),xt(ue,null,S,{kind:"method",name:"dragAndDrop",static:!1,private:!1,access:{has:D=>"dragAndDrop"in D,get:D=>D.dragAndDrop},metadata:te},null,t),xt(ue,null,I,{kind:"method",name:"select",static:!1,private:!1,access:{has:D=>"select"in D,get:D=>D.select},metadata:te},null,t),xt(ue,null,O,{kind:"method",name:"tap",static:!1,private:!1,access:{has:D=>"tap"in D,get:D=>D.tap},metadata:te},null,t),xt(ue,null,E,{kind:"method",name:"touchStart",static:!1,private:!1,access:{has:D=>"touchStart"in D,get:D=>D.touchStart},metadata:te},null,t),xt(ue,null,T,{kind:"method",name:"touchMove",static:!1,private:!1,access:{has:D=>"touchMove"in D,get:D=>D.touchMove},metadata:te},null,t),xt(ue,null,P,{kind:"method",name:"touchEnd",static:!1,private:!1,access:{has:D=>"touchEnd"in D,get:D=>D.touchEnd},metadata:te},null,t),xt(ue,null,W,{kind:"method",name:"focus",static:!1,private:!1,access:{has:D=>"focus"in D,get:D=>D.focus},metadata:te},null,t),xt(ue,null,U,{kind:"method",name:"type",static:!1,private:!1,access:{has:D=>"type"in D,get:D=>D.type},metadata:te},null,t),xt(ue,null,A,{kind:"method",name:"press",static:!1,private:!1,access:{has:D=>"press"in D,get:D=>D.press},metadata:te},null,t),xt(ue,null,N,{kind:"method",name:"boundingBox",static:!1,private:!1,access:{has:D=>"boundingBox"in D,get:D=>D.boundingBox},metadata:te},null,t),xt(ue,null,C,{kind:"method",name:"boxModel",static:!1,private:!1,access:{has:D=>"boxModel"in D,get:D=>D.boxModel},metadata:te},null,t),xt(ue,null,K,{kind:"method",name:"screenshot",static:!1,private:!1,access:{has:D=>"screenshot"in D,get:D=>D.screenshot},metadata:te},null,t),xt(ue,null,ne,{kind:"method",name:"isIntersectingViewport",static:!1,private:!1,access:{has:D=>"isIntersectingViewport"in D,get:D=>D.isIntersectingViewport},metadata:te},null,t),xt(ue,null,X,{kind:"method",name:"scrollIntoView",static:!1,private:!1,access:{has:D=>"scrollIntoView"in D,get:D=>D.scrollIntoView},metadata:te},null,t),te&&Object.defineProperty(ue,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:te})})(),ue})();function p5(r,t,e){r.width=Math.max(r.x>=0?Math.min(t-r.x,r.width):Math.min(t,r.width+r.x),0),r.height=Math.max(r.y>=0?Math.min(e-r.y,r.height):Math.min(e,r.height+r.y),0)}var m5=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},g5=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n}),Yu;(function(r){r.Action="action"})(Yu||(Yu={}));class Ju extends Ue{constructor(){super(...arguments);y(this,si);H(this,"visibility",null);H(this,"_timeout",3e4);y(this,Yc,!0);y(this,Jc,!0);y(this,Zc,!0);H(this,"operators",{conditions:(e,n)=>Sr(a=>v0(...e.map(i=>i(a,n))).pipe(oC(a))),retryAndRaceWithSignalAndTimer:(e,n)=>{const a=[];return e&&a.push(xc(e,n)),a.push(En(this._timeout,n)),TM(kw({delay:jw}),jr(...a))}});y(this,$p,(e,n)=>o(this,Jc)?dt(e.frame.waitForFunction(a=>a instanceof HTMLElement?!["BUTTON","INPUT","SELECT","TEXTAREA","OPTION","OPTGROUP"].includes(a.nodeName)||!a.hasAttribute("disabled"):!0,{timeout:this._timeout,signal:n},e)).pipe(yw()):gc);y(this,Qc,e=>o(this,Zc)?wc(()=>dt(e.evaluate(n=>new Promise(a=>{window.requestAnimationFrame(()=>{const i=n.getBoundingClientRect();window.requestAnimationFrame(()=>{const s=n.getBoundingClientRect();a([{x:i.x,y:i.y,width:i.width,height:i.height},{x:s.x,y:s.y,width:s.width,height:s.height}])})})})))).pipe(zu(([n,a])=>n.x===a.x&&n.y===a.y&&n.width===a.width&&n.height===a.height),kw({delay:jw}),yw()):gc);y(this,el,e=>o(this,Yc)?dt(e.isIntersectingViewport({threshold:0})).pipe(vc(n=>!n),Sr(()=>dt(e.scrollIntoView())),Sr(()=>wc(()=>dt(e.isIntersectingViewport({threshold:0}))).pipe(zu(Ka),kw({delay:jw}),yw()))):gc)}static race(e){return Uk.create(e)}get timeout(){return this._timeout}setTimeout(e){const n=this._clone();return n._timeout=e,n}setVisibility(e){const n=this._clone();return n.visibility=e,n}setWaitForEnabled(e){const n=this._clone();return _(n,Jc,e),n}setEnsureElementIsInTheViewport(e){const n=this._clone();return _(n,Yc,e),n}setWaitForStableBoundingBox(e){const n=this._clone();return _(n,Zc,e),n}copyOptions(e){return this._timeout=e._timeout,this.visibility=e.visibility,_(this,Jc,o(e,Jc)),_(this,Yc,o(e,Yc)),_(this,Zc,o(e,Zc)),this}clone(){return this._clone()}async waitHandle(e){const n=new Error("Locator.waitHandle");return await Er(this._wait(e).pipe(this.operators.retryAndRaceWithSignalAndTimer(e==null?void 0:e.signal,n)))}async wait(e){const n={stack:[],error:void 0,hasError:!1};try{return await m5(n,await this.waitHandle(e),!1).jsonValue()}catch(a){n.error=a,n.hasError=!0}finally{g5(n)}}map(e){return new Uw(this._clone(),n=>n.evaluateHandle(e))}filter(e){return new Bw(this._clone(),async(n,a)=>(await n.frame.waitForFunction(e,{signal:a,timeout:this._timeout},n),!0))}filterHandle(e){return new Bw(this._clone(),e)}mapHandle(e){return new Uw(this._clone(),e)}click(e){return Er(F(this,si,EP).call(this,e))}fill(e,n){return Er(F(this,si,SP).call(this,e,n))}hover(e){return Er(F(this,si,CP).call(this,e))}scroll(e){return Er(F(this,si,TP).call(this,e))}}Yc=new WeakMap,Jc=new WeakMap,Zc=new WeakMap,$p=new WeakMap,Qc=new WeakMap,el=new WeakMap,si=new WeakSet,EP=function(e){const n=e==null?void 0:e.signal,a=new Error("Locator.click");return this._wait(e).pipe(this.operators.conditions([o(this,el),o(this,Qc),o(this,$p)],n),_w(()=>this.emit(Yu.Action,void 0)),Sr(i=>dt(i.click(e)).pipe(y0(s=>{throw i.dispose().catch(Re),s}))),this.operators.retryAndRaceWithSignalAndTimer(n,a))},SP=function(e,n){const a=n==null?void 0:n.signal,i=new Error("Locator.fill");return this._wait(n).pipe(this.operators.conditions([o(this,el),o(this,Qc),o(this,$p)],a),_w(()=>this.emit(Yu.Action,void 0)),Sr(s=>dt(s.evaluate(c=>c instanceof HTMLSelectElement?"select":c instanceof HTMLTextAreaElement?"typeable-input":c instanceof HTMLInputElement?new Set(["textarea","text","url","tel","search","password","number","email"]).has(c.type)?"typeable-input":"other-input":c.isContentEditable?"contenteditable":"unknown")).pipe(Sr(c=>{switch(c){case"select":return dt(s.select(e).then(Wu));case"contenteditable":case"typeable-input":return dt(s.evaluate((l,u)=>{const h=l.isContentEditable?l.innerText:l.value;if(u.length<=h.length||!u.startsWith(l.value))return l.isContentEditable?l.innerText="":l.value="",u;const d=l.isContentEditable?l.innerText:l.value;return l.isContentEditable?(l.innerText="",l.innerText=d):(l.value="",l.value=d),u.substring(d.length)},e)).pipe(Sr(l=>dt(s.type(l))));case"other-input":return dt(s.focus()).pipe(Sr(()=>dt(s.evaluate((l,u)=>{l.value=u,l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0}))},e))));case"unknown":throw new Error("Element cannot be filled out.")}})).pipe(y0(c=>{throw s.dispose().catch(Re),c}))),this.operators.retryAndRaceWithSignalAndTimer(a,i))},CP=function(e){const n=e==null?void 0:e.signal,a=new Error("Locator.hover");return this._wait(e).pipe(this.operators.conditions([o(this,el),o(this,Qc)],n),_w(()=>this.emit(Yu.Action,void 0)),Sr(i=>dt(i.hover()).pipe(y0(s=>{throw i.dispose().catch(Re),s}))),this.operators.retryAndRaceWithSignalAndTimer(n,a))},TP=function(e){const n=e==null?void 0:e.signal,a=new Error("Locator.scroll");return this._wait(e).pipe(this.operators.conditions([o(this,el),o(this,Qc)],n),_w(()=>this.emit(Yu.Action,void 0)),Sr(i=>dt(i.evaluate((s,c,l)=>{c!==void 0&&(s.scrollTop=c),l!==void 0&&(s.scrollLeft=l)},e==null?void 0:e.scrollTop,e==null?void 0:e.scrollLeft)).pipe(y0(s=>{throw i.dispose().catch(Re),s}))),this.operators.retryAndRaceWithSignalAndTimer(n,a))};const My=class My extends Ju{constructor(e,n){super();y(this,Oh);y(this,Mh);_(this,Oh,e),_(this,Mh,n)}static create(e,n){return new My(e,n).setTimeout("getDefaultTimeout"in e?e.getDefaultTimeout():e.page().getDefaultTimeout())}_clone(){return new My(o(this,Oh),o(this,Mh))}_wait(e){const n=e==null?void 0:e.signal;return wc(()=>dt(o(this,Oh).waitForFunction(o(this,Mh),{timeout:this.timeout,signal:n}))).pipe(xw())}};Oh=new WeakMap,Mh=new WeakMap;let Lw=My;class PC extends Ju{constructor(e){super();y(this,nn);_(this,nn,e),this.copyOptions(o(this,nn))}get delegate(){return o(this,nn)}setTimeout(e){const n=super.setTimeout(e);return _(n,nn,o(this,nn).setTimeout(e)),n}setVisibility(e){const n=super.setVisibility(e);return _(n,nn,o(n,nn).setVisibility(e)),n}setWaitForEnabled(e){const n=super.setWaitForEnabled(e);return _(n,nn,o(this,nn).setWaitForEnabled(e)),n}setEnsureElementIsInTheViewport(e){const n=super.setEnsureElementIsInTheViewport(e);return _(n,nn,o(this,nn).setEnsureElementIsInTheViewport(e)),n}setWaitForStableBoundingBox(e){const n=super.setWaitForStableBoundingBox(e);return _(n,nn,o(this,nn).setWaitForStableBoundingBox(e)),n}}nn=new WeakMap;const mE=class mE extends PC{constructor(e,n){super(e);y(this,Rh);_(this,Rh,n)}_clone(){return new mE(this.delegate.clone(),o(this,Rh)).copyOptions(this)}_wait(e){return this.delegate._wait(e).pipe(Sr(n=>dt(Promise.resolve(o(this,Rh).call(this,n,e==null?void 0:e.signal))).pipe(vc(a=>a),tr(()=>n))),xw())}};Rh=new WeakMap;let Bw=mE;const gE=class gE extends PC{constructor(e,n){super(e);y(this,Nh);_(this,Nh,n)}_clone(){return new gE(this.delegate.clone(),o(this,Nh)).copyOptions(this)}_wait(e){return this.delegate._wait(e).pipe(Sr(n=>dt(Promise.resolve(o(this,Nh).call(this,n,e==null?void 0:e.signal)))))}};Nh=new WeakMap;let Uw=gE;const Ny=class Ny extends Ju{constructor(e,n){super();y(this,Lh);y(this,Bh);y(this,Ry,e=>this.visibility?(()=>{switch(this.visibility){case"hidden":return wc(()=>dt(e.isHidden()));case"visible":return wc(()=>dt(e.isVisible()))}})().pipe(zu(Ka),kw({delay:jw}),yw()):gc);_(this,Lh,e),_(this,Bh,n)}static create(e,n){return new Ny(e,n).setTimeout("getDefaultTimeout"in e?e.getDefaultTimeout():e.page().getDefaultTimeout())}_clone(){return new Ny(o(this,Lh),o(this,Bh)).copyOptions(this)}_wait(e){const n=e==null?void 0:e.signal;return wc(()=>dt(o(this,Lh).waitForSelector(o(this,Bh),{visible:!1,timeout:this._timeout,signal:n}))).pipe(vc(a=>a!==null),xw(),this.operators.conditions([o(this,Ry)],n))}};Lh=new WeakMap,Bh=new WeakMap,Ry=new WeakMap;let $w=Ny;function w5(r){for(const t of r)if(!(t instanceof Ju))throw new Error("Unknown locator for race candidate");return r}const Ly=class Ly extends Ju{constructor(e){super();y(this,Uh);_(this,Uh,e)}static create(e){const n=w5(e);return new Ly(n)}_clone(){return new Ly(o(this,Uh).map(e=>e.clone())).copyOptions(this)}_wait(e){return kR(...o(this,Uh).map(n=>n._wait(e)))}};Uh=new WeakMap;let Uk=Ly;const jw=100;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var v5=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},nr=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},Os=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Ms=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n}),Hr;(function(r){r.FrameNavigated=Symbol("Frame.FrameNavigated"),r.FrameSwapped=Symbol("Frame.FrameSwapped"),r.LifecycleEvent=Symbol("Frame.LifecycleEvent"),r.FrameNavigatedWithinDocument=Symbol("Frame.FrameNavigatedWithinDocument"),r.FrameDetached=Symbol("Frame.FrameDetached"),r.FrameSwappedByActivation=Symbol("Frame.FrameSwappedByActivation")})(Hr||(Hr={}));const ut=Fe(r=>`Attempted to use detached Frame '${r._id}'.`);let IC=(()=>{var O,E,tw,P;let r=Ue,t=[],e,n,a,i,s,c,l,u,h,d,f,m,w,p,g,v,k,x,S,I;return P=class extends r{constructor(){super();y(this,E);H(this,"_id",v5(this,t));H(this,"_parentId");H(this,"_name");H(this,"_hasStartedLoading",!1);y(this,O)}clearDocumentHandle(){_(this,O,void 0)}async frameElement(){const A={stack:[],error:void 0,hasError:!1};try{const N=this.parentFrame();if(!N)return null;const C=Os(A,await N.isolatedRealm().evaluateHandle(()=>document.querySelectorAll("iframe,frame")),!1);for await(const K of SC(C)){const ne={stack:[],error:void 0,hasError:!1};try{const X=Os(ne,K,!1),oe=await X.contentFrame();if((oe==null?void 0:oe._id)===this._id)return X.move()}catch(X){ne.error=X,ne.hasError=!0}finally{Ms(ne)}}return null}catch(N){A.error=N,A.hasError=!0}finally{Ms(A)}}async evaluateHandle(A,...N){return A=Cr(this.evaluateHandle.name,A),await this.mainRealm().evaluateHandle(A,...N)}async evaluate(A,...N){return A=Cr(this.evaluate.name,A),await this.mainRealm().evaluate(A,...N)}locator(A){return typeof A=="string"?$w.create(this,A):Lw.create(this,A)}async $(A){return await(await F(this,E,tw).call(this)).$(A)}async $$(A,N){return await(await F(this,E,tw).call(this)).$$(A,N)}async $eval(A,N,...C){return N=Cr(this.$eval.name,N),await(await F(this,E,tw).call(this)).$eval(A,N,...C)}async $$eval(A,N,...C){return N=Cr(this.$$eval.name,N),await(await F(this,E,tw).call(this)).$$eval(A,N,...C)}async waitForSelector(A,N={}){const{updatedSelector:C,QueryHandler:K,polling:ne}=Mw(A);return await K.waitFor(this,C,{polling:ne,...N})}async waitForFunction(A,N={},...C){return await this.mainRealm().waitForFunction(A,N,...C)}async content(){return await this.evaluate(()=>{let A="";for(const N of document.childNodes)switch(N){case document.documentElement:A+=document.documentElement.outerHTML;break;default:A+=new XMLSerializer().serializeToString(N);break}return A})}async setFrameContent(A){return await this.evaluate(N=>{document.open(),document.write(N),document.close()},A)}name(){return this._name||""}isDetached(){return this.detached}get disposed(){return this.detached}async addScriptTag(A){let{content:N="",type:C}=A;const{path:K}=A;if(+!!A.url+ +!!K+ +!!N!=1)throw new Error("Exactly one of `url`, `path`, or `content` must be specified.");return K&&(N=await Is.value.fs.promises.readFile(K,"utf8"),N+=`//# sourceURL=${K.replace(/\n/g,"")}`),C=C??"text/javascript",await this.mainRealm().transferHandle(await this.isolatedRealm().evaluateHandle(async({url:ne,id:X,type:oe,content:q})=>await new Promise((se,Q)=>{const R=document.createElement("script");R.type=oe,R.text=q,R.addEventListener("error",ae=>{Q(new Error(ae.message??"Could not load script"))},{once:!0}),X&&(R.id=X),ne?(R.src=ne,R.addEventListener("load",()=>{se(R)},{once:!0}),document.head.appendChild(R)):(document.head.appendChild(R),se(R))}),{...A,type:C,content:N}))}async addStyleTag(A){let{content:N=""}=A;const{path:C}=A;if(+!!A.url+ +!!C+ +!!N!=1)throw new Error("Exactly one of `url`, `path`, or `content` must be specified.");return C&&(N=await Is.value.fs.promises.readFile(C,"utf8"),N+="/*# sourceURL="+C.replace(/\n/g,"")+"*/",A.content=N),await this.mainRealm().transferHandle(await this.isolatedRealm().evaluateHandle(async({url:K,content:ne})=>await new Promise((X,oe)=>{let q;if(!K)q=document.createElement("style"),q.appendChild(document.createTextNode(ne));else{const se=document.createElement("link");se.rel="stylesheet",se.href=K,q=se}return q.addEventListener("load",()=>{X(q)},{once:!0}),q.addEventListener("error",se=>{oe(new Error(se.message??"Could not load style"))},{once:!0}),document.head.appendChild(q),q}),A))}async click(A,N={}){const C={stack:[],error:void 0,hasError:!1};try{const K=Os(C,await this.$(A),!1);Ee(K,`No element found for selector: ${A}`),await K.click(N),await K.dispose()}catch(K){C.error=K,C.hasError=!0}finally{Ms(C)}}async focus(A){const N={stack:[],error:void 0,hasError:!1};try{const C=Os(N,await this.$(A),!1);Ee(C,`No element found for selector: ${A}`),await C.focus()}catch(C){N.error=C,N.hasError=!0}finally{Ms(N)}}async hover(A){const N={stack:[],error:void 0,hasError:!1};try{const C=Os(N,await this.$(A),!1);Ee(C,`No element found for selector: ${A}`),await C.hover()}catch(C){N.error=C,N.hasError=!0}finally{Ms(N)}}async select(A,...N){const C={stack:[],error:void 0,hasError:!1};try{const K=Os(C,await this.$(A),!1);return Ee(K,`No element found for selector: ${A}`),await K.select(...N)}catch(K){C.error=K,C.hasError=!0}finally{Ms(C)}}async tap(A){const N={stack:[],error:void 0,hasError:!1};try{const C=Os(N,await this.$(A),!1);Ee(C,`No element found for selector: ${A}`),await C.tap()}catch(C){N.error=C,N.hasError=!0}finally{Ms(N)}}async type(A,N,C){const K={stack:[],error:void 0,hasError:!1};try{const ne=Os(K,await this.$(A),!1);Ee(ne,`No element found for selector: ${A}`),await ne.type(N,C)}catch(ne){K.error=ne,K.hasError=!0}finally{Ms(K)}}async title(){return await this.isolatedRealm().evaluate(()=>document.title)}},O=new WeakMap,E=new WeakSet,tw=function(){return o(this,O)||_(this,O,this.mainRealm().evaluateHandle(()=>document)),o(this,O)},(()=>{const A=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e=[ut],n=[ut],a=[ut],i=[ut],s=[ut],c=[ut],l=[ut],u=[ut],h=[ut],d=[ut],f=[ut],m=[ut],w=[ut],p=[ut],g=[ut],v=[ut],k=[ut],x=[ut],S=[ut],I=[ut],nr(P,null,e,{kind:"method",name:"frameElement",static:!1,private:!1,access:{has:N=>"frameElement"in N,get:N=>N.frameElement},metadata:A},null,t),nr(P,null,n,{kind:"method",name:"evaluateHandle",static:!1,private:!1,access:{has:N=>"evaluateHandle"in N,get:N=>N.evaluateHandle},metadata:A},null,t),nr(P,null,a,{kind:"method",name:"evaluate",static:!1,private:!1,access:{has:N=>"evaluate"in N,get:N=>N.evaluate},metadata:A},null,t),nr(P,null,i,{kind:"method",name:"locator",static:!1,private:!1,access:{has:N=>"locator"in N,get:N=>N.locator},metadata:A},null,t),nr(P,null,s,{kind:"method",name:"$",static:!1,private:!1,access:{has:N=>"$"in N,get:N=>N.$},metadata:A},null,t),nr(P,null,c,{kind:"method",name:"$$",static:!1,private:!1,access:{has:N=>"$$"in N,get:N=>N.$$},metadata:A},null,t),nr(P,null,l,{kind:"method",name:"$eval",static:!1,private:!1,access:{has:N=>"$eval"in N,get:N=>N.$eval},metadata:A},null,t),nr(P,null,u,{kind:"method",name:"$$eval",static:!1,private:!1,access:{has:N=>"$$eval"in N,get:N=>N.$$eval},metadata:A},null,t),nr(P,null,h,{kind:"method",name:"waitForSelector",static:!1,private:!1,access:{has:N=>"waitForSelector"in N,get:N=>N.waitForSelector},metadata:A},null,t),nr(P,null,d,{kind:"method",name:"waitForFunction",static:!1,private:!1,access:{has:N=>"waitForFunction"in N,get:N=>N.waitForFunction},metadata:A},null,t),nr(P,null,f,{kind:"method",name:"content",static:!1,private:!1,access:{has:N=>"content"in N,get:N=>N.content},metadata:A},null,t),nr(P,null,m,{kind:"method",name:"addScriptTag",static:!1,private:!1,access:{has:N=>"addScriptTag"in N,get:N=>N.addScriptTag},metadata:A},null,t),nr(P,null,w,{kind:"method",name:"addStyleTag",static:!1,private:!1,access:{has:N=>"addStyleTag"in N,get:N=>N.addStyleTag},metadata:A},null,t),nr(P,null,p,{kind:"method",name:"click",static:!1,private:!1,access:{has:N=>"click"in N,get:N=>N.click},metadata:A},null,t),nr(P,null,g,{kind:"method",name:"focus",static:!1,private:!1,access:{has:N=>"focus"in N,get:N=>N.focus},metadata:A},null,t),nr(P,null,v,{kind:"method",name:"hover",static:!1,private:!1,access:{has:N=>"hover"in N,get:N=>N.hover},metadata:A},null,t),nr(P,null,k,{kind:"method",name:"select",static:!1,private:!1,access:{has:N=>"select"in N,get:N=>N.select},metadata:A},null,t),nr(P,null,x,{kind:"method",name:"tap",static:!1,private:!1,access:{has:N=>"tap"in N,get:N=>N.tap},metadata:A},null,t),nr(P,null,S,{kind:"method",name:"type",static:!1,private:!1,access:{has:N=>"type"in N,get:N=>N.type},metadata:A},null,t),nr(P,null,I,{kind:"method",name:"title",static:!1,private:!1,access:{has:N=>"title"in N,get:N=>N.title},metadata:A},null,t),A&&Object.defineProperty(P,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:A})})(),P})();class Hw{constructor(){y(this,$h);H(this,"_interceptionId");H(this,"_failureText",null);H(this,"_response",null);H(this,"_fromMemoryCache",!1);H(this,"_redirectChain",[]);H(this,"interception",{enabled:!1,handled:!1,handlers:[],resolutionState:{action:qa.None},requestOverrides:{},response:null,abortReason:null})}continueRequestOverrides(){return Ee(this.interception.enabled,"Request Interception is not enabled!"),this.interception.requestOverrides}responseForRequest(){return Ee(this.interception.enabled,"Request Interception is not enabled!"),this.interception.response}abortErrorReason(){return Ee(this.interception.enabled,"Request Interception is not enabled!"),this.interception.abortReason}interceptResolutionState(){return this.interception.enabled?this.interception.handled?{action:qa.AlreadyHandled}:{...this.interception.resolutionState}:{action:qa.Disabled}}isInterceptResolutionHandled(){return this.interception.handled}enqueueInterceptAction(t){this.interception.handlers.push(t)}async finalizeInterceptions(){await this.interception.handlers.reduce((e,n)=>e.then(n),Promise.resolve()),this.interception.handlers=[];const{action:t}=this.interceptResolutionState();switch(t){case"abort":return await this._abort(this.interception.abortReason);case"respond":if(this.interception.response===null)throw new Error("Response is missing for the interception");return await this._respond(this.interception.response);case"continue":return await this._continue(this.interception.requestOverrides)}}async continue(t={},e){if(F(this,$h,Tx).call(this)){if(Ee(this.interception.enabled,"Request Interception is not enabled!"),Ee(!this.interception.handled,"Request is already handled!"),e===void 0)return await this._continue(t);if(this.interception.requestOverrides=t,this.interception.resolutionState.priority===void 0||e>this.interception.resolutionState.priority){this.interception.resolutionState={action:qa.Continue,priority:e};return}if(e===this.interception.resolutionState.priority){if(this.interception.resolutionState.action==="abort"||this.interception.resolutionState.action==="respond")return;this.interception.resolutionState.action=qa.Continue}}}async respond(t,e){if(F(this,$h,Tx).call(this)){if(Ee(this.interception.enabled,"Request Interception is not enabled!"),Ee(!this.interception.handled,"Request is already handled!"),e===void 0)return await this._respond(t);if(this.interception.response=t,this.interception.resolutionState.priority===void 0||e>this.interception.resolutionState.priority){this.interception.resolutionState={action:qa.Respond,priority:e};return}if(e===this.interception.resolutionState.priority){if(this.interception.resolutionState.action==="abort")return;this.interception.resolutionState.action=qa.Respond}}}async abort(t="failed",e){if(!F(this,$h,Tx).call(this))return;const n=y5[t];if(Ee(n,"Unknown error code: "+t),Ee(this.interception.enabled,"Request Interception is not enabled!"),Ee(!this.interception.handled,"Request is already handled!"),e===void 0)return await this._abort(n);if(this.interception.abortReason=n,this.interception.resolutionState.priority===void 0||e>=this.interception.resolutionState.priority){this.interception.resolutionState={action:qa.Abort,priority:e};return}}static getResponse(t){const e=Ni(t)?new TextEncoder().encode(t):t;return{contentLength:e.byteLength,base64:hC(e)}}}$h=new WeakSet,Tx=function(){return!this.url().startsWith("data:")&&!this._fromMemoryCache};var qa;(function(r){r.Abort="abort",r.Respond="respond",r.Continue="continue",r.Disabled="disabled",r.None="none",r.AlreadyHandled="already-handled"})(qa||(qa={}));function DC(r){const t=[];for(const e in r){const n=r[e];if(!Object.is(n,void 0)){const a=Array.isArray(n)?n:[n];t.push(...a.map(i=>({name:e,value:i+""})))}}return t}const OC={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"},y5={aborted:"Aborted",accessdenied:"AccessDenied",addressunreachable:"AddressUnreachable",blockedbyclient:"BlockedByClient",blockedbyresponse:"BlockedByResponse",connectionaborted:"ConnectionAborted",connectionclosed:"ConnectionClosed",connectionfailed:"ConnectionFailed",connectionrefused:"ConnectionRefused",connectionreset:"ConnectionReset",internetdisconnected:"InternetDisconnected",namenotresolved:"NameNotResolved",timedout:"TimedOut",failed:"Failed"};function Ww(r){if(r.originalMessage.includes("Invalid header")||r.originalMessage.includes('Expected "header"')||r.originalMessage.includes("invalid argument"))throw r;Re(r)}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class MC{constructor(){}ok(){const t=this.status();return t===0||t>=200&&t<=299}async buffer(){const t=await this.content();return Buffer.from(t)}async text(){const t=await this.content();return new TextDecoder().decode(t)}async json(){const t=await this.text();return JSON.parse(t)}}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class RC{constructor(){}}const It=Object.freeze({Left:"left",Right:"right",Middle:"middle",Back:"back",Forward:"forward"});class NC{constructor(){}}class LC{constructor(){}async tap(t,e){await this.touchStart(t,e),await this.touchEnd()}}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const BC=3e4;class $k{constructor(){y(this,Xi);y(this,tl);_(this,Xi,null),_(this,tl,null)}setDefaultTimeout(t){_(this,Xi,t)}setDefaultNavigationTimeout(t){_(this,tl,t)}navigationTimeout(){return o(this,tl)!==null?o(this,tl):o(this,Xi)!==null?o(this,Xi):BC}timeout(){return o(this,Xi)!==null?o(this,Xi):BC}}Xi=new WeakMap,tl=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var x5=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},k5=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},jk=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},UC=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});function b5(r){r.optimizeForSpeed??(r.optimizeForSpeed=!1),r.type??(r.type="png"),r.fromSurface??(r.fromSurface=!0),r.fullPage??(r.fullPage=!1),r.omitBackground??(r.omitBackground=!1),r.encoding??(r.encoding="binary"),r.captureBeyondViewport??(r.captureBeyondViewport=!0)}let $C=(()=>{var n,a,i,s,c,AP,u;let r=Ue,t=[],e;return u=class extends r{constructor(){super();y(this,c);H(this,"_isDragging",(x5(this,t),!1));H(this,"_timeoutSettings",new $k);y(this,n,new WeakMap);y(this,a,new OM(1));y(this,i,0);y(this,s);_t(this,"request").pipe(Sr(f=>bk(Ps(1),v0(_t(this,"requestfailed"),_t(this,"requestfinished"),_t(this,"response").pipe(tr(m=>m.request()))).pipe(vc(m=>m.id===f.id),Sk(1),tr(()=>-1)))),SR((f,m)=>Ps(f+m),0),TR(_t(this,"close")),CR(0)).subscribe(o(this,a))}on(f,m){if(f!=="request")return super.on(f,m);let w=o(this,n).get(m);return w===void 0&&(w=p=>{p.enqueueInterceptAction(()=>m(p))},o(this,n).set(m,w)),super.on(f,w)}off(f,m){return f==="request"&&(m=o(this,n).get(m)||m),super.off(f,m)}get accessibility(){return this.mainFrame().accessibility}locator(f){return typeof f=="string"?$w.create(this,f):Lw.create(this,f)}locatorRace(f){return Ju.race(f)}async $(f){return await this.mainFrame().$(f)}async $$(f,m){return await this.mainFrame().$$(f,m)}async evaluateHandle(f,...m){return f=Cr(this.evaluateHandle.name,f),await this.mainFrame().evaluateHandle(f,...m)}async $eval(f,m,...w){return m=Cr(this.$eval.name,m),await this.mainFrame().$eval(f,m,...w)}async $$eval(f,m,...w){return m=Cr(this.$$eval.name,m),await this.mainFrame().$$eval(f,m,...w)}async addScriptTag(f){return await this.mainFrame().addScriptTag(f)}async addStyleTag(f){return await this.mainFrame().addStyleTag(f)}url(){return this.mainFrame().url()}async content(){return await this.mainFrame().content()}async setContent(f,m){await this.mainFrame().setContent(f,m)}async goto(f,m){return await this.mainFrame().goto(f,m)}async waitForNavigation(f={}){return await this.mainFrame().waitForNavigation(f)}waitForRequest(f,m={}){const{timeout:w=this._timeoutSettings.timeout(),signal:p}=m;if(typeof f=="string"){const v=f;f=k=>k.url()===v}const g=_t(this,"request").pipe(x0(f),jr(En(w),xc(p),_t(this,"close").pipe(tr(()=>{throw new ya("Page closed!")}))));return Er(g)}waitForResponse(f,m={}){const{timeout:w=this._timeoutSettings.timeout(),signal:p}=m;if(typeof f=="string"){const v=f;f=k=>k.url()===v}const g=_t(this,"response").pipe(x0(f),jr(En(w),xc(p),_t(this,"close").pipe(tr(()=>{throw new ya("Page closed!")}))));return Er(g)}waitForNetworkIdle(f={}){return Er(this.waitForNetworkIdle$(f))}waitForNetworkIdle$(f={}){const{timeout:m=this._timeoutSettings.timeout(),idleTime:w=LR,concurrency:p=0,signal:g}=f;return o(this,a).pipe(bw(v=>v>p?gc:Ek(w)),tr(()=>{}),jr(En(m),xc(g),_t(this,"close").pipe(tr(()=>{throw new ya("Page closed!")}))))}async waitForFrame(f,m={}){const{timeout:w=this.getDefaultTimeout(),signal:p}=m,g=Ni(f)?v=>f===v.url():f;return await Er(v0(_t(this,"frameattached"),_t(this,"framenavigated"),dt(this.frames())).pipe(x0(g),zu(),jr(En(w),xc(p),_t(this,"close").pipe(tr(()=>{throw new ya("Page closed.")})))))}async emulate(f){await Promise.all([this.setUserAgent(f.userAgent),this.setViewport(f.viewport)])}async evaluate(f,...m){return f=Cr(this.evaluate.name,f),await this.mainFrame().evaluate(f,...m)}async _maybeWriteTypedArrayToFile(f,m){f&&await Is.value.fs.promises.writeFile(f,m)}async screencast(f={}){const m=Is.value.ScreenRecorder,[w,p,g]=await F(this,c,AP).call(this);let v;if(f.crop){const{x,y:S,width:I,height:O}=HC(jC(f.crop));if(x<0||S<0)throw new Error("`crop.x` and `crop.y` must be greater than or equal to 0.");if(I<=0||O<=0)throw new Error("`crop.height` and `crop.width` must be greater than or equal to 0.");const E=w/g,T=p/g;if(x+I>E)throw new Error(`\`crop.width\` cannot be larger than the viewport width (${E}).`);if(S+O>T)throw new Error(`\`crop.height\` cannot be larger than the viewport height (${T}).`);v={x:x*g,y:S*g,width:I*g,height:O*g}}if(f.speed!==void 0&&f.speed<=0)throw new Error("`speed` must be greater than 0.");if(f.scale!==void 0&&f.scale<=0)throw new Error("`scale` must be greater than 0.");const k=new m(this,w,p,{...f,path:f.ffmpegPath,crop:v});try{await this._startScreencast()}catch(x){throw k.stop(),x}if(f.path){const{createWriteStream:x}=Is.value.fs,S=x(f.path,"binary");k.pipe(S)}return k}async _startScreencast(){++Du(this,i)._,o(this,s)||_(this,s,this.mainFrame().client.send("Page.startScreencast",{format:"png"}).then(()=>new Promise(f=>this.mainFrame().client.once("Page.screencastFrame",()=>f())))),await o(this,s)}async _stopScreencast(){--Du(this,i)._,o(this,s)&&(_(this,s,void 0),o(this,i)===0&&await this.mainFrame().client.send("Page.stopScreencast"))}async screenshot(f={}){const m={stack:[],error:void 0,hasError:!1};try{const w=jk(m,await this.browserContext().startScreenshot(),!1);await this.bringToFront();const p={...f,clip:f.clip?{...f.clip}:void 0};if(p.type===void 0&&p.path!==void 0){const x=p.path;switch(x.slice(x.lastIndexOf(".")+1).toLowerCase()){case"png":p.type="png";break;case"jpeg":case"jpg":p.type="jpeg";break;case"webp":p.type="webp";break}}if(p.quality!==void 0){if(p.quality<0||p.quality>100)throw new Error(`Expected 'quality' (${p.quality}) to be between 0 and 100, inclusive.`);if(p.type===void 0||!["jpeg","webp"].includes(p.type))throw new Error(`${p.type??"png"} screenshots do not support 'quality'.`)}if(p.clip){if(p.clip.width<=0)throw new Error("'width' in 'clip' must be positive.");if(p.clip.height<=0)throw new Error("'height' in 'clip' must be positive.")}b5(p);const g=jk(m,new Ew,!0);if(p.clip){if(p.fullPage)throw new Error("'clip' and 'fullPage' are mutually exclusive");p.clip=HC(jC(p.clip))}else if(p.fullPage){if(!p.captureBeyondViewport){const x=await this.mainFrame().isolatedRealm().evaluate(()=>{const I=document.documentElement;return{width:I.scrollWidth,height:I.scrollHeight}}),S=this.viewport();await this.setViewport({...S,...x}),g.defer(async()=>{await this.setViewport(S).catch(Re)})}}else p.captureBeyondViewport=!1;const v=await this._screenshot(p);if(p.encoding==="base64")return v;const k=Ck(v,!0);return await this._maybeWriteTypedArrayToFile(p.path,k),k}catch(w){m.error=w,m.hasError=!0}finally{const w=UC(m);w&&await w}}async title(){return await this.mainFrame().title()}click(f,m){return this.mainFrame().click(f,m)}focus(f){return this.mainFrame().focus(f)}hover(f){return this.mainFrame().hover(f)}select(f,...m){return this.mainFrame().select(f,...m)}tap(f){return this.mainFrame().tap(f)}type(f,m,w){return this.mainFrame().type(f,m,w)}async waitForSelector(f,m={}){return await this.mainFrame().waitForSelector(f,m)}waitForFunction(f,m,...w){return this.mainFrame().waitForFunction(f,m,...w)}[(e=[l5(function(){return this.browser()})],He)](){return void this.close().catch(Re)}[va](){return this.close()}},n=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakSet,AP=async function(){const f={stack:[],error:void 0,hasError:!1};try{const m=this.viewport(),w=jk(f,new rr,!1);return m&&m.deviceScaleFactor!==0&&(await this.setViewport({...m,deviceScaleFactor:0}),w.defer(()=>{this.setViewport(m).catch(Re)})),await this.mainFrame().isolatedRealm().evaluate(()=>[window.visualViewport.width*window.devicePixelRatio,window.visualViewport.height*window.devicePixelRatio,window.devicePixelRatio])}catch(m){f.error=m,f.hasError=!0}finally{UC(f)}},(()=>{const f=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;k5(u,null,e,{kind:"method",name:"screenshot",static:!1,private:!1,access:{has:m=>"screenshot"in m,get:m=>m.screenshot},metadata:f},null,t),f&&Object.defineProperty(u,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f})})(),u})();function jC(r){return{...r,...r.width<0?{x:r.x+r.width,width:-r.width}:{x:r.x,width:r.width},...r.height<0?{y:r.y+r.height,height:-r.height}:{y:r.y,height:r.height}}}function HC(r){const t=Math.round(r.x),e=Math.round(r.y),n=Math.round(r.width+r.x-t),a=Math.round(r.height+r.y-e);return{...r,x:t,y:e,width:n,height:a}}/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class _5{constructor(t,e,n,...a){y(this,Yi);y(this,jh);y(this,jp);y(this,no);y(this,rl);y(this,Hp);y(this,Wp);y(this,nl,Et.create());y(this,Ln);y(this,Hh);y(this,Wh,[]);var i;switch(_(this,Yi,t),_(this,jh,e.polling),_(this,jp,e.root),_(this,Hh,e.signal),(i=o(this,Hh))==null||i.addEventListener("abort",()=>{var s;this.terminate((s=o(this,Hh))==null?void 0:s.reason)},{once:!0}),typeof n){case"string":_(this,no,`() => {return (${n});}`);break;default:_(this,no,Va(n));break}_(this,rl,a),o(this,Yi).taskManager.add(this),e.timeout&&(_(this,Wp,new Sw(`Waiting failed: ${e.timeout}ms exceeded`)),_(this,Hp,setTimeout(()=>{this.terminate(o(this,Wp))},e.timeout))),this.rerun()}get result(){return o(this,nl).valueOrThrow()}async rerun(){for(const e of o(this,Wh))e.abort();o(this,Wh).length=0;const t=new AbortController;o(this,Wh).push(t);try{switch(o(this,jh)){case"raf":_(this,Ln,await o(this,Yi).evaluateHandle(({RAFPoller:n,createFunction:a},i,...s)=>{const c=a(i);return new n(()=>c(...s))},Dn.create(n=>n.puppeteerUtil),o(this,no),...o(this,rl)));break;case"mutation":_(this,Ln,await o(this,Yi).evaluateHandle(({MutationPoller:n,createFunction:a},i,s,...c)=>{const l=a(s);return new n(()=>l(...c),i||document)},Dn.create(n=>n.puppeteerUtil),o(this,jp),o(this,no),...o(this,rl)));break;default:_(this,Ln,await o(this,Yi).evaluateHandle(({IntervalPoller:n,createFunction:a},i,s,...c)=>{const l=a(s);return new n(()=>l(...c),i)},Dn.create(n=>n.puppeteerUtil),o(this,jh),o(this,no),...o(this,rl)));break}await o(this,Ln).evaluate(n=>{n.start()});const e=await o(this,Ln).evaluateHandle(n=>n.result());o(this,nl).resolve(e),await this.terminate()}catch(e){if(t.signal.aborted)return;const n=this.getBadError(e);n&&await this.terminate(n)}}async terminate(t){if(o(this,Yi).taskManager.delete(this),clearTimeout(o(this,Hp)),t&&!o(this,nl).finished()&&o(this,nl).reject(t),o(this,Ln))try{await o(this,Ln).evaluateHandle(async e=>{await e.stop()}),o(this,Ln)&&(await o(this,Ln).dispose(),_(this,Ln,void 0))}catch{}}getBadError(t){return Yn(t)?t.message.includes("Execution context is not available in detached frame")?new Error("Waiting failed: Frame detached"):t.message.includes("Execution context was destroyed")||t.message.includes("Cannot find context with specified id")||t.message.includes("AbortError: Actor 'MessageHandlerFrame' destroyed")?void 0:t:new Error("WaitTask failed with an error",{cause:t})}}Yi=new WeakMap,jh=new WeakMap,jp=new WeakMap,no=new WeakMap,rl=new WeakMap,Hp=new WeakMap,Wp=new WeakMap,nl=new WeakMap,Ln=new WeakMap,Hh=new WeakMap,Wh=new WeakMap;class E5{constructor(){y(this,ao,new Set)}add(t){o(this,ao).add(t)}delete(t){o(this,ao).delete(t)}terminateAll(t){for(const e of o(this,ao))e.terminate(t);o(this,ao).clear()}async rerunAll(){await Promise.all([...o(this,ao)].map(t=>t.rerun()))}}ao=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */let WC=(hP=class{constructor(t){H(this,"timeoutSettings");H(this,"taskManager",new E5);y(this,zp,!1);this.timeoutSettings=t}async waitForFunction(t,e={},...n){const{polling:a="raf",timeout:i=this.timeoutSettings.timeout(),root:s,signal:c}=e;if(typeof a=="number"&&a<0)throw new Error("Cannot poll with non-positive interval");return await new _5(this,{polling:a,root:s,timeout:i,signal:c},t,...n).result}get disposed(){return o(this,zp)}dispose(){_(this,zp,!0),this.taskManager.terminateAll(new Error("waitForFunction failed: frame got detached."))}[He](){this.dispose()}},zp=new WeakMap,hP);/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Wr;(function(r){r.PAGE="page",r.BACKGROUND_PAGE="background_page",r.SERVICE_WORKER="service_worker",r.SHARED_WORKER="shared_worker",r.BROWSER="browser",r.WEBVIEW="webview",r.OTHER="other",r.TAB="tab"})(Wr||(Wr={}));class T0{constructor(){}async worker(){return null}async page(){return null}}/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class zC extends Ue{constructor(e){super();H(this,"timeoutSettings",new $k);y(this,Kp);_(this,Kp,e)}url(){return o(this,Kp)}async evaluate(e,...n){return e=Cr(this.evaluate.name,e),await this.mainRealm().evaluate(e,...n)}async evaluateHandle(e,...n){return e=Cr(this.evaluateHandle.name,e),await this.mainRealm().evaluateHandle(e,...n)}async close(){throw new et("WebWorker.close() is not supported")}}Kp=new WeakMap;/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class KC{constructor(t){y(this,al);_(this,al,t)}async snapshot(t={}){const{interestingOnly:e=!0,root:n=null}=t,{nodes:a}=await o(this,al).environment.client.send("Accessibility.getFullAXTree");let i;if(n){const{node:u}=await o(this,al).environment.client.send("DOM.describeNode",{objectId:n.id});i=u.backendNodeId}const s=Hk.createTree(o(this,al),a);let c=s;if(!s||(i&&(c=s.find(u=>u.payload.backendDOMNodeId===i)),!c))return null;if(!e)return this.serializeTree(c)[0]??null;const l=new Set;return this.collectInterestingNodes(l,s,!1),l.has(c)?this.serializeTree(c,l)[0]??null:null}serializeTree(t,e){const n=[];for(const i of t.children)n.push(...this.serializeTree(i,e));if(e&&!e.has(t))return n;const a=t.serialize();return n.length&&(a.children=n),[a]}collectInterestingNodes(t,e,n){if(e.isInteresting(n)&&t.add(e),!e.isLeafNode()){n=n||e.isControl();for(const a of e.children)this.collectInterestingNodes(t,a,n)}}}al=new WeakMap;const wE=class wE{constructor(t,e){y(this,Ji);H(this,"payload");H(this,"children",[]);y(this,zh,!1);y(this,Vp,!1);y(this,il,!1);y(this,qp,!1);y(this,sl);y(this,Bn);y(this,Gp);y(this,ol);y(this,Xp);this.payload=e,_(this,sl,this.payload.name?this.payload.name.value:""),_(this,Bn,this.payload.role?this.payload.role.value:"Unknown"),_(this,Gp,this.payload.ignored),_(this,Xp,t);for(const n of this.payload.properties||[])n.name==="editable"&&(_(this,zh,n.value.value==="richtext"),_(this,Vp,!0)),n.name==="focusable"&&_(this,il,n.value.value),n.name==="hidden"&&_(this,qp,n.value.value)}find(t){if(t(this))return this;for(const e of this.children){const n=e.find(t);if(n)return n}return null}isLeafNode(){if(!this.children.length||F(this,Ji,FP).call(this)||F(this,Ji,PP).call(this))return!0;switch(o(this,Bn)){case"doc-cover":case"graphics-symbol":case"img":case"image":case"Meter":case"scrollbar":case"slider":case"separator":case"progressbar":return!0}return F(this,Ji,zE).call(this)?!1:!!(o(this,il)&&o(this,sl)||o(this,Bn)==="heading"&&o(this,sl))}isControl(){switch(o(this,Bn)){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"tree":case"treeitem":return!0;default:return!1}}isInteresting(t){return o(this,Bn)==="Ignored"||o(this,qp)||o(this,Gp)?!1:o(this,il)||o(this,zh)||this.isControl()?!0:t?!1:this.isLeafNode()&&!!o(this,sl)}serialize(){const t=new Map;for(const f of this.payload.properties||[])t.set(f.name.toLowerCase(),f.value.value);this.payload.name&&t.set("name",this.payload.name.value),this.payload.value&&t.set("value",this.payload.value.value),this.payload.description&&t.set("description",this.payload.description.value);const e={role:o(this,Bn),elementHandle:async()=>this.payload.backendDOMNodeId?await o(this,Xp).adoptBackendNode(this.payload.backendDOMNodeId):null},n=["name","value","description","keyshortcuts","roledescription","valuetext"],a=f=>t.get(f);for(const f of n)t.has(f)&&(e[f]=a(f));const i=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"],s=f=>t.get(f);for(const f of i)f==="focused"&&o(this,Bn)==="RootWebArea"||!s(f)||(e[f]=s(f));const c=["checked","pressed"];for(const f of c){if(!t.has(f))continue;const m=t.get(f);e[f]=m==="mixed"?"mixed":m==="true"}const l=["level","valuemax","valuemin"],u=f=>t.get(f);for(const f of l)t.has(f)&&(e[f]=u(f));const h=["autocomplete","haspopup","invalid","orientation"],d=f=>t.get(f);for(const f of h){const m=d(f);!m||m==="false"||(e[f]=d(f))}return e}static createTree(t,e){const n=new Map;for(const a of e)n.set(a.nodeId,new wE(t,a));for(const a of n.values())for(const i of a.payload.childIds||[]){const s=n.get(i);s&&a.children.push(s)}return n.values().next().value??null}};zh=new WeakMap,Vp=new WeakMap,il=new WeakMap,qp=new WeakMap,sl=new WeakMap,Bn=new WeakMap,Gp=new WeakMap,ol=new WeakMap,Xp=new WeakMap,Ji=new WeakSet,FP=function(){return o(this,zh)?!1:o(this,Vp)?!0:o(this,Bn)==="textbox"||o(this,Bn)==="searchbox"},PP=function(){const t=o(this,Bn);return t==="LineBreak"||t==="text"||t==="InlineTextBox"||t==="StaticText"},zE=function(){var t;if(o(this,ol)===void 0){_(this,ol,!1);for(const e of this.children)if(o(e,il)||F(t=e,Ji,zE).call(t)){_(this,ol,!0);break}}return o(this,ol)};let Hk=wE;var S5=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},C5=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});class zw{constructor(t,e,n){y(this,Zi);y(this,Yp);y(this,Jp);_(this,Zi,t),_(this,Yp,e),_(this,Jp,n)}get name(){return o(this,Zi)}get initSource(){return o(this,Jp)}async run(t,e,n,a){const i=new rr;try{if(!a){const s={stack:[],error:void 0,hasError:!1};try{const l=await S5(s,await t.evaluateHandle((u,h)=>globalThis[u].args.get(h),o(this,Zi),e),!1).getProperties();for(const[u,h]of l)if(u in n)switch(h.remoteObject().subtype){case"node":n[+u]=h;break;default:i.use(h)}else i.use(h)}catch(c){s.error=c,s.hasError=!0}finally{C5(s)}}await t.evaluate((s,c,l)=>{const u=globalThis[s].callbacks;u.get(c).resolve(l),u.delete(c)},o(this,Zi),e,await o(this,Yp).call(this,...n));for(const s of n)s instanceof bc&&i.use(s)}catch(s){Yn(s)?await t.evaluate((c,l,u,h)=>{const d=new Error(u);d.stack=h;const f=globalThis[c].callbacks;f.get(l).reject(d),f.delete(l)},o(this,Zi),e,s.message,s.stack).catch(Re):await t.evaluate((c,l,u)=>{const h=globalThis[c].callbacks;h.get(l).reject(u),h.delete(l)},o(this,Zi),e,s).catch(Re)}}}Zi=new WeakMap,Yp=new WeakMap,Jp=new WeakMap;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var T5=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},A5=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});class Wk extends xC{constructor(e,n,a){super();y(this,Kh);y(this,Qi);y(this,oi);_(this,Kh,e),_(this,Qi,n),_(this,oi,a)}get id(){return o(this,oi)}targets(){return o(this,Qi).targets().filter(e=>e.browserContext()===this)}async pages(){return(await Promise.all(this.targets().filter(n=>{var a;return n.type()==="page"||n.type()==="other"&&((a=o(this,Qi)._getIsPageTargetCallback())==null?void 0:a(n))}).map(n=>n.page()))).filter(n=>!!n)}async overridePermissions(e,n){const a=n.map(i=>{const s=Ik.get(i);if(!s)throw new Error("Unknown permission: "+i);return s});await o(this,Kh).send("Browser.grantPermissions",{origin:e,browserContextId:o(this,oi)||void 0,permissions:a})}async clearPermissionOverrides(){await o(this,Kh).send("Browser.resetPermissions",{browserContextId:o(this,oi)||void 0})}async newPage(){const e={stack:[],error:void 0,hasError:!1};try{const n=T5(e,await this.waitForScreenshotOperations(),!1);return await o(this,Qi)._createPageInContext(o(this,oi))}catch(n){e.error=n,e.hasError=!0}finally{A5(e)}}browser(){return o(this,Qi)}async close(){Ee(o(this,oi),"Default BrowserContext cannot be closed!"),await o(this,Qi)._disposeContext(o(this,oi))}}Kh=new WeakMap,Qi=new WeakMap,oi=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class zk{constructor(){y(this,Ia,new Map);y(this,By,P5())}create(t,e,n){const a=new F5(o(this,By).call(this),t,e);o(this,Ia).set(a.id,a);try{n(a.id)}catch(i){throw a.promise.catch(Re).finally(()=>{o(this,Ia).delete(a.id)}),a.reject(i),i}return a.promise.finally(()=>{o(this,Ia).delete(a.id)})}reject(t,e,n){const a=o(this,Ia).get(t);a&&this._reject(a,e,n)}_reject(t,e,n){let a,i;e instanceof yc?(a=e,a.cause=t.error,i=e.message):(a=t.error,i=e),t.reject(bC(a,`Protocol error (${t.label}): ${i}`,n))}resolve(t,e){const n=o(this,Ia).get(t);n&&n.resolve(e)}clear(){for(const t of o(this,Ia).values())this._reject(t,new ya("Target closed"));o(this,Ia).clear()}getPendingProtocolErrors(){const t=[];for(const e of o(this,Ia).values())t.push(new Error(`${e.label} timed out. Trace: ${e.error.stack}`));return t}}Ia=new WeakMap,By=new WeakMap;class F5{constructor(t,e,n){y(this,Zp);y(this,Qp,new yc);y(this,cl,Et.create());y(this,Vh);y(this,em);_(this,Zp,t),_(this,em,e),n&&_(this,Vh,setTimeout(()=>{o(this,cl).reject(bC(o(this,Qp),`${e} timed out. Increase the 'protocolTimeout' setting in launch/connect calls for a higher timeout if needed.`))},n))}resolve(t){clearTimeout(o(this,Vh)),o(this,cl).resolve(t)}reject(t){clearTimeout(o(this,Vh)),o(this,cl).reject(t)}get id(){return o(this,Zp)}get promise(){return o(this,cl).valueOrThrow()}get error(){return o(this,Qp)}get label(){return o(this,em)}}Zp=new WeakMap,Qp=new WeakMap,cl=new WeakMap,Vh=new WeakMap,em=new WeakMap;function P5(){let r=0;return()=>++r}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Zu extends k0{constructor(e,n,a,i){super();y(this,ll);y(this,qh);y(this,io,new zk);y(this,Da);y(this,Gh);y(this,Xh);_(this,Da,e),_(this,qh,n),_(this,ll,a),_(this,Gh,i)}_setTarget(e){_(this,Xh,e)}_target(){return Ee(o(this,Xh),"Target must exist"),o(this,Xh)}connection(){return o(this,Da)}parentSession(){var n;return o(this,Gh)?((n=o(this,Da))==null?void 0:n.session(o(this,Gh)))??void 0:this}send(e,n,a){return o(this,Da)?o(this,Da)._rawSend(o(this,io),e,n,o(this,ll),a):Promise.reject(new ya(`Protocol error (${e}): Session closed. Most likely the ${o(this,qh)} has been closed.`))}_onMessage(e){e.id?e.error?o(this,io).reject(e.id,_C(e),e.error.message):o(this,io).resolve(e.id,e.result):(Ee(!e.id),this.emit(e.method,e.params))}async detach(){if(!o(this,Da))throw new Error(`Session already detached. Most likely the ${o(this,qh)} has been closed.`);await o(this,Da).send("Target.detachFromTarget",{sessionId:o(this,ll)})}_onClosed(){o(this,io).clear(),_(this,Da,void 0),this.emit(St.Disconnected,void 0)}id(){return o(this,ll)}getPendingProtocolErrors(){return o(this,io).getPendingProtocolErrors()}}ll=new WeakMap,qh=new WeakMap,io=new WeakMap,Da=new WeakMap,Gh=new WeakMap,Xh=new WeakMap;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Kk{constructor(t,e,n,a){y(this,tm);y(this,rm);y(this,nm);y(this,Yh);_(this,tm,t),_(this,rm,e),_(this,nm,n),_(this,Yh,a)}type(){return o(this,tm)}text(){return o(this,rm)}args(){return o(this,nm)}location(){return o(this,Yh)[0]??{}}stackTrace(){return o(this,Yh)}}tm=new WeakMap,rm=new WeakMap,nm=new WeakMap,Yh=new WeakMap;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class I5{constructor(t,e){y(this,Jh);y(this,am);y(this,ul,!1);_(this,Jh,t),_(this,am,e.mode!=="selectSingle")}isMultiple(){return o(this,am)}async accept(t){Ee(!o(this,ul),"Cannot accept FileChooser which is already handled!"),_(this,ul,!0),await o(this,Jh).uploadFile(...t)}async cancel(){Ee(!o(this,ul),"Cannot cancel FileChooser which is already handled!"),_(this,ul,!0),await o(this,Jh).evaluate(t=>{t.dispatchEvent(new Event("cancel",{bubbles:!0}))})}}Jh=new WeakMap,am=new WeakMap,ul=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Tr;(function(r){r.Request=Symbol("NetworkManager.Request"),r.RequestServedFromCache=Symbol("NetworkManager.RequestServedFromCache"),r.Response=Symbol("NetworkManager.Response"),r.RequestFailed=Symbol("NetworkManager.RequestFailed"),r.RequestFinished=Symbol("NetworkManager.RequestFinished")})(Tr||(Tr={}));/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const D5=Ku("puppeteer:protocol:SEND ►"),O5=Ku("puppeteer:protocol:RECV ◀");class VC extends Ue{constructor(e,n,a=0,i){super();y(this,sm);y(this,im);y(this,ci);y(this,hl);y(this,Zh);y(this,mn,new Map);y(this,dl,!1);y(this,Qh,new Set);y(this,so,new zk);_(this,im,e),_(this,hl,a),_(this,Zh,i??18e4),_(this,ci,n),o(this,ci).onmessage=this.onMessage.bind(this),o(this,ci).onclose=F(this,sm,KE).bind(this)}static fromSession(e){return e.connection()}get delay(){return o(this,hl)}get timeout(){return o(this,Zh)}get _closed(){return o(this,dl)}get _sessions(){return o(this,mn)}session(e){return o(this,mn).get(e)||null}url(){return o(this,im)}send(e,n,a){return this._rawSend(o(this,so),e,n,void 0,a)}_rawSend(e,n,a,i,s){return o(this,dl)?Promise.reject(new Error("Protocol error: Connection closed.")):e.create(n,(s==null?void 0:s.timeout)??o(this,Zh),c=>{const l=JSON.stringify({method:n,params:a,id:c,sessionId:i});D5(l),o(this,ci).send(l)})}async closeBrowser(){await this.send("Browser.close")}async onMessage(e){o(this,hl)&&await new Promise(a=>setTimeout(a,o(this,hl))),O5(e);const n=JSON.parse(e);if(n.method==="Target.attachedToTarget"){const a=n.params.sessionId,i=new Zu(this,n.params.targetInfo.type,a,n.sessionId);o(this,mn).set(a,i),this.emit(St.SessionAttached,i);const s=o(this,mn).get(n.sessionId);s&&s.emit(St.SessionAttached,i)}else if(n.method==="Target.detachedFromTarget"){const a=o(this,mn).get(n.params.sessionId);if(a){a._onClosed(),o(this,mn).delete(n.params.sessionId),this.emit(St.SessionDetached,a);const i=o(this,mn).get(n.sessionId);i&&i.emit(St.SessionDetached,a)}}if(n.sessionId){const a=o(this,mn).get(n.sessionId);a&&a._onMessage(n)}else n.id?n.error?o(this,so).reject(n.id,_C(n),n.error.message):o(this,so).resolve(n.id,n.result):this.emit(n.method,n.params)}dispose(){F(this,sm,KE).call(this),o(this,ci).close()}isAutoAttached(e){return!o(this,Qh).has(e)}async _createSession(e,n=!0){n||o(this,Qh).add(e.targetId);const{sessionId:a}=await this.send("Target.attachToTarget",{targetId:e.targetId,flatten:!0});o(this,Qh).delete(e.targetId);const i=o(this,mn).get(a);if(!i)throw new Error("CDPSession creation failed.");return i}async createSession(e){return await this._createSession(e,!1)}getPendingProtocolErrors(){const e=[];e.push(...o(this,so).getPendingProtocolErrors());for(const n of o(this,mn).values())e.push(...n.getPendingProtocolErrors());return e}}im=new WeakMap,ci=new WeakMap,hl=new WeakMap,Zh=new WeakMap,mn=new WeakMap,dl=new WeakMap,Qh=new WeakMap,so=new WeakMap,sm=new WeakSet,KE=function(){if(!o(this,dl)){_(this,dl,!0),o(this,ci).onmessage=void 0,o(this,ci).onclose=void 0,o(this,so).clear();for(const e of o(this,mn).values())e._onClosed();o(this,mn).clear(),this.emit(St.Disconnected,void 0)}};function Vk(r){return r instanceof ya}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class qC{constructor(t){y(this,fl);y(this,pl);_(this,fl,new M5(t)),_(this,pl,new R5(t))}updateClient(t){o(this,fl).updateClient(t),o(this,pl).updateClient(t)}async startJSCoverage(t={}){return await o(this,fl).start(t)}async stopJSCoverage(){return await o(this,fl).stop()}async startCSSCoverage(t={}){return await o(this,pl).start(t)}async stopCSSCoverage(){return await o(this,pl).stop()}}fl=new WeakMap,pl=new WeakMap;class M5{constructor(t){y(this,nd);y(this,gn);y(this,ml,!1);y(this,gl,new Map);y(this,wl,new Map);y(this,ed);y(this,om,!1);y(this,td,!1);y(this,rd,!1);_(this,gn,t)}updateClient(t){_(this,gn,t)}async start(t={}){Ee(!o(this,ml),"JSCoverage is already enabled");const{resetOnNavigation:e=!0,reportAnonymousScripts:n=!1,includeRawScriptCoverage:a=!1,useBlockCoverage:i=!0}=t;_(this,om,e),_(this,td,n),_(this,rd,a),_(this,ml,!0),o(this,gl).clear(),o(this,wl).clear(),_(this,ed,new rr);const s=o(this,ed).use(new Ue(o(this,gn)));s.on("Debugger.scriptParsed",F(this,nd,DP).bind(this)),s.on("Runtime.executionContextsCleared",F(this,nd,IP).bind(this)),await Promise.all([o(this,gn).send("Profiler.enable"),o(this,gn).send("Profiler.startPreciseCoverage",{callCount:o(this,rd),detailed:i}),o(this,gn).send("Debugger.enable"),o(this,gn).send("Debugger.setSkipAllPauses",{skip:!0})])}async stop(){var a;Ee(o(this,ml),"JSCoverage is not enabled"),_(this,ml,!1);const t=await Promise.all([o(this,gn).send("Profiler.takePreciseCoverage"),o(this,gn).send("Profiler.stopPreciseCoverage"),o(this,gn).send("Profiler.disable"),o(this,gn).send("Debugger.disable")]);(a=o(this,ed))==null||a.dispose();const e=[],n=t[0];for(const i of n.result){let s=o(this,gl).get(i.scriptId);!s&&o(this,td)&&(s="debugger://VM"+i.scriptId);const c=o(this,wl).get(i.scriptId);if(c===void 0||s===void 0)continue;const l=[];for(const h of i.functions)l.push(...h.ranges);const u=GC(l);o(this,rd)?e.push({url:s,ranges:u,text:c,rawScriptCoverage:i}):e.push({url:s,ranges:u,text:c})}return e}}gn=new WeakMap,ml=new WeakMap,gl=new WeakMap,wl=new WeakMap,ed=new WeakMap,om=new WeakMap,td=new WeakMap,rd=new WeakMap,nd=new WeakSet,IP=function(){o(this,om)&&(o(this,gl).clear(),o(this,wl).clear())},DP=async function(t){if(!In.isPuppeteerURL(t.url)&&!(!t.url&&!o(this,td)))try{const e=await o(this,gn).send("Debugger.getScriptSource",{scriptId:t.scriptId});o(this,gl).set(t.scriptId,t.url),o(this,wl).set(t.scriptId,e.scriptSource)}catch(e){Re(e)}};class R5{constructor(t){y(this,id);y(this,Un);y(this,vl,!1);y(this,oo,new Map);y(this,yl,new Map);y(this,ad);y(this,cm,!1);_(this,Un,t)}updateClient(t){_(this,Un,t)}async start(t={}){Ee(!o(this,vl),"CSSCoverage is already enabled");const{resetOnNavigation:e=!0}=t;_(this,cm,e),_(this,vl,!0),o(this,oo).clear(),o(this,yl).clear(),_(this,ad,new rr);const n=o(this,ad).use(new Ue(o(this,Un)));n.on("CSS.styleSheetAdded",F(this,id,MP).bind(this)),n.on("Runtime.executionContextsCleared",F(this,id,OP).bind(this)),await Promise.all([o(this,Un).send("DOM.enable"),o(this,Un).send("CSS.enable"),o(this,Un).send("CSS.startRuleUsageTracking")])}async stop(){var a;Ee(o(this,vl),"CSSCoverage is not enabled"),_(this,vl,!1);const t=await o(this,Un).send("CSS.stopRuleUsageTracking");await Promise.all([o(this,Un).send("CSS.disable"),o(this,Un).send("DOM.disable")]),(a=o(this,ad))==null||a.dispose();const e=new Map;for(const i of t.ruleUsage){let s=e.get(i.styleSheetId);s||(s=[],e.set(i.styleSheetId,s)),s.push({startOffset:i.startOffset,endOffset:i.endOffset,count:i.used?1:0})}const n=[];for(const i of o(this,oo).keys()){const s=o(this,oo).get(i);Ee(typeof s<"u",`Stylesheet URL is undefined (styleSheetId=${i})`);const c=o(this,yl).get(i);Ee(typeof c<"u",`Stylesheet text is undefined (styleSheetId=${i})`);const l=GC(e.get(i)||[]);n.push({url:s,ranges:l,text:c})}return n}}Un=new WeakMap,vl=new WeakMap,oo=new WeakMap,yl=new WeakMap,ad=new WeakMap,cm=new WeakMap,id=new WeakSet,OP=function(){o(this,cm)&&(o(this,oo).clear(),o(this,yl).clear())},MP=async function(t){const e=t.header;if(e.sourceURL)try{const n=await o(this,Un).send("CSS.getStyleSheetText",{styleSheetId:e.styleSheetId});o(this,oo).set(e.styleSheetId,e.sourceURL),o(this,yl).set(e.styleSheetId,n.text)}catch(n){Re(n)}};function GC(r){const t=[];for(const i of r)t.push({offset:i.startOffset,type:0,range:i}),t.push({offset:i.endOffset,type:1,range:i});t.sort((i,s)=>{if(i.offset!==s.offset)return i.offset-s.offset;if(i.type!==s.type)return s.type-i.type;const c=i.range.endOffset-i.range.startOffset,l=s.range.endOffset-s.range.startOffset;return i.type===0?l-c:c-l});const e=[],n=[];let a=0;for(const i of t){if(e.length&&a<i.offset&&e[e.length-1]>0){const s=n[n.length-1];s&&s.end===a?s.end=i.offset:n.push({start:a,end:i.offset})}a=i.offset,i.type===0?e.push(i.range.count):e.pop()}return n.filter(i=>i.end-i.start>0)}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class N5 extends kC{constructor(e,n,a,i=""){super(n,a,i);y(this,lm);_(this,lm,e)}async handle(e){await o(this,lm).send("Page.handleJavaScriptDialog",{accept:e.accept,promptText:e.text})}}lm=new WeakMap;var L5=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Ga=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},Xa=function(r,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:e?"".concat(e," ",t):t})};class Ya{constructor(t,e,n){y(this,xl);y(this,sd);y(this,um);_(this,xl,t),_(this,sd,e),_(this,um,n),o(this,sd).registerState(this)}async setState(t){_(this,xl,t),await this.sync()}get state(){return o(this,xl)}async sync(){await Promise.all(o(this,sd).clients().map(t=>o(this,um).call(this,t,o(this,xl))))}}xl=new WeakMap,sd=new WeakMap,um=new WeakMap;let XC=(()=>{var I,O,E,T,P,W,U,A,N,C,K,ne,X,oe,q,se,VE,qE,GE,XE,YE,JE,ZE,QE,eS,tS,te;let r=[],t,e,n,a,i,s,c,l,u,h,d,f,m,w,p,g,v,k,x,S;return te=class{constructor(he){y(this,se);y(this,I,L5(this,r));y(this,O,!1);y(this,E,!1);y(this,T,[]);y(this,P,new Ya({active:!1},this,o(this,se,VE)));y(this,W,new Ya({active:!1},this,o(this,se,qE)));y(this,U,new Ya({active:!1},this,o(this,se,GE)));y(this,A,new Ya({active:!1},this,o(this,se,XE)));y(this,N,new Ya({active:!1},this,o(this,se,YE)));y(this,C,new Ya({active:!1},this,o(this,se,JE)));y(this,K,new Ya({active:!1},this,o(this,se,ZE)));y(this,ne,new Ya({active:!1},this,o(this,se,QE)));y(this,X,new Ya({active:!1},this,o(this,se,eS)));y(this,oe,new Ya({javaScriptEnabled:!0,active:!1},this,o(this,se,tS)));y(this,q,new Set);_(this,I,he)}updateClient(he){_(this,I,he),o(this,q).delete(he)}registerState(he){o(this,T).push(he)}clients(){return[o(this,I),...Array.from(o(this,q))]}async registerSpeculativeSession(he){o(this,q).add(he),he.once(St.Disconnected,()=>{o(this,q).delete(he)}),Promise.all(o(this,T).map(b=>b.sync().catch(Re)))}get javascriptEnabled(){return o(this,oe).state.javaScriptEnabled}async emulateViewport(he){const b=o(this,P).state;if(!he&&!b.active)return!1;await o(this,P).setState(he?{viewport:he,active:!0}:{active:!1});const ee=(he==null?void 0:he.isMobile)||!1,re=(he==null?void 0:he.hasTouch)||!1,j=o(this,O)!==ee||o(this,E)!==re;return _(this,O,ee),_(this,E,re),j}async emulateIdleState(he){await o(this,W).setState({active:!0,overrides:he})}async emulateTimezone(he){await o(this,U).setState({timezoneId:he,active:!0})}async emulateVisionDeficiency(he){Ee(!he||new Set(["none","achromatopsia","blurredVision","deuteranopia","protanopia","tritanopia"]).has(he),`Unsupported vision deficiency: ${he}`),await o(this,A).setState({active:!0,visionDeficiency:he})}async emulateCPUThrottling(he){Ee(he===null||he>=1,"Throttling rate should be greater or equal to 1"),await o(this,N).setState({active:!0,factor:he??void 0})}async emulateMediaFeatures(he){if(Array.isArray(he))for(const b of he){const ee=b.name;Ee(/^(?:prefers-(?:color-scheme|reduced-motion)|color-gamut)$/.test(ee),"Unsupported media feature: "+ee)}await o(this,C).setState({active:!0,mediaFeatures:he})}async emulateMediaType(he){Ee(he==="screen"||he==="print"||(he??void 0)===void 0,"Unsupported media type: "+he),await o(this,K).setState({type:he,active:!0})}async setGeolocation(he){const{longitude:b,latitude:ee,accuracy:re=0}=he;if(b<-180||b>180)throw new Error(`Invalid longitude "${b}": precondition -180 <= LONGITUDE <= 180 failed.`);if(ee<-90||ee>90)throw new Error(`Invalid latitude "${ee}": precondition -90 <= LATITUDE <= 90 failed.`);if(re<0)throw new Error(`Invalid accuracy "${re}": precondition 0 <= ACCURACY failed.`);await o(this,ne).setState({active:!0,geoLocation:{longitude:b,latitude:ee,accuracy:re}})}async resetDefaultBackgroundColor(){await o(this,X).setState({active:!0,color:void 0})}async setTransparentBackgroundColor(){await o(this,X).setState({active:!0,color:{r:0,g:0,b:0,a:0}})}async setJavaScriptEnabled(he){await o(this,oe).setState({active:!0,javaScriptEnabled:he})}},I=new WeakMap,O=new WeakMap,E=new WeakMap,T=new WeakMap,P=new WeakMap,W=new WeakMap,U=new WeakMap,A=new WeakMap,N=new WeakMap,C=new WeakMap,K=new WeakMap,ne=new WeakMap,X=new WeakMap,oe=new WeakMap,q=new WeakMap,se=new WeakSet,VE=function(){return e.value},qE=function(){return a.value},GE=function(){return s.value},XE=function(){return l.value},YE=function(){return h.value},JE=function(){return f.value},ZE=function(){return w.value},QE=function(){return g.value},eS=function(){return k.value},tS=function(){return S.value},(()=>{const he=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;t=[xa],n=[xa],i=[xa],c=[xa],u=[xa],d=[xa],m=[xa],p=[xa],v=[xa],x=[xa],Ga(te,e={value:Xa(async function(b,ee){if(!ee.viewport){await Promise.all([b.send("Emulation.clearDeviceMetricsOverride"),b.send("Emulation.setTouchEmulationEnabled",{enabled:!1})]).catch(Re);return}const{viewport:re}=ee,j=re.isMobile||!1,z=re.width,ie=re.height,we=re.deviceScaleFactor??1,ye=re.isLandscape?{angle:90,type:"landscapePrimary"}:{angle:0,type:"portraitPrimary"},le=re.hasTouch||!1;await Promise.all([b.send("Emulation.setDeviceMetricsOverride",{mobile:j,width:z,height:ie,deviceScaleFactor:we,screenOrientation:ye}).catch(be=>{if(be.message.includes("Target does not support metrics override")){Re(be);return}throw be}),b.send("Emulation.setTouchEmulationEnabled",{enabled:le})])},"#applyViewport")},t,{kind:"method",name:"#applyViewport",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,VE)},metadata:he},null,r),Ga(te,a={value:Xa(async function(b,ee){ee.active&&(ee.overrides?await b.send("Emulation.setIdleOverride",{isUserActive:ee.overrides.isUserActive,isScreenUnlocked:ee.overrides.isScreenUnlocked}):await b.send("Emulation.clearIdleOverride"))},"#emulateIdleState")},n,{kind:"method",name:"#emulateIdleState",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,qE)},metadata:he},null,r),Ga(te,s={value:Xa(async function(b,ee){if(ee.active)try{await b.send("Emulation.setTimezoneOverride",{timezoneId:ee.timezoneId||""})}catch(re){throw Yn(re)&&re.message.includes("Invalid timezone")?new Error(`Invalid timezone ID: ${ee.timezoneId}`):re}},"#emulateTimezone")},i,{kind:"method",name:"#emulateTimezone",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,GE)},metadata:he},null,r),Ga(te,l={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setEmulatedVisionDeficiency",{type:ee.visionDeficiency||"none"})},"#emulateVisionDeficiency")},c,{kind:"method",name:"#emulateVisionDeficiency",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,XE)},metadata:he},null,r),Ga(te,h={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setCPUThrottlingRate",{rate:ee.factor??1})},"#emulateCpuThrottling")},u,{kind:"method",name:"#emulateCpuThrottling",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,YE)},metadata:he},null,r),Ga(te,f={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setEmulatedMedia",{features:ee.mediaFeatures})},"#emulateMediaFeatures")},d,{kind:"method",name:"#emulateMediaFeatures",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,JE)},metadata:he},null,r),Ga(te,w={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setEmulatedMedia",{media:ee.type||""})},"#emulateMediaType")},m,{kind:"method",name:"#emulateMediaType",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,ZE)},metadata:he},null,r),Ga(te,g={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setGeolocationOverride",ee.geoLocation?{longitude:ee.geoLocation.longitude,latitude:ee.geoLocation.latitude,accuracy:ee.geoLocation.accuracy}:void 0)},"#setGeolocation")},p,{kind:"method",name:"#setGeolocation",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,QE)},metadata:he},null,r),Ga(te,k={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setDefaultBackgroundColorOverride",{color:ee.color})},"#setDefaultBackgroundColor")},v,{kind:"method",name:"#setDefaultBackgroundColor",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,eS)},metadata:he},null,r),Ga(te,S={value:Xa(async function(b,ee){ee.active&&await b.send("Emulation.setScriptExecutionDisabled",{value:!ee.javaScriptEnabled})},"#setJavaScriptEnabled")},x,{kind:"method",name:"#setJavaScriptEnabled",static:!1,private:!0,access:{has:b=>_n(se,b),get:b=>o(b,se,tS)},metadata:he},null,r),he&&Object.defineProperty(te,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:he})})(),te})();/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class qk extends Ue{constructor(e,n,a){super();y(this,bl);y(this,sa);y(this,kl,new Map);y(this,li,new Map);y(this,hm,new Map);y(this,od);y(this,cd);y(this,co,new WeakMap);y(this,dm,Et.create());y(this,ld,new Set);y(this,Uy,e=>{this.removeSessionListeners(e),o(this,hm).delete(e.id())});y(this,fm,async e=>{if(o(this,kl).has(e.targetInfo.targetId))return;if(o(this,kl).set(e.targetInfo.targetId,e.targetInfo),e.targetInfo.type==="browser"&&e.targetInfo.attached){const a=o(this,cd).call(this,e.targetInfo,void 0);a._initialize(),o(this,li).set(e.targetInfo.targetId,a),F(this,bl,rw).call(this,a._targetId);return}const n=o(this,cd).call(this,e.targetInfo,void 0);if(o(this,od)&&!o(this,od).call(this,n)){F(this,bl,rw).call(this,e.targetInfo.targetId);return}n._initialize(),o(this,li).set(e.targetInfo.targetId,n),this.emit("targetAvailable",n),F(this,bl,rw).call(this,n._targetId)});y(this,pm,e=>{o(this,kl).delete(e.targetId),F(this,bl,rw).call(this,e.targetId);const n=o(this,li).get(e.targetId);n&&(this.emit("targetGone",n),o(this,li).delete(e.targetId))});y(this,$y,async(e,n)=>{const a=n.targetInfo,i=o(this,sa).session(n.sessionId);if(!i)throw new Error(`Session ${n.sessionId} was not created.`);const s=o(this,li).get(a.targetId);Ee(s,`Target ${a.targetId} is missing`),i._setTarget(s),this.setupAttachmentListeners(i),o(this,hm).set(i.id(),o(this,li).get(a.targetId)),e.emit(St.Ready,i)});_(this,sa,e),_(this,od,a),_(this,cd,n),o(this,sa).on("Target.targetCreated",o(this,fm)),o(this,sa).on("Target.targetDestroyed",o(this,pm)),o(this,sa).on(St.SessionDetached,o(this,Uy)),this.setupAttachmentListeners(o(this,sa))}setupAttachmentListeners(e){const n=a=>o(this,$y).call(this,e,a);Ee(!o(this,co).has(e)),o(this,co).set(e,n),e.on("Target.attachedToTarget",n)}removeSessionListeners(e){o(this,co).has(e)&&(e.off("Target.attachedToTarget",o(this,co).get(e)),o(this,co).delete(e))}getAvailableTargets(){return o(this,li)}getChildTargets(e){return new Set}dispose(){o(this,sa).off("Target.targetCreated",o(this,fm)),o(this,sa).off("Target.targetDestroyed",o(this,pm))}async initialize(){await o(this,sa).send("Target.setDiscoverTargets",{discover:!0,filter:[{}]}),_(this,ld,new Set(o(this,kl).keys())),await o(this,dm).valueOrThrow()}}sa=new WeakMap,kl=new WeakMap,li=new WeakMap,hm=new WeakMap,od=new WeakMap,cd=new WeakMap,co=new WeakMap,dm=new WeakMap,ld=new WeakMap,Uy=new WeakMap,fm=new WeakMap,pm=new WeakMap,$y=new WeakMap,bl=new WeakSet,rw=function(e){o(this,ld).delete(e),o(this,ld).size===0&&o(this,dm).resolve()};/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class B5{constructor(t,e,n){y(this,mm);y(this,gm);y(this,ud,new WeakMap);_(this,mm,e),_(this,gm,n),o(this,ud).set(t,e)}get id(){return o(this,mm)}get source(){return o(this,gm)}getIdForFrame(t){return o(this,ud).get(t)}setIdForFrame(t,e){o(this,ud).set(t,e)}}mm=new WeakMap,gm=new WeakMap,ud=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class U5{constructor(t,e){H(this,"id");H(this,"name");this.id=t,this.name=e}}class $5{constructor(t,e,n){y(this,vm);y(this,$n);y(this,wm);y(this,_l);y(this,El,!1);y(this,hd,F(this,vm,rS).bind(this));y(this,dd,new Set);H(this,"devices",[]);_(this,$n,t),_(this,wm,e),_(this,_l,n.id),o(this,$n).on("DeviceAccess.deviceRequestPrompted",o(this,hd)),o(this,$n).on("Target.detachedFromTarget",()=>{_(this,$n,null)}),F(this,vm,rS).call(this,n)}async waitForDevice(t,e={}){for(const s of this.devices)if(t(s))return s;const{timeout:n=o(this,wm).timeout()}=e,a=Et.create({message:`Waiting for \`DeviceRequestPromptDevice\` failed: ${n}ms exceeded`,timeout:n});e.signal&&e.signal.addEventListener("abort",()=>{var s;a.reject((s=e.signal)==null?void 0:s.reason)},{once:!0});const i={filter:t,promise:a};o(this,dd).add(i);try{return await a.valueOrThrow()}finally{o(this,dd).delete(i)}}async select(t){return Ee(o(this,$n)!==null,"Cannot select device through detached session!"),Ee(this.devices.includes(t),"Cannot select unknown device!"),Ee(!o(this,El),"Cannot select DeviceRequestPrompt which is already handled!"),o(this,$n).off("DeviceAccess.deviceRequestPrompted",o(this,hd)),_(this,El,!0),await o(this,$n).send("DeviceAccess.selectPrompt",{id:o(this,_l),deviceId:t.id})}async cancel(){return Ee(o(this,$n)!==null,"Cannot cancel prompt through detached session!"),Ee(!o(this,El),"Cannot cancel DeviceRequestPrompt which is already handled!"),o(this,$n).off("DeviceAccess.deviceRequestPrompted",o(this,hd)),_(this,El,!0),await o(this,$n).send("DeviceAccess.cancelPrompt",{id:o(this,_l)})}}$n=new WeakMap,wm=new WeakMap,_l=new WeakMap,El=new WeakMap,hd=new WeakMap,dd=new WeakMap,vm=new WeakSet,rS=function(t){if(t.id===o(this,_l))for(const e of t.devices){if(this.devices.some(a=>a.id===e.id))continue;const n=new U5(e.id,e.name);this.devices.push(n);for(const a of o(this,dd))a.filter(n)&&a.promise.resolve(n)}};class j5{constructor(t,e){y(this,jy);y(this,Oa);y(this,fd);y(this,es,new Set);_(this,Oa,t),_(this,fd,e),o(this,Oa).on("DeviceAccess.deviceRequestPrompted",n=>{F(this,jy,RP).call(this,n)}),o(this,Oa).on("Target.detachedFromTarget",()=>{_(this,Oa,null)})}async waitForDevicePrompt(t={}){Ee(o(this,Oa)!==null,"Cannot wait for device prompt through detached session!");const e=o(this,es).size===0;let n;e&&(n=o(this,Oa).send("DeviceAccess.enable"));const{timeout:a=o(this,fd).timeout()}=t,i=Et.create({message:`Waiting for \`DeviceRequestPrompt\` failed: ${a}ms exceeded`,timeout:a});t.signal&&t.signal.addEventListener("abort",()=>{var s;i.reject((s=t.signal)==null?void 0:s.reason)},{once:!0}),o(this,es).add(i);try{const[s]=await Promise.all([i.valueOrThrow(),n]);return s}finally{o(this,es).delete(i)}}}Oa=new WeakMap,fd=new WeakMap,es=new WeakMap,jy=new WeakSet,RP=function(t){if(!o(this,es).size)return;Ee(o(this,Oa)!==null);const e=new $5(o(this,Oa),o(this,fd),t);for(const n of o(this,es))n.resolve(e);o(this,es).clear()};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function YC(r){let t,e;if(!r.exception)t="Error",e=r.text;else{if((r.exception.type!=="object"||r.exception.subtype!=="error")&&!r.exception.objectId)return _c(r.exception);{const c=JC(r);t=c.name,e=c.message}}const n=e.split(`
`).length,a=new Error(e);a.name=t;const i=a.stack.split(`
`),s=i.splice(0,n);if(i.shift(),r.stackTrace&&i.length<Error.stackTraceLimit)for(const c of r.stackTrace.callFrames.reverse()){if(In.isPuppeteerURL(c.url)&&c.url!==In.INTERNAL_URL){const l=In.parse(c.url);i.unshift(`    at ${c.functionName||l.functionName} (${l.functionName} at ${l.siteString}, <anonymous>:${c.lineNumber}:${c.columnNumber})`)}else i.push(`    at ${c.functionName||"<anonymous>"} (${c.url}:${c.lineNumber}:${c.columnNumber})`);if(i.length>=Error.stackTraceLimit)break}return a.stack=[...s,...i].join(`
`),a}const JC=r=>{var i,s,c,l;let t="",e;const n=((s=(i=r.exception)==null?void 0:i.description)==null?void 0:s.split(`
    at `))??[],a=Math.min(((c=r.stackTrace)==null?void 0:c.callFrames.length)??0,n.length-1);return n.splice(-a,a),(l=r.exception)!=null&&l.className&&(t=r.exception.className),e=n.join(`
`),t&&e.startsWith(`${t}: `)&&(e=e.slice(t.length+2)),{message:e,name:t}};function H5(r){let t,e;if(!r.exception)t="Error",e=r.text;else{if((r.exception.type!=="object"||r.exception.subtype!=="error")&&!r.exception.objectId)return _c(r.exception);{const c=JC(r);t=c.name,e=c.message}}const n=new Error(e);n.name=t;const a=n.message.split(`
`).length,i=n.stack.split(`
`).splice(0,a),s=[];if(r.stackTrace){for(const c of r.stackTrace.callFrames)if(s.push(`    at ${c.functionName||"<anonymous>"} (${c.url}:${c.lineNumber+1}:${c.columnNumber+1})`),s.length>=Error.stackTraceLimit)break}return n.stack=[...i,...s].join(`
`),n}function _c(r){if(Ee(!r.objectId,"Cannot extract value when objectId is given"),r.unserializableValue){if(r.type==="bigint")return BigInt(r.unserializableValue.replace("n",""));switch(r.unserializableValue){case"-0":return-0;case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error("Unsupported unserializable value: "+r.unserializableValue)}}return r.value}function ZC(r,t,e){globalThis[t]||Object.assign(globalThis,{[t](...n){const a=globalThis[t];a.args??(a.args=new Map),a.callbacks??(a.callbacks=new Map);const i=(a.lastSeq??0)+1;return a.lastSeq=i,a.args.set(i,n),globalThis[e+t](JSON.stringify({type:r,name:t,seq:i,args:n,isTrivial:!n.some(s=>s instanceof Node)})),new Promise((s,c)=>{a.callbacks.set(i,{resolve(l){a.args.delete(i),s(l)},reject(l){a.args.delete(i),c(l)}})})}})}const Qu="puppeteer_";function W5(r,t){return Fk(ZC,r,t,Qu)}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Kw extends bc{constructor(e,n){super();y(this,pd,!1);y(this,An);y(this,md);_(this,md,e),_(this,An,n)}get disposed(){return o(this,pd)}get realm(){return o(this,md)}get client(){return this.realm.environment.client}async jsonValue(){if(!o(this,An).objectId)return _c(o(this,An));const e=await this.evaluate(n=>n);if(e===void 0)throw new Error("Could not serialize referenced object");return e}asElement(){return null}async dispose(){o(this,pd)||(_(this,pd,!0),await QC(this.client,o(this,An)))}toString(){return o(this,An).objectId?"JSHandle@"+(o(this,An).subtype||o(this,An).type):"JSHandle:"+_c(o(this,An))}get id(){return o(this,An).objectId}remoteObject(){return o(this,An)}async getProperties(){const e=await this.client.send("Runtime.getProperties",{objectId:o(this,An).objectId,ownProperties:!0}),n=new Map;for(const a of e.result)!a.enumerable||!a.value||n.set(a.name,o(this,md).createCdpHandle(a.value));return n}}pd=new WeakMap,An=new WeakMap,md=new WeakMap;async function QC(r,t){t.objectId&&await r.send("Runtime.releaseObject",{objectId:t.objectId}).catch(e=>{Re(e)})}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var z5=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Vw=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};const K5=new Set(["StaticText","InlineTextBox"]);let eT=(()=>{var s,NP,l;let r=FC,t=[],e,n,a,i;return l=class extends r{constructor(d,f){super(new Kw(d,f));y(this,s);z5(this,t)}get realm(){return this.handle.realm}get client(){return this.handle.client}remoteObject(){return this.handle.remoteObject()}get frame(){return this.realm.environment}async contentFrame(){const d=await this.client.send("DOM.describeNode",{objectId:this.id});return typeof d.node.frameId!="string"?null:o(this,s,NP).frame(d.node.frameId)}async scrollIntoView(){await this.assertConnectedElement();try{await this.client.send("DOM.scrollIntoViewIfNeeded",{objectId:this.id})}catch(d){Re(d),await super.scrollIntoView()}}async uploadFile(...d){const f=await this.evaluate(g=>g.multiple);Ee(d.length<=1||f,"Multiple file uploads only work with <input type=file multiple>");const m=Is.value.path,w=d.map(g=>m.win32.isAbsolute(g)||m.posix.isAbsolute(g)?g:m.resolve(g));if(w.length===0){await this.evaluate(g=>{g.files=new DataTransfer().files,g.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),g.dispatchEvent(new Event("change",{bubbles:!0}))});return}const{node:{backendNodeId:p}}=await this.client.send("DOM.describeNode",{objectId:this.id});await this.client.send("DOM.setFileInputFiles",{objectId:this.id,files:w,backendNodeId:p})}async autofill(d){const m=(await this.client.send("DOM.describeNode",{objectId:this.handle.id})).node.backendNodeId,w=this.frame._id;await this.client.send("Autofill.trigger",{fieldId:m,frameId:w,card:d.creditCard})}async*queryAXTree(d,f){const{nodes:m}=await this.client.send("Accessibility.queryAXTree",{objectId:this.id,accessibleName:d,role:f}),w=m.filter(p=>!(p.ignored||!p.role||K5.has(p.role.value)));return yield*Gu.map(w,p=>this.realm.adoptBackendNode(p.backendDOMNodeId))}},s=new WeakSet,NP=function(){return this.frame._frameManager},(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e=[Fe()],n=[Fe(),ft],a=[Fe(),ft],i=[Fe()],Vw(l,null,e,{kind:"method",name:"contentFrame",static:!1,private:!1,access:{has:f=>"contentFrame"in f,get:f=>f.contentFrame},metadata:d},null,t),Vw(l,null,n,{kind:"method",name:"scrollIntoView",static:!1,private:!1,access:{has:f=>"scrollIntoView"in f,get:f=>f.scrollIntoView},metadata:d},null,t),Vw(l,null,a,{kind:"method",name:"uploadFile",static:!1,private:!1,access:{has:f=>"uploadFile"in f,get:f=>f.uploadFile},metadata:d},null,t),Vw(l,null,i,{kind:"method",name:"autofill",static:!1,private:!1,access:{has:f=>"autofill"in f,get:f=>f.autofill},metadata:d},null,t),d&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d})})(),l})();/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var V5=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},q5=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});const G5=new zw("__ariaQuerySelector",kc.queryOne,""),X5=new zw("__ariaQuerySelectorAll",async(r,t)=>{const e=kc.queryAll(r,t);return await r.realm.evaluateHandle((...n)=>n,...await Gu.collect(e))},"");class tT extends Ue{constructor(e,n,a){super();y(this,Fn);y(this,lo);y(this,Sl);y(this,Ma);y(this,gd);y(this,ym,new rr);y(this,Cl,new Map);y(this,Hy,new Dk);y(this,xm,!1);y(this,uo);_(this,lo,e),_(this,Sl,a),_(this,Ma,n.id),n.name&&_(this,gd,n.name);const i=o(this,ym).use(new Ue(o(this,lo)));i.on("Runtime.bindingCalled",F(this,Fn,BP).bind(this)),i.on("Runtime.executionContextDestroyed",async s=>{s.executionContextId===o(this,Ma)&&this[He]()}),i.on("Runtime.executionContextsCleared",async()=>{this[He]()}),i.on("Runtime.consoleAPICalled",F(this,Fn,UP).bind(this)),i.on(St.Disconnected,()=>{this[He]()})}get id(){return o(this,Ma)}get puppeteerUtil(){let e=Promise.resolve();return o(this,xm)||(e=Promise.all([F(this,Fn,nS).call(this,G5),F(this,Fn,nS).call(this,X5)]),_(this,xm,!0)),b0.inject(n=>{o(this,uo)&&o(this,uo).then(a=>{a.dispose()}),_(this,uo,e.then(()=>this.evaluateHandle(n)))},!o(this,uo)),o(this,uo)}async evaluate(e,...n){return await F(this,Fn,aS).call(this,!0,e,...n)}async evaluateHandle(e,...n){return await F(this,Fn,aS).call(this,!1,e,...n)}[He](){o(this,ym).dispose(),this.emit("disposed",void 0)}}lo=new WeakMap,Sl=new WeakMap,Ma=new WeakMap,gd=new WeakMap,ym=new WeakMap,Cl=new WeakMap,Hy=new WeakMap,Fn=new WeakSet,LP=async function(e){const n={stack:[],error:void 0,hasError:!1};try{if(o(this,Cl).has(e.name))return;const a=V5(n,await o(this,Hy).acquire(),!1);try{await o(this,lo).send("Runtime.addBinding",o(this,gd)?{name:Qu+e.name,executionContextName:o(this,gd)}:{name:Qu+e.name,executionContextId:o(this,Ma)}),await this.evaluate(ZC,"internal",e.name,Qu),o(this,Cl).set(e.name,e)}catch(i){if(i instanceof Error&&(i.message.includes("Execution context was destroyed")||i.message.includes("Cannot find context with specified id")))return;Re(i)}}catch(a){n.error=a,n.hasError=!0}finally{q5(n)}},BP=async function(e){if(e.executionContextId!==o(this,Ma))return;let n;try{n=JSON.parse(e.payload)}catch{return}const{type:a,name:i,seq:s,args:c,isTrivial:l}=n;if(a!=="internal"){this.emit("bindingcalled",e);return}if(!o(this,Cl).has(i)){this.emit("bindingcalled",e);return}try{const u=o(this,Cl).get(i);await(u==null?void 0:u.run(this,s,c,l))}catch(u){Re(u)}},UP=function(e){e.executionContextId===o(this,Ma)&&this.emit("consoleapicalled",e)},xm=new WeakMap,uo=new WeakMap,nS=async function(e){try{await F(this,Fn,LP).call(this,e)}catch(n){Re(n)}},aS=async function(e,n,...a){var m;const i=wC(((m=fC(n))==null?void 0:m.toString())??In.INTERNAL_URL);if(Ni(n)){const w=o(this,Ma),p=n,g=Tw.test(p)?p:`${p}
${i}
`,{exceptionDetails:v,result:k}=await o(this,lo).send("Runtime.evaluate",{expression:g,contextId:w,returnByValue:e,awaitPromise:!0,userGesture:!0}).catch(rT);if(v)throw YC(v);return e?_c(k):o(this,Sl).createCdpHandle(k)}const s=Va(n),c=Tw.test(s)?s:`${s}
${i}
`;let l;try{l=o(this,lo).send("Runtime.callFunctionOn",{functionDeclaration:c,executionContextId:o(this,Ma),arguments:a.some(w=>w instanceof Dn)?await Promise.all(a.map(w=>d(this,w))):a.map(w=>f(this,w)),returnByValue:e,awaitPromise:!0,userGesture:!0})}catch(w){throw w instanceof TypeError&&w.message.startsWith("Converting circular structure to JSON")&&(w.message+=" Recursive objects are not allowed."),w}const{exceptionDetails:u,result:h}=await l.catch(rT);if(u)throw YC(u);return e?_c(h):o(this,Sl).createCdpHandle(h);async function d(w,p){return p instanceof Dn&&(p=await p.get(w)),f(w,p)}function f(w,p){if(typeof p=="bigint")return{unserializableValue:`${p.toString()}n`};if(Object.is(p,-0))return{unserializableValue:"-0"};if(Object.is(p,1/0))return{unserializableValue:"Infinity"};if(Object.is(p,-1/0))return{unserializableValue:"-Infinity"};if(Object.is(p,NaN))return{unserializableValue:"NaN"};const g=p&&(p instanceof Kw||p instanceof eT)?p:null;if(g){if(g.realm!==o(w,Sl))throw new Error("JSHandles can be evaluated only in the context they were created!");if(g.disposed)throw new Error("JSHandle is disposed!");return g.remoteObject().unserializableValue?{unserializableValue:g.remoteObject().unserializableValue}:g.remoteObject().objectId?{objectId:g.remoteObject().objectId}:{value:g.remoteObject().value}}return{value:p}}};const rT=r=>{if(r.message.includes("Object reference chain is too long"))return{result:{type:"undefined"}};if(r.message.includes("Object couldn't be returned by value"))return{result:{type:"undefined"}};throw r.message.endsWith("Cannot find context with specified id")||r.message.endsWith("Inspected target navigated or closed")?new Error("Execution context was destroyed, most likely because of a navigation."):r};/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ar;(function(r){r.FrameAttached=Symbol("FrameManager.FrameAttached"),r.FrameNavigated=Symbol("FrameManager.FrameNavigated"),r.FrameDetached=Symbol("FrameManager.FrameDetached"),r.FrameSwapped=Symbol("FrameManager.FrameSwapped"),r.LifecycleEvent=Symbol("FrameManager.LifecycleEvent"),r.FrameNavigatedWithinDocument=Symbol("FrameManager.FrameNavigatedWithinDocument"),r.ConsoleApiCalled=Symbol("FrameManager.ConsoleApiCalled"),r.BindingCalled=Symbol("FrameManager.BindingCalled")})(Ar||(Ar={}));/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Gk extends WC{constructor(e,n){super(n);y(this,an);y(this,ui);y(this,Ra,new Ue);y(this,ho);_(this,ho,e)}get environment(){return o(this,ho)}get client(){return o(this,ho).client}get emitter(){return o(this,Ra)}setContext(e){var n;(n=o(this,ui))==null||n[He](),e.once("disposed",F(this,an,$P).bind(this)),e.on("consoleapicalled",F(this,an,jP).bind(this)),e.on("bindingcalled",F(this,an,HP).bind(this)),_(this,ui,e),o(this,Ra).emit("context",e),this.taskManager.rerunAll()}hasContext(){return!!o(this,ui)}get context(){return o(this,ui)}async evaluateHandle(e,...n){e=Cr(this.evaluateHandle.name,e);let a=F(this,an,Ax).call(this);return a||(a=await F(this,an,Fx).call(this)),await a.evaluateHandle(e,...n)}async evaluate(e,...n){e=Cr(this.evaluate.name,e);let a=F(this,an,Ax).call(this);return a||(a=await F(this,an,Fx).call(this)),await a.evaluate(e,...n)}async adoptBackendNode(e){let n=F(this,an,Ax).call(this);n||(n=await F(this,an,Fx).call(this));const{object:a}=await this.client.send("DOM.resolveNode",{backendNodeId:e,executionContextId:n.id});return this.createCdpHandle(a)}async adoptHandle(e){if(e.realm===this)return await e.evaluateHandle(a=>a);const n=await this.client.send("DOM.describeNode",{objectId:e.id});return await this.adoptBackendNode(n.node.backendNodeId)}async transferHandle(e){if(e.realm===this||e.remoteObject().objectId===void 0)return e;const n=await this.client.send("DOM.describeNode",{objectId:e.remoteObject().objectId}),a=await this.adoptBackendNode(n.node.backendNodeId);return await e.dispose(),a}createCdpHandle(e){return e.subtype==="node"?new eT(this,e):new Kw(this,e)}[He](){var e;(e=o(this,ui))==null||e[He](),o(this,Ra).emit("disposed",void 0),super[He](),o(this,Ra).removeAllListeners()}}ui=new WeakMap,Ra=new WeakMap,ho=new WeakMap,an=new WeakSet,$P=function(){_(this,ui,void 0),"clearDocumentHandle"in o(this,ho)&&o(this,ho).clearDocumentHandle()},jP=function(e){o(this,Ra).emit("consoleapicalled",e)},HP=function(e){o(this,Ra).emit("bindingcalled",e)},Ax=function(){if(this.disposed)throw new Error(`Execution context is not available in detached frame or worker "${this.environment.url()}" (are you trying to evaluate?)`);return o(this,ui)},Fx=async function(){const e=new Error("Execution context was destroyed");return await Er(_t(o(this,Ra),"context").pipe(jr(_t(o(this,Ra),"disposed").pipe(tr(()=>{throw e})),En(this.timeoutSettings.timeout()))))};/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Ja=Symbol("mainWorld"),qw=Symbol("puppeteerWorld");/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Y5=new Map([["load","load"],["domcontentloaded","DOMContentLoaded"],["networkidle0","networkIdle"],["networkidle2","networkAlmostIdle"]]);class Xk{constructor(t,e,n,a,i){y(this,Lt);y(this,km);y(this,fo);y(this,wd);y(this,po,null);y(this,Tl,new rr);y(this,bm);y(this,mo);y(this,_m,Et.create());y(this,Em,Et.create());y(this,Sm,Et.create());y(this,Cm);y(this,Tm);y(this,ts);Array.isArray(n)?n=n.slice():typeof n=="string"&&(n=[n]),_(this,bm,e._loaderId),_(this,km,n.map(u=>{const h=Y5.get(u);return Ee(h,"Unknown value for options.waitUntil: "+u),h})),i==null||i.addEventListener("abort",()=>{o(this,mo).reject(i.reason)}),_(this,fo,e),_(this,wd,a),o(this,Tl).use(new Ue(e._frameManager)).on(Ar.LifecycleEvent,F(this,Lt,Ou).bind(this));const c=o(this,Tl).use(new Ue(e));c.on(Hr.FrameNavigatedWithinDocument,F(this,Lt,qP).bind(this)),c.on(Hr.FrameNavigated,F(this,Lt,GP).bind(this)),c.on(Hr.FrameSwapped,F(this,Lt,Px).bind(this)),c.on(Hr.FrameSwappedByActivation,F(this,Lt,Px).bind(this)),c.on(Hr.FrameDetached,F(this,Lt,VP).bind(this));const l=o(this,Tl).use(new Ue(t));l.on(Tr.Request,F(this,Lt,WP).bind(this)),l.on(Tr.Response,F(this,Lt,KP).bind(this)),l.on(Tr.RequestFailed,F(this,Lt,zP).bind(this)),_(this,mo,Et.create({timeout:o(this,wd),message:`Navigation timeout of ${o(this,wd)} ms exceeded`})),F(this,Lt,Ou).call(this)}async navigationResponse(){var t;return await((t=o(this,ts))==null?void 0:t.valueOrThrow()),o(this,po)?o(this,po).response():null}sameDocumentNavigationPromise(){return o(this,_m).valueOrThrow()}newDocumentNavigationPromise(){return o(this,Sm).valueOrThrow()}lifecyclePromise(){return o(this,Em).valueOrThrow()}terminationPromise(){return o(this,mo).valueOrThrow()}dispose(){o(this,Tl).dispose(),o(this,mo).resolve(new Error("LifecycleWatcher disposed"))}}km=new WeakMap,fo=new WeakMap,wd=new WeakMap,po=new WeakMap,Tl=new WeakMap,bm=new WeakMap,mo=new WeakMap,_m=new WeakMap,Em=new WeakMap,Sm=new WeakMap,Cm=new WeakMap,Tm=new WeakMap,ts=new WeakMap,Lt=new WeakSet,WP=function(t){var e,n;t.frame()!==o(this,fo)||!t.isNavigationRequest()||(_(this,po,t),(e=o(this,ts))==null||e.resolve(),_(this,ts,Et.create()),t.response()!==null&&((n=o(this,ts))==null||n.resolve()))},zP=function(t){var e,n;((e=o(this,po))==null?void 0:e.id)===t.id&&((n=o(this,ts))==null||n.resolve())},KP=function(t){var e,n;((e=o(this,po))==null?void 0:e.id)===t.request().id&&((n=o(this,ts))==null||n.resolve())},VP=function(t){if(o(this,fo)===t){o(this,mo).resolve(new Error("Navigating frame was detached"));return}F(this,Lt,Ou).call(this)},qP=function(){_(this,Cm,!0),F(this,Lt,Ou).call(this)},GP=function(t){if(t==="BackForwardCacheRestore")return F(this,Lt,Px).call(this);F(this,Lt,Ou).call(this)},Px=function(){_(this,Tm,!0),F(this,Lt,Ou).call(this)},Ou=function(){if(!t(o(this,fo),o(this,km)))return;o(this,Em).resolve(),o(this,Cm)&&o(this,_m).resolve(void 0),(o(this,Tm)||o(this,fo)._loaderId!==o(this,bm))&&o(this,Sm).resolve(void 0);function t(e,n){for(const a of n)if(!e._lifecycleEvents.has(a))return!1;for(const a of e.childFrames())if(a._hasStartedLoading&&!t(a,n))return!1;return!0}};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var J5=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Ec=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let nT=(()=>{var u,h,d,f,XP,YP,JP,g;let r=IC,t=[],e,n,a,i,s,c,l;return g=class extends r{constructor(x,S,I,O){super();y(this,f);y(this,u,(J5(this,t),""));y(this,h,!1);y(this,d);H(this,"_frameManager");H(this,"_loaderId","");H(this,"_lifecycleEvents",new Set);H(this,"_id");H(this,"_parentId");H(this,"accessibility");H(this,"worlds");this._frameManager=x,_(this,u,""),this._id=S,this._parentId=I,_(this,h,!1),_(this,d,O),this._loaderId="",this.worlds={[Ja]:new Gk(this,this._frameManager.timeoutSettings),[qw]:new Gk(this,this._frameManager.timeoutSettings)},this.accessibility=new KC(this.worlds[Ja]),this.on(Hr.FrameSwappedByActivation,()=>{this._onLoadingStarted(),this._onLoadingStopped()}),this.worlds[Ja].emitter.on("consoleapicalled",F(this,f,XP).bind(this)),this.worlds[Ja].emitter.on("bindingcalled",F(this,f,YP).bind(this))}_client(){return o(this,d)}updateId(x){this._id=x}updateClient(x){_(this,d,x)}page(){return this._frameManager.page()}async goto(x,S={}){const{referer:I=this._frameManager.networkManager.extraHTTPHeaders().referer,referrerPolicy:O=this._frameManager.networkManager.extraHTTPHeaders()["referer-policy"],waitUntil:E=["load"],timeout:T=this._frameManager.timeoutSettings.navigationTimeout()}=S;let P=!1;const W=new Xk(this._frameManager.networkManager,this,E,T);let U=await Et.race([A(o(this,d),x,I,O,this._id),W.terminationPromise()]);U||(U=await Et.race([W.terminationPromise(),P?W.newDocumentNavigationPromise():W.sameDocumentNavigationPromise()]));try{if(U)throw U;return await W.navigationResponse()}finally{W.dispose()}async function A(N,C,K,ne,X){try{const oe=await N.send("Page.navigate",{url:C,referrer:K,frameId:X,referrerPolicy:ne});return P=!!oe.loaderId,oe.errorText==="net::ERR_HTTP_RESPONSE_CODE_FAILURE"?null:oe.errorText?new Error(`${oe.errorText} at ${C}`):null}catch(oe){if(Yn(oe))return oe;throw oe}}}async waitForNavigation(x={}){const{waitUntil:S=["load"],timeout:I=this._frameManager.timeoutSettings.navigationTimeout(),signal:O}=x,E=new Xk(this._frameManager.networkManager,this,S,I,O),T=await Et.race([E.terminationPromise(),...x.ignoreSameDocumentNavigation?[]:[E.sameDocumentNavigationPromise()],E.newDocumentNavigationPromise()]);try{if(T)throw T;const P=await Et.race([E.terminationPromise(),E.navigationResponse()]);if(P instanceof Error)throw T;return P||null}finally{E.dispose()}}get client(){return o(this,d)}mainRealm(){return this.worlds[Ja]}isolatedRealm(){return this.worlds[qw]}async setContent(x,S={}){const{waitUntil:I=["load"],timeout:O=this._frameManager.timeoutSettings.navigationTimeout()}=S;await this.setFrameContent(x);const E=new Xk(this._frameManager.networkManager,this,I,O),T=await Et.race([E.terminationPromise(),E.lifecyclePromise()]);if(E.dispose(),T)throw T}url(){return o(this,u)}parentFrame(){return this._frameManager._frameTree.parentFrame(this._id)||null}childFrames(){return this._frameManager._frameTree.childFrames(this._id)}async addPreloadScript(x){const S=this.parentFrame();if(S&&o(this,d)===S.client||x.getIdForFrame(this))return;const{identifier:I}=await o(this,d).send("Page.addScriptToEvaluateOnNewDocument",{source:x.source});x.setIdForFrame(this,I)}async addExposedFunctionBinding(x){this!==this._frameManager.mainFrame()&&!this._hasStartedLoading||await Promise.all([o(this,d).send("Runtime.addBinding",{name:Qu+x.name}),this.evaluate(x.initSource).catch(Re)])}async removeExposedFunctionBinding(x){this!==this._frameManager.mainFrame()&&!this._hasStartedLoading||await Promise.all([o(this,d).send("Runtime.removeBinding",{name:Qu+x.name}),this.evaluate(S=>{globalThis[S]=void 0},x.name).catch(Re)])}async waitForDevicePrompt(x={}){return await F(this,f,JP).call(this).waitForDevicePrompt(x)}_navigated(x){this._name=x.name,_(this,u,`${x.url}${x.urlFragment||""}`)}_navigatedWithinDocument(x){_(this,u,x)}_onLifecycleEvent(x,S){S==="init"&&(this._loaderId=x,this._lifecycleEvents.clear()),this._lifecycleEvents.add(S)}_onLoadingStopped(){this._lifecycleEvents.add("DOMContentLoaded"),this._lifecycleEvents.add("load")}_onLoadingStarted(){this._hasStartedLoading=!0}get detached(){return o(this,h)}[(e=[ut],n=[ut],a=[ut],i=[ut],s=[ut],c=[ut],l=[ut],He)](){o(this,h)||(_(this,h,!0),this.worlds[Ja][He](),this.worlds[qw][He]())}exposeFunction(){throw new et}async frameElement(){if(this.page().target()._targetManager()instanceof qk)return await super.frameElement();const S=this.parentFrame();if(!S)return null;const{backendNodeId:I}=await S.client.send("DOM.getFrameOwner",{frameId:this._id});return await S.mainRealm().adoptBackendNode(I)}},u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakSet,XP=function(x){this._frameManager.emit(Ar.ConsoleApiCalled,[this.worlds[Ja],x])},YP=function(x){this._frameManager.emit(Ar.BindingCalled,[this.worlds[Ja],x])},JP=function(){return this._frameManager._deviceRequestPromptManager(o(this,d))},(()=>{const x=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;Ec(g,null,e,{kind:"method",name:"goto",static:!1,private:!1,access:{has:S=>"goto"in S,get:S=>S.goto},metadata:x},null,t),Ec(g,null,n,{kind:"method",name:"waitForNavigation",static:!1,private:!1,access:{has:S=>"waitForNavigation"in S,get:S=>S.waitForNavigation},metadata:x},null,t),Ec(g,null,a,{kind:"method",name:"setContent",static:!1,private:!1,access:{has:S=>"setContent"in S,get:S=>S.setContent},metadata:x},null,t),Ec(g,null,i,{kind:"method",name:"addPreloadScript",static:!1,private:!1,access:{has:S=>"addPreloadScript"in S,get:S=>S.addPreloadScript},metadata:x},null,t),Ec(g,null,s,{kind:"method",name:"addExposedFunctionBinding",static:!1,private:!1,access:{has:S=>"addExposedFunctionBinding"in S,get:S=>S.addExposedFunctionBinding},metadata:x},null,t),Ec(g,null,c,{kind:"method",name:"removeExposedFunctionBinding",static:!1,private:!1,access:{has:S=>"removeExposedFunctionBinding"in S,get:S=>S.removeExposedFunctionBinding},metadata:x},null,t),Ec(g,null,l,{kind:"method",name:"waitForDevicePrompt",static:!1,private:!1,access:{has:S=>"waitForDevicePrompt"in S,get:S=>S.waitForDevicePrompt},metadata:x},null,t),x&&Object.defineProperty(g,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:x})})(),g})();/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Z5{constructor(){y(this,Al,new Map);y(this,vd,new Map);y(this,go,new Map);y(this,yd);y(this,xd,!1);y(this,Am,new Map)}getMainFrame(){return o(this,yd)}getById(t){return o(this,Al).get(t)}waitForFrame(t){const e=this.getById(t);if(e)return Promise.resolve(e);const n=Et.create();return(o(this,Am).get(t)||new Set).add(n),n.valueOrThrow()}frames(){return Array.from(o(this,Al).values())}addFrame(t){var e;o(this,Al).set(t._id,t),t._parentId?(o(this,vd).set(t._id,t._parentId),o(this,go).has(t._parentId)||o(this,go).set(t._parentId,new Set),o(this,go).get(t._parentId).add(t._id)):(!o(this,yd)||o(this,xd))&&(_(this,yd,t),_(this,xd,!1)),(e=o(this,Am).get(t._id))==null||e.forEach(n=>n.resolve(t))}removeFrame(t){var e;o(this,Al).delete(t._id),o(this,vd).delete(t._id),t._parentId?(e=o(this,go).get(t._parentId))==null||e.delete(t._id):_(this,xd,!0)}childFrames(t){const e=o(this,go).get(t);return e?Array.from(e).map(n=>this.getById(n)).filter(n=>n!==void 0):[]}parentFrame(t){const e=o(this,vd).get(t);return e?this.getById(e):void 0}}Al=new WeakMap,vd=new WeakMap,go=new WeakMap,yd=new WeakMap,xd=new WeakMap,Am=new WeakMap;class Yk extends Hw{constructor(e,n,a,i,s,c){super();H(this,"id");y(this,rs);y(this,Fm);y(this,Pm);y(this,Im);y(this,Dm);y(this,Om,!1);y(this,Mm);y(this,Rm,{});y(this,Nm);y(this,Lm);_(this,rs,e),this.id=s.requestId,_(this,Fm,s.requestId===s.loaderId&&s.type==="Document"),this._interceptionId=a,_(this,Pm,s.request.url),_(this,Im,(s.type||"other").toLowerCase()),_(this,Dm,s.request.method),_(this,Mm,s.request.postData),_(this,Om,s.request.hasPostData??!1),_(this,Nm,n),this._redirectChain=c,_(this,Lm,s.initiator),this.interception.enabled=i;for(const[l,u]of Object.entries(s.request.headers))o(this,Rm)[l.toLowerCase()]=u}get client(){return o(this,rs)}url(){return o(this,Pm)}resourceType(){return o(this,Im)}method(){return o(this,Dm)}postData(){return o(this,Mm)}hasPostData(){return o(this,Om)}async fetchPostData(){try{return(await o(this,rs).send("Network.getRequestPostData",{requestId:this.id})).postData}catch(e){Re(e);return}}headers(){return o(this,Rm)}response(){return this._response}frame(){return o(this,Nm)}isNavigationRequest(){return o(this,Fm)}initiator(){return o(this,Lm)}redirectChain(){return this._redirectChain.slice()}failure(){return this._failureText?{errorText:this._failureText}:null}async _continue(e={}){const{url:n,method:a,postData:i,headers:s}=e;this.interception.handled=!0;const c=i?uC(i):void 0;if(this._interceptionId===void 0)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.continueRequest");await o(this,rs).send("Fetch.continueRequest",{requestId:this._interceptionId,url:n,method:a,postData:c,headers:s?DC(s):void 0}).catch(l=>(this.interception.handled=!1,Ww(l)))}async _respond(e){this.interception.handled=!0;let n;e.body&&(n=Hw.getResponse(e.body));const a={};if(e.headers)for(const s of Object.keys(e.headers)){const c=e.headers[s];a[s.toLowerCase()]=Array.isArray(c)?c.map(l=>String(l)):String(c)}e.contentType&&(a["content-type"]=e.contentType),n!=null&&n.contentLength&&!("content-length"in a)&&(a["content-length"]=String(n.contentLength));const i=e.status||200;if(this._interceptionId===void 0)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.fulfillRequest");await o(this,rs).send("Fetch.fulfillRequest",{requestId:this._interceptionId,responseCode:i,responsePhrase:OC[i],responseHeaders:DC(a),body:n==null?void 0:n.base64}).catch(s=>(this.interception.handled=!1,Ww(s)))}async _abort(e){if(this.interception.handled=!0,this._interceptionId===void 0)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.failRequest");await o(this,rs).send("Fetch.failRequest",{requestId:this._interceptionId,errorReason:e||"Failed"}).catch(Ww)}}rs=new WeakMap,Fm=new WeakMap,Pm=new WeakMap,Im=new WeakMap,Dm=new WeakMap,Om=new WeakMap,Mm=new WeakMap,Rm=new WeakMap,Nm=new WeakMap,Lm=new WeakMap;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class aT{constructor(t){y(this,Bm);y(this,Um);y(this,$m);y(this,jm);y(this,Hm);y(this,Wm);_(this,Bm,t.subjectName),_(this,Um,t.issuer),_(this,$m,t.validFrom),_(this,jm,t.validTo),_(this,Hm,t.protocol),_(this,Wm,t.sanList)}issuer(){return o(this,Um)}validFrom(){return o(this,$m)}validTo(){return o(this,jm)}protocol(){return o(this,Hm)}subjectName(){return o(this,Bm)}subjectAlternativeNames(){return o(this,Wm)}}Bm=new WeakMap,Um=new WeakMap,$m=new WeakMap,jm=new WeakMap,Hm=new WeakMap,Wm=new WeakMap;class iT extends MC{constructor(e,n,a,i){super();y(this,Wy);y(this,zm);y(this,wo);y(this,kd,null);y(this,bd,Et.create());y(this,Km);y(this,Vm);y(this,qm);y(this,Gm);y(this,Xm);y(this,Ym);y(this,Jm,{});y(this,Zm);y(this,Qm);_(this,zm,e),_(this,wo,n),_(this,Km,{ip:a.remoteIPAddress,port:a.remotePort}),_(this,qm,F(this,Wy,ZP).call(this,i)||a.statusText),_(this,Gm,n.url()),_(this,Xm,!!a.fromDiskCache),_(this,Ym,!!a.fromServiceWorker),_(this,Vm,i?i.statusCode:a.status);const s=i?i.headers:a.headers;for(const[c,l]of Object.entries(s))o(this,Jm)[c.toLowerCase()]=l;_(this,Zm,a.securityDetails?new aT(a.securityDetails):null),_(this,Qm,a.timing||null)}_resolveBody(e){return e?o(this,bd).reject(e):o(this,bd).resolve()}remoteAddress(){return o(this,Km)}url(){return o(this,Gm)}status(){return o(this,Vm)}statusText(){return o(this,qm)}headers(){return o(this,Jm)}securityDetails(){return o(this,Zm)}timing(){return o(this,Qm)}content(){return o(this,kd)||_(this,kd,o(this,bd).valueOrThrow().then(async()=>{try{const e=await o(this,zm).send("Network.getResponseBody",{requestId:o(this,wo).id});return Ck(e.body,e.base64Encoded)}catch(e){throw e instanceof yc&&e.originalMessage==="No resource with given identifier found"?new yc("Could not load body for this request. This might happen if the request is a preflight request."):e}})),o(this,kd)}request(){return o(this,wo)}fromCache(){return o(this,Xm)||o(this,wo)._fromMemoryCache}fromServiceWorker(){return o(this,Ym)}frame(){return o(this,wo).frame()}}zm=new WeakMap,wo=new WeakMap,kd=new WeakMap,bd=new WeakMap,Km=new WeakMap,Vm=new WeakMap,qm=new WeakMap,Gm=new WeakMap,Xm=new WeakMap,Ym=new WeakMap,Jm=new WeakMap,Zm=new WeakMap,Qm=new WeakMap,Wy=new WeakSet,ZP=function(e){if(!e||!e.headersText)return;const n=e.headersText.split("\r",1)[0];if(!n)return;const a=n.match(/[^ ]* [^ ]* (.*)/);if(!a)return;const i=a[1];if(i)return i};/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Q5{constructor(){y(this,vo,new Map);y(this,yo,new Map);y(this,xo,new Map);y(this,ko,new Map);y(this,Fl,new Map);y(this,Pl,new Map)}forget(t){o(this,vo).delete(t),o(this,yo).delete(t),o(this,Pl).delete(t),o(this,Fl).delete(t),o(this,ko).delete(t)}responseExtraInfo(t){return o(this,ko).has(t)||o(this,ko).set(t,[]),o(this,ko).get(t)}queuedRedirectInfo(t){return o(this,Fl).has(t)||o(this,Fl).set(t,[]),o(this,Fl).get(t)}queueRedirectInfo(t,e){this.queuedRedirectInfo(t).push(e)}takeQueuedRedirectInfo(t){return this.queuedRedirectInfo(t).shift()}inFlightRequestsCount(){let t=0;for(const e of o(this,xo).values())e.response()||t++;return t}storeRequestWillBeSent(t,e){o(this,vo).set(t,e)}getRequestWillBeSent(t){return o(this,vo).get(t)}forgetRequestWillBeSent(t){o(this,vo).delete(t)}getRequestPaused(t){return o(this,yo).get(t)}forgetRequestPaused(t){o(this,yo).delete(t)}storeRequestPaused(t,e){o(this,yo).set(t,e)}getRequest(t){return o(this,xo).get(t)}storeRequest(t,e){o(this,xo).set(t,e)}forgetRequest(t){o(this,xo).delete(t)}getQueuedEventGroup(t){return o(this,Pl).get(t)}queueEventGroup(t,e){o(this,Pl).set(t,e)}forgetQueuedEventGroup(t){o(this,Pl).delete(t)}printState(){function t(e,n){return n instanceof Map?{dataType:"Map",value:Array.from(n.entries())}:n instanceof Yk?{dataType:"CdpHTTPRequest",value:`${n.id}: ${n.url()}`}:n}console.log("httpRequestsMap",JSON.stringify(o(this,xo),t,2)),console.log("requestWillBeSentMap",JSON.stringify(o(this,vo),t,2)),console.log("requestWillBeSentMap",JSON.stringify(o(this,ko),t,2)),console.log("requestWillBeSentMap",JSON.stringify(o(this,yo),t,2))}}vo=new WeakMap,yo=new WeakMap,xo=new WeakMap,ko=new WeakMap,Fl=new WeakMap,Pl=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class e6 extends Ue{constructor(e){super();y(this,Oe);y(this,_d);y(this,gt,new Q5);y(this,Il);y(this,bo,null);y(this,Ed,new Set);y(this,hi,!1);y(this,ns,!1);y(this,_o);y(this,sn);y(this,Sd);y(this,eg);y(this,zy,[["Fetch.requestPaused",F(this,Oe,rI)],["Fetch.authRequired",F(this,Oe,tI)],["Network.requestWillBeSent",F(this,Oe,eI)],["Network.requestServedFromCache",F(this,Oe,aI)],["Network.responseReceived",F(this,Oe,sI)],["Network.loadingFinished",F(this,Oe,cI)],["Network.loadingFailed",F(this,Oe,lI)],["Network.responseReceivedExtraInfo",F(this,Oe,oI)],[St.Disconnected,F(this,Oe,QP)]]);y(this,Eo,new Map);_(this,_d,e)}async addClient(e){if(o(this,Eo).has(e))return;const n=new rr;o(this,Eo).set(e,n);const a=n.use(new Ue(e));for(const[i,s]of o(this,zy))a.on(i,c=>s.bind(this)(e,c));await Promise.all([e.send("Network.enable"),F(this,Oe,iS).call(this,e),F(this,Oe,Ix).call(this,e),F(this,Oe,nw).call(this,e),F(this,Oe,Dx).call(this,e),F(this,Oe,sS).call(this,e)])}async authenticate(e){_(this,bo,e);const n=o(this,hi)||!!o(this,bo);n!==o(this,ns)&&(_(this,ns,n),await F(this,Oe,hc).call(this,F(this,Oe,Dx).bind(this)))}async setExtraHTTPHeaders(e){const n={};for(const[a,i]of Object.entries(e))Ee(Ni(i),`Expected value of header "${a}" to be String, but "${typeof i}" is found.`),n[a.toLowerCase()]=i;_(this,Il,n),await F(this,Oe,hc).call(this,F(this,Oe,iS).bind(this))}extraHTTPHeaders(){return Object.assign({},o(this,Il))}inFlightRequestsCount(){return o(this,gt).inFlightRequestsCount()}async setOfflineMode(e){o(this,sn)||_(this,sn,{offline:!1,upload:-1,download:-1,latency:0}),o(this,sn).offline=e,await F(this,Oe,hc).call(this,F(this,Oe,Ix).bind(this))}async emulateNetworkConditions(e){o(this,sn)||_(this,sn,{offline:!1,upload:-1,download:-1,latency:0}),o(this,sn).upload=e?e.upload:-1,o(this,sn).download=e?e.download:-1,o(this,sn).latency=e?e.latency:0,await F(this,Oe,hc).call(this,F(this,Oe,Ix).bind(this))}async setUserAgent(e,n){_(this,Sd,e),_(this,eg,n),await F(this,Oe,hc).call(this,F(this,Oe,sS).bind(this))}async setCacheEnabled(e){_(this,_o,!e),await F(this,Oe,hc).call(this,F(this,Oe,nw).bind(this))}async setRequestInterception(e){_(this,hi,e);const n=o(this,hi)||!!o(this,bo);n!==o(this,ns)&&(_(this,ns,n),await F(this,Oe,hc).call(this,F(this,Oe,Dx).bind(this)))}}_d=new WeakMap,gt=new WeakMap,Il=new WeakMap,bo=new WeakMap,Ed=new WeakMap,hi=new WeakMap,ns=new WeakMap,_o=new WeakMap,sn=new WeakMap,Sd=new WeakMap,eg=new WeakMap,zy=new WeakMap,Eo=new WeakMap,Oe=new WeakSet,QP=async function(e){var n;(n=o(this,Eo).get(e))==null||n.dispose(),o(this,Eo).delete(e)},iS=async function(e){o(this,Il)!==void 0&&await e.send("Network.setExtraHTTPHeaders",{headers:o(this,Il)})},hc=async function(e){await Promise.all(Array.from(o(this,Eo).keys()).map(n=>e(n)))},Ix=async function(e){o(this,sn)!==void 0&&await e.send("Network.emulateNetworkConditions",{offline:o(this,sn).offline,latency:o(this,sn).latency,uploadThroughput:o(this,sn).upload,downloadThroughput:o(this,sn).download})},sS=async function(e){o(this,Sd)!==void 0&&await e.send("Network.setUserAgentOverride",{userAgent:o(this,Sd),userAgentMetadata:o(this,eg)})},Dx=async function(e){o(this,_o)===void 0&&_(this,_o,!1),o(this,ns)?await Promise.all([F(this,Oe,nw).call(this,e),e.send("Fetch.enable",{handleAuthRequests:!0,patterns:[{urlPattern:"*"}]})]):await Promise.all([F(this,Oe,nw).call(this,e),e.send("Fetch.disable")])},nw=async function(e){o(this,_o)!==void 0&&await e.send("Network.setCacheDisabled",{cacheDisabled:o(this,_o)})},eI=function(e,n){if(o(this,hi)&&!n.request.url.startsWith("data:")){const{requestId:a}=n;o(this,gt).storeRequestWillBeSent(a,n);const i=o(this,gt).getRequestPaused(a);if(i){const{requestId:s}=i;F(this,Oe,oS).call(this,n,i),F(this,Oe,n0).call(this,e,n,s),o(this,gt).forgetRequestPaused(a)}return}F(this,Oe,n0).call(this,e,n,void 0)},tI=function(e,n){let a="Default";o(this,Ed).has(n.requestId)?a="CancelAuth":o(this,bo)&&(a="ProvideCredentials",o(this,Ed).add(n.requestId));const{username:i,password:s}=o(this,bo)||{username:void 0,password:void 0};e.send("Fetch.continueWithAuth",{requestId:n.requestId,authChallengeResponse:{response:a,username:i,password:s}}).catch(Re)},rI=function(e,n){!o(this,hi)&&o(this,ns)&&e.send("Fetch.continueRequest",{requestId:n.requestId}).catch(Re);const{networkId:a,requestId:i}=n;if(!a){F(this,Oe,nI).call(this,e,n);return}const s=(()=>{const c=o(this,gt).getRequestWillBeSent(a);if(c&&(c.request.url!==n.request.url||c.request.method!==n.request.method)){o(this,gt).forgetRequestWillBeSent(a);return}return c})();s?(F(this,Oe,oS).call(this,s,n),F(this,Oe,n0).call(this,e,s,i)):o(this,gt).storeRequestPaused(a,n)},oS=function(e,n){e.request.headers={...e.request.headers,...n.request.headers}},nI=function(e,n){const a=n.frameId?o(this,_d).frame(n.frameId):null,i=new Yk(e,a,n.requestId,o(this,hi),n,[]);this.emit(Tr.Request,i),i.finalizeInterceptions()},n0=function(e,n,a,i=!1){let s=[];if(n.redirectResponse){let u=null;if(n.redirectHasExtraInfo&&(u=o(this,gt).responseExtraInfo(n.requestId).shift(),!u)){o(this,gt).queueRedirectInfo(n.requestId,{event:n,fetchRequestId:a});return}const h=o(this,gt).getRequest(n.requestId);h&&(F(this,Oe,iI).call(this,e,h,n.redirectResponse,u),s=h._redirectChain)}const c=n.frameId?o(this,_d).frame(n.frameId):null,l=new Yk(e,c,a,o(this,hi),n,s);l._fromMemoryCache=i,o(this,gt).storeRequest(n.requestId,l),this.emit(Tr.Request,l),l.finalizeInterceptions()},aI=function(e,n){const a=o(this,gt).getRequestWillBeSent(n.requestId);let i=o(this,gt).getRequest(n.requestId);if(i&&(i._fromMemoryCache=!0),!i&&a&&(F(this,Oe,n0).call(this,e,a,void 0,!0),i=o(this,gt).getRequest(n.requestId)),!i){Re(new Error(`Request ${n.requestId} was served from cache but we could not find the corresponding request object`));return}this.emit(Tr.RequestServedFromCache,i)},iI=function(e,n,a,i){const s=new iT(e,n,a,i);n._response=s,n._redirectChain.push(n),s._resolveBody(new Error("Response body is unavailable for redirect responses")),F(this,Oe,Ox).call(this,n,!1),this.emit(Tr.Response,s),this.emit(Tr.RequestFinished,n)},cS=function(e,n,a){const i=o(this,gt).getRequest(n.requestId);if(!i)return;o(this,gt).responseExtraInfo(n.requestId).length&&Re(new Error("Unexpected extraInfo events for request "+n.requestId)),n.response.fromDiskCache&&(a=null);const c=new iT(e,i,n.response,a);i._response=c,this.emit(Tr.Response,c)},sI=function(e,n){const a=o(this,gt).getRequest(n.requestId);let i=null;if(a&&!a._fromMemoryCache&&n.hasExtraInfo&&(i=o(this,gt).responseExtraInfo(n.requestId).shift(),!i)){o(this,gt).queueEventGroup(n.requestId,{responseReceivedEvent:n});return}F(this,Oe,cS).call(this,e,n,i)},oI=function(e,n){const a=o(this,gt).takeQueuedRedirectInfo(n.requestId);if(a){o(this,gt).responseExtraInfo(n.requestId).push(n),F(this,Oe,n0).call(this,e,a.event,a.fetchRequestId);return}const i=o(this,gt).getQueuedEventGroup(n.requestId);if(i){o(this,gt).forgetQueuedEventGroup(n.requestId),F(this,Oe,cS).call(this,e,i.responseReceivedEvent,n),i.loadingFinishedEvent&&F(this,Oe,lS).call(this,i.loadingFinishedEvent),i.loadingFailedEvent&&F(this,Oe,uS).call(this,i.loadingFailedEvent);return}o(this,gt).responseExtraInfo(n.requestId).push(n)},Ox=function(e,n){const a=e.id,i=e._interceptionId;o(this,gt).forgetRequest(a),i!==void 0&&o(this,Ed).delete(i),n&&o(this,gt).forget(a)},cI=function(e,n){const a=o(this,gt).getQueuedEventGroup(n.requestId);a?a.loadingFinishedEvent=n:F(this,Oe,lS).call(this,n)},lS=function(e){var a;const n=o(this,gt).getRequest(e.requestId);n&&(n.response()&&((a=n.response())==null||a._resolveBody()),F(this,Oe,Ox).call(this,n,!0),this.emit(Tr.RequestFinished,n))},lI=function(e,n){const a=o(this,gt).getQueuedEventGroup(n.requestId);a?a.loadingFailedEvent=n:F(this,Oe,uS).call(this,n)},uS=function(e){const n=o(this,gt).getRequest(e.requestId);if(!n)return;n._failureText=e.errorText;const a=n.response();a&&a._resolveBody(),F(this,Oe,Ox).call(this,n,!0),this.emit(Tr.RequestFailed,n)};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const t6=100;class r6 extends Ue{constructor(e,n,a){super();y(this,ht);y(this,tg);y(this,So);y(this,Cd);y(this,rg,new Set);y(this,oa);y(this,Dl,new Map);y(this,Td,new Set);H(this,"_frameTree",new Z5);y(this,Ol,new Set);y(this,ng,new WeakMap);y(this,wn);_(this,oa,e),_(this,tg,n),_(this,So,new e6(this)),_(this,Cd,a),this.setupEventListeners(o(this,oa)),e.once(St.Disconnected,()=>{F(this,ht,hS).call(this).catch(Re)})}get timeoutSettings(){return o(this,Cd)}get networkManager(){return o(this,So)}get client(){return o(this,oa)}async swapFrameTree(e){_(this,oa,e),Ee(o(this,oa)instanceof Zu,"CDPSession is not an instance of CDPSessionImpl.");const n=this._frameTree.getMainFrame();n&&(o(this,Ol).add(o(this,oa)._target()._targetId),this._frameTree.removeFrame(n),n.updateId(o(this,oa)._target()._targetId),this._frameTree.addFrame(n),n.updateClient(e)),this.setupEventListeners(e),e.once(St.Disconnected,()=>{F(this,ht,hS).call(this).catch(Re)}),await this.initialize(e,n),await o(this,So).addClient(e),n&&n.emit(Hr.FrameSwappedByActivation,void 0)}async registerSpeculativeSession(e){await o(this,So).addClient(e)}setupEventListeners(e){e.on("Page.frameAttached",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,fS).call(this,e,n.frameId,n.parentFrameId)}),e.on("Page.frameNavigated",async n=>{var a;o(this,Ol).add(n.frame.id),await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,pS).call(this,n.frame,n.type)}),e.on("Page.navigatedWithinDocument",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,pI).call(this,n.frameId,n.url)}),e.on("Page.frameDetached",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,mI).call(this,n.frameId,n.reason)}),e.on("Page.frameStartedLoading",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,hI).call(this,n.frameId)}),e.on("Page.frameStoppedLoading",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,dI).call(this,n.frameId)}),e.on("Runtime.executionContextCreated",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,gI).call(this,n.context,e)}),e.on("Page.lifecycleEvent",async n=>{var a;await((a=o(this,wn))==null?void 0:a.valueOrThrow()),F(this,ht,uI).call(this,n)})}async initialize(e,n){var a,i;try{(a=o(this,wn))==null||a.resolve(),_(this,wn,Et.create()),await Promise.all([o(this,So).addClient(e),e.send("Page.enable"),e.send("Page.getFrameTree").then(({frameTree:s})=>{var c;F(this,ht,dS).call(this,e,s),(c=o(this,wn))==null||c.resolve()}),e.send("Page.setLifecycleEventsEnabled",{enabled:!0}),e.send("Runtime.enable").then(()=>F(this,ht,fI).call(this,e,gC)),...(n?Array.from(o(this,Dl).values()):[]).map(s=>n==null?void 0:n.addPreloadScript(s)),...(n?Array.from(o(this,Td).values()):[]).map(s=>n==null?void 0:n.addExposedFunctionBinding(s))])}catch(s){if((i=o(this,wn))==null||i.resolve(),Yn(s)&&Vk(s))return;throw s}}page(){return o(this,tg)}mainFrame(){const e=this._frameTree.getMainFrame();return Ee(e,"Requesting main frame too early!"),e}frames(){return Array.from(this._frameTree.frames())}frame(e){return this._frameTree.getById(e)||null}async addExposedFunctionBinding(e){o(this,Td).add(e),await Promise.all(this.frames().map(async n=>await n.addExposedFunctionBinding(e)))}async removeExposedFunctionBinding(e){o(this,Td).delete(e),await Promise.all(this.frames().map(async n=>await n.removeExposedFunctionBinding(e)))}async evaluateOnNewDocument(e){const{identifier:n}=await this.mainFrame()._client().send("Page.addScriptToEvaluateOnNewDocument",{source:e}),a=new B5(this.mainFrame(),n,e);return o(this,Dl).set(n,a),await Promise.all(this.frames().map(async i=>await i.addPreloadScript(a))),{identifier:n}}async removeScriptToEvaluateOnNewDocument(e){const n=o(this,Dl).get(e);if(!n)throw new Error(`Script to evaluate on new document with id ${e} not found`);o(this,Dl).delete(e),await Promise.all(this.frames().map(a=>{const i=n.getIdForFrame(a);if(i)return a._client().send("Page.removeScriptToEvaluateOnNewDocument",{identifier:i}).catch(Re)}))}onAttachedToTarget(e){if(e._getTargetInfo().type!=="iframe")return;const n=this.frame(e._getTargetInfo().targetId);n&&n.updateClient(e._session()),this.setupEventListeners(e._session()),this.initialize(e._session(),n)}_deviceRequestPromptManager(e){let n=o(this,ng).get(e);return n===void 0&&(n=new j5(e,o(this,Cd)),o(this,ng).set(e,n)),n}}tg=new WeakMap,So=new WeakMap,Cd=new WeakMap,rg=new WeakMap,oa=new WeakMap,Dl=new WeakMap,Td=new WeakMap,Ol=new WeakMap,ng=new WeakMap,wn=new WeakMap,ht=new WeakSet,hS=async function(){const e=this._frameTree.getMainFrame();if(!e)return;for(const a of e.childFrames())F(this,ht,a0).call(this,a);const n=Et.create({timeout:t6,message:"Frame was not swapped"});e.once(Hr.FrameSwappedByActivation,()=>{n.resolve()});try{await n.valueOrThrow()}catch{F(this,ht,a0).call(this,e)}},uI=function(e){const n=this.frame(e.frameId);n&&(n._onLifecycleEvent(e.loaderId,e.name),this.emit(Ar.LifecycleEvent,n),n.emit(Hr.LifecycleEvent,void 0))},hI=function(e){const n=this.frame(e);n&&n._onLoadingStarted()},dI=function(e){const n=this.frame(e);n&&(n._onLoadingStopped(),this.emit(Ar.LifecycleEvent,n),n.emit(Hr.LifecycleEvent,void 0))},dS=function(e,n){if(n.frame.parentId&&F(this,ht,fS).call(this,e,n.frame.id,n.frame.parentId),o(this,Ol).has(n.frame.id)?o(this,Ol).delete(n.frame.id):F(this,ht,pS).call(this,n.frame,"Navigation"),!!n.childFrames)for(const a of n.childFrames)F(this,ht,dS).call(this,e,a)},fS=function(e,n,a){let i=this.frame(n);if(i){const s=this.frame(a);e&&s&&i.client!==(s==null?void 0:s.client)&&i.updateClient(e);return}i=new nT(this,n,a,e),this._frameTree.addFrame(i),this.emit(Ar.FrameAttached,i)},pS=async function(e,n){const a=e.id,i=!e.parentId;let s=this._frameTree.getById(a);if(s)for(const c of s.childFrames())F(this,ht,a0).call(this,c);i&&(s?(this._frameTree.removeFrame(s),s._id=a):s=new nT(this,a,void 0,o(this,oa)),this._frameTree.addFrame(s)),s=await this._frameTree.waitForFrame(a),s._navigated(e),this.emit(Ar.FrameNavigated,s),s.emit(Hr.FrameNavigated,n)},fI=async function(e,n){const a=`${e.id()}:${n}`;o(this,rg).has(a)||(await e.send("Page.addScriptToEvaluateOnNewDocument",{source:`//# sourceURL=${In.INTERNAL_URL}`,worldName:n}),await Promise.all(this.frames().filter(i=>i.client===e).map(i=>e.send("Page.createIsolatedWorld",{frameId:i._id,worldName:n,grantUniveralAccess:!0}).catch(Re))),o(this,rg).add(a))},pI=function(e,n){const a=this.frame(e);a&&(a._navigatedWithinDocument(n),this.emit(Ar.FrameNavigatedWithinDocument,a),a.emit(Hr.FrameNavigatedWithinDocument,void 0),this.emit(Ar.FrameNavigated,a),a.emit(Hr.FrameNavigated,"Navigation"))},mI=function(e,n){const a=this.frame(e);if(a)switch(n){case"remove":F(this,ht,a0).call(this,a);break;case"swap":this.emit(Ar.FrameSwapped,a),a.emit(Hr.FrameSwapped,void 0);break}},gI=function(e,n){const a=e.auxData,i=a&&a.frameId,s=typeof i=="string"?this.frame(i):void 0;let c;if(s){if(s.client!==n)return;e.auxData&&e.auxData.isDefault?c=s.worlds[Ja]:e.name===gC&&(c=s.worlds[qw])}if(!c)return;const l=new tT((s==null?void 0:s.client)||o(this,oa),e,c);c.setContext(l)},a0=function(e){for(const n of e.childFrames())F(this,ht,a0).call(this,n);e[He](),this._frameTree.removeFrame(e),this.emit(Ar.FrameDetached,e),e.emit(Hr.FrameDetached,e)};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const sT={0:{keyCode:48,key:"0",code:"Digit0"},1:{keyCode:49,key:"1",code:"Digit1"},2:{keyCode:50,key:"2",code:"Digit2"},3:{keyCode:51,key:"3",code:"Digit3"},4:{keyCode:52,key:"4",code:"Digit4"},5:{keyCode:53,key:"5",code:"Digit5"},6:{keyCode:54,key:"6",code:"Digit6"},7:{keyCode:55,key:"7",code:"Digit7"},8:{keyCode:56,key:"8",code:"Digit8"},9:{keyCode:57,key:"9",code:"Digit9"},Power:{key:"Power",code:"Power"},Eject:{key:"Eject",code:"Eject"},Abort:{keyCode:3,code:"Abort",key:"Cancel"},Help:{keyCode:6,code:"Help",key:"Help"},Backspace:{keyCode:8,code:"Backspace",key:"Backspace"},Tab:{keyCode:9,code:"Tab",key:"Tab"},Numpad5:{keyCode:12,shiftKeyCode:101,key:"Clear",code:"Numpad5",shiftKey:"5",location:3},NumpadEnter:{keyCode:13,code:"NumpadEnter",key:"Enter",text:"\r",location:3},Enter:{keyCode:13,code:"Enter",key:"Enter",text:"\r"},"\r":{keyCode:13,code:"Enter",key:"Enter",text:"\r"},"\n":{keyCode:13,code:"Enter",key:"Enter",text:"\r"},ShiftLeft:{keyCode:16,code:"ShiftLeft",key:"Shift",location:1},ShiftRight:{keyCode:16,code:"ShiftRight",key:"Shift",location:2},ControlLeft:{keyCode:17,code:"ControlLeft",key:"Control",location:1},ControlRight:{keyCode:17,code:"ControlRight",key:"Control",location:2},AltLeft:{keyCode:18,code:"AltLeft",key:"Alt",location:1},AltRight:{keyCode:18,code:"AltRight",key:"Alt",location:2},Pause:{keyCode:19,code:"Pause",key:"Pause"},CapsLock:{keyCode:20,code:"CapsLock",key:"CapsLock"},Escape:{keyCode:27,code:"Escape",key:"Escape"},Convert:{keyCode:28,code:"Convert",key:"Convert"},NonConvert:{keyCode:29,code:"NonConvert",key:"NonConvert"},Space:{keyCode:32,code:"Space",key:" "},Numpad9:{keyCode:33,shiftKeyCode:105,key:"PageUp",code:"Numpad9",shiftKey:"9",location:3},PageUp:{keyCode:33,code:"PageUp",key:"PageUp"},Numpad3:{keyCode:34,shiftKeyCode:99,key:"PageDown",code:"Numpad3",shiftKey:"3",location:3},PageDown:{keyCode:34,code:"PageDown",key:"PageDown"},End:{keyCode:35,code:"End",key:"End"},Numpad1:{keyCode:35,shiftKeyCode:97,key:"End",code:"Numpad1",shiftKey:"1",location:3},Home:{keyCode:36,code:"Home",key:"Home"},Numpad7:{keyCode:36,shiftKeyCode:103,key:"Home",code:"Numpad7",shiftKey:"7",location:3},ArrowLeft:{keyCode:37,code:"ArrowLeft",key:"ArrowLeft"},Numpad4:{keyCode:37,shiftKeyCode:100,key:"ArrowLeft",code:"Numpad4",shiftKey:"4",location:3},Numpad8:{keyCode:38,shiftKeyCode:104,key:"ArrowUp",code:"Numpad8",shiftKey:"8",location:3},ArrowUp:{keyCode:38,code:"ArrowUp",key:"ArrowUp"},ArrowRight:{keyCode:39,code:"ArrowRight",key:"ArrowRight"},Numpad6:{keyCode:39,shiftKeyCode:102,key:"ArrowRight",code:"Numpad6",shiftKey:"6",location:3},Numpad2:{keyCode:40,shiftKeyCode:98,key:"ArrowDown",code:"Numpad2",shiftKey:"2",location:3},ArrowDown:{keyCode:40,code:"ArrowDown",key:"ArrowDown"},Select:{keyCode:41,code:"Select",key:"Select"},Open:{keyCode:43,code:"Open",key:"Execute"},PrintScreen:{keyCode:44,code:"PrintScreen",key:"PrintScreen"},Insert:{keyCode:45,code:"Insert",key:"Insert"},Numpad0:{keyCode:45,shiftKeyCode:96,key:"Insert",code:"Numpad0",shiftKey:"0",location:3},Delete:{keyCode:46,code:"Delete",key:"Delete"},NumpadDecimal:{keyCode:46,shiftKeyCode:110,code:"NumpadDecimal",key:"\0",shiftKey:".",location:3},Digit0:{keyCode:48,code:"Digit0",shiftKey:")",key:"0"},Digit1:{keyCode:49,code:"Digit1",shiftKey:"!",key:"1"},Digit2:{keyCode:50,code:"Digit2",shiftKey:"@",key:"2"},Digit3:{keyCode:51,code:"Digit3",shiftKey:"#",key:"3"},Digit4:{keyCode:52,code:"Digit4",shiftKey:"$",key:"4"},Digit5:{keyCode:53,code:"Digit5",shiftKey:"%",key:"5"},Digit6:{keyCode:54,code:"Digit6",shiftKey:"^",key:"6"},Digit7:{keyCode:55,code:"Digit7",shiftKey:"&",key:"7"},Digit8:{keyCode:56,code:"Digit8",shiftKey:"*",key:"8"},Digit9:{keyCode:57,code:"Digit9",shiftKey:"(",key:"9"},KeyA:{keyCode:65,code:"KeyA",shiftKey:"A",key:"a"},KeyB:{keyCode:66,code:"KeyB",shiftKey:"B",key:"b"},KeyC:{keyCode:67,code:"KeyC",shiftKey:"C",key:"c"},KeyD:{keyCode:68,code:"KeyD",shiftKey:"D",key:"d"},KeyE:{keyCode:69,code:"KeyE",shiftKey:"E",key:"e"},KeyF:{keyCode:70,code:"KeyF",shiftKey:"F",key:"f"},KeyG:{keyCode:71,code:"KeyG",shiftKey:"G",key:"g"},KeyH:{keyCode:72,code:"KeyH",shiftKey:"H",key:"h"},KeyI:{keyCode:73,code:"KeyI",shiftKey:"I",key:"i"},KeyJ:{keyCode:74,code:"KeyJ",shiftKey:"J",key:"j"},KeyK:{keyCode:75,code:"KeyK",shiftKey:"K",key:"k"},KeyL:{keyCode:76,code:"KeyL",shiftKey:"L",key:"l"},KeyM:{keyCode:77,code:"KeyM",shiftKey:"M",key:"m"},KeyN:{keyCode:78,code:"KeyN",shiftKey:"N",key:"n"},KeyO:{keyCode:79,code:"KeyO",shiftKey:"O",key:"o"},KeyP:{keyCode:80,code:"KeyP",shiftKey:"P",key:"p"},KeyQ:{keyCode:81,code:"KeyQ",shiftKey:"Q",key:"q"},KeyR:{keyCode:82,code:"KeyR",shiftKey:"R",key:"r"},KeyS:{keyCode:83,code:"KeyS",shiftKey:"S",key:"s"},KeyT:{keyCode:84,code:"KeyT",shiftKey:"T",key:"t"},KeyU:{keyCode:85,code:"KeyU",shiftKey:"U",key:"u"},KeyV:{keyCode:86,code:"KeyV",shiftKey:"V",key:"v"},KeyW:{keyCode:87,code:"KeyW",shiftKey:"W",key:"w"},KeyX:{keyCode:88,code:"KeyX",shiftKey:"X",key:"x"},KeyY:{keyCode:89,code:"KeyY",shiftKey:"Y",key:"y"},KeyZ:{keyCode:90,code:"KeyZ",shiftKey:"Z",key:"z"},MetaLeft:{keyCode:91,code:"MetaLeft",key:"Meta",location:1},MetaRight:{keyCode:92,code:"MetaRight",key:"Meta",location:2},ContextMenu:{keyCode:93,code:"ContextMenu",key:"ContextMenu"},NumpadMultiply:{keyCode:106,code:"NumpadMultiply",key:"*",location:3},NumpadAdd:{keyCode:107,code:"NumpadAdd",key:"+",location:3},NumpadSubtract:{keyCode:109,code:"NumpadSubtract",key:"-",location:3},NumpadDivide:{keyCode:111,code:"NumpadDivide",key:"/",location:3},F1:{keyCode:112,code:"F1",key:"F1"},F2:{keyCode:113,code:"F2",key:"F2"},F3:{keyCode:114,code:"F3",key:"F3"},F4:{keyCode:115,code:"F4",key:"F4"},F5:{keyCode:116,code:"F5",key:"F5"},F6:{keyCode:117,code:"F6",key:"F6"},F7:{keyCode:118,code:"F7",key:"F7"},F8:{keyCode:119,code:"F8",key:"F8"},F9:{keyCode:120,code:"F9",key:"F9"},F10:{keyCode:121,code:"F10",key:"F10"},F11:{keyCode:122,code:"F11",key:"F11"},F12:{keyCode:123,code:"F12",key:"F12"},F13:{keyCode:124,code:"F13",key:"F13"},F14:{keyCode:125,code:"F14",key:"F14"},F15:{keyCode:126,code:"F15",key:"F15"},F16:{keyCode:127,code:"F16",key:"F16"},F17:{keyCode:128,code:"F17",key:"F17"},F18:{keyCode:129,code:"F18",key:"F18"},F19:{keyCode:130,code:"F19",key:"F19"},F20:{keyCode:131,code:"F20",key:"F20"},F21:{keyCode:132,code:"F21",key:"F21"},F22:{keyCode:133,code:"F22",key:"F22"},F23:{keyCode:134,code:"F23",key:"F23"},F24:{keyCode:135,code:"F24",key:"F24"},NumLock:{keyCode:144,code:"NumLock",key:"NumLock"},ScrollLock:{keyCode:145,code:"ScrollLock",key:"ScrollLock"},AudioVolumeMute:{keyCode:173,code:"AudioVolumeMute",key:"AudioVolumeMute"},AudioVolumeDown:{keyCode:174,code:"AudioVolumeDown",key:"AudioVolumeDown"},AudioVolumeUp:{keyCode:175,code:"AudioVolumeUp",key:"AudioVolumeUp"},MediaTrackNext:{keyCode:176,code:"MediaTrackNext",key:"MediaTrackNext"},MediaTrackPrevious:{keyCode:177,code:"MediaTrackPrevious",key:"MediaTrackPrevious"},MediaStop:{keyCode:178,code:"MediaStop",key:"MediaStop"},MediaPlayPause:{keyCode:179,code:"MediaPlayPause",key:"MediaPlayPause"},Semicolon:{keyCode:186,code:"Semicolon",shiftKey:":",key:";"},Equal:{keyCode:187,code:"Equal",shiftKey:"+",key:"="},NumpadEqual:{keyCode:187,code:"NumpadEqual",key:"=",location:3},Comma:{keyCode:188,code:"Comma",shiftKey:"<",key:","},Minus:{keyCode:189,code:"Minus",shiftKey:"_",key:"-"},Period:{keyCode:190,code:"Period",shiftKey:">",key:"."},Slash:{keyCode:191,code:"Slash",shiftKey:"?",key:"/"},Backquote:{keyCode:192,code:"Backquote",shiftKey:"~",key:"`"},BracketLeft:{keyCode:219,code:"BracketLeft",shiftKey:"{",key:"["},Backslash:{keyCode:220,code:"Backslash",shiftKey:"|",key:"\\"},BracketRight:{keyCode:221,code:"BracketRight",shiftKey:"}",key:"]"},Quote:{keyCode:222,code:"Quote",shiftKey:'"',key:"'"},AltGraph:{keyCode:225,code:"AltGraph",key:"AltGraph"},Props:{keyCode:247,code:"Props",key:"CrSel"},Cancel:{keyCode:3,key:"Cancel",code:"Abort"},Clear:{keyCode:12,key:"Clear",code:"Numpad5",location:3},Shift:{keyCode:16,key:"Shift",code:"ShiftLeft",location:1},Control:{keyCode:17,key:"Control",code:"ControlLeft",location:1},Alt:{keyCode:18,key:"Alt",code:"AltLeft",location:1},Accept:{keyCode:30,key:"Accept"},ModeChange:{keyCode:31,key:"ModeChange"}," ":{keyCode:32,key:" ",code:"Space"},Print:{keyCode:42,key:"Print"},Execute:{keyCode:43,key:"Execute",code:"Open"},"\0":{keyCode:46,key:"\0",code:"NumpadDecimal",location:3},a:{keyCode:65,key:"a",code:"KeyA"},b:{keyCode:66,key:"b",code:"KeyB"},c:{keyCode:67,key:"c",code:"KeyC"},d:{keyCode:68,key:"d",code:"KeyD"},e:{keyCode:69,key:"e",code:"KeyE"},f:{keyCode:70,key:"f",code:"KeyF"},g:{keyCode:71,key:"g",code:"KeyG"},h:{keyCode:72,key:"h",code:"KeyH"},i:{keyCode:73,key:"i",code:"KeyI"},j:{keyCode:74,key:"j",code:"KeyJ"},k:{keyCode:75,key:"k",code:"KeyK"},l:{keyCode:76,key:"l",code:"KeyL"},m:{keyCode:77,key:"m",code:"KeyM"},n:{keyCode:78,key:"n",code:"KeyN"},o:{keyCode:79,key:"o",code:"KeyO"},p:{keyCode:80,key:"p",code:"KeyP"},q:{keyCode:81,key:"q",code:"KeyQ"},r:{keyCode:82,key:"r",code:"KeyR"},s:{keyCode:83,key:"s",code:"KeyS"},t:{keyCode:84,key:"t",code:"KeyT"},u:{keyCode:85,key:"u",code:"KeyU"},v:{keyCode:86,key:"v",code:"KeyV"},w:{keyCode:87,key:"w",code:"KeyW"},x:{keyCode:88,key:"x",code:"KeyX"},y:{keyCode:89,key:"y",code:"KeyY"},z:{keyCode:90,key:"z",code:"KeyZ"},Meta:{keyCode:91,key:"Meta",code:"MetaLeft",location:1},"*":{keyCode:106,key:"*",code:"NumpadMultiply",location:3},"+":{keyCode:107,key:"+",code:"NumpadAdd",location:3},"-":{keyCode:109,key:"-",code:"NumpadSubtract",location:3},"/":{keyCode:111,key:"/",code:"NumpadDivide",location:3},";":{keyCode:186,key:";",code:"Semicolon"},"=":{keyCode:187,key:"=",code:"Equal"},",":{keyCode:188,key:",",code:"Comma"},".":{keyCode:190,key:".",code:"Period"},"`":{keyCode:192,key:"`",code:"Backquote"},"[":{keyCode:219,key:"[",code:"BracketLeft"},"\\":{keyCode:220,key:"\\",code:"Backslash"},"]":{keyCode:221,key:"]",code:"BracketRight"},"'":{keyCode:222,key:"'",code:"Quote"},Attn:{keyCode:246,key:"Attn"},CrSel:{keyCode:247,key:"CrSel",code:"Props"},ExSel:{keyCode:248,key:"ExSel"},EraseEof:{keyCode:249,key:"EraseEof"},Play:{keyCode:250,key:"Play"},ZoomOut:{keyCode:251,key:"ZoomOut"},")":{keyCode:48,key:")",code:"Digit0"},"!":{keyCode:49,key:"!",code:"Digit1"},"@":{keyCode:50,key:"@",code:"Digit2"},"#":{keyCode:51,key:"#",code:"Digit3"},$:{keyCode:52,key:"$",code:"Digit4"},"%":{keyCode:53,key:"%",code:"Digit5"},"^":{keyCode:54,key:"^",code:"Digit6"},"&":{keyCode:55,key:"&",code:"Digit7"},"(":{keyCode:57,key:"(",code:"Digit9"},A:{keyCode:65,key:"A",code:"KeyA"},B:{keyCode:66,key:"B",code:"KeyB"},C:{keyCode:67,key:"C",code:"KeyC"},D:{keyCode:68,key:"D",code:"KeyD"},E:{keyCode:69,key:"E",code:"KeyE"},F:{keyCode:70,key:"F",code:"KeyF"},G:{keyCode:71,key:"G",code:"KeyG"},H:{keyCode:72,key:"H",code:"KeyH"},I:{keyCode:73,key:"I",code:"KeyI"},J:{keyCode:74,key:"J",code:"KeyJ"},K:{keyCode:75,key:"K",code:"KeyK"},L:{keyCode:76,key:"L",code:"KeyL"},M:{keyCode:77,key:"M",code:"KeyM"},N:{keyCode:78,key:"N",code:"KeyN"},O:{keyCode:79,key:"O",code:"KeyO"},P:{keyCode:80,key:"P",code:"KeyP"},Q:{keyCode:81,key:"Q",code:"KeyQ"},R:{keyCode:82,key:"R",code:"KeyR"},S:{keyCode:83,key:"S",code:"KeyS"},T:{keyCode:84,key:"T",code:"KeyT"},U:{keyCode:85,key:"U",code:"KeyU"},V:{keyCode:86,key:"V",code:"KeyV"},W:{keyCode:87,key:"W",code:"KeyW"},X:{keyCode:88,key:"X",code:"KeyX"},Y:{keyCode:89,key:"Y",code:"KeyY"},Z:{keyCode:90,key:"Z",code:"KeyZ"},":":{keyCode:186,key:":",code:"Semicolon"},"<":{keyCode:188,key:"<",code:"Comma"},_:{keyCode:189,key:"_",code:"Minus"},">":{keyCode:190,key:">",code:"Period"},"?":{keyCode:191,key:"?",code:"Slash"},"~":{keyCode:192,key:"~",code:"Backquote"},"{":{keyCode:219,key:"{",code:"BracketLeft"},"|":{keyCode:220,key:"|",code:"Backslash"},"}":{keyCode:221,key:"}",code:"BracketRight"},'"':{keyCode:222,key:'"',code:"Quote"},SoftLeft:{key:"SoftLeft",code:"SoftLeft",location:4},SoftRight:{key:"SoftRight",code:"SoftRight",location:4},Camera:{keyCode:44,key:"Camera",code:"Camera",location:4},Call:{key:"Call",code:"Call",location:4},EndCall:{keyCode:95,key:"EndCall",code:"EndCall",location:4},VolumeDown:{keyCode:182,key:"VolumeDown",code:"VolumeDown",location:4},VolumeUp:{keyCode:183,key:"VolumeUp",code:"VolumeUp",location:4}};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class n6 extends RC{constructor(e){super();y(this,To);y(this,Co);y(this,Ad,new Set);H(this,"_modifiers",0);_(this,Co,e)}updateClient(e){_(this,Co,e)}async down(e,n={text:void 0,commands:[]}){const a=F(this,To,gS).call(this,e),i=o(this,Ad).has(a.code);o(this,Ad).add(a.code),this._modifiers|=F(this,To,mS).call(this,a.key);const s=n.text===void 0?a.text:n.text;await o(this,Co).send("Input.dispatchKeyEvent",{type:s?"keyDown":"rawKeyDown",modifiers:this._modifiers,windowsVirtualKeyCode:a.keyCode,code:a.code,key:a.key,text:s,unmodifiedText:s,autoRepeat:i,location:a.location,isKeypad:a.location===3,commands:n.commands})}async up(e){const n=F(this,To,gS).call(this,e);this._modifiers&=~F(this,To,mS).call(this,n.key),o(this,Ad).delete(n.code),await o(this,Co).send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:this._modifiers,key:n.key,windowsVirtualKeyCode:n.keyCode,code:n.code,location:n.location})}async sendCharacter(e){await o(this,Co).send("Input.insertText",{text:e})}charIsKey(e){return!!sT[e]}async type(e,n={}){const a=n.delay||void 0;for(const i of e)this.charIsKey(i)?await this.press(i,{delay:a}):(a&&await new Promise(s=>setTimeout(s,a)),await this.sendCharacter(i))}async press(e,n={}){const{delay:a=null}=n;await this.down(e,n),a&&await new Promise(i=>setTimeout(i,n.delay)),await this.up(e)}}Co=new WeakMap,Ad=new WeakMap,To=new WeakSet,mS=function(e){return e==="Alt"?1:e==="Control"?2:e==="Meta"?4:e==="Shift"?8:0},gS=function(e){const n=this._modifiers&8,a={key:"",keyCode:0,code:"",text:"",location:0},i=sT[e];return Ee(i,`Unknown key: "${e}"`),i.key&&(a.key=i.key),n&&i.shiftKey&&(a.key=i.shiftKey),i.keyCode&&(a.keyCode=i.keyCode),n&&i.shiftKeyCode&&(a.keyCode=i.shiftKeyCode),i.code&&(a.code=i.code),i.location&&(a.location=i.location),a.key.length===1&&(a.text=a.key),i.text&&(a.text=i.text),n&&i.shiftText&&(a.text=i.shiftText),this._modifiers&-9&&(a.text=""),a};const oT=r=>{switch(r){case It.Left:return 1;case It.Right:return 2;case It.Middle:return 4;case It.Back:return 8;case It.Forward:return 16}},a6=r=>r&1?It.Left:r&2?It.Right:r&4?It.Middle:r&8?It.Back:r&16?It.Forward:"none";class i6 extends NC{constructor(e,n){super();y(this,Jt);y(this,jn);y(this,Na);y(this,Fd,{position:{x:0,y:0},buttons:0});y(this,Ml,[]);_(this,jn,e),_(this,Na,n)}updateClient(e){_(this,jn,e)}async reset(){const e=[];for(const[n,a]of[[1,It.Left],[4,It.Middle],[2,It.Right],[16,It.Forward],[8,It.Back]])o(this,Jt,Vn).buttons&n&&e.push(this.up({button:a}));(o(this,Jt,Vn).position.x!==0||o(this,Jt,Vn).position.y!==0)&&e.push(this.move(0,0)),await Promise.all(e)}async move(e,n,a={}){const{steps:i=1}=a,s=o(this,Jt,Vn).position,c={x:e,y:n};for(let l=1;l<=i;l++)await F(this,Jt,Mx).call(this,u=>{u({position:{x:s.x+(c.x-s.x)*(l/i),y:s.y+(c.y-s.y)*(l/i)}});const{buttons:h,position:d}=o(this,Jt,Vn);return o(this,jn).send("Input.dispatchMouseEvent",{type:"mouseMoved",modifiers:o(this,Na)._modifiers,buttons:h,button:a6(h),...d})})}async down(e={}){const{button:n=It.Left,clickCount:a=1}=e,i=oT(n);if(!i)throw new Error(`Unsupported mouse button: ${n}`);if(o(this,Jt,Vn).buttons&i)throw new Error(`'${n}' is already pressed.`);await F(this,Jt,Mx).call(this,s=>{s({buttons:o(this,Jt,Vn).buttons|i});const{buttons:c,position:l}=o(this,Jt,Vn);return o(this,jn).send("Input.dispatchMouseEvent",{type:"mousePressed",modifiers:o(this,Na)._modifiers,clickCount:a,buttons:c,button:n,...l})})}async up(e={}){const{button:n=It.Left,clickCount:a=1}=e,i=oT(n);if(!i)throw new Error(`Unsupported mouse button: ${n}`);if(!(o(this,Jt,Vn).buttons&i))throw new Error(`'${n}' is not pressed.`);await F(this,Jt,Mx).call(this,s=>{s({buttons:o(this,Jt,Vn).buttons&~i});const{buttons:c,position:l}=o(this,Jt,Vn);return o(this,jn).send("Input.dispatchMouseEvent",{type:"mouseReleased",modifiers:o(this,Na)._modifiers,clickCount:a,buttons:c,button:n,...l})})}async click(e,n,a={}){const{delay:i,count:s=1,clickCount:c=s}=a;if(s<1)throw new Error("Click must occur a positive number of times.");const l=[this.move(e,n)];if(c===s)for(let u=1;u<s;++u)l.push(this.down({...a,clickCount:u}),this.up({...a,clickCount:u}));l.push(this.down({...a,clickCount:c})),typeof i=="number"&&(await Promise.all(l),l.length=0,await new Promise(u=>{setTimeout(u,i)})),l.push(this.up({...a,clickCount:c})),await Promise.all(l)}async wheel(e={}){const{deltaX:n=0,deltaY:a=0}=e,{position:i,buttons:s}=o(this,Jt,Vn);await o(this,jn).send("Input.dispatchMouseEvent",{type:"mouseWheel",pointerType:"mouse",modifiers:o(this,Na)._modifiers,deltaY:a,deltaX:n,buttons:s,...i})}async drag(e,n){const a=new Promise(i=>{o(this,jn).once("Input.dragIntercepted",s=>i(s.data))});return await this.move(e.x,e.y),await this.down(),await this.move(n.x,n.y),await a}async dragEnter(e,n){await o(this,jn).send("Input.dispatchDragEvent",{type:"dragEnter",x:e.x,y:e.y,modifiers:o(this,Na)._modifiers,data:n})}async dragOver(e,n){await o(this,jn).send("Input.dispatchDragEvent",{type:"dragOver",x:e.x,y:e.y,modifiers:o(this,Na)._modifiers,data:n})}async drop(e,n){await o(this,jn).send("Input.dispatchDragEvent",{type:"drop",x:e.x,y:e.y,modifiers:o(this,Na)._modifiers,data:n})}async dragAndDrop(e,n,a={}){const{delay:i=null}=a,s=await this.drag(e,n);await this.dragEnter(n,s),await this.dragOver(n,s),i&&await new Promise(c=>setTimeout(c,i)),await this.drop(n,s),await this.up()}}jn=new WeakMap,Na=new WeakMap,Fd=new WeakMap,Jt=new WeakSet,Vn=function(){return Object.assign({...o(this,Fd)},...o(this,Ml))},Ml=new WeakMap,wI=function(){const e={};o(this,Ml).push(e);const n=()=>{o(this,Ml).splice(o(this,Ml).indexOf(e),1)};return{update:a=>{Object.assign(e,a)},commit:()=>{_(this,Fd,{...o(this,Fd),...e}),n()},rollback:n}},Mx=async function(e){const{update:n,commit:a,rollback:i}=F(this,Jt,wI).call(this);try{await e(n),a()}catch(s){throw i(),s}};class s6 extends LC{constructor(e,n){super();y(this,Ao);y(this,Rl);_(this,Ao,e),_(this,Rl,n)}updateClient(e){_(this,Ao,e)}async touchStart(e,n){await o(this,Ao).send("Input.dispatchTouchEvent",{type:"touchStart",touchPoints:[{x:Math.round(e),y:Math.round(n),radiusX:.5,radiusY:.5,force:.5}],modifiers:o(this,Rl)._modifiers})}async touchMove(e,n){await o(this,Ao).send("Input.dispatchTouchEvent",{type:"touchMove",touchPoints:[{x:Math.round(e),y:Math.round(n),radiusX:.5,radiusY:.5,force:.5}],modifiers:o(this,Rl)._modifiers})}async touchEnd(){await o(this,Ao).send("Input.dispatchTouchEvent",{type:"touchEnd",touchPoints:[],modifiers:o(this,Rl)._modifiers})}}Ao=new WeakMap,Rl=new WeakMap;class cT{constructor(t){y(this,as);y(this,Pd,!1);y(this,ag);_(this,as,t)}updateClient(t){_(this,as,t)}async start(t={}){Ee(!o(this,Pd),"Cannot start recording trace while already recording trace.");const e=["-*","devtools.timeline","v8.execute","disabled-by-default-devtools.timeline","disabled-by-default-devtools.timeline.frame","toplevel","blink.console","blink.user_timing","latencyInfo","disabled-by-default-devtools.timeline.stack","disabled-by-default-v8.cpu_profiler"],{path:n,screenshots:a=!1,categories:i=e}=t;a&&i.push("disabled-by-default-devtools.screenshot");const s=i.filter(l=>l.startsWith("-")).map(l=>l.slice(1)),c=i.filter(l=>!l.startsWith("-"));_(this,ag,n),_(this,Pd,!0),await o(this,as).send("Tracing.start",{transferMode:"ReturnAsStream",traceConfig:{excludedCategories:s,includedCategories:c}})}async stop(){const t=Et.create();return o(this,as).once("Tracing.tracingComplete",async e=>{try{Ee(e.stream,'Missing "stream"');const n=await mC(o(this,as),e.stream),a=await pC(n,o(this,ag));t.resolve(a??void 0)}catch(n){Yn(n)?t.reject(n):t.reject(new Error(`Unknown error: ${n}`))}}),await o(this,as).send("Tracing.end"),_(this,Pd,!1),await t.valueOrThrow()}}as=new WeakMap,Pd=new WeakMap,ag=new WeakMap;class lT extends zC{constructor(e,n,a,i,s,c){super(n);y(this,di);y(this,is);y(this,ig);y(this,sg);_(this,ig,a),_(this,is,e),_(this,sg,i),_(this,di,new Gk(this,new $k)),o(this,is).once("Runtime.executionContextCreated",async l=>{o(this,di).setContext(new tT(e,l.context,o(this,di)))}),o(this,di).emitter.on("consoleapicalled",async l=>{try{return s(l.type,l.args.map(u=>new Kw(o(this,di),u)),l.stackTrace)}catch(u){Re(u)}}),o(this,is).on("Runtime.exceptionThrown",c),o(this,is).once(St.Disconnected,()=>{o(this,di).dispose()}),o(this,is).send("Runtime.enable").catch(Re)}mainRealm(){return o(this,di)}get client(){return o(this,is)}async close(){var e,n;switch(o(this,sg)){case Wr.SERVICE_WORKER:case Wr.SHARED_WORKER:{await((e=this.client.connection())==null?void 0:e.send("Target.closeTarget",{targetId:o(this,ig)})),await((n=this.client.connection())==null?void 0:n.send("Target.detachFromTarget",{sessionId:this.client.id()}));break}default:await this.evaluate(()=>{self.close()})}}}di=new WeakMap,is=new WeakMap,ig=new WeakMap,sg=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Jk=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Zk=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});function Qk(r){switch(r){case"warning":return"warn";default:return r}}const vE=class vE extends $C{constructor(e,n){super();y(this,rt);y(this,og,!1);y(this,Fo);y(this,wt);y(this,La);y(this,Po);y(this,Nl);y(this,Io);y(this,Id);y(this,Dd);y(this,Ft);y(this,hr);y(this,Od);y(this,Do,new Map);y(this,Md,new Map);y(this,Rd);y(this,Nd);y(this,Ll,new Map);y(this,ss,new Set);y(this,Ky,Et.create());y(this,cg,!1);y(this,lg,!1);y(this,ug,e=>{var i;const n=(i=e._session())==null?void 0:i.id(),a=o(this,Ll).get(n);a&&(o(this,Ll).delete(n),this.emit("workerdestroyed",a))});y(this,Ld,e=>{if(Ee(e instanceof Zu),o(this,Ft).onAttachedToTarget(e._target()),e._target()._getTargetInfo().type==="worker"){const n=new lT(e,e._target().url(),e._target()._targetId,e._target().type(),F(this,rt,xS).bind(this),F(this,rt,yS).bind(this));o(this,Ll).set(e.id(),n),this.emit("workercreated",n)}e.on(St.Ready,o(this,Ld))});_(this,wt,e),_(this,Po,e.parentSession()),Ee(o(this,Po),"Tab target session is not defined."),_(this,Nl,o(this,Po)._target()),Ee(o(this,Nl),"Tab target is not defined."),_(this,La,n),_(this,Fo,n._targetManager()),_(this,Io,new n6(e)),_(this,Id,new i6(e,o(this,Io))),_(this,Dd,new s6(e,o(this,Io))),_(this,Ft,new r6(e,this,this._timeoutSettings)),_(this,hr,new XC(e)),_(this,Od,new cT(e)),_(this,Rd,new qC(e)),_(this,Nd,null);const a=new Ue(o(this,Ft));a.on(Ar.FrameAttached,s=>{this.emit("frameattached",s)}),a.on(Ar.FrameDetached,s=>{this.emit("framedetached",s)}),a.on(Ar.FrameNavigated,s=>{this.emit("framenavigated",s)}),a.on(Ar.ConsoleApiCalled,([s,c])=>{F(this,rt,CI).call(this,s,c)}),a.on(Ar.BindingCalled,([s,c])=>{F(this,rt,TI).call(this,s,c)});const i=new Ue(o(this,Ft).networkManager);i.on(Tr.Request,s=>{this.emit("request",s)}),i.on(Tr.RequestServedFromCache,s=>{this.emit("requestservedfromcache",s)}),i.on(Tr.Response,s=>{this.emit("response",s)}),i.on(Tr.RequestFailed,s=>{this.emit("requestfailed",s)}),i.on(Tr.RequestFinished,s=>{this.emit("requestfinished",s)}),o(this,Po).on(St.Swapped,F(this,rt,yI).bind(this)),o(this,Po).on(St.Ready,F(this,rt,xI).bind(this)),o(this,Fo).on("targetGone",o(this,ug)),o(this,Nl)._isClosedDeferred.valueOrThrow().then(()=>{o(this,Fo).off("targetGone",o(this,ug)),this.emit("close",void 0),_(this,og,!0)}).catch(Re),F(this,rt,wS).call(this),F(this,rt,vI).call(this)}static async _create(e,n,a){var s;const i=new vE(e,n);if(await F(s=i,rt,kI).call(s),a)try{await i.setViewport(a)}catch(c){if(Yn(c)&&Vk(c))Re(c);else throw c}return i}_client(){return o(this,wt)}isServiceWorkerBypassed(){return o(this,cg)}isDragInterceptionEnabled(){return o(this,lg)}isJavaScriptEnabled(){return o(this,hr).javascriptEnabled}async waitForFileChooser(e={}){const n=o(this,ss).size===0,{timeout:a=this._timeoutSettings.timeout()}=e,i=Et.create({message:`Waiting for \`FileChooser\` failed: ${a}ms exceeded`,timeout:a});e.signal&&e.signal.addEventListener("abort",()=>{var c;i.reject((c=e.signal)==null?void 0:c.reason)},{once:!0}),o(this,ss).add(i);let s;n&&(s=o(this,wt).send("Page.setInterceptFileChooserDialog",{enabled:!0}));try{const[c]=await Promise.all([i.valueOrThrow(),s]);return c}catch(c){throw o(this,ss).delete(i),c}}async setGeolocation(e){return await o(this,hr).setGeolocation(e)}target(){return o(this,La)}browser(){return o(this,La).browser()}browserContext(){return o(this,La).browserContext()}mainFrame(){return o(this,Ft).mainFrame()}get keyboard(){return o(this,Io)}get touchscreen(){return o(this,Dd)}get coverage(){return o(this,Rd)}get tracing(){return o(this,Od)}frames(){return o(this,Ft).frames()}workers(){return Array.from(o(this,Ll).values())}async setRequestInterception(e){return await o(this,Ft).networkManager.setRequestInterception(e)}async setBypassServiceWorker(e){return _(this,cg,e),await o(this,wt).send("Network.setBypassServiceWorker",{bypass:e})}async setDragInterception(e){return _(this,lg,e),await o(this,wt).send("Input.setInterceptDrags",{enabled:e})}async setOfflineMode(e){return await o(this,Ft).networkManager.setOfflineMode(e)}async emulateNetworkConditions(e){return await o(this,Ft).networkManager.emulateNetworkConditions(e)}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}getDefaultTimeout(){return this._timeoutSettings.timeout()}async queryObjects(e){Ee(!e.disposed,"Prototype JSHandle is disposed!"),Ee(e.id,"Prototype JSHandle must not be referencing primitive value");const n=await this.mainFrame().client.send("Runtime.queryObjects",{prototypeObjectId:e.id});return this.mainFrame().mainRealm().createCdpHandle(n.objects)}async cookies(...e){const n=(await o(this,wt).send("Network.getCookies",{urls:e.length?e:[this.url()]})).cookies,a=["sourcePort"],i=s=>{for(const c of a)delete s[c];return s};return n.map(i).map(s=>({...s,partitionKey:s.partitionKey?s.partitionKey.topLevelSite:void 0}))}async deleteCookie(...e){const n=this.url();for(const a of e){const i={...a,partitionKey:a.partitionKey?{topLevelSite:a.partitionKey,hasCrossSiteAncestor:!1}:void 0};if(!a.url&&n.startsWith("http")&&(i.url=n),await o(this,wt).send("Network.deleteCookies",i),n.startsWith("http")&&!i.partitionKey){const s=new URL(n);await o(this,wt).send("Network.deleteCookies",{...i,partitionKey:{topLevelSite:s.origin.replace(`:${s.port}`,""),hasCrossSiteAncestor:!1}})}}}async setCookie(...e){const n=this.url(),a=n.startsWith("http"),i=e.map(s=>{const c=Object.assign({},s);return!c.url&&a&&(c.url=n),Ee(c.url!=="about:blank",`Blank page can not have cookie "${c.name}"`),Ee(!String.prototype.startsWith.call(c.url||"","data:"),`Data URL page can not have cookie "${c.name}"`),c});await this.deleteCookie(...i),i.length&&await o(this,wt).send("Network.setCookies",{cookies:i.map(s=>({...s,partitionKey:s.partitionKey?{topLevelSite:s.partitionKey,hasCrossSiteAncestor:!1}:void 0}))})}async exposeFunction(e,n){if(o(this,Do).has(e))throw new Error(`Failed to add page binding with name ${e}: window['${e}'] already exists!`);const a=W5("exposedFun",e);let i;switch(typeof n){case"function":i=new zw(e,n,a);break;default:i=new zw(e,n.default,a);break}o(this,Do).set(e,i);const[{identifier:s}]=await Promise.all([o(this,Ft).evaluateOnNewDocument(a),o(this,Ft).addExposedFunctionBinding(i)]);o(this,Md).set(e,s)}async removeExposedFunction(e){const n=o(this,Md).get(e);if(!n)throw new Error(`Function with name "${e}" does not exist`);const a=o(this,Do).get(e);o(this,Md).delete(e),o(this,Do).delete(e),await Promise.all([o(this,Ft).removeScriptToEvaluateOnNewDocument(n),o(this,Ft).removeExposedFunctionBinding(a)])}async authenticate(e){return await o(this,Ft).networkManager.authenticate(e)}async setExtraHTTPHeaders(e){return await o(this,Ft).networkManager.setExtraHTTPHeaders(e)}async setUserAgent(e,n){return await o(this,Ft).networkManager.setUserAgent(e,n)}async metrics(){const e=await o(this,wt).send("Performance.getMetrics");return F(this,rt,vS).call(this,e.metrics)}async reload(e){const[n]=await Promise.all([this.waitForNavigation({...e,ignoreSameDocumentNavigation:!0}),o(this,wt).send("Page.reload")]);return n}async createCDPSession(){return await this.target().createCDPSession()}async goBack(e={}){return await F(this,rt,kS).call(this,-1,e)}async goForward(e={}){return await F(this,rt,kS).call(this,1,e)}async bringToFront(){await o(this,wt).send("Page.bringToFront")}async setJavaScriptEnabled(e){return await o(this,hr).setJavaScriptEnabled(e)}async setBypassCSP(e){await o(this,wt).send("Page.setBypassCSP",{enabled:e})}async emulateMediaType(e){return await o(this,hr).emulateMediaType(e)}async emulateCPUThrottling(e){return await o(this,hr).emulateCPUThrottling(e)}async emulateMediaFeatures(e){return await o(this,hr).emulateMediaFeatures(e)}async emulateTimezone(e){return await o(this,hr).emulateTimezone(e)}async emulateIdleState(e){return await o(this,hr).emulateIdleState(e)}async emulateVisionDeficiency(e){return await o(this,hr).emulateVisionDeficiency(e)}async setViewport(e){const n=await o(this,hr).emulateViewport(e);_(this,Nd,e),n&&await this.reload()}viewport(){return o(this,Nd)}async evaluateOnNewDocument(e,...n){const a=Fk(e,...n);return await o(this,Ft).evaluateOnNewDocument(a)}async removeScriptToEvaluateOnNewDocument(e){return await o(this,Ft).removeScriptToEvaluateOnNewDocument(e)}async setCacheEnabled(e=!0){await o(this,Ft).networkManager.setCacheEnabled(e)}async _screenshot(e){const n={stack:[],error:void 0,hasError:!1};try{const{fromSurface:a,omitBackground:i,optimizeForSpeed:s,quality:c,clip:l,type:u,captureBeyondViewport:h}=e,d=this.target()._targetManager()instanceof qk,f=Jk(n,new Ew,!0);!d&&i&&(u==="png"||u==="webp")&&(await o(this,hr).setTransparentBackgroundColor(),f.defer(async()=>{await o(this,hr).resetDefaultBackgroundColor().catch(Re)}));let m=l;if(m&&!h){const p=await this.mainFrame().isolatedRealm().evaluate(()=>{const{height:g,pageLeft:v,pageTop:k,width:x}=window.visualViewport;return{x:v,y:k,height:g,width:x}});m=c6(m,p)}const{data:w}=await o(this,wt).send("Page.captureScreenshot",{format:u,...s?{optimizeForSpeed:s}:{},...c!==void 0?{quality:Math.round(c)}:{},...m?{clip:{...m,scale:m.scale??1}}:{},...a?{}:{fromSurface:a},captureBeyondViewport:h});return w}catch(a){n.error=a,n.hasError=!0}finally{const a=Zk(n);a&&await a}}async createPDFStream(e={}){const{timeout:n=this._timeoutSettings.timeout()}=e,{landscape:a,displayHeaderFooter:i,headerTemplate:s,footerTemplate:c,printBackground:l,scale:u,width:h,height:d,margin:f,pageRanges:m,preferCSSPageSize:w,omitBackground:p,tagged:g,outline:v,waitForFonts:k}=vC(e);p&&await o(this,hr).setTransparentBackgroundColor(),k&&await Er(dt(this.mainFrame().isolatedRealm().evaluate(()=>document.fonts.ready)).pipe(jr(En(n))));const x=o(this,wt).send("Page.printToPDF",{transferMode:"ReturnAsStream",landscape:a,displayHeaderFooter:i,headerTemplate:s,footerTemplate:c,printBackground:l,scale:u,paperWidth:h,paperHeight:d,marginTop:f.top,marginBottom:f.bottom,marginLeft:f.left,marginRight:f.right,pageRanges:m,preferCSSPageSize:w,generateTaggedPDF:g,generateDocumentOutline:v}),S=await Er(dt(x).pipe(jr(En(n))));return p&&await o(this,hr).resetDefaultBackgroundColor(),Ee(S.stream,"`stream` is missing from `Page.printToPDF"),await mC(o(this,wt),S.stream)}async pdf(e={}){const{path:n=void 0}=e,a=await this.createPDFStream(e),i=await pC(a,n);return Ee(i,"Could not create typed array"),i}async close(e={runBeforeUnload:void 0}){const n={stack:[],error:void 0,hasError:!1};try{const a=Jk(n,await this.browserContext().waitForScreenshotOperations(),!1),i=o(this,wt).connection();Ee(i,"Protocol error: Connection closed. Most likely the page has been closed."),!!e.runBeforeUnload?await o(this,wt).send("Page.close"):(await i.send("Target.closeTarget",{targetId:o(this,La)._targetId}),await o(this,Nl)._isClosedDeferred.valueOrThrow())}catch(a){n.error=a,n.hasError=!0}finally{Zk(n)}}isClosed(){return o(this,og)}get mouse(){return o(this,Id)}async waitForDevicePrompt(e={}){return await this.mainFrame().waitForDevicePrompt(e)}};og=new WeakMap,Fo=new WeakMap,wt=new WeakMap,La=new WeakMap,Po=new WeakMap,Nl=new WeakMap,Io=new WeakMap,Id=new WeakMap,Dd=new WeakMap,Ft=new WeakMap,hr=new WeakMap,Od=new WeakMap,Do=new WeakMap,Md=new WeakMap,Rd=new WeakMap,Nd=new WeakMap,Ll=new WeakMap,ss=new WeakMap,Ky=new WeakMap,cg=new WeakMap,lg=new WeakMap,rt=new WeakSet,vI=function(){const e=[];for(const a of o(this,Fo).getChildTargets(o(this,La)))e.push(a);let n=0;for(;n<e.length;){const a=e[n];n++;const i=a._session();i&&o(this,Ld).call(this,i);for(const s of o(this,Fo).getChildTargets(a))e.push(s)}},yI=async function(e){_(this,wt,e),Ee(o(this,wt)instanceof Zu,"CDPSession is not instance of CDPSessionImpl"),_(this,La,o(this,wt)._target()),Ee(o(this,La),"Missing target on swap"),o(this,Io).updateClient(e),o(this,Id).updateClient(e),o(this,Dd).updateClient(e),o(this,hr).updateClient(e),o(this,Od).updateClient(e),o(this,Rd).updateClient(e),await o(this,Ft).swapFrameTree(e),F(this,rt,wS).call(this)},xI=async function(e){Ee(e instanceof Zu),e._target()._subtype()==="prerender"&&(o(this,Ft).registerSpeculativeSession(e).catch(Re),o(this,hr).registerSpeculativeSession(e).catch(Re))},wS=function(){const e=new Ue(o(this,wt));e.on(St.Ready,o(this,Ld)),e.on(St.Disconnected,()=>{o(this,Ky).reject(new ya("Target closed"))}),e.on("Page.domContentEventFired",()=>{this.emit("domcontentloaded",void 0)}),e.on("Page.loadEventFired",()=>{this.emit("load",void 0)}),e.on("Page.javascriptDialogOpening",F(this,rt,AI).bind(this)),e.on("Runtime.exceptionThrown",F(this,rt,yS).bind(this)),e.on("Inspector.targetCrashed",F(this,rt,_I).bind(this)),e.on("Performance.metrics",F(this,rt,SI).bind(this)),e.on("Log.entryAdded",F(this,rt,EI).bind(this)),e.on("Page.fileChooserOpened",F(this,rt,bI).bind(this))},ug=new WeakMap,Ld=new WeakMap,kI=async function(){try{await Promise.all([o(this,Ft).initialize(o(this,wt)),o(this,wt).send("Performance.enable"),o(this,wt).send("Log.enable")])}catch(e){if(Yn(e)&&Vk(e))Re(e);else throw e}},bI=async function(e){const n={stack:[],error:void 0,hasError:!1};try{if(!o(this,ss).size)return;const a=o(this,Ft).frame(e.frameId);Ee(a,"This should never happen.");const i=Jk(n,await a.worlds[Ja].adoptBackendNode(e.backendNodeId),!1),s=new I5(i.move(),e);for(const c of o(this,ss))c.resolve(s);o(this,ss).clear()}catch(a){n.error=a,n.hasError=!0}finally{Zk(n)}},_I=function(){this.emit("error",new Error("Page crashed!"))},EI=function(e){const{level:n,text:a,args:i,source:s,url:c,lineNumber:l}=e.entry;i&&i.map(u=>{QC(o(this,wt),u)}),s!=="worker"&&this.emit("console",new Kk(Qk(n),a,[],[{url:c,lineNumber:l}]))},SI=function(e){this.emit("metrics",{title:e.title,metrics:F(this,rt,vS).call(this,e.metrics)})},vS=function(e){const n={};for(const a of e||[])o6.has(a.name)&&(n[a.name]=a.value);return n},yS=function(e){this.emit("pageerror",H5(e.exceptionDetails))},CI=function(e,n){const a=n.args.map(i=>e.createCdpHandle(i));F(this,rt,xS).call(this,Qk(n.type),a,n.stackTrace)},TI=async function(e,n){let a;try{a=JSON.parse(n.payload)}catch{return}const{type:i,name:s,seq:c,args:l,isTrivial:u}=a;if(i!=="exposedFun")return;const h=e.context;if(!h)return;const d=o(this,Do).get(s);await(d==null?void 0:d.run(h,c,l,u))},xS=function(e,n,a){if(!this.listenerCount("console")){n.forEach(l=>l.dispose());return}const i=[];for(const l of n){const u=l.remoteObject();u.objectId?i.push(l.toString()):i.push(_c(u))}const s=[];if(a)for(const l of a.callFrames)s.push({url:l.url,lineNumber:l.lineNumber,columnNumber:l.columnNumber});const c=new Kk(Qk(e),i.join(" "),n,s);this.emit("console",c)},AI=function(e){const n=NR(e.type),a=new N5(o(this,wt),n,e.message,e.defaultPrompt);this.emit("dialog",a)},kS=async function(e,n){const a=await o(this,wt).send("Page.getNavigationHistory"),i=a.entries[a.currentIndex+e];return i?(await Promise.all([this.waitForNavigation(n),o(this,wt).send("Page.navigateToHistoryEntry",{entryId:i.id})]))[0]:null};let A0=vE;const o6=new Set(["Timestamp","Documents","Frames","JSEventListeners","Nodes","LayoutCount","RecalcStyleCount","LayoutDuration","RecalcStyleDuration","ScriptDuration","TaskDuration","JSHeapUsedSize","JSHeapTotalSize"]);function c6(r,t){const e=Math.max(r.x,t.x),n=Math.max(r.y,t.y);return{x:e,y:n,width:Math.max(Math.min(r.x+r.width,t.x+t.width)-e,0),height:Math.max(Math.min(r.y+r.height,t.y+t.height)-n,0)}}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Jn;(function(r){r.SUCCESS="success",r.ABORTED="aborted"})(Jn||(Jn={}));let Gw=(dP=class extends T0{constructor(e,n,a,i,s){super();y(this,Oo);y(this,Mo);y(this,fi);y(this,Bd);y(this,Ro);y(this,Ud,new Set);H(this,"_initializedDeferred",Et.create());H(this,"_isClosedDeferred",Et.create());H(this,"_targetId");_(this,Mo,n),_(this,Bd,i),_(this,fi,e),_(this,Oo,a),this._targetId=e.targetId,_(this,Ro,s),o(this,Mo)&&o(this,Mo)instanceof Zu&&o(this,Mo)._setTarget(this)}async asPage(){const e=this._session();return e?await A0._create(e,this,null):await this.createCDPSession().then(n=>A0._create(n,this,null))}_subtype(){return o(this,fi).subtype}_session(){return o(this,Mo)}_addChildTarget(e){o(this,Ud).add(e)}_removeChildTarget(e){o(this,Ud).delete(e)}_childTargets(){return o(this,Ud)}_sessionFactory(){if(!o(this,Ro))throw new Error("sessionFactory is not initialized");return o(this,Ro)}createCDPSession(){if(!o(this,Ro))throw new Error("sessionFactory is not initialized");return o(this,Ro).call(this,!1).then(e=>(e._setTarget(this),e))}url(){return o(this,fi).url}type(){switch(o(this,fi).type){case"page":return Wr.PAGE;case"background_page":return Wr.BACKGROUND_PAGE;case"service_worker":return Wr.SERVICE_WORKER;case"shared_worker":return Wr.SHARED_WORKER;case"browser":return Wr.BROWSER;case"webview":return Wr.WEBVIEW;case"tab":return Wr.TAB;default:return Wr.OTHER}}_targetManager(){if(!o(this,Bd))throw new Error("targetManager is not initialized");return o(this,Bd)}_getTargetInfo(){return o(this,fi)}browser(){if(!o(this,Oo))throw new Error("browserContext is not initialized");return o(this,Oo).browser()}browserContext(){if(!o(this,Oo))throw new Error("browserContext is not initialized");return o(this,Oo)}opener(){const{openerId:e}=o(this,fi);if(e)return this.browser().targets().find(n=>n._targetId===e)}_targetInfoChanged(e){_(this,fi,e),this._checkIfInitialized()}_initialize(){this._initializedDeferred.resolve(Jn.SUCCESS)}_isTargetExposed(){return this.type()!==Wr.TAB&&!this._subtype()}_checkIfInitialized(){this._initializedDeferred.resolved()||this._initializedDeferred.resolve(Jn.SUCCESS)}},Oo=new WeakMap,Mo=new WeakMap,fi=new WeakMap,Bd=new WeakMap,Ro=new WeakMap,Ud=new WeakMap,dP);const yE=class yE extends Gw{constructor(e,n,a,i,s,c){super(e,n,a,i,s);y(this,hg);H(this,"pagePromise");_(this,hg,c??void 0)}_initialize(){this._initializedDeferred.valueOrThrow().then(async e=>{if(e===Jn.ABORTED)return;const n=this.opener();if(!(n instanceof yE))return;if(!n||!n.pagePromise||this.type()!=="page")return!0;const a=await n.pagePromise;if(!a.listenerCount("popup"))return!0;const i=await this.page();return a.emit("popup",i),!0}).catch(Re),this._checkIfInitialized()}async page(){if(!this.pagePromise){const e=this._session();this.pagePromise=(e?Promise.resolve(e):this._sessionFactory()(!1)).then(n=>A0._create(n,this,o(this,hg)??null))}return await this.pagePromise??null}_checkIfInitialized(){this._initializedDeferred.resolved()||this._getTargetInfo().url!==""&&this._initializedDeferred.resolve(Jn.SUCCESS)}};hg=new WeakMap;let Xw=yE;class l6 extends Xw{}class u6 extends Gw{constructor(){super(...arguments);y(this,$d)}async worker(){if(!o(this,$d)){const e=this._session();_(this,$d,(e?Promise.resolve(e):this._sessionFactory()(!1)).then(n=>new lT(n,this._getTargetInfo().url,this._targetId,this.type(),()=>{},()=>{})))}return await o(this,$d)}}$d=new WeakMap;class h6 extends Gw{}/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function d6(r,t){return!!r._subtype()&&!t.subtype}class f6 extends Ue{constructor(e,n,a,i=!0){super();y(this,Pn);y(this,Ir);y(this,No,new Map);y(this,Dr,new Map);y(this,Bl,new Map);y(this,dg,new Set);y(this,Lo);y(this,Ul);y(this,$l,new WeakMap);y(this,Bo,new WeakMap);y(this,fg,Et.create());y(this,jl,new Set);y(this,pg,!0);y(this,jd,[{}]);y(this,Vy,()=>{if(o(this,pg))for(const[e,n]of o(this,No).entries()){const a=new Gw(n,void 0,void 0,this,void 0),i=n.type==="page"||n.type==="iframe",s=n.url.startsWith("chrome-extension://");(!o(this,Lo)||o(this,Lo).call(this,a))&&i&&!s&&o(this,jl).add(e)}});y(this,mg,e=>{F(this,Pn,_S).call(this,e)});y(this,gg,async e=>{if(o(this,No).set(e.targetInfo.targetId,e.targetInfo),this.emit("targetDiscovered",e.targetInfo),e.targetInfo.type==="browser"&&e.targetInfo.attached){if(o(this,Dr).has(e.targetInfo.targetId))return;const n=o(this,Ul).call(this,e.targetInfo,void 0);n._initialize(),o(this,Dr).set(e.targetInfo.targetId,n)}});y(this,wg,e=>{const n=o(this,No).get(e.targetId);if(o(this,No).delete(e.targetId),F(this,Pn,i0).call(this,e.targetId),(n==null?void 0:n.type)==="service_worker"&&o(this,Dr).has(e.targetId)){const a=o(this,Dr).get(e.targetId);a&&(this.emit("targetGone",a),o(this,Dr).delete(e.targetId))}});y(this,vg,e=>{var s;if(o(this,No).set(e.targetInfo.targetId,e.targetInfo),o(this,dg).has(e.targetInfo.targetId)||!o(this,Dr).has(e.targetInfo.targetId)||!e.targetInfo.attached)return;const n=o(this,Dr).get(e.targetInfo.targetId);if(!n)return;const a=n.url(),i=n._initializedDeferred.value()===Jn.SUCCESS;if(d6(n,e.targetInfo)){const c=n==null?void 0:n._session();Ee(c,"Target that is being activated is missing a CDPSession."),(s=c.parentSession())==null||s.emit(St.Swapped,c)}n._targetInfoChanged(e.targetInfo),i&&a!==n.url()&&this.emit("targetChanged",{target:n,wasInitialized:i,previousURL:a})});y(this,qy,async(e,n)=>{const a=n.targetInfo,i=o(this,Ir).session(n.sessionId);if(!i)throw new Error(`Session ${n.sessionId} was not created.`);const s=async()=>{await i.send("Runtime.runIfWaitingForDebugger").catch(Re),await e.send("Target.detachFromTarget",{sessionId:i.id()}).catch(Re)};if(!o(this,Ir).isAutoAttached(a.targetId))return;if(a.type==="service_worker"){if(F(this,Pn,i0).call(this,a.targetId),await s(),o(this,Dr).has(a.targetId))return;const h=o(this,Ul).call(this,a);h._initialize(),o(this,Dr).set(a.targetId,h),this.emit("targetAvailable",h);return}const c=o(this,Dr).has(a.targetId),l=c?o(this,Dr).get(a.targetId):o(this,Ul).call(this,a,i,e instanceof k0?e:void 0);if(o(this,Lo)&&!o(this,Lo).call(this,l)){o(this,dg).add(a.targetId),F(this,Pn,i0).call(this,a.targetId),await s();return}F(this,Pn,bS).call(this,i),c?(i._setTarget(l),o(this,Bl).set(i.id(),o(this,Dr).get(a.targetId))):(l._initialize(),o(this,Dr).set(a.targetId,l),o(this,Bl).set(i.id(),l));const u=e instanceof k0?e._target():null;u==null||u._addChildTarget(l),e.emit(St.Ready,i),o(this,jl).delete(l._targetId),c||this.emit("targetAvailable",l),F(this,Pn,i0).call(this),await Promise.all([i.send("Target.setAutoAttach",{waitForDebuggerOnStart:!0,flatten:!0,autoAttach:!0,filter:o(this,jd)}),i.send("Runtime.runIfWaitingForDebugger")]).catch(Re)});y(this,Gy,(e,n)=>{const a=o(this,Bl).get(n.sessionId);o(this,Bl).delete(n.sessionId),a&&(e instanceof k0&&e._target()._removeChildTarget(a),o(this,Dr).delete(a._targetId),this.emit("targetGone",a))});_(this,Ir,e),_(this,Lo,a),_(this,Ul,n),_(this,pg,i),o(this,Ir).on("Target.targetCreated",o(this,gg)),o(this,Ir).on("Target.targetDestroyed",o(this,wg)),o(this,Ir).on("Target.targetInfoChanged",o(this,vg)),o(this,Ir).on(St.SessionDetached,o(this,mg)),F(this,Pn,bS).call(this,o(this,Ir))}async initialize(){await o(this,Ir).send("Target.setDiscoverTargets",{discover:!0,filter:o(this,jd)}),o(this,Vy).call(this),await o(this,Ir).send("Target.setAutoAttach",{waitForDebuggerOnStart:!0,flatten:!0,autoAttach:!0,filter:[{type:"page",exclude:!0},...o(this,jd)]}),F(this,Pn,i0).call(this),await o(this,fg).valueOrThrow()}getChildTargets(e){return e._childTargets()}dispose(){o(this,Ir).off("Target.targetCreated",o(this,gg)),o(this,Ir).off("Target.targetDestroyed",o(this,wg)),o(this,Ir).off("Target.targetInfoChanged",o(this,vg)),o(this,Ir).off(St.SessionDetached,o(this,mg)),F(this,Pn,_S).call(this,o(this,Ir))}getAvailableTargets(){return o(this,Dr)}}Ir=new WeakMap,No=new WeakMap,Dr=new WeakMap,Bl=new WeakMap,dg=new WeakMap,Lo=new WeakMap,Ul=new WeakMap,$l=new WeakMap,Bo=new WeakMap,fg=new WeakMap,jl=new WeakMap,pg=new WeakMap,jd=new WeakMap,Vy=new WeakMap,Pn=new WeakSet,bS=function(e){const n=i=>{o(this,qy).call(this,e,i)};Ee(!o(this,$l).has(e)),o(this,$l).set(e,n),e.on("Target.attachedToTarget",n);const a=i=>o(this,Gy).call(this,e,i);Ee(!o(this,Bo).has(e)),o(this,Bo).set(e,a),e.on("Target.detachedFromTarget",a)},_S=function(e){const n=o(this,$l).get(e);n&&(e.off("Target.attachedToTarget",n),o(this,$l).delete(e)),o(this,Bo).has(e)&&(e.off("Target.detachedFromTarget",o(this,Bo).get(e)),o(this,Bo).delete(e))},mg=new WeakMap,gg=new WeakMap,wg=new WeakMap,vg=new WeakMap,qy=new WeakMap,i0=function(e){e!==void 0&&o(this,jl).delete(e),o(this,jl).size===0&&o(this,fg).resolve()},Gy=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const xE=class xE extends yC{constructor(e,n,a,i,s,c,l,u,h=!0){super();y(this,Hl);H(this,"protocol","cdp");y(this,Hd);y(this,yg);y(this,Or);y(this,xg);y(this,Wd);y(this,zd);y(this,Uo);y(this,os,new Map);y(this,Zt);y(this,kg,()=>{this.emit("disconnected",void 0)});y(this,bg,(e,n)=>{var l;const{browserContextId:a}=e,i=a&&o(this,os).has(a)?o(this,os).get(a):o(this,Uo);if(!i)throw new Error("Missing browser context");const s=u=>o(this,Or)._createSession(e,u),c=new h6(e,n,i,o(this,Zt),s);return(l=e.url)!=null&&l.startsWith("devtools://")?new l6(e,n,i,o(this,Zt),s,o(this,Hd)??null):o(this,zd).call(this,c)?new Xw(e,n,i,o(this,Zt),s,o(this,Hd)??null):e.type==="service_worker"||e.type==="shared_worker"?new u6(e,n,i,o(this,Zt),s):c});y(this,_g,async e=>{e._isTargetExposed()&&await e._initializedDeferred.valueOrThrow()===Jn.SUCCESS&&(this.emit("targetcreated",e),e.browserContext().emit("targetcreated",e))});y(this,Eg,async e=>{e._initializedDeferred.resolve(Jn.ABORTED),e._isClosedDeferred.resolve(),e._isTargetExposed()&&await e._initializedDeferred.valueOrThrow()===Jn.SUCCESS&&(this.emit("targetdestroyed",e),e.browserContext().emit("targetdestroyed",e))});y(this,Sg,({target:e})=>{this.emit("targetchanged",e),e.browserContext().emit("targetchanged",e)});y(this,Cg,e=>{this.emit("targetdiscovered",e)});e=e||"chrome",_(this,Hd,i),_(this,yg,s),_(this,Or,n),_(this,xg,c||(()=>{})),_(this,Wd,l||(()=>!0)),F(this,Hl,FI).call(this,u),e==="firefox"?_(this,Zt,new qk(n,o(this,bg),o(this,Wd))):_(this,Zt,new f6(n,o(this,bg),o(this,Wd),h)),_(this,Uo,new Wk(o(this,Or),this));for(const d of a)o(this,os).set(d,new Wk(o(this,Or),this,d))}static async _create(e,n,a,i,s,c,l,u,h,d=!0){const f=new xE(e,n,a,s,c,l,u,h,d);return i&&await n.send("Security.setIgnoreCertificateErrors",{ignore:!0}),await f._attach(),f}async _attach(){o(this,Or).on(St.Disconnected,o(this,kg)),o(this,Zt).on("targetAvailable",o(this,_g)),o(this,Zt).on("targetGone",o(this,Eg)),o(this,Zt).on("targetChanged",o(this,Sg)),o(this,Zt).on("targetDiscovered",o(this,Cg)),await o(this,Zt).initialize()}_detach(){o(this,Or).off(St.Disconnected,o(this,kg)),o(this,Zt).off("targetAvailable",o(this,_g)),o(this,Zt).off("targetGone",o(this,Eg)),o(this,Zt).off("targetChanged",o(this,Sg)),o(this,Zt).off("targetDiscovered",o(this,Cg))}process(){return o(this,yg)??null}_targetManager(){return o(this,Zt)}_getIsPageTargetCallback(){return o(this,zd)}async createBrowserContext(e={}){const{proxyServer:n,proxyBypassList:a}=e,{browserContextId:i}=await o(this,Or).send("Target.createBrowserContext",{proxyServer:n,proxyBypassList:a&&a.join(",")}),s=new Wk(o(this,Or),this,i);return o(this,os).set(i,s),s}browserContexts(){return[o(this,Uo),...Array.from(o(this,os).values())]}defaultBrowserContext(){return o(this,Uo)}async _disposeContext(e){e&&(await o(this,Or).send("Target.disposeBrowserContext",{browserContextId:e}),o(this,os).delete(e))}wsEndpoint(){return o(this,Or).url()}async newPage(){return await o(this,Uo).newPage()}async _createPageInContext(e){const{targetId:n}=await o(this,Or).send("Target.createTarget",{url:"about:blank",browserContextId:e||void 0}),a=await this.waitForTarget(c=>c._targetId===n);if(!a)throw new Error(`Missing target for page (id = ${n})`);if(!(await a._initializedDeferred.valueOrThrow()===Jn.SUCCESS))throw new Error(`Failed to create target for page (id = ${n})`);const s=await a.page();if(!s)throw new Error(`Failed to create a page for context (id = ${e})`);return s}targets(){return Array.from(o(this,Zt).getAvailableTargets().values()).filter(e=>e._isTargetExposed()&&e._initializedDeferred.value()===Jn.SUCCESS)}target(){const e=this.targets().find(n=>n.type()==="browser");if(!e)throw new Error("Browser target is not found");return e}async version(){return(await F(this,Hl,ES).call(this)).product}async userAgent(){return(await F(this,Hl,ES).call(this)).userAgent}async close(){await o(this,xg).call(null),await this.disconnect()}disconnect(){return o(this,Zt).dispose(),o(this,Or).dispose(),this._detach(),Promise.resolve()}get connected(){return!o(this,Or)._closed}get debugInfo(){return{pendingProtocolErrors:o(this,Or).getPendingProtocolErrors()}}};Hd=new WeakMap,yg=new WeakMap,Or=new WeakMap,xg=new WeakMap,Wd=new WeakMap,zd=new WeakMap,Uo=new WeakMap,os=new WeakMap,Zt=new WeakMap,kg=new WeakMap,Hl=new WeakSet,FI=function(e){_(this,zd,e||(n=>n.type()==="page"||n.type()==="background_page"||n.type()==="webview"))},bg=new WeakMap,_g=new WeakMap,Eg=new WeakMap,Sg=new WeakMap,Cg=new WeakMap,ES=function(){return o(this,Or).send("Browser.getVersion")};let eb=xE;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */async function p6(r,t,e){const{acceptInsecureCerts:n=!1,defaultViewport:a=dC,targetFilter:i,_isPageTarget:s,slowMo:c=0,protocolTimeout:l}=e,u=new VC(t,r,c,l),d=(await u.send("Browser.getVersion")).product.toLowerCase().includes("firefox")?"firefox":"chrome",{browserContextIds:f}=await u.send("Target.getBrowserContexts");return await eb._create(d||"chrome",u,f,n,a,void 0,()=>u.send("Browser.close").catch(Re),i,s)}const uT={targetId:"tabTargetId",type:"tab",title:"tab",url:"about:blank",attached:!1,canAccessOpener:!1},hT={targetId:"pageTargetId",type:"page",title:"page",url:"about:blank",attached:!1,canAccessOpener:!1},kE=class kE{constructor(t){y(this,vn);H(this,"onmessage");H(this,"onclose");y(this,Wl);y(this,Tg,(t,e,n)=>{t.tabId===o(this,Wl)&&F(this,vn,qn).call(this,{sessionId:t.sessionId??"pageTargetSessionId",method:e,params:n})});_(this,Wl,t),chrome.debugger.onEvent.addListener(o(this,Tg))}static async connectTab(t){return await chrome.debugger.attach({tabId:t},"1.3"),new kE(t)}send(t){const e=JSON.parse(t);switch(e.method){case"Browser.getVersion":{F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{protocolVersion:"1.3",product:"chrome",revision:"unknown",userAgent:"chrome",jsVersion:"unknown"}});return}case"Target.getBrowserContexts":{F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{browserContextIds:[]}});return}case"Target.setDiscoverTargets":{F(this,vn,qn).call(this,{method:"Target.targetCreated",params:{targetInfo:uT}}),F(this,vn,qn).call(this,{method:"Target.targetCreated",params:{targetInfo:hT}}),F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{}});return}case"Target.setAutoAttach":if(e.sessionId==="tabTargetSessionId"){F(this,vn,qn).call(this,{method:"Target.attachedToTarget",params:{targetInfo:hT,sessionId:"pageTargetSessionId"}}),F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{}});return}else if(!e.sessionId){F(this,vn,qn).call(this,{method:"Target.attachedToTarget",params:{targetInfo:uT,sessionId:"tabTargetSessionId"}}),F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{}});return}}e.sessionId==="pageTargetSessionId"&&delete e.sessionId,chrome.debugger.sendCommand({tabId:o(this,Wl),sessionId:e.sessionId},e.method,e.params).then(n=>{F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId??"pageTargetSessionId",method:e.method,result:n})}).catch(n=>{F(this,vn,qn).call(this,{id:e.id,sessionId:e.sessionId??"pageTargetSessionId",method:e.method,error:n})})}close(){chrome.debugger.onEvent.removeListener(o(this,Tg)),chrome.debugger.detach({tabId:o(this,Wl)})}};Wl=new WeakMap,Tg=new WeakMap,vn=new WeakSet,qn=function(t){var e;(e=this.onmessage)==null||e.call(this,JSON.stringify(t))};let tb=kE;const bE=class bE{constructor(t){y(this,cs);H(this,"onmessage");H(this,"onclose");_(this,cs,t),o(this,cs).addEventListener("message",e=>{this.onmessage&&this.onmessage.call(null,e.data)}),o(this,cs).addEventListener("close",()=>{this.onclose&&this.onclose.call(null)}),o(this,cs).addEventListener("error",()=>{})}static create(t){return new Promise((e,n)=>{const a=new WebSocket(t);a.addEventListener("open",()=>e(new bE(a))),a.addEventListener("error",n)})}send(t){o(this,cs).send(t)}close(){o(this,cs).close()}};cs=new WeakMap;let rb=bE;const m6=Object.freeze(Object.defineProperty({__proto__:null,BrowserWebSocketTransport:rb},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const g6=[{name:"Blackberry PlayBook",userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/7.2.1.0 Safari/536.2+",viewport:{width:600,height:1024,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Blackberry PlayBook landscape",userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/7.2.1.0 Safari/536.2+",viewport:{width:1024,height:600,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"BlackBerry Z30",userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/10.0.9.2372 Mobile Safari/537.10+",viewport:{width:360,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"BlackBerry Z30 landscape",userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/10.0.9.2372 Mobile Safari/537.10+",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy Note 3",userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy Note 3 landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy Note II",userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:360,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy Note II landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S III",userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:360,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S III landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S5",userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S5 landscape",userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S8",userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36",viewport:{width:360,height:740,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S8 landscape",userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36",viewport:{width:740,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S9+",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.111 Mobile Safari/537.36",viewport:{width:320,height:658,deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S9+ landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.111 Mobile Safari/537.36",viewport:{width:658,height:320,deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy Tab S4",userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.80 Safari/537.36",viewport:{width:712,height:1138,deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy Tab S4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.80 Safari/537.36",viewport:{width:1138,height:712,deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:768,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1024,height:768,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad (gen 6)",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad (gen 6) landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad (gen 7)",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:810,height:1080,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad (gen 7) landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1080,height:810,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad Mini",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:768,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad Mini landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1024,height:768,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad Pro",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1024,height:1366,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad Pro landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1366,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad Pro 11",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:834,height:1194,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad Pro 11 landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1194,height:834,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 4",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D257 Safari/9537.53",viewport:{width:320,height:480,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 4 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D257 Safari/9537.53",viewport:{width:480,height:320,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 5",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:320,height:568,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 5 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:568,height:320,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 6",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 6 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 6 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 6 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 7",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 7 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 7 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 7 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 8",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 8 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 8 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 8 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone SE",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:320,height:568,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone SE landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:568,height:320,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone X",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone X landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone XR",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1",viewport:{width:414,height:896,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone XR landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1",viewport:{width:896,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 11",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:414,height:828,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 11 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:828,height:414,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 11 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 11 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 11 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:414,height:896,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 11 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:896,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:428,height:926,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:926,height:428,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12 Mini",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 Mini landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:428,height:926,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:926,height:428,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13 Mini",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 Mini landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:390,height:663,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:750,height:340,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:428,height:745,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:832,height:378,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:393,height:659,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:734,height:343,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:430,height:739,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:814,height:380,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:393,height:659,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:734,height:343,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:430,height:739,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:814,height:380,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:393,height:659,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:734,height:343,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:430,height:739,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:814,height:380,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"JioPhone 2",userAgent:"Mozilla/5.0 (Mobile; LYF/F300B/LYF-F300B-001-01-15-130718-i;Android; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/2.5",viewport:{width:240,height:320,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"JioPhone 2 landscape",userAgent:"Mozilla/5.0 (Mobile; LYF/F300B/LYF-F300B-001-01-15-130718-i;Android; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/2.5",viewport:{width:320,height:240,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Kindle Fire HDX",userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:800,height:1280,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Kindle Fire HDX landscape",userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:1280,height:800,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"LG Optimus L70",userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:384,height:640,deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"LG Optimus L70 landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:384,deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Microsoft Lumia 550",userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 550) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Microsoft Lumia 950",userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14263",viewport:{width:360,height:640,deviceScaleFactor:4,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Microsoft Lumia 950 landscape",userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360,deviceScaleFactor:4,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 10",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:800,height:1280,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 10 landscape",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:1280,height:800,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 4",userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:384,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:384,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 5",userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 5 landscape",userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 5X",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:412,height:732,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 5X landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:732,height:412,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 6",userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:412,height:732,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 6 landscape",userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:732,height:412,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 6P",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:412,height:732,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 6P landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:732,height:412,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 7",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:600,height:960,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 7 landscape",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:960,height:600,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nokia Lumia 520",userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:320,height:533,deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nokia Lumia 520 landscape",userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:533,height:320,deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nokia N9",userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:480,height:854,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nokia N9 landscape",userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:854,height:480,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 2",userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:411,height:731,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 2 landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:731,height:411,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 2 XL",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:411,height:823,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 2 XL landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:823,height:411,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 3",userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.158 Mobile Safari/537.36",viewport:{width:393,height:786,deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 3 landscape",userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.158 Mobile Safari/537.36",viewport:{width:786,height:393,deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 4",userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Mobile Safari/537.36",viewport:{width:353,height:745,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Mobile Safari/537.36",viewport:{width:745,height:353,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 4a (5G)",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:353,height:745,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 4a (5G) landscape",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:745,height:353,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 5",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:393,height:851,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 5 landscape",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:851,height:393,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Moto G4",userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Moto G4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}}],dT={};for(const r of g6)dT[r.name]=r;Object.freeze(dT);/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */async function w6(r,t,e){const{acceptInsecureCerts:n=!1,defaultViewport:a=dC}=e,{bidiConnection:i,cdpConnection:s,closeCallback:c}=await v6(r,t,e);return await(await Promise.resolve().then(()=>aP)).BidiBrowser.create({connection:i,cdpConnection:s,closeCallback:c,process:void 0,defaultViewport:a,acceptInsecureCerts:n,capabilities:e.capabilities})}async function v6(r,t,e){const n=await Promise.resolve().then(()=>aP),{slowMo:a=0,protocolTimeout:i}=e,s=new n.BidiConnection(t,r,a,i);try{const h=await s.send("session.status",{});if("type"in h&&h.type==="success")return{bidiConnection:s,closeCallback:async()=>{await s.send("browser.close",{}).catch(Re)}}}catch(h){if(!(h instanceof yc))throw h}s.unbind();const c=new VC(t,r,a,i);if((await c.send("Browser.getVersion")).product.toLowerCase().includes("firefox"))throw new et("Firefox is not supported in BiDi over CDP mode.");const u=await n.connectBidiOverCdp(c);return{cdpConnection:c,bidiConnection:u,closeCallback:async()=>{await c.send("Browser.close").catch(Re)}}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const fT=async()=>cC?(await Promise.resolve().then(()=>Hq)).NodeWebSocketTransport:(await Promise.resolve().then(()=>m6)).BrowserWebSocketTransport;async function y6(r){const{connectionTransport:t,endpointUrl:e}=await x6(r);return r.protocol==="webDriverBiDi"?await w6(t,e,r):await p6(t,e,r)}async function x6(r){const{browserWSEndpoint:t,browserURL:e,transport:n,headers:a={}}=r;if(Ee(+!!t+ +!!e+ +!!n==1,"Exactly one of browserWSEndpoint, browserURL or transport must be passed to puppeteer.connect"),n)return{connectionTransport:n,endpointUrl:""};if(t)return{connectionTransport:await(await fT()).create(t,a),endpointUrl:t};if(e){const i=await k6(e);return{connectionTransport:await(await fT()).create(i),endpointUrl:i}}throw new Error("Invalid connection options")}async function k6(r){const t=new URL("/json/version",r);try{const e=await globalThis.fetch(t.toString(),{method:"GET"});if(!e.ok)throw new Error(`HTTP ${e.statusText}`);return(await e.json()).webSocketDebuggerUrl}catch(e){throw Yn(e)&&(e.message=`Failed to fetch browser webSocket URL from ${t}: `+e.message),e}}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class pT{constructor(t){H(this,"_isPuppeteerCore");H(this,"_changedBrowsers",!1);this._isPuppeteerCore=t.isPuppeteerCore,this.connect=this.connect.bind(this)}static registerCustomQueryHandler(t,e){return this.customQueryHandlers.register(t,e)}static unregisterCustomQueryHandler(t){return this.customQueryHandlers.unregister(t)}static customQueryHandlerNames(){return this.customQueryHandlers.names()}static clearCustomQueryHandlers(){return this.customQueryHandlers.clear()}connect(t){return y6(t)}}H(pT,"customQueryHandlers",Mk);/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const b6=new pT({isPuppeteerCore:!0}),{connect:_6}=b6,mT="BOSS",gT="51JOB",wT="ZHILIAN",vT="LAGOU",yT="LIEPIN",Yw="AUTOMATE_ERROR_UNKNOW",Rs="AUTOMATE_ERROR_HUMAN_VALID",xT="JOB_DATA_UPLOAD",kT="COMPANY_DATA_UPLOAD",bT="COMPANY_TAG_DATA_UPLOAD",_T="JOB_DATA_DOWNLOAD",ET="COMPANY_DATA_DOWNLOAD",ST="COMPANY_TAG_DATA_DOWNLOAD",nb="JOB_DATA_MERGE",ab="COMPANY_DATA_MERGE",ib="COMPANY_TAG_DATA_MERGE",Jw="READY",CT="RUNNING",E6="FINISHED",S6="FINISHED_BUT_ERROR",TT="ERROR",eh=1e7,C6="YYYY-MM-DD HH:mm:ss.SSS",T6={automateFetchJobItemData:async function(r,t){try{let e=await A6(t);pc(r,e)}catch(e){Wa(r,"[background] automateFetchJobItemData error : "+e.message)}}},th=new Map;th.set(gT,F6),th.set(mT,P6),th.set(wT,D6),th.set(vT,O6),th.set(yT,I6);async function A6({url:r,platform:t,delay:e,delayRandomRange:n,maxPage:a}){let i=await chrome.windows.create({url:r,width:800,height:600});const s=i.tabs[0];lt(`[puppeteer] create tab id = ${s.id}`);const c=await _6({transport:await tb.connectTab(s.id)}),[l]=await c.pages();try{const u=th.get(t);if(lt(`[puppeteer] get job item page handle function platform = ${t}`),u){const h=new Date,d=await u(s,l,t,e,n,a);return d.startDatetime=h,d.endDatetime=new Date,d}else throw`not support platform = ${t}`}finally{l&&l.close(),i&&chrome.windows.remove(i.id)}}function pt(r,t){lt(t),r.push(`${kt(new Date).format(C6)} ${t}`)}async function F6(r,t,e,n,a,i){const s=[],c=[];let l=null,u=1;try{if(pt(s,`[puppeteer] [${e}] handle _51jobHandle`),await t.waitForSelector(".btn-next",{timeout:5e3})){for(;;){await t.waitForSelector(".__status_job_render_finish");let d=await t.waitForSelector(".btn-next");if(c.push(await t.screenshot({encoding:"base64",fullPage:!0})),u++,i&&i>0&&u>i){pt(s,`[puppeteer] [${e}] page(${u}) over maxPage(${i})`);break}if(await(await d.getProperty("disabled")).jsonValue()){pt(s,`[puppeteer] [${e}] is last page`),pt(s,`[puppeteer] [${e}] close page tab id = ${r.id}`);break}else pt(s,`[puppeteer] [${e}] has next page tab id = ${r.id}`),pt(s,`[puppeteer] [${e}] will go to page no = ${u}`),await f0(n,a),await d.click(),pt(s,`[puppeteer] [${e}] go to page no = ${u}`)}return{logList:s,count:u,error:l,screenshotList:c}}else await chrome.tabs.reload(r.id)}catch(h){return Gn(h),pt(s,`[puppeteer] [${e}] handle has error`),l=await rh(e,t)?Rs:Yw,c.push(await t.screenshot({encoding:"base64",fullPage:!0})),{logList:s,count:u,error:l,screenshotList:c}}}async function P6(r,t,e,n,a,i){const s=[],c=[];let l=null,u=1;try{if(pt(s,`[puppeteer] [${e}] handle _bossHandle`),await t.waitForNavigation(),l=await rh(e,t)?Rs:null,l==Rs)throw"navigate to human valid page";try{await t.waitForSelector(".__status_job_render_finish",{timeout:5e3})}catch{await chrome.tabs.reload(r.id),await t.waitForSelector(".__status_job_render_finish")}for(;;){await t.waitForSelector(".__status_job_render_finish");let h=await t.waitForSelector(".ui-icon-arrow-right");if(c.push(await t.screenshot({encoding:"base64",fullPage:!0})),u++,i&&i>0&&u>i){pt(s,`[puppeteer] [${e}] page(${u}) over maxPage(${i})`);break}if(await t.evaluate(()=>{var m;const f=(m=document.querySelector(".ui-icon-arrow-right"))==null?void 0:m.parentElement;return(f==null?void 0:f.className)=="disabled"})){pt(s,`[puppeteer] [${e}] is last page`),pt(s,`[puppeteer] [${e}] close page tab id = ${r.id}`);break}else pt(s,`[puppeteer] [${e}] has next page tab id = ${r.id}`),pt(s,`[puppeteer] [${e}] will go to page no = ${u}`),await f0(n,a),await t.evaluate(f=>{f.click()},h),pt(s,`[puppeteer] [${e}] go to page no = ${u}`)}return{logList:s,count:u,error:l,screenshotList:c}}catch(h){return Gn(h),pt(s,`[puppeteer] [${e}] handle has error`),l=await rh(e,t)?Rs:Yw,c.push(await t.screenshot({encoding:"base64",fullPage:!0})),{logList:s,count:u,error:l,screenshotList:c}}}async function I6(r,t,e,n,a,i){const s=[],c=[];let l=null,u=1;try{if(pt(s,`[puppeteer] [${e}] handle _liepinHandle`),await t.waitForNavigation(),l=await rh(e,t)?Rs:null,l==Rs)throw"navigate to human valid page";for(await t.waitForSelector(".__status_job_render_finish");;){await t.waitForSelector(".__status_job_render_finish");let h=await t.waitForSelector(".anticon-right");if(c.push(await t.screenshot({encoding:"base64",fullPage:!0})),u++,i&&i>0&&u>i){pt(s,`[puppeteer] [${e}] page(${u}) over maxPage(${i})`);break}if(await t.evaluate(()=>document.querySelector(".anticon-right").parentElement.disabled)){pt(s,`[puppeteer] [${e}] is last page`),pt(s,`[puppeteer] [${e}] close page tab id = ${r.id}`);break}else pt(s,`[puppeteer] [${e}] has next page tab id = ${r.id}`),pt(s,`[puppeteer] [${e}] will go to page no = ${u}`),await f0(n,a),await h.click(),pt(s,`[puppeteer] [${e}] go to page no = ${u}`)}return{logList:s,count:u,error:l,screenshotList:c}}catch(h){return Gn(h),pt(s,`[puppeteer] [${e}] handle has error`),l=await rh(e,t)?Rs:Yw,c.push(await t.screenshot({encoding:"base64",fullPage:!0})),{logList:s,count:u,error:l,screenshotList:c}}}async function D6(r,t,e,n,a,i){return AT(r,t,e,n,a,i,{nextButtonSelector:".btn ::-p-text(下一页)",lastPageButtonSelector:"a.btn.soupager__btn.soupager__btn--disable"})}async function O6(r,t,e,n,a,i){return AT(r,t,e,n,a,i,{nextButtonSelector:".lg-pagination-next",lastPageButtonSelector:"li.lg-pagination-next.lg-pagination-disabled"})}async function AT(r,t,e,n,a,i,{nextButtonSelector:s,lastPageButtonSelector:c}){const l=[],u=[];let h=null,d=1;try{pt(l,`[puppeteer] [${e}] handle _handle`);try{await t.waitForNavigation({timeout:5e3})}catch{pt(l,`[puppeteer] [${e}] waitForNavigation error`)}for(;;){await t.waitForSelector(".__status_job_render_finish");let f=await t.waitForSelector(`${s}`);if(u.push(await t.screenshot({encoding:"base64",fullPage:!0})),d++,i&&i>0&&d>i){pt(l,`[puppeteer] [${e}] page(${d}) over maxPage(${i})`);break}if(f.remoteObject().description==`${c}`){pt(l,`[puppeteer] [${e}] is last page`),pt(l,`[puppeteer] [${e}] close page tab id = ${r.id}`);break}else pt(l,`[puppeteer] [${e}] has next page tab id = ${r.id}`),pt(l,`[puppeteer] [${e}] will go to page no = ${d}`),f=await t.waitForSelector(`${s}`),await f0(n,a),await f.click(),pt(l,`[puppeteer] [${e}] go to page no = ${d}`)}return{logList:l,count:d,error:h,screenshotList:u}}catch(f){return Gn(f),pt(l,`[puppeteer] [${e}] handle has error`),h=await rh(e,t)?Rs:Yw,u.push(await t.screenshot({encoding:"base64",fullPage:!0})),{logList:l,count:d,error:h,screenshotList:u}}}async function rh(r,t){try{if(r==mT)return t.url().startsWith("https://www.zhipin.com/web/user/safe/verify-slider");if(r==gT)return!!await t.waitForSelector(".waf-nc-wrapper",{timeout:5e3});if(r==wT)return!!await t.waitForSelector(".__status_job_render_error",{timeout:5e3});if(r==vT)return!1;if(r==yT)return!1;throw`checkValidHuman unknow platform ${r}`}catch{return!1}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var FT=1252,M6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ob=function(r){M6.indexOf(r)!=-1&&(FT=sb[0]=r)};function R6(){ob(1252)}var ka=function(r){ob(r)};function cb(){ka(1200),R6()}function PT(r){for(var t=[],e=0,n=r.length;e<n;++e)t[e]=r.charCodeAt(e);return t}function N6(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e)+(r.charCodeAt(2*e+1)<<8));return t.join("")}function IT(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e+1)+(r.charCodeAt(2*e)<<8));return t.join("")}var F0=function(r){var t=r.charCodeAt(0),e=r.charCodeAt(1);return t==255&&e==254?N6(r.slice(2)):t==254&&e==255?IT(r.slice(2)):t==65279?r.slice(1):r},Zw=function(t){return String.fromCharCode(t)},DT=function(t){return String.fromCharCode(t)},Ns,Ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function OT(r){for(var t="",e=0,n=0,a=0,i=0,s=0,c=0,l=0,u=0;u<r.length;)e=r.charCodeAt(u++),i=e>>2,n=r.charCodeAt(u++),s=(e&3)<<4|n>>4,a=r.charCodeAt(u++),c=(n&15)<<2|a>>6,l=a&63,isNaN(n)?c=l=64:isNaN(a)&&(l=64),t+=Ls.charAt(i)+Ls.charAt(s)+Ls.charAt(c)+Ls.charAt(l);return t}function On(r){var t="",e=0,n=0,a=0,i=0,s=0,c=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<r.length;)i=Ls.indexOf(r.charAt(u++)),s=Ls.indexOf(r.charAt(u++)),e=i<<2|s>>4,t+=String.fromCharCode(e),c=Ls.indexOf(r.charAt(u++)),n=(s&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),l=Ls.indexOf(r.charAt(u++)),a=(c&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var ot=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Sc=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Bs(r){return ot?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function MT(r){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Zn=function(t){return ot?Sc(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Qw(r){if(typeof ArrayBuffer>"u")return Zn(r);for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),n=0;n!=r.length;++n)e[n]=r.charCodeAt(n)&255;return t}function Us(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],e=0;e<r.length;++e)t[e]=String.fromCharCode(r[e]);return t.join("")}function L6(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function lb(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return lb(new Uint8Array(r));for(var t=new Array(r.length),e=0;e<r.length;++e)t[e]=r[e];return t}var $s=ot?function(r){return Buffer.concat(r.map(function(t){return Buffer.isBuffer(t)?t:Sc(t)}))}:function(r){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<r.length;++t)e+=r[t].length;var n=new Uint8Array(e),a=0;for(t=0,e=0;t<r.length;e+=a,++t)if(a=r[t].length,r[t]instanceof Uint8Array)n.set(r[t],e);else{if(typeof r[t]=="string")throw"wtf";n.set(new Uint8Array(r[t]),e)}return n}return[].concat.apply([],r.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function B6(r){for(var t=[],e=0,n=r.length+250,a=Bs(r.length+255),i=0;i<r.length;++i){var s=r.charCodeAt(i);if(s<128)a[e++]=s;else if(s<2048)a[e++]=192|s>>6&31,a[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var c=r.charCodeAt(++i)&1023;a[e++]=240|s>>8&7,a[e++]=128|s>>2&63,a[e++]=128|c>>6&15|(s&3)<<4,a[e++]=128|c&63}else a[e++]=224|s>>12&15,a[e++]=128|s>>6&63,a[e++]=128|s&63;e>n&&(t.push(a.slice(0,e)),e=0,a=Bs(65535),n=65530)}return t.push(a.slice(0,e)),$s(t)}var hn=/\u0000/g,P0=/[\u0001-\u0006]/g;function nh(r){for(var t="",e=r.length-1;e>=0;)t+=r.charAt(e--);return t}function ba(r,t){var e=""+r;return e.length>=t?e:qt("0",t-e.length)+e}function ub(r,t){var e=""+r;return e.length>=t?e:qt(" ",t-e.length)+e}function ev(r,t){var e=""+r;return e.length>=t?e:e+qt(" ",t-e.length)}function U6(r,t){var e=""+Math.round(r);return e.length>=t?e:qt("0",t-e.length)+e}function $6(r,t){var e=""+r;return e.length>=t?e:qt("0",t-e.length)+e}var RT=Math.pow(2,32);function ah(r,t){if(r>RT||r<-RT)return U6(r,t);var e=Math.round(r);return $6(e,t)}function tv(r,t){return t=t||0,r.length>=7+t&&(r.charCodeAt(t)|32)===103&&(r.charCodeAt(t+1)|32)===101&&(r.charCodeAt(t+2)|32)===110&&(r.charCodeAt(t+3)|32)===101&&(r.charCodeAt(t+4)|32)===114&&(r.charCodeAt(t+5)|32)===97&&(r.charCodeAt(t+6)|32)===108}var NT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function j6(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',r}var Xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},LT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},H6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rv(r,t,e){for(var n=r<0?-1:1,a=r*n,i=0,s=1,c=0,l=1,u=0,h=0,d=Math.floor(a);u<t&&(d=Math.floor(a),c=d*s+i,h=d*u+l,!(a-d<5e-8));)a=1/(a-d),i=s,s=c,l=u,u=h;if(h>t&&(u>t?(h=l,c=i):(h=u,c=s)),!e)return[0,n*c,h];var f=Math.floor(n*c/h);return[f,n*c-f*h,h]}function Cc(r,t,e){if(r>2958465||r<0)return null;var n=r|0,a=Math.floor(86400*(r-n)),i=0,s=[],c={D:n,T:a,u:86400*(r-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)s=e?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=e?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),e&&(i=G6(l,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var BT=new Date(1899,11,31,0,0,0),W6=BT.getTime(),z6=new Date(1900,2,1,0,0,0);function UT(r,t){var e=r.getTime();return t?e-=1461*24*60*60*1e3:r>=z6&&(e+=24*60*60*1e3),(e-(W6+(r.getTimezoneOffset()-BT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function db(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function K6(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function V6(r){var t=r<0?12:11,e=db(r.toFixed(12));return e.length<=t||(e=r.toPrecision(10),e.length<=t)?e:r.toExponential(5)}function q6(r){var t=db(r.toFixed(11));return t.length>(r<0?12:11)||t==="0"||t==="-0"?r.toPrecision(6):t}function I0(r){var t=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),e;return t>=-4&&t<=-1?e=r.toPrecision(10+t):Math.abs(t)<=9?e=V6(r):t===10?e=r.toFixed(10).substr(0,12):e=q6(r),db(K6(e.toUpperCase()))}function Tc(r,t){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):I0(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ea(14,UT(r,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+r)}function G6(r,t){t[0]-=581;var e=r.getDay();return r<60&&(e=(e+6)%7),e}function X6(r,t,e,n){var a="",i=0,s=0,c=e.y,l,u=0;switch(r){case 98:c=e.y+543;case 121:switch(t.length){case 1:case 2:l=c%100,u=2;break;default:l=c%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=e.m,u=t.length;break;case 3:return hb[e.m-1][1];case 5:return hb[e.m-1][0];default:return hb[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=e.d,u=t.length;break;case 3:return NT[e.q][0];default:return NT[e.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(e.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=e.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=e.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?ba(e.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(e.S+e.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=ba(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=c,u=1;break}var h=u>0?ba(l,u):"";return h}function js(r){var t=3;if(r.length<=t)return r;for(var e=r.length%t,n=r.substr(0,e);e!=r.length;e+=t)n+=(n.length>0?",":"")+r.substr(e,t);return n}var $T=/%/g;function Y6(r,t,e){var n=t.replace($T,""),a=t.length-n.length;return Bi(r,n,e*Math.pow(10,2*a))+qt("%",a)}function J6(r,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Bi(r,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function jT(r,t){var e,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+jT(r,-t);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),e.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+i):e+="E+"+(s-i);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,h){return l+u+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else e=t.toExponential(n);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var HT=/# (\?+)( ?)\/( ?)(\d+)/;function Z6(r,t,e){var n=parseInt(r[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,c=n;return e+(i===0?"":""+i)+" "+(s===0?qt(" ",r[1].length+1+r[4].length):ub(s,r[1].length)+r[2]+"/"+r[3]+ba(c,r[4].length))}function Q6(r,t,e){return e+(t===0?"":""+t)+qt(" ",r[1].length+2+r[4].length)}var WT=/^#*0*\.([0#]+)/,zT=/\).*[0#]/,KT=/\(###\) ###\\?-####/;function dn(r){for(var t="",e,n=0;n!=r.length;++n)switch(e=r.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function VT(r,t){var e=Math.pow(10,t);return""+Math.round(r*e)/e}function qT(r,t){var e=r-Math.floor(r),n=Math.pow(10,t);return t<(""+Math.round(e*n)).length?0:Math.round(e*n)}function eN(r,t){return t<(""+Math.round((r-Math.floor(r))*Math.pow(10,t))).length?1:0}function tN(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Qn(r,t,e){if(r.charCodeAt(0)===40&&!t.match(zT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Qn("n",n,e):"("+Qn("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return J6(r,t,e);if(t.indexOf("%")!==-1)return Y6(r,t,e);if(t.indexOf("E")!==-1)return jT(t,e);if(t.charCodeAt(0)===36)return"$"+Qn(r,t.substr(t.charAt(1)==" "?2:1),e);var a,i,s,c,l=Math.abs(e),u=e<0?"-":"";if(t.match(/^00+$/))return u+ah(l,t.length);if(t.match(/^[#?]+$/))return a=ah(e,0),a==="0"&&(a=""),a.length>t.length?a:dn(t.substr(0,t.length-a.length))+a;if(i=t.match(HT))return Z6(i,l,u);if(t.match(/^#+0+$/))return u+ah(l,t.length-t.indexOf("0"));if(i=t.match(WT))return a=VT(e,i[1].length).replace(/^([^\.]+)$/,"$1."+dn(i[1])).replace(/\.$/,"."+dn(i[1])).replace(/\.(\d*)$/,function(w,p){return"."+p+qt("0",dn(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+VT(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+js(ah(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Qn(r,t,-e):js(""+(Math.floor(e)+eN(e,i[1].length)))+"."+ba(qT(e,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Qn(r,t.replace(/^#,#*,/,""),e);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=nh(Qn(r,t.replace(/[\\-]/g,""),e)),s=0,nh(nh(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return s<a.length?a.charAt(s++):w==="0"?"0":""}));if(t.match(KT))return a=Qn(r,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=rv(l,Math.pow(10,s)-1,!1),a=""+u,h=Bi("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=ev(c[2],s),h.length<i[4].length&&(h=dn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=rv(l,Math.pow(10,s)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ub(c[1],s)+i[2]+"/"+i[3]+ev(c[2],s):qt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=ah(e,0),t.length<=a.length?a:dn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,f=t.length-a.length-d;return dn(t.substr(0,d)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=qT(e,i[1].length),e<0?"-"+Qn(r,t,-e):js(tN(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ba(0,3-w.length):"")+w})+"."+ba(s,i[1].length);switch(t){case"###,##0.00":return Qn(r,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var m=js(ah(l,0));return m!=="0"?u+m:"";case"###,###.00":return Qn(r,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Qn(r,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function rN(r,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Bi(r,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function nN(r,t,e){var n=t.replace($T,""),a=t.length-n.length;return Bi(r,n,e*Math.pow(10,2*a))+qt("%",a)}function GT(r,t){var e,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GT(r,-t);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!e.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+i):e+="E+"+(s-i),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,h){return l+u+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else e=t.toExponential(n);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Za(r,t,e){if(r.charCodeAt(0)===40&&!t.match(zT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Za("n",n,e):"("+Za("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return rN(r,t,e);if(t.indexOf("%")!==-1)return nN(r,t,e);if(t.indexOf("E")!==-1)return GT(t,e);if(t.charCodeAt(0)===36)return"$"+Za(r,t.substr(t.charAt(1)==" "?2:1),e);var a,i,s,c,l=Math.abs(e),u=e<0?"-":"";if(t.match(/^00+$/))return u+ba(l,t.length);if(t.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>t.length?a:dn(t.substr(0,t.length-a.length))+a;if(i=t.match(HT))return Q6(i,l,u);if(t.match(/^#+0+$/))return u+ba(l,t.length-t.indexOf("0"));if(i=t.match(WT))return a=(""+e).replace(/^([^\.]+)$/,"$1."+dn(i[1])).replace(/\.$/,"."+dn(i[1])),a=a.replace(/\.(\d*)$/,function(w,p){return"."+p+qt("0",dn(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+js(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Za(r,t,-e):js(""+e)+"."+qt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Za(r,t.replace(/^#,#*,/,""),e);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=nh(Za(r,t.replace(/[\\-]/g,""),e)),s=0,nh(nh(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return s<a.length?a.charAt(s++):w==="0"?"0":""}));if(t.match(KT))return a=Za(r,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=rv(l,Math.pow(10,s)-1,!1),a=""+u,h=Bi("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=ev(c[2],s),h.length<i[4].length&&(h=dn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=rv(l,Math.pow(10,s)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ub(c[1],s)+i[2]+"/"+i[3]+ev(c[2],s):qt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+e,t.length<=a.length?a:dn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,f=t.length-a.length-d;return dn(t.substr(0,d)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Za(r,t,-e):js(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ba(0,3-w.length):"")+w})+"."+ba(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=js(""+l);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Za(r,t.slice(0,t.lastIndexOf(".")),e)+dn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Bi(r,t,e){return(e|0)===e?Za(r,t,e):Qn(r,t,e)}function aN(r){for(var t=[],e=!1,n=0,a=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=r.substr(a,n-a),a=n+1}if(t[t.length]=r.substr(a),e===!0)throw new Error("Format |"+r+"| unterminated string ");return t}var XT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ih(r){for(var t=0,e="",n="";t<r.length;)switch(e=r.charAt(t)){case"G":tv(r,t)&&(t+=6),t++;break;case'"':for(;r.charCodeAt(++t)!==34&&t<r.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(r.charAt(t+1)==="1"||r.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(r.substr(t,3).toUpperCase()==="A/P"||r.substr(t,5).toUpperCase()==="AM/PM"||r.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=e;r.charAt(t++)!=="]"&&t<r.length;)n+=r.charAt(t);if(n.match(XT))return!0;break;case".":case"0":case"#":for(;t<r.length&&("0#?.,E+-%".indexOf(e=r.charAt(++t))>-1||e=="\\"&&r.charAt(t+1)=="-"&&"0#".indexOf(r.charAt(t+2))>-1););break;case"?":for(;r.charAt(++t)===e;);break;case"*":++t,(r.charAt(t)==" "||r.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<r.length&&"0123456789".indexOf(r.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function iN(r,t,e,n){for(var a=[],i="",s=0,c="",l="t",u,h,d,f="H";s<r.length;)switch(c=r.charAt(s)){case"G":if(!tv(r,s))throw new Error("unrecognized character "+c+" in "+r);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=r.charCodeAt(++s))!==34&&s<r.length;)i+=String.fromCharCode(d);a[a.length]={t:"t",v:i},++s;break;case"\\":var m=r.charAt(++s),w=m==="("||m===")"?m:"t";a[a.length]={t:w,v:m},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(r.charAt(s+1)==="1"||r.charAt(s+1)==="2"){if(u==null&&(u=Cc(t,e,r.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:r.substr(s,2)},l=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Cc(t,e),u==null))return"";for(i=c;++s<r.length&&r.charAt(s).toLowerCase()===c;)i+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=f),a[a.length]={t:c,v:i},l=c;break;case"A":case"a":case"上":var p={t:c,v:c};if(u==null&&(u=Cc(t,e)),r.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",f="h",s+=3):r.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",s+=5,f="h"):r.substr(s,5).toUpperCase()==="上午/下午"?(u!=null&&(p.v=u.H>=12?"下午":"上午"),p.t="T",s+=5,f="h"):(p.t="t",++s),u==null&&p.t==="T")return"";a[a.length]=p,l=c;break;case"[":for(i=c;r.charAt(s++)!=="]"&&s<r.length;)i+=r.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(XT)){if(u==null&&(u=Cc(t,e),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",ih(r)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=c;++s<r.length&&(c=r.charAt(s))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<r.length&&"0#?.,E+-%".indexOf(c=r.charAt(s))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;r.charAt(++s)===c;)i+=c;a[a.length]={t:c,v:i},l=c;break;case"*":++s,(r.charAt(s)==" "||r.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<r.length&&"0123456789".indexOf(r.charAt(++s))>-1;)i+=r.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+r);a[a.length]={t:"t",v:c},++s;break}var g=0,v=0,k;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=f,l="h",g<1&&(g=1);break;case"s":(k=a[s].v.match(/\.0+$/))&&(v=Math.max(v,k[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[s].v.match(/[Hh]/)&&(g=1),g<2&&a[s].v.match(/[Mm]/)&&(g=2),g<3&&a[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",S;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=X6(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(S=s+1;a[S]!=null&&((c=a[S].t)==="?"||c==="D"||(c===" "||c==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[s].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[s].v+=a[S].v,a[S]={v:"",t:";"},++S;x+=a[s].v,s=S-1;break;case"G":a[s].t="t",a[s].v=Tc(t,e);break}var I="",O,E;if(x.length>0){x.charCodeAt(0)==40?(O=t<0&&x.charCodeAt(0)===45?-t:t,E=Bi("n",x,O)):(O=t<0&&n>1?-t:t,E=Bi("n",x,O),O<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),S=E.length-1;var T=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){T=s;break}var P=a.length;if(T===a.length&&E.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(S>=a[s].v.length-1?(S-=a[s].v.length,a[s].v=E.substr(S+1,a[s].v.length)):S<0?a[s].v="":(a[s].v=E.substr(0,S+1),S=-1),a[s].t="t",P=s);S>=0&&P<a.length&&(a[P].v=E.substr(0,S+1)+a[P].v)}else if(T!==a.length&&E.indexOf("E")===-1){for(S=E.indexOf(".")-1,s=T;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===T?a[s].v.indexOf(".")-1:a[s].v.length-1,I=a[s].v.substr(h+1);h>=0;--h)S>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(I=E.charAt(S--)+I);a[s].v=I,a[s].t="t",P=s}for(S>=0&&P<a.length&&(a[P].v=E.substr(0,S+1)+a[P].v),S=E.indexOf(".")+1,s=T;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==T)){for(h=a[s].v.indexOf(".")>-1&&s===T?a[s].v.indexOf(".")+1:0,I=a[s].v.substr(0,h);h<a[s].v.length;++h)S<E.length&&(I+=E.charAt(S++));a[s].v=I,a[s].t="t",P=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(O=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Bi(a[s].t,a[s].v,O),a[s].t="t");var W="";for(s=0;s!==a.length;++s)a[s]!=null&&(W+=a[s].v);return W}var YT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function JT(r,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(r==e)return!0;break;case">":if(r>e)return!0;break;case"<":if(r<e)return!0;break;case"<>":if(r!=e)return!0;break;case">=":if(r>=e)return!0;break;case"<=":if(r<=e)return!0;break}return!1}function sN(r,t){var e=aN(r),n=e.length,a=e[n-1].indexOf("@");if(n<4&&a>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var i=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,i];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(YT),c=e[1].match(YT);return JT(t,s)?[n,e[0]]:JT(t,c)?[n,e[1]]:[n,e[s!=null&&c!=null?2:1]]}return[n,i]}function ea(r,t,e){e==null&&(e={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&e.dateNF?n=e.dateNF:n=r;break;case"number":r==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:Xe)[r],n==null&&(n=e.table&&e.table[LT[r]]||Xe[LT[r]]),n==null&&(n=H6[r]||"General");break}if(tv(n,0))return Tc(t,e);t instanceof Date&&(t=UT(t,e.date1904));var a=sN(n,t);if(tv(a[1]))return Tc(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return iN(a[1],t,e,a[0])}function Ui(r,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(Xe[e]==null){t<0&&(t=e);continue}if(Xe[e]==r){t=e;break}}t<0&&(t=391)}return Xe[t]=r,t}function oN(r){for(var t=0;t!=392;++t)r[t]!==void 0&&Ui(r[t],t)}function fb(){Xe=j6()}var cN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ZT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function lN(r){var t=typeof r=="number"?Xe[r]:r;return t=t.replace(ZT,"(\\d+)"),new RegExp("^"+t+"$")}function uN(r,t,e){var n=-1,a=-1,i=-1,s=-1,c=-1,l=-1;(t.match(ZT)||[]).forEach(function(d,f){var m=parseInt(e[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":s=m;break;case"s":l=m;break;case"m":s>=0?c=m:a=m;break}}),l>=0&&c==-1&&a>=0&&(c=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&c==-1&&l==-1?u:n==-1&&a==-1&&i==-1?h:u+"T"+h}var hN=function(){var r={};r.version="1.2.0";function t(){for(var E=0,T=new Array(256),P=0;P!=256;++P)E=P,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,T[P]=E;return typeof Int32Array<"u"?new Int32Array(T):T}var e=t();function n(E){var T=0,P=0,W=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)U[W]=E[W];for(W=0;W!=256;++W)for(P=E[W],T=256+W;T<4096;T+=256)P=U[T]=P>>>8^E[P&255];var A=[];for(W=1;W!=16;++W)A[W-1]=typeof Int32Array<"u"?U.subarray(W*256,W*256+256):U.slice(W*256,W*256+256);return A}var a=n(e),i=a[0],s=a[1],c=a[2],l=a[3],u=a[4],h=a[5],d=a[6],f=a[7],m=a[8],w=a[9],p=a[10],g=a[11],v=a[12],k=a[13],x=a[14];function S(E,T){for(var P=T^-1,W=0,U=E.length;W<U;)P=P>>>8^e[(P^E.charCodeAt(W++))&255];return~P}function I(E,T){for(var P=T^-1,W=E.length-15,U=0;U<W;)P=x[E[U++]^P&255]^k[E[U++]^P>>8&255]^v[E[U++]^P>>16&255]^g[E[U++]^P>>>24]^p[E[U++]]^w[E[U++]]^m[E[U++]]^f[E[U++]]^d[E[U++]]^h[E[U++]]^u[E[U++]]^l[E[U++]]^c[E[U++]]^s[E[U++]]^i[E[U++]]^e[E[U++]];for(W+=15;U<W;)P=P>>>8^e[(P^E[U++])&255];return~P}function O(E,T){for(var P=T^-1,W=0,U=E.length,A=0,N=0;W<U;)A=E.charCodeAt(W++),A<128?P=P>>>8^e[(P^A)&255]:A<2048?(P=P>>>8^e[(P^(192|A>>6&31))&255],P=P>>>8^e[(P^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,N=E.charCodeAt(W++)&1023,P=P>>>8^e[(P^(240|A>>8&7))&255],P=P>>>8^e[(P^(128|A>>2&63))&255],P=P>>>8^e[(P^(128|N>>6&15|(A&3)<<4))&255],P=P>>>8^e[(P^(128|N&63))&255]):(P=P>>>8^e[(P^(224|A>>12&15))&255],P=P>>>8^e[(P^(128|A>>6&63))&255],P=P>>>8^e[(P^(128|A&63))&255]);return~P}return r.table=e,r.bstr=S,r.buf=I,r.str=O,r}(),it=function(){var t={};t.version="1.2.1";function e(B,Y){for(var V=B.split("/"),G=Y.split("/"),J=0,Z=0,fe=Math.min(V.length,G.length);J<fe;++J){if(Z=V[J].length-G[J].length)return Z;if(V[J]!=G[J])return V[J]<G[J]?-1:1}return V.length-G.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var Y=B.lastIndexOf("/");return Y===-1?B:B.slice(0,Y+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var Y=B.lastIndexOf("/");return Y===-1?B:B.slice(Y+1)}function i(B,Y){typeof Y=="string"&&(Y=new Date(Y));var V=Y.getHours();V=V<<6|Y.getMinutes(),V=V<<5|Y.getSeconds()>>>1,B.write_shift(2,V);var G=Y.getFullYear()-1980;G=G<<4|Y.getMonth()+1,G=G<<5|Y.getDate(),B.write_shift(2,G)}function s(B){var Y=B.read_shift(2)&65535,V=B.read_shift(2)&65535,G=new Date,J=V&31;V>>>=5;var Z=V&15;V>>>=4,G.setMilliseconds(0),G.setFullYear(V+1980),G.setMonth(Z-1),G.setDate(J);var fe=Y&31;Y>>>=5;var xe=Y&63;return Y>>>=6,G.setHours(Y),G.setMinutes(xe),G.setSeconds(fe<<1),G}function c(B){zr(B,0);for(var Y={},V=0;B.l<=B.length-4;){var G=B.read_shift(2),J=B.read_shift(2),Z=B.l+J,fe={};switch(G){case 21589:V=B.read_shift(1),V&1&&(fe.mtime=B.read_shift(4)),J>5&&(V&2&&(fe.atime=B.read_shift(4)),V&4&&(fe.ctime=B.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}B.l=Z,Y[G]=fe}return Y}var l;function u(){return l||(l={})}function h(B,Y){if(B[0]==80&&B[1]==75)return Sx(B,Y);if((B[0]|32)==109&&(B[1]|32)==105)return Gq(B,Y);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var V=3,G=512,J=0,Z=0,fe=0,xe=0,de=0,pe=[],me=B.slice(0,512);zr(me,0);var Te=d(me);switch(V=Te[0],V){case 3:G=512;break;case 4:G=4096;break;case 0:if(Te[1]==0)return Sx(B,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}G!==512&&(me=B.slice(0,G),zr(me,28));var Ie=B.slice(0,G);f(me,V);var Ne=me.read_shift(4,"i");if(V===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);me.l+=4,fe=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),xe=me.read_shift(4,"i"),J=me.read_shift(4,"i"),de=me.read_shift(4,"i"),Z=me.read_shift(4,"i");for(var Ae=-1,Me=0;Me<109&&(Ae=me.read_shift(4,"i"),!(Ae<0));++Me)pe[Me]=Ae;var Qe=m(B,G);g(de,Z,Qe,G,pe);var Kt=k(Qe,fe,pe,G);Kt[fe].name="!Directory",J>0&&xe!==N&&(Kt[xe].name="!MiniFAT"),Kt[pe[0]].name="!FAT",Kt.fat_addrs=pe,Kt.ssz=G;var Vt={},ln=[],Z1=[],Q1=[];x(fe,Kt,Qe,ln,J,Vt,Z1,xe),w(Z1,Q1,ln),ln.shift();var ew={FileIndex:Z1,FullPaths:Q1};return Y&&Y.raw&&(ew.raw={header:Ie,sectors:Qe}),ew}function d(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(C,"Header Signature: "),B.l+=16;var Y=B.read_shift(2,"u");return[B.read_shift(2,"u"),Y]}function f(B,Y){var V=9;switch(B.l+=2,V=B.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function m(B,Y){for(var V=Math.ceil(B.length/Y)-1,G=[],J=1;J<V;++J)G[J-1]=B.slice(J*Y,(J+1)*Y);return G[V-1]=B.slice(V*Y),G}function w(B,Y,V){for(var G=0,J=0,Z=0,fe=0,xe=0,de=V.length,pe=[],me=[];G<de;++G)pe[G]=me[G]=G,Y[G]=V[G];for(;xe<me.length;++xe)G=me[xe],J=B[G].L,Z=B[G].R,fe=B[G].C,pe[G]===G&&(J!==-1&&pe[J]!==J&&(pe[G]=pe[J]),Z!==-1&&pe[Z]!==Z&&(pe[G]=pe[Z])),fe!==-1&&(pe[fe]=G),J!==-1&&G!=pe[G]&&(pe[J]=pe[G],me.lastIndexOf(J)<xe&&me.push(J)),Z!==-1&&G!=pe[G]&&(pe[Z]=pe[G],me.lastIndexOf(Z)<xe&&me.push(Z));for(G=1;G<de;++G)pe[G]===G&&(Z!==-1&&pe[Z]!==Z?pe[G]=pe[Z]:J!==-1&&pe[J]!==J&&(pe[G]=pe[J]));for(G=1;G<de;++G)if(B[G].type!==0){if(xe=G,xe!=pe[xe])do xe=pe[xe],Y[G]=Y[xe]+"/"+Y[G];while(xe!==0&&pe[xe]!==-1&&xe!=pe[xe]);pe[G]=-1}for(Y[0]+="/",G=1;G<de;++G)B[G].type!==2&&(Y[G]+="/")}function p(B,Y,V){for(var G=B.start,J=B.size,Z=[],fe=G;V&&J>0&&fe>=0;)Z.push(Y.slice(fe*A,fe*A+A)),J-=A,fe=Ic(V,fe*4);return Z.length===0?mr(0):$s(Z).slice(0,B.size)}function g(B,Y,V,G,J){var Z=N;if(B===N){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var fe=V[B],xe=(G>>>2)-1;if(!fe)return;for(var de=0;de<xe&&(Z=Ic(fe,de*4))!==N;++de)J.push(Z);g(Ic(fe,G-4),Y-1,V,G,J)}}function v(B,Y,V,G,J){var Z=[],fe=[];J||(J=[]);var xe=G-1,de=0,pe=0;for(de=Y;de>=0;){J[de]=!0,Z[Z.length]=de,fe.push(B[de]);var me=V[Math.floor(de*4/G)];if(pe=de*4&xe,G<4+pe)throw new Error("FAT boundary crossed: "+de+" 4 "+G);if(!B[me])break;de=Ic(B[me],pe)}return{nodes:Z,data:xA([fe])}}function k(B,Y,V,G){var J=B.length,Z=[],fe=[],xe=[],de=[],pe=G-1,me=0,Te=0,Ie=0,Ne=0;for(me=0;me<J;++me)if(xe=[],Ie=me+Y,Ie>=J&&(Ie-=J),!fe[Ie]){de=[];var Ae=[];for(Te=Ie;Te>=0;){Ae[Te]=!0,fe[Te]=!0,xe[xe.length]=Te,de.push(B[Te]);var Me=V[Math.floor(Te*4/G)];if(Ne=Te*4&pe,G<4+Ne)throw new Error("FAT boundary crossed: "+Te+" 4 "+G);if(!B[Me]||(Te=Ic(B[Me],Ne),Ae[Te]))break}Z[Ie]={nodes:xe,data:xA([de])}}return Z}function x(B,Y,V,G,J,Z,fe,xe){for(var de=0,pe=G.length?2:0,me=Y[B].data,Te=0,Ie=0,Ne;Te<me.length;Te+=128){var Ae=me.slice(Te,Te+128);zr(Ae,64),Ie=Ae.read_shift(2),Ne=xb(Ae,0,Ie-pe),G.push(Ne);var Me={name:Ne,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Qe=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Qe!==0&&(Me.ct=S(Ae,Ae.l-8));var Kt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Kt!==0&&(Me.mt=S(Ae,Ae.l-8)),Me.start=Ae.read_shift(4,"i"),Me.size=Ae.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=N,Me.name=""),Me.type===5?(de=Me.start,J>0&&de!==N&&(Y[de].name="!StreamData")):Me.size>=4096?(Me.storage="fat",Y[Me.start]===void 0&&(Y[Me.start]=v(V,Me.start,Y.fat_addrs,Y.ssz)),Y[Me.start].name=Me.name,Me.content=Y[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:de!==N&&Me.start!==N&&Y[de]&&(Me.content=p(Me,Y[de].data,(Y[xe]||{}).data))),Me.content&&zr(Me.content,0),Z[Ne]=Me,fe.push(Me)}}function S(B,Y){return new Date((Rn(B,Y+4)/1e7*Math.pow(2,32)+Rn(B,Y)/1e7-11644473600)*1e3)}function I(B,Y){return u(),h(l.readFileSync(B),Y)}function O(B,Y){var V=Y&&Y.type;switch(V||ot&&Buffer.isBuffer(B)&&(V="buffer"),V||"base64"){case"file":return I(B,Y);case"base64":return h(Zn(On(B)),Y);case"binary":return h(Zn(B),Y)}return h(B,Y)}function E(B,Y){var V=Y||{},G=V.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=G+"/",B.FileIndex[0]={name:G,type:5}),V.CLSID&&(B.FileIndex[0].clsid=V.CLSID),T(B)}function T(B){var Y="Sh33tJ5";if(!it.find(B,"/"+Y)){var V=mr(4);V[0]=55,V[1]=V[3]=50,V[2]=54,B.FileIndex.push({name:Y,type:2,content:V,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Y),P(B)}}function P(B,Y){E(B);for(var V=!1,G=!1,J=B.FullPaths.length-1;J>=0;--J){var Z=B.FileIndex[J];switch(Z.type){case 0:G?V=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(Z.R*Z.L*Z.C)&&(V=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!Y)){var fe=new Date(1987,1,19),xe=0,de=Object.create?Object.create(null):{},pe=[];for(J=0;J<B.FullPaths.length;++J)de[B.FullPaths[J]]=!0,B.FileIndex[J].type!==0&&pe.push([B.FullPaths[J],B.FileIndex[J]]);for(J=0;J<pe.length;++J){var me=n(pe[J][0]);G=de[me],G||(pe.push([me,{name:a(me).replace("/",""),type:1,clsid:ne,ct:fe,mt:fe,content:null}]),de[me]=!0)}for(pe.sort(function(Ne,Ae){return e(Ne[0],Ae[0])}),B.FullPaths=[],B.FileIndex=[],J=0;J<pe.length;++J)B.FullPaths[J]=pe[J][0],B.FileIndex[J]=pe[J][1];for(J=0;J<pe.length;++J){var Te=B.FileIndex[J],Ie=B.FullPaths[J];if(Te.name=a(Ie).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||ne,J===0)Te.C=pe.length>1?1:-1,Te.size=0,Te.type=5;else if(Ie.slice(-1)=="/"){for(xe=J+1;xe<pe.length&&n(B.FullPaths[xe])!=Ie;++xe);for(Te.C=xe>=pe.length?-1:xe,xe=J+1;xe<pe.length&&n(B.FullPaths[xe])!=n(Ie);++xe);Te.R=xe>=pe.length?-1:xe,Te.type=1}else n(B.FullPaths[J+1]||"")==n(Ie)&&(Te.R=J+1),Te.type=2}}}function W(B,Y){var V=Y||{};if(V.fileType=="mad")return Xq(B,V);switch(P(B),V.fileType){case"zip":return Pu(B,V)}var G=function(Ne){for(var Ae=0,Me=0,Qe=0;Qe<Ne.FileIndex.length;++Qe){var Kt=Ne.FileIndex[Qe];if(Kt.content){var Vt=Kt.content.length;Vt>0&&(Vt<4096?Ae+=Vt+63>>6:Me+=Vt+511>>9)}}for(var ln=Ne.FullPaths.length+3>>2,Z1=Ae+7>>3,Q1=Ae+127>>7,ew=Z1+Me+ln+Q1,Iu=ew+127>>7,ME=Iu<=109?0:Math.ceil((Iu-109)/127);ew+Iu+ME+127>>7>Iu;)ME=++Iu<=109?0:Math.ceil((Iu-109)/127);var Ts=[1,ME,Iu,Q1,ln,Me,Ae,0];return Ne.FileIndex[0].size=Ae<<6,Ts[7]=(Ne.FileIndex[0].start=Ts[0]+Ts[1]+Ts[2]+Ts[3]+Ts[4]+Ts[5])+(Ts[6]+7>>3),Ts}(B),J=mr(G[7]<<9),Z=0,fe=0;{for(Z=0;Z<8;++Z)J.write_shift(1,K[Z]);for(Z=0;Z<8;++Z)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),Z=0;Z<3;++Z)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,G[2]),J.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:N),J.write_shift(4,G[3]),J.write_shift(-4,G[1]?G[0]-1:N),J.write_shift(4,G[1]),Z=0;Z<109;++Z)J.write_shift(-4,Z<G[2]?G[1]+Z:-1)}if(G[1])for(fe=0;fe<G[1];++fe){for(;Z<236+fe*127;++Z)J.write_shift(-4,Z<G[2]?G[1]+Z:-1);J.write_shift(-4,fe===G[1]-1?N:fe+1)}var xe=function(Ne){for(fe+=Ne;Z<fe-1;++Z)J.write_shift(-4,Z+1);Ne&&(++Z,J.write_shift(-4,N))};for(fe=Z=0,fe+=G[1];Z<fe;++Z)J.write_shift(-4,X.DIFSECT);for(fe+=G[2];Z<fe;++Z)J.write_shift(-4,X.FATSECT);xe(G[3]),xe(G[4]);for(var de=0,pe=0,me=B.FileIndex[0];de<B.FileIndex.length;++de)me=B.FileIndex[de],me.content&&(pe=me.content.length,!(pe<4096)&&(me.start=fe,xe(pe+511>>9)));for(xe(G[6]+7>>3);J.l&511;)J.write_shift(-4,X.ENDOFCHAIN);for(fe=Z=0,de=0;de<B.FileIndex.length;++de)me=B.FileIndex[de],me.content&&(pe=me.content.length,!(!pe||pe>=4096)&&(me.start=fe,xe(pe+63>>6)));for(;J.l&511;)J.write_shift(-4,X.ENDOFCHAIN);for(Z=0;Z<G[4]<<2;++Z){var Te=B.FullPaths[Z];if(!Te||Te.length===0){for(de=0;de<17;++de)J.write_shift(4,0);for(de=0;de<3;++de)J.write_shift(4,-1);for(de=0;de<12;++de)J.write_shift(4,0);continue}me=B.FileIndex[Z],Z===0&&(me.start=me.size?me.start-1:N);var Ie=Z===0&&V.root||me.name;if(pe=2*(Ie.length+1),J.write_shift(64,Ie,"utf16le"),J.write_shift(2,pe),J.write_shift(1,me.type),J.write_shift(1,me.color),J.write_shift(-4,me.L),J.write_shift(-4,me.R),J.write_shift(-4,me.C),me.clsid)J.write_shift(16,me.clsid,"hex");else for(de=0;de<4;++de)J.write_shift(4,0);J.write_shift(4,me.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,me.start),J.write_shift(4,me.size),J.write_shift(4,0)}for(Z=1;Z<B.FileIndex.length;++Z)if(me=B.FileIndex[Z],me.size>=4096)if(J.l=me.start+1<<9,ot&&Buffer.isBuffer(me.content))me.content.copy(J,J.l,0,me.size),J.l+=me.size+511&-512;else{for(de=0;de<me.size;++de)J.write_shift(1,me.content[de]);for(;de&511;++de)J.write_shift(1,0)}for(Z=1;Z<B.FileIndex.length;++Z)if(me=B.FileIndex[Z],me.size>0&&me.size<4096)if(ot&&Buffer.isBuffer(me.content))me.content.copy(J,J.l,0,me.size),J.l+=me.size+63&-64;else{for(de=0;de<me.size;++de)J.write_shift(1,me.content[de]);for(;de&63;++de)J.write_shift(1,0)}if(ot)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function U(B,Y){var V=B.FullPaths.map(function(de){return de.toUpperCase()}),G=V.map(function(de){var pe=de.split("/");return pe[pe.length-(de.slice(-1)=="/"?2:1)]}),J=!1;Y.charCodeAt(0)===47?(J=!0,Y=V[0].slice(0,-1)+Y):J=Y.indexOf("/")!==-1;var Z=Y.toUpperCase(),fe=J===!0?V.indexOf(Z):G.indexOf(Z);if(fe!==-1)return B.FileIndex[fe];var xe=!Z.match(P0);for(Z=Z.replace(hn,""),xe&&(Z=Z.replace(P0,"!")),fe=0;fe<V.length;++fe)if((xe?V[fe].replace(P0,"!"):V[fe]).replace(hn,"")==Z||(xe?G[fe].replace(P0,"!"):G[fe]).replace(hn,"")==Z)return B.FileIndex[fe];return null}var A=64,N=-2,C="d0cf11e0a1b11ae1",K=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:C,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(B,Y,V){u();var G=W(B,V);l.writeFileSync(Y,G)}function q(B){for(var Y=new Array(B.length),V=0;V<B.length;++V)Y[V]=String.fromCharCode(B[V]);return Y.join("")}function se(B,Y){var V=W(B,Y);switch(Y&&Y.type||"buffer"){case"file":return u(),l.writeFileSync(Y.filename,V),V;case"binary":return typeof V=="string"?V:q(V);case"base64":return OT(typeof V=="string"?V:q(V));case"buffer":if(ot)return Buffer.isBuffer(V)?V:Sc(V);case"array":return typeof V=="string"?Zn(V):V}return V}var Q;function R(B){try{var Y=B.InflateRaw,V=new Y;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)Q=B;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function ae(B,Y){if(!Q)return _x(B,Y);var V=Q.InflateRaw,G=new V,J=G._processChunk(B.slice(B.l),G._finishFlushFlag);return B.l+=G.bytesRead,J}function L(B){return Q?Q.deflateRawSync(B):Ze(B)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(B){var Y=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var ve=typeof Uint8Array<"u",ge=ve?new Uint8Array(256):[],te=0;te<256;++te)ge[te]=ue(te);function D(B,Y){var V=ge[B&255];return Y<=8?V>>>8-Y:(V=V<<8|ge[B>>8&255],Y<=16?V>>>16-Y:(V=V<<8|ge[B>>16&255],V>>>24-Y))}function he(B,Y){var V=Y&7,G=Y>>>3;return(B[G]|(V<=6?0:B[G+1]<<8))>>>V&3}function b(B,Y){var V=Y&7,G=Y>>>3;return(B[G]|(V<=5?0:B[G+1]<<8))>>>V&7}function ee(B,Y){var V=Y&7,G=Y>>>3;return(B[G]|(V<=4?0:B[G+1]<<8))>>>V&15}function re(B,Y){var V=Y&7,G=Y>>>3;return(B[G]|(V<=3?0:B[G+1]<<8))>>>V&31}function j(B,Y){var V=Y&7,G=Y>>>3;return(B[G]|(V<=1?0:B[G+1]<<8))>>>V&127}function z(B,Y,V){var G=Y&7,J=Y>>>3,Z=(1<<V)-1,fe=B[J]>>>G;return V<8-G||(fe|=B[J+1]<<8-G,V<16-G)||(fe|=B[J+2]<<16-G,V<24-G)||(fe|=B[J+3]<<24-G),fe&Z}function ie(B,Y,V){var G=Y&7,J=Y>>>3;return G<=5?B[J]|=(V&7)<<G:(B[J]|=V<<G&255,B[J+1]=(V&7)>>8-G),Y+3}function we(B,Y,V){var G=Y&7,J=Y>>>3;return V=(V&1)<<G,B[J]|=V,Y+1}function ye(B,Y,V){var G=Y&7,J=Y>>>3;return V<<=G,B[J]|=V&255,V>>>=8,B[J+1]=V,Y+8}function le(B,Y,V){var G=Y&7,J=Y>>>3;return V<<=G,B[J]|=V&255,V>>>=8,B[J+1]=V&255,B[J+2]=V>>>8,Y+16}function be(B,Y){var V=B.length,G=2*V>Y?2*V:Y+5,J=0;if(V>=Y)return B;if(ot){var Z=MT(G);if(B.copy)B.copy(Z);else for(;J<B.length;++J)Z[J]=B[J];return Z}else if(ve){var fe=new Uint8Array(G);if(fe.set)fe.set(B);else for(;J<V;++J)fe[J]=B[J];return fe}return B.length=G,B}function Pe(B){for(var Y=new Array(B),V=0;V<B;++V)Y[V]=0;return Y}function Ce(B,Y,V){var G=1,J=0,Z=0,fe=0,xe=0,de=B.length,pe=ve?new Uint16Array(32):Pe(32);for(Z=0;Z<32;++Z)pe[Z]=0;for(Z=de;Z<V;++Z)B[Z]=0;de=B.length;var me=ve?new Uint16Array(de):Pe(de);for(Z=0;Z<de;++Z)pe[J=B[Z]]++,G<J&&(G=J),me[Z]=0;for(pe[0]=0,Z=1;Z<=G;++Z)pe[Z+16]=xe=xe+pe[Z-1]<<1;for(Z=0;Z<de;++Z)xe=B[Z],xe!=0&&(me[Z]=pe[xe+16]++);var Te=0;for(Z=0;Z<de;++Z)if(Te=B[Z],Te!=0)for(xe=D(me[Z],G)>>G-Te,fe=(1<<G+4-Te)-1;fe>=0;--fe)Y[xe|fe<<Te]=Te&15|Z<<4;return G}var $e=ve?new Uint16Array(512):Pe(512),vt=ve?new Uint16Array(32):Pe(32);if(!ve){for(var Ve=0;Ve<512;++Ve)$e[Ve]=0;for(Ve=0;Ve<32;++Ve)vt[Ve]=0}(function(){for(var B=[],Y=0;Y<32;Y++)B.push(5);Ce(B,vt,32);var V=[];for(Y=0;Y<=143;Y++)V.push(8);for(;Y<=255;Y++)V.push(9);for(;Y<=279;Y++)V.push(7);for(;Y<=287;Y++)V.push(8);Ce(V,$e,288)})();var zt=function(){for(var Y=ve?new Uint8Array(32768):[],V=0,G=0;V<ke.length-1;++V)for(;G<ke[V+1];++G)Y[G]=V;for(;G<32768;++G)Y[G]=29;var J=ve?new Uint8Array(259):[];for(V=0,G=0;V<ce.length-1;++V)for(;G<ce[V+1];++G)J[G]=V;function Z(xe,de){for(var pe=0;pe<xe.length;){var me=Math.min(65535,xe.length-pe),Te=pe+me==xe.length;for(de.write_shift(1,+Te),de.write_shift(2,me),de.write_shift(2,~me&65535);me-- >0;)de[de.l++]=xe[pe++]}return de.l}function fe(xe,de){for(var pe=0,me=0,Te=ve?new Uint16Array(32768):[];me<xe.length;){var Ie=Math.min(65535,xe.length-me);if(Ie<10){for(pe=ie(de,pe,+(me+Ie==xe.length)),pe&7&&(pe+=8-(pe&7)),de.l=pe/8|0,de.write_shift(2,Ie),de.write_shift(2,~Ie&65535);Ie-- >0;)de[de.l++]=xe[me++];pe=de.l*8;continue}pe=ie(de,pe,+(me+Ie==xe.length)+2);for(var Ne=0;Ie-- >0;){var Ae=xe[me];Ne=(Ne<<5^Ae)&32767;var Me=-1,Qe=0;if((Me=Te[Ne])&&(Me|=me&-32768,Me>me&&(Me-=32768),Me<me))for(;xe[Me+Qe]==xe[me+Qe]&&Qe<250;)++Qe;if(Qe>2){Ae=J[Qe],Ae<=22?pe=ye(de,pe,ge[Ae+1]>>1)-1:(ye(de,pe,3),pe+=5,ye(de,pe,ge[Ae-23]>>5),pe+=3);var Kt=Ae<8?0:Ae-4>>2;Kt>0&&(le(de,pe,Qe-ce[Ae]),pe+=Kt),Ae=Y[me-Me],pe=ye(de,pe,ge[Ae]>>3),pe-=3;var Vt=Ae<4?0:Ae-2>>1;Vt>0&&(le(de,pe,me-Me-ke[Ae]),pe+=Vt);for(var ln=0;ln<Qe;++ln)Te[Ne]=me&32767,Ne=(Ne<<5^xe[me])&32767,++me;Ie-=Qe-1}else Ae<=143?Ae=Ae+48:pe=we(de,pe,1),pe=ye(de,pe,ge[Ae]),Te[Ne]=me&32767,++me}pe=ye(de,pe,0)-1}return de.l=(pe+7)/8|0,de.l}return function(de,pe){return de.length<8?Z(de,pe):fe(de,pe)}}();function Ze(B){var Y=mr(50+Math.floor(B.length*1.1)),V=zt(B,Y);return Y.slice(0,V)}var yt=ve?new Uint16Array(32768):Pe(32768),Br=ve?new Uint16Array(32768):Pe(32768),tt=ve?new Uint16Array(128):Pe(128),ga=1,r0=1;function Ha(B,Y){var V=re(B,Y)+257;Y+=5;var G=re(B,Y)+1;Y+=5;var J=ee(B,Y)+4;Y+=4;for(var Z=0,fe=ve?new Uint8Array(19):Pe(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,pe=ve?new Uint8Array(8):Pe(8),me=ve?new Uint8Array(8):Pe(8),Te=fe.length,Ie=0;Ie<J;++Ie)fe[M[Ie]]=Z=b(B,Y),de<Z&&(de=Z),pe[Z]++,Y+=3;var Ne=0;for(pe[0]=0,Ie=1;Ie<=de;++Ie)me[Ie]=Ne=Ne+pe[Ie-1]<<1;for(Ie=0;Ie<Te;++Ie)(Ne=fe[Ie])!=0&&(xe[Ie]=me[Ne]++);var Ae=0;for(Ie=0;Ie<Te;++Ie)if(Ae=fe[Ie],Ae!=0){Ne=ge[xe[Ie]]>>8-Ae;for(var Me=(1<<7-Ae)-1;Me>=0;--Me)tt[Ne|Me<<Ae]=Ae&7|Ie<<3}var Qe=[];for(de=1;Qe.length<V+G;)switch(Ne=tt[j(B,Y)],Y+=Ne&7,Ne>>>=3){case 16:for(Z=3+he(B,Y),Y+=2,Ne=Qe[Qe.length-1];Z-- >0;)Qe.push(Ne);break;case 17:for(Z=3+b(B,Y),Y+=3;Z-- >0;)Qe.push(0);break;case 18:for(Z=11+j(B,Y),Y+=7;Z-- >0;)Qe.push(0);break;default:Qe.push(Ne),de<Ne&&(de=Ne);break}var Kt=Qe.slice(0,V),Vt=Qe.slice(V);for(Ie=V;Ie<286;++Ie)Kt[Ie]=0;for(Ie=G;Ie<30;++Ie)Vt[Ie]=0;return ga=Ce(Kt,yt,286),r0=Ce(Vt,Br,30),Y}function bx(B,Y){if(B[0]==3&&!(B[1]&3))return[Bs(Y),2];for(var V=0,G=0,J=MT(Y||1<<18),Z=0,fe=J.length>>>0,xe=0,de=0;!(G&1);){if(G=b(B,V),V+=3,G>>>1)G>>1==1?(xe=9,de=5):(V=Ha(B,V),xe=ga,de=r0);else{V&7&&(V+=8-(V&7));var pe=B[V>>>3]|B[(V>>>3)+1]<<8;if(V+=32,pe>0)for(!Y&&fe<Z+pe&&(J=be(J,Z+pe),fe=J.length);pe-- >0;)J[Z++]=B[V>>>3],V+=8;continue}for(;;){!Y&&fe<Z+32767&&(J=be(J,Z+32767),fe=J.length);var me=z(B,V,xe),Te=G>>>1==1?$e[me]:yt[me];if(V+=Te&15,Te>>>=4,!(Te>>>8&255))J[Z++]=Te;else{if(Te==256)break;Te-=257;var Ie=Te<8?0:Te-4>>2;Ie>5&&(Ie=0);var Ne=Z+ce[Te];Ie>0&&(Ne+=z(B,V,Ie),V+=Ie),me=z(B,V,de),Te=G>>>1==1?vt[me]:Br[me],V+=Te&15,Te>>>=4;var Ae=Te<4?0:Te-2>>1,Me=ke[Te];for(Ae>0&&(Me+=z(B,V,Ae),V+=Ae),!Y&&fe<Ne&&(J=be(J,Ne+100),fe=J.length);Z<Ne;)J[Z]=J[Z-Me],++Z}}}return Y?[J,V+7>>>3]:[J.slice(0,Z),V+7>>>3]}function _x(B,Y){var V=B.slice(B.l||0),G=bx(V,Y);return B.l+=G[1],G[0]}function Ex(B,Y){if(B)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function Sx(B,Y){var V=B;zr(V,0);var G=[],J=[],Z={FileIndex:G,FullPaths:J};E(Z,{root:Y.root});for(var fe=V.length-4;(V[fe]!=80||V[fe+1]!=75||V[fe+2]!=5||V[fe+3]!=6)&&fe>=0;)--fe;V.l=fe+4,V.l+=4;var xe=V.read_shift(2);V.l+=6;var de=V.read_shift(4);for(V.l=de,fe=0;fe<xe;++fe){V.l+=20;var pe=V.read_shift(4),me=V.read_shift(4),Te=V.read_shift(2),Ie=V.read_shift(2),Ne=V.read_shift(2);V.l+=8;var Ae=V.read_shift(4),Me=c(V.slice(V.l+Te,V.l+Te+Ie));V.l+=Te+Ie+Ne;var Qe=V.l;V.l=Ae+4,Cx(V,pe,me,Z,Me),V.l=Qe}return Z}function Cx(B,Y,V,G,J){B.l+=2;var Z=B.read_shift(2),fe=B.read_shift(2),xe=s(B);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var de=B.read_shift(4),pe=B.read_shift(4),me=B.read_shift(4),Te=B.read_shift(2),Ie=B.read_shift(2),Ne="",Ae=0;Ae<Te;++Ae)Ne+=String.fromCharCode(B[B.l++]);if(Ie){var Me=c(B.slice(B.l,B.l+Ie));(Me[21589]||{}).mt&&(xe=Me[21589].mt),((J||{})[21589]||{}).mt&&(xe=J[21589].mt)}B.l+=Ie;var Qe=B.slice(B.l,B.l+pe);switch(fe){case 8:Qe=ae(B,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Kt=!1;Z&8&&(de=B.read_shift(4),de==134695760&&(de=B.read_shift(4),Kt=!0),pe=B.read_shift(4),me=B.read_shift(4)),pe!=Y&&Ex(Kt,"Bad compressed size: "+Y+" != "+pe),me!=V&&Ex(Kt,"Bad uncompressed size: "+V+" != "+me),OE(G,Ne,Qe,{unsafe:!0,mt:xe})}function Pu(B,Y){var V=Y||{},G=[],J=[],Z=mr(1),fe=V.compression?8:0,xe=0,de=0,pe=0,me=0,Te=0,Ie=B.FullPaths[0],Ne=Ie,Ae=B.FileIndex[0],Me=[],Qe=0;for(de=1;de<B.FullPaths.length;++de)if(Ne=B.FullPaths[de].slice(Ie.length),Ae=B.FileIndex[de],!(!Ae.size||!Ae.content||Ne=="Sh33tJ5")){var Kt=me,Vt=mr(Ne.length);for(pe=0;pe<Ne.length;++pe)Vt.write_shift(1,Ne.charCodeAt(pe)&127);Vt=Vt.slice(0,Vt.l),Me[Te]=hN.buf(Ae.content,0);var ln=Ae.content;fe==8&&(ln=L(ln)),Z=mr(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,xe),Z.write_shift(2,fe),Ae.mt?i(Z,Ae.mt):Z.write_shift(4,0),Z.write_shift(-4,Me[Te]),Z.write_shift(4,ln.length),Z.write_shift(4,Ae.content.length),Z.write_shift(2,Vt.length),Z.write_shift(2,0),me+=Z.length,G.push(Z),me+=Vt.length,G.push(Vt),me+=ln.length,G.push(ln),Z=mr(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,xe),Z.write_shift(2,fe),Z.write_shift(4,0),Z.write_shift(-4,Me[Te]),Z.write_shift(4,ln.length),Z.write_shift(4,Ae.content.length),Z.write_shift(2,Vt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Kt),Qe+=Z.l,J.push(Z),Qe+=Vt.length,J.push(Vt),++Te}return Z=mr(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,Te),Z.write_shift(2,Te),Z.write_shift(4,Qe),Z.write_shift(4,me),Z.write_shift(2,0),$s([$s(G),$s(J),Z])}var Cs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wq(B,Y){if(B.ctype)return B.ctype;var V=B.name||"",G=V.match(/\.([^\.]+)$/);return G&&Cs[G[1]]||Y&&(G=(V=Y).match(/[\.\\]([^\.\\])+$/),G&&Cs[G[1]])?Cs[G[1]]:"application/octet-stream"}function zq(B){for(var Y=OT(B),V=[],G=0;G<Y.length;G+=76)V.push(Y.slice(G,G+76));return V.join(`\r
`)+`\r
`}function Kq(B){var Y=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var me=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],G=Y.split(`\r
`),J=0;J<G.length;++J){var Z=G[J];if(Z.length==0){V.push("");continue}for(var fe=0;fe<Z.length;){var xe=76,de=Z.slice(fe,fe+xe);de.charAt(xe-1)=="="?xe--:de.charAt(xe-2)=="="?xe-=2:de.charAt(xe-3)=="="&&(xe-=3),de=Z.slice(fe,fe+xe),fe+=xe,fe<Z.length&&(de+="="),V.push(de)}}return V.join(`\r
`)}function Vq(B){for(var Y=[],V=0;V<B.length;++V){for(var G=B[V];V<=B.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+B[++V];Y.push(G)}for(var J=0;J<Y.length;++J)Y[J]=Y[J].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return Zn(Y.join(`\r
`))}function qq(B,Y,V){for(var G="",J="",Z="",fe,xe=0;xe<10;++xe){var de=Y[xe];if(!de||de.match(/^\s*$/))break;var pe=de.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":G=pe[2].trim();break;case"content-type":Z=pe[2].trim();break;case"content-transfer-encoding":J=pe[2].trim();break}}switch(++xe,J.toLowerCase()){case"base64":fe=Zn(On(Y.slice(xe).join("")));break;case"quoted-printable":fe=Vq(Y.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var me=OE(B,G.slice(V.length),fe,{unsafe:!0});Z&&(me.ctype=Z)}function Gq(B,Y){if(q(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=Y&&Y.root||"",G=(ot&&Buffer.isBuffer(B)?B.toString("binary"):q(B)).split(`\r
`),J=0,Z="";for(J=0;J<G.length;++J)if(Z=G[J],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),V||(V=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),Z.slice(0,V.length)!=V););var fe=(G[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var xe="--"+(fe[1]||""),de=[],pe=[],me={FileIndex:de,FullPaths:pe};E(me);var Te,Ie=0;for(J=0;J<G.length;++J){var Ne=G[J];Ne!==xe&&Ne!==xe+"--"||(Ie++&&qq(me,G.slice(Te,J),V),Te=J)}return me}function Xq(B,Y){var V=Y||{},G=V.boundary||"SheetJS";G="------="+G;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],Z=B.FullPaths[0],fe=Z,xe=B.FileIndex[0],de=1;de<B.FullPaths.length;++de)if(fe=B.FullPaths[de].slice(Z.length),xe=B.FileIndex[de],!(!xe.size||!xe.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var pe=xe.content,me=ot&&Buffer.isBuffer(pe)?pe.toString("binary"):q(pe),Te=0,Ie=Math.min(1024,me.length),Ne=0,Ae=0;Ae<=Ie;++Ae)(Ne=me.charCodeAt(Ae))>=32&&Ne<128&&++Te;var Me=Te>=Ie*4/5;J.push(G),J.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+fe),J.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),J.push("Content-Type: "+Wq(xe,fe)),J.push(""),J.push(Me?Kq(me):zq(me))}return J.push(G+`--\r
`),J.join(`\r
`)}function Yq(B){var Y={};return E(Y,B),Y}function OE(B,Y,V,G){var J=G&&G.unsafe;J||E(B);var Z=!J&&it.find(B,Y);if(!Z){var fe=B.FullPaths[0];Y.slice(0,fe.length)==fe?fe=Y:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+Y).replace("//","/")),Z={name:a(Y),type:2},B.FileIndex.push(Z),B.FullPaths.push(fe),J||it.utils.cfb_gc(B)}return Z.content=V,Z.size=V?V.length:0,G&&(G.CLSID&&(Z.clsid=G.CLSID),G.mt&&(Z.mt=G.mt),G.ct&&(Z.ct=G.ct)),Z}function Jq(B,Y){E(B);var V=it.find(B,Y);if(V){for(var G=0;G<B.FileIndex.length;++G)if(B.FileIndex[G]==V)return B.FileIndex.splice(G,1),B.FullPaths.splice(G,1),!0}return!1}function Zq(B,Y,V){E(B);var G=it.find(B,Y);if(G){for(var J=0;J<B.FileIndex.length;++J)if(B.FileIndex[J]==G)return B.FileIndex[J].name=a(V),B.FullPaths[J]=V,!0}return!1}function Qq(B){P(B,!0)}return t.find=U,t.read=O,t.parse=h,t.write=se,t.writeFile=oe,t.utils={cfb_new:Yq,cfb_add:OE,cfb_del:Jq,cfb_mov:Zq,cfb_gc:Qq,ReadShift:N0,CheckField:LA,prep_blob:zr,bconcat:$s,use_zlib:R,_deflateRaw:Ze,_inflateRaw:_x,consts:X},t}();function dN(r){return typeof r=="string"?Qw(r):Array.isArray(r)?L6(r):r}function QT(r,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=Qw(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(r,t)}var n=e=="utf8"?Fc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var a=new Blob([dN(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,r);if(typeof saveAs<"u")return saveAs(a,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:r,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=r,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(r);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Us(t)),c.write(t),c.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+r)}function fN(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(r);t.open("r"),t.encoding="binary";var e=t.read();return t.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function fn(r){for(var t=Object.keys(r),e=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(r,t[n])&&e.push(t[n]);return e}function pb(r){for(var t=[],e=fn(r),n=0;n!==e.length;++n)t[r[e[n]]]=e[n];return t}function pN(r){for(var t=[],e=fn(r),n=0;n!==e.length;++n)t[r[e[n]]]=parseInt(e[n],10);return t}function mN(r){for(var t=[],e=fn(r),n=0;n!==e.length;++n)t[r[e[n]]]==null&&(t[r[e[n]]]=[]),t[r[e[n]]].push(e[n]);return t}var nv=new Date(1899,11,30,0,0,0);function Vr(r,t){var e=r.getTime(),n=nv.getTime()+(r.getTimezoneOffset()-nv.getTimezoneOffset())*6e4;return(e-n)/(24*60*60*1e3)}var eA=new Date,gN=nv.getTime()+(eA.getTimezoneOffset()-nv.getTimezoneOffset())*6e4,tA=eA.getTimezoneOffset();function av(r){var t=new Date;return t.setTime(r*24*60*60*1e3+gN),t.getTimezoneOffset()!==tA&&t.setTime(t.getTime()+(t.getTimezoneOffset()-tA)*6e4),t}function wN(r){var t=0,e=0,n=!1,a=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(e=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=e*parseInt(a[i],10)}return t}var rA=new Date("2017-02-19T19:06:09.000Z"),nA=isNaN(rA.getFullYear())?new Date("2/19/17"):rA,vN=nA.getFullYear()==2017;function ar(r,t){var e=new Date(r);if(vN)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(r instanceof Date)return r;if(nA.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return r.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var a=r.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return r.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ac(r,t){if(ot&&Buffer.isBuffer(r)){if(t){if(r[0]==255&&r[1]==254)return Fc(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Fc(IT(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(r[0]==255&&r[1]==254)return Fc(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Fc(new TextDecoder("utf-16be").decode(r.slice(2)))}var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return e[i]||i})}catch{}for(var n=[],a=0;a!=r.length;++a)n.push(String.fromCharCode(r[a]));return n.join("")}function Xt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=Xt(r[e]));return t}function qt(r,t){for(var e="";e.length<t;)e+=r;return e}function _a(r){var t=Number(r);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(r))return t;var e=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return e=-e,i}),!isNaN(t=Number(n)))?t/e:t}var yN=["january","february","march","april","may","june","july","august","september","october","november","december"];function sh(r){var t=new Date(r),e=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return e;var s=r.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&yN.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return n<0||n>8099?e:(a>0||i>1)&&n!=101?t:r.match(/[^-0-9:,\/\\]/)?e:t}var xN=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(e,n,a){if(r||typeof n=="string")return e.split(n);for(var i=e.split(n),s=[i[0]],c=1;c<i.length;++c)s.push(a),s.push(i[c]);return s}}();function aA(r){return r?r.content&&r.type?Ac(r.content,!0):r.data?F0(r.data):r.asNodeBuffer&&ot?F0(r.asNodeBuffer().toString("binary")):r.asBinary?F0(r.asBinary()):r._data&&r._data.getContent?F0(Ac(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function iA(r){if(!r)return null;if(r.data)return PT(r.data);if(r.asNodeBuffer&&ot)return r.asNodeBuffer();if(r._data&&r._data.getContent){var t=r._data.getContent();return typeof t=="string"?PT(t):Array.prototype.slice.call(t)}return r.content&&r.type?r.content:null}function kN(r){return r&&r.name.slice(-4)===".bin"?iA(r):aA(r)}function ta(r,t){for(var e=r.FullPaths||fn(r.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<e.length;++i){var s=e[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return r.files?r.files[e[i]]:r.FileIndex[i]}return null}function mb(r,t){var e=ta(r,t);if(e==null)throw new Error("Cannot find file "+t+" in zip");return e}function ir(r,t,e){if(!e)return kN(mb(r,t));if(!t)return null;try{return ir(r,t)}catch{return null}}function Mn(r,t,e){if(!e)return aA(mb(r,t));if(!t)return null;try{return Mn(r,t)}catch{return null}}function bN(r,t,e){return iA(mb(r,t))}function sA(r){for(var t=r.FullPaths||fn(r.files),e=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&e.push(t[n].replace(/^Root Entry[\/]/,""));return e.sort()}function fr(r,t,e){if(r.FullPaths){if(typeof e=="string"){var n;return ot?n=Sc(e):n=B6(e),it.utils.cfb_add(r,t,n)}it.utils.cfb_add(r,t,e)}else r.file(t,e)}function _N(){return it.utils.cfb_new()}function oA(r,t){switch(t.type){case"base64":return it.read(r,{type:"base64"});case"binary":return it.read(r,{type:"binary"});case"buffer":case"array":return it.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function D0(r,t){if(r.charAt(0)=="/")return r.slice(1);var e=t.split("/");t.slice(-1)!="/"&&e.pop();for(var n=r.split("/");n.length!==0;){var a=n.shift();a===".."?e.pop():a!=="."&&e.push(a)}return e.join("/")}var pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,EN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,SN=/<[^>]*>/g,qr=pn.match(cA)?cA:SN,CN=/<\w*:/,TN=/<(\/?)\w+:/;function qe(r,t,e){for(var n={},a=0,i=0;a!==r.length&&!((i=r.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=r.slice(0,a)),a===r.length)return n;var s=r.match(EN),c=0,l="",u=0,h="",d="",f=1;if(s)for(u=0;u!=s.length;++u){for(d=s[u],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(h=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(f=(a=d.charCodeAt(i+1))==34||a==39?1:0,l=d.slice(i+1+f,d.length-f),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=l,n[h.toLowerCase()]=l;else{var m=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(n[m]&&h.slice(c-3,c)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Qa(r){return r.replace(TN,"<$1")}var lA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uA=pb(lA),mt=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function e(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(r,function(c,l){return lA[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return e(a.slice(0,i))+a.slice(i+9,s)+e(a.slice(s+3))}}(),hA=/[&<>'"]/g,AN=/[\u0000-\u0008\u000b-\u001f]/g;function sr(r){var t=r+"";return t.replace(hA,function(e){return uA[e]}).replace(AN,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}var FN=/[\u0000-\u001f]/g;function gb(r){var t=r+"";return t.replace(hA,function(e){return uA[e]}).replace(/\n/g,"<br/>").replace(FN,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var dA=function(){var r=/&#(\d+);/g;function t(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,t)}}();function $t(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wb(r){for(var t="",e=0,n=0,a=0,i=0,s=0,c=0;e<r.length;){if(n=r.charCodeAt(e++),n<128){t+=String.fromCharCode(n);continue}if(a=r.charCodeAt(e++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=r.charCodeAt(e++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=r.charCodeAt(e++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function fA(r){var t=Bs(2*r.length),e,n,a=1,i=0,s=0,c;for(n=0;n<r.length;n+=a)a=1,(c=r.charCodeAt(n))<128?e=c:c<224?(e=(c&31)*64+(r.charCodeAt(n+1)&63),a=2):c<240?(e=(c&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),a=3):(a=4,e=(c&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=e%256,t[i++]=e>>>8;return t.slice(0,i).toString("ucs2")}function pA(r){return Sc(r,"binary").toString("utf8")}var iv="foo bar bazâð£",Ct=ot&&(pA(iv)==wb(iv)&&pA||fA(iv)==wb(iv)&&fA)||wb,Fc=ot?function(r){return Sc(r,"utf8").toString("binary")}:function(r){for(var t=[],e=0,n=0,a=0;e<r.length;)switch(n=r.charCodeAt(e++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=r.charCodeAt(e++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},O0=function(){var r={};return function(e,n){var a=e+"|"+(n||"");return r[a]?r[a]:r[a]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}}(),mA=function(){var r=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<r.length;++a)n=n.replace(r[a][0],r[a][1]);return n}}(),PN=function(){var r={};return function(e){return r[e]!==void 0?r[e]:r[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),IN=/<\/?(?:vt:)?variant>/g,DN=/<(?:vt:)([^>]*)>([\s\S]*)</;function gA(r,t){var e=qe(r),n=r.match(PN(e.baseType))||[],a=[];if(n.length!=e.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return a}return n.forEach(function(i){var s=i.replace(IN,"").match(DN);s&&a.push({v:Ct(s[2]),t:s[1]})}),a}var wA=/(^\s|\s$|\n)/;function Ea(r,t){return"<"+r+(t.match(wA)?' xml:space="preserve"':"")+">"+t+"</"+r+">"}function vA(r){return fn(r).map(function(t){return" "+t+'="'+r[t]+'"'}).join("")}function Be(r,t,e){return"<"+r+(e!=null?vA(e):"")+(t!=null?(t.match(wA)?' xml:space="preserve"':"")+">"+t+"</"+r:"/")+">"}function vb(r,t){try{return r.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function ON(r,t){switch(typeof r){case"string":var e=Be("vt:lpwstr",sr(r));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return Be((r|0)==r?"vt:i4":"vt:r8",sr(String(r)));case"boolean":return Be("vt:bool",r?"true":"false")}if(r instanceof Date)return Be("vt:filetime",vb(r));throw new Error("Unable to serialize "+r)}function yb(r){if(ot&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Ct(Us(lb(r)));throw new Error("Bad input format: expected Buffer or string")}var M0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sv={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function MN(r,t){for(var e=1-2*(r[t+7]>>>7),n=((r[t+7]&127)<<4)+(r[t+6]>>>4&15),a=r[t+6]&15,i=5;i>=0;--i)a=a*256+r[t+i];return n==2047?a==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),e*Math.pow(2,n-52)*a)}function RN(r,t,e){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)r[e+c]=i&255;r[e+6]=(a&15)<<4|i&15,r[e+7]=a>>4|n}var yA=function(r){for(var t=[],e=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var a=0,i=r[0][n].length;a<i;a+=e)t.push.apply(t,r[0][n].slice(a,a+e));return t},xA=ot?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(t){return Buffer.isBuffer(t)?t:Sc(t)})):yA(r)}:yA,kA=function(r,t,e){for(var n=[],a=t;a<e;a+=2)n.push(String.fromCharCode($i(r,a)));return n.join("").replace(hn,"")},xb=ot?function(r,t,e){return Buffer.isBuffer(r)?r.toString("utf16le",t,e).replace(hn,""):kA(r,t,e)}:kA,bA=function(r,t,e){for(var n=[],a=t;a<t+e;++a)n.push(("0"+r[a].toString(16)).slice(-2));return n.join("")},_A=ot?function(r,t,e){return Buffer.isBuffer(r)?r.toString("hex",t,t+e):bA(r,t,e)}:bA,EA=function(r,t,e){for(var n=[],a=t;a<e;a++)n.push(String.fromCharCode(oh(r,a)));return n.join("")},R0=ot?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf8",e,n):EA(t,e,n)}:EA,SA=function(r,t){var e=Rn(r,t);return e>0?R0(r,t+4,t+4+e-1):""},CA=SA,TA=function(r,t){var e=Rn(r,t);return e>0?R0(r,t+4,t+4+e-1):""},AA=TA,FA=function(r,t){var e=2*Rn(r,t);return e>0?R0(r,t+4,t+4+e-1):""},PA=FA,IA=function(t,e){var n=Rn(t,e);return n>0?xb(t,e+4,e+4+n):""},DA=IA,OA=function(r,t){var e=Rn(r,t);return e>0?R0(r,t+4,t+4+e):""},MA=OA,RA=function(r,t){return MN(r,t)},ov=RA,NA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ot&&(CA=function(t,e){if(!Buffer.isBuffer(t))return SA(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},AA=function(t,e){if(!Buffer.isBuffer(t))return TA(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},PA=function(t,e){if(!Buffer.isBuffer(t))return FA(t,e);var n=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n-1)},DA=function(t,e){if(!Buffer.isBuffer(t))return IA(t,e);var n=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n)},MA=function(t,e){if(!Buffer.isBuffer(t))return OA(t,e);var n=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+n)},ov=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):RA(t,e)},NA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var oh=function(r,t){return r[t]},$i=function(r,t){return r[t+1]*256+r[t]},NN=function(r,t){var e=r[t+1]*256+r[t];return e<32768?e:(65535-e+1)*-1},Rn=function(r,t){return r[t+3]*(1<<24)+(r[t+2]<<16)+(r[t+1]<<8)+r[t]},Ic=function(r,t){return r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]},LN=function(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]};function N0(r,t){var e="",n,a,i=[],s,c,l,u;switch(t){case"dbcs":if(u=this.l,ot&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)e+=String.fromCharCode($i(this,u)),u+=2;r*=2;break;case"utf8":e=R0(this,this.l,this.l+r);break;case"utf16le":r*=2,e=xb(this,this.l,this.l+r);break;case"wstr":return N0.call(this,r,"dbcs");case"lpstr-ansi":e=CA(this,this.l),r=4+Rn(this,this.l);break;case"lpstr-cp":e=AA(this,this.l),r=4+Rn(this,this.l);break;case"lpwstr":e=PA(this,this.l),r=4+2*Rn(this,this.l);break;case"lpp4":r=4+Rn(this,this.l),e=DA(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Rn(this,this.l),e=MA(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,e="";(s=oh(this,this.l+r++))!==0;)i.push(Zw(s));e=i.join("");break;case"_wstr":for(r=0,e="";(s=$i(this,this.l+r))!==0;)i.push(Zw(s)),r+=2;r+=2,e=i.join("");break;case"dbcs-cont":for(e="",u=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=oh(this,u),this.l=u+1,c=N0.call(this,r-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Zw($i(this,u))),u+=2}e=i.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(e="",u=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=oh(this,u),this.l=u+1,c=N0.call(this,r-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Zw(oh(this,u))),u+=1}e=i.join("");break;default:switch(r){case 1:return n=oh(this,this.l),this.l++,n;case 2:return n=(t==="i"?NN:$i)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(r>0?Ic:LN)(this,this.l),this.l+=4,n):(a=Rn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return r==8?a=ov(this,this.l):a=ov([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;r=8;case 16:e=_A(this,this.l,r);break}}return this.l+=r,e}var BN=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},UN=function(r,t,e){r[e]=t&255,r[e+1]=t>>8&255,r[e+2]=t>>16&255,r[e+3]=t>>24&255},$N=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255};function jN(r,t,e){var n=0,a=0;if(e==="dbcs"){for(a=0;a!=t.length;++a)$N(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(e==="hex"){for(;a<r;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var i=Math.min(this.l+r,this.length);for(a=0;a<Math.min(t.length,r);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,BN(this,t,this.l);break;case 8:if(n=8,e==="f"){RN(this,t,this.l);break}case 16:break;case-4:n=4,UN(this,t,this.l);break}return this.l+=n,this}function LA(r,t){var e=_A(this,this.l,r.length>>1);if(e!==r)throw new Error(t+"Expected "+r+" saw "+e);this.l+=r.length>>1}function zr(r,t){r.l=t,r.read_shift=N0,r.chk=LA,r.write_shift=jN}function Gr(r,t){r.l+=t}function mr(r){var t=Bs(r);return zr(t,0),t}function ji(r,t,e){if(r){var n,a,i;zr(r,r.l||0);for(var s=r.length,c=0,l=0;r.l<s;){c=r.read_shift(1),c&128&&(c=(c&127)+((r.read_shift(1)&127)<<7));var u=Tv[c]||Tv[65535];for(n=r.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=r.read_shift(1))&127)<<7*a;l=r.l+i;var h=u.f&&u.f(r,i,e);if(r.l=l,t(h,u,c))return}}}function kb(){var r=[],t=ot?256:2048,e=function(u){var h=mr(u);return zr(h,0),h},n=e(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=e(Math.max(u+1,t)))},s=function(){return a(),$s(r)},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:r}}function L0(r,t,e){var n=Xt(r);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BA(r,t,e){var n=Xt(r);return n.s=L0(n.s,t.s,e),n.e=L0(n.e,t.s,e),n}function B0(r,t){if(r.cRel&&r.c<0)for(r=Xt(r);r.c<0;)r.c+=t>8?16384:256;if(r.rRel&&r.r<0)for(r=Xt(r);r.r<0;)r.r+=t>8?1048576:t>5?65536:16384;var e=Ye(r);return!r.cRel&&r.cRel!=null&&(e=zN(e)),!r.rRel&&r.rRel!=null&&(e=HN(e)),e}function bb(r,t){return r.s.r==0&&!r.s.rRel&&r.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+or(r.s.c)+":"+(r.e.cRel?"":"$")+or(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(t.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Fr(r.s.r)+":"+(r.e.rRel?"":"$")+Fr(r.e.r):B0(r.s,t.biff)+":"+B0(r.e,t.biff)}function _b(r){return parseInt(WN(r),10)-1}function Fr(r){return""+(r+1)}function HN(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WN(r){return r.replace(/\$(\d+)$/,"$1")}function Eb(r){for(var t=KN(r),e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function or(r){if(r<0)throw new Error("invalid column "+r);var t="";for(++r;r;r=Math.floor((r-1)/26))t=String.fromCharCode((r-1)%26+65)+t;return t}function zN(r){return r.replace(/^([A-Z])/,"$$$1")}function KN(r){return r.replace(/^\$([A-Z])/,"$1")}function VN(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xr(r){for(var t=0,e=0,n=0;n<r.length;++n){var a=r.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:t-1}}function Ye(r){for(var t=r.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(r.r+1)}function Hs(r){var t=r.indexOf(":");return t==-1?{s:Xr(r),e:Xr(r)}:{s:Xr(r.slice(0,t)),e:Xr(r.slice(t+1))}}function st(r,t){return typeof t>"u"||typeof t=="number"?st(r.s,r.e):(typeof r!="string"&&(r=Ye(r)),typeof t!="string"&&(t=Ye(t)),r==t?r:r+":"+t)}function Dt(r){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,a=0,i=r.length;for(e=0;n<i&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(t.s.c=--e,e=0;n<i&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;if(t.s.r=--e,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,e=0;n!=i&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(t.e.c=--e,e=0;n!=i&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;return t.e.r=--e,t}function UA(r,t){var e=r.t=="d"&&t instanceof Date;if(r.z!=null)try{return r.w=ea(r.z,e?Vr(t):t)}catch{}try{return r.w=ea((r.XF||{}).numFmtId||(e?14:0),e?Vr(t):t)}catch{return""+t}}function Hi(r,t,e){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&e&&e.dateNF&&(r.z=e.dateNF),r.t=="e"?zs[r.v]||r.v:t==null?UA(r,r.v):UA(r,t))}function Ws(r,t){var e=t&&t.sheet?t.sheet:"Sheet1",n={};return n[e]=r,{SheetNames:[e],Sheets:n}}function $A(r,t,e){var n=e||{},a=r?Array.isArray(r):n.dense,i=r||(a?[]:{}),s=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Xr(n.origin):n.origin;s=l.r,c=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=Dt(i["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(u.e.r=s=h.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[d].length;++f)if(!(typeof t[d][f]>"u")){var m={v:t[d][f]},w=s+d,p=c+f;if(u.s.r>w&&(u.s.r=w),u.s.c>p&&(u.s.c=p),u.e.r<w&&(u.e.r=w),u.e.c<p&&(u.e.c=p),t[d][f]&&typeof t[d][f]=="object"&&!Array.isArray(t[d][f])&&!(t[d][f]instanceof Date))m=t[d][f];else if(Array.isArray(m.v)&&(m.f=t[d][f][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Xe[14],n.cellDates?(m.t="d",m.w=ea(m.z,Vr(m.v))):(m.t="n",m.v=Vr(m.v),m.w=ea(m.z,m.v))):m.t="s";if(a)i[w]||(i[w]=[]),i[w][p]&&i[w][p].z&&(m.z=i[w][p].z),i[w][p]=m;else{var g=Ye({c:p,r:w});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return u.s.c<1e7&&(i["!ref"]=st(u)),i}function ch(r,t){return $A(null,r,t)}function qN(r){return r.read_shift(4,"i")}function Yr(r){var t=r.read_shift(4);return t===0?"":r.read_shift(t,"dbcs")}function GN(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function Sb(r,t){var e=r.l,n=r.read_shift(1),a=Yr(r),i=[],s={t:a,h:a};if(n&1){for(var c=r.read_shift(4),l=0;l!=c;++l)i.push(GN(r));s.r=i}else s.r=[{ich:0,ifnt:0}];return r.l=e+t,s}var XN=Sb;function ra(r){var t=r.read_shift(4),e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:t,iStyleRef:e}}function Dc(r){var t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:t}}var YN=Yr;function Cb(r){var t=r.read_shift(4);return t===0||t===4294967295?"":r.read_shift(t,"dbcs")}var JN=Yr,Tb=Cb;function Ab(r){var t=r.slice(r.l,r.l+4),e=t[0]&1,n=t[0]&2;r.l+=4;var a=n===0?ov([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ic(t,0)>>2;return e?a/100:a}function jA(r){var t={s:{},e:{}};return t.s.r=r.read_shift(4),t.e.r=r.read_shift(4),t.s.c=r.read_shift(4),t.e.c=r.read_shift(4),t}var Oc=jA;function Jr(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ZN(r){var t={},e=r.read_shift(1),n=e>>>1,a=r.read_shift(1),i=r.read_shift(2,"i"),s=r.read_shift(1),c=r.read_shift(1),l=r.read_shift(1);switch(r.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Mc[a];u&&(t.rgb=z0(u));break;case 2:t.rgb=z0([s,c,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function QN(r){var t=r.read_shift(1);r.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function HA(r,t){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,t==1?"lpstr":"lpwstr")}function e8(r){return HA(r,1)}function t8(r){return HA(r,2)}var Fb=2,Sn=3,cv=11,WA=12,lv=19,uv=64,r8=65,n8=71,a8=4108,i8=4126,Pr=80,zA=81,s8=[Pr,zA],o8={1:{n:"CodePage",t:Fb},2:{n:"Category",t:Pr},3:{n:"PresentationFormat",t:Pr},4:{n:"ByteCount",t:Sn},5:{n:"LineCount",t:Sn},6:{n:"ParagraphCount",t:Sn},7:{n:"SlideCount",t:Sn},8:{n:"NoteCount",t:Sn},9:{n:"HiddenCount",t:Sn},10:{n:"MultimediaClipCount",t:Sn},11:{n:"ScaleCrop",t:cv},12:{n:"HeadingPairs",t:a8},13:{n:"TitlesOfParts",t:i8},14:{n:"Manager",t:Pr},15:{n:"Company",t:Pr},16:{n:"LinksUpToDate",t:cv},17:{n:"CharacterCount",t:Sn},19:{n:"SharedDoc",t:cv},22:{n:"HyperlinksChanged",t:cv},23:{n:"AppVersion",t:Sn,p:"version"},24:{n:"DigSig",t:r8},26:{n:"ContentType",t:Pr},27:{n:"ContentStatus",t:Pr},28:{n:"Language",t:Pr},29:{n:"Version",t:Pr},255:{},2147483648:{n:"Locale",t:lv},2147483651:{n:"Behavior",t:lv},1919054434:{}},c8={1:{n:"CodePage",t:Fb},2:{n:"Title",t:Pr},3:{n:"Subject",t:Pr},4:{n:"Author",t:Pr},5:{n:"Keywords",t:Pr},6:{n:"Comments",t:Pr},7:{n:"Template",t:Pr},8:{n:"LastAuthor",t:Pr},9:{n:"RevNumber",t:Pr},10:{n:"EditTime",t:uv},11:{n:"LastPrinted",t:uv},12:{n:"CreatedDate",t:uv},13:{n:"ModifiedDate",t:uv},14:{n:"PageCount",t:Sn},15:{n:"WordCount",t:Sn},16:{n:"CharCount",t:Sn},17:{n:"Thumbnail",t:n8},18:{n:"Application",t:Pr},19:{n:"DocSecurity",t:Sn},255:{},2147483648:{n:"Locale",t:lv},2147483651:{n:"Behavior",t:lv},1919054434:{}},KA={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},l8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function u8(r){return r.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var h8=u8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mc=Xt(h8),zs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},VA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hv={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function qA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function d8(r){var t=qA();if(!r||!r.match)return t;var e={};if((r.match(qr)||[]).forEach(function(n){var a=qe(n);switch(a[0].replace(CN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[a.Extension]=a.ContentType;break;case"<Override":t[Pb[a.ContentType]]!==void 0&&t[Pb[a.ContentType]].push(a.PartName);break}}),t.xmlns!==pr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=e,delete t.calcchains,t}function f8(r,t){var e=mN(Pb),n=[],a;n[n.length]=pn,n[n.length]=Be("Types",null,{xmlns:pr.CT,"xmlns:xsd":pr.xsd,"xmlns:xsi":pr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Be("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){r[l]&&r[l].length>0&&(a=r[l][0],n[n.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:hv[l][t.bookType]||hv[l].xlsx}))},s=function(l){(r[l]||[]).forEach(function(u){n[n.length]=Be("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:hv[l][t.bookType]||hv[l].xlsx})})},c=function(l){(r[l]||[]).forEach(function(u){n[n.length]=Be("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:e[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),s("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ot={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dv(r){var t=r.lastIndexOf("/");return r.slice(0,t+1)+"_rels/"+r.slice(t+1)+".rels"}function U0(r,t){var e={"!id":{}};if(!r)return e;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(r.match(qr)||[]).forEach(function(a){var i=qe(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:D0(i.Target,t);e[c]=s,n[i.Id]=s}}),e["!id"]=n,e}function Ib(r){var t=[pn,Be("Relationships",null,{xmlns:pr.RELS})];return fn(r["!id"]).forEach(function(e){t[t.length]=Be("Relationship",null,r["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Zr(r,t,e,n,a,i){if(a||(a={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),t<0)for(t=r["!idx"];r["!id"]["rId"+t];++t);if(r["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=e,[Ot.HLINK,Ot.XPATH,Ot.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),r["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return r["!id"][a.Id]=a,r[("/"+a.Target).replace("//","/")]=a,t}var p8="application/vnd.oasis.opendocument.spreadsheet";function m8(r,t){for(var e=yb(r),n,a;n=M0.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(a=qe(n[0],!1),a.path=="/"&&a.type!==p8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Rc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],g8=function(){for(var r=new Array(Rc.length),t=0;t<Rc.length;++t){var e=Rc[t],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);r[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function GA(r){var t={};r=Ct(r);for(var e=0;e<Rc.length;++e){var n=Rc[e],a=r.match(g8[e]);a!=null&&a.length>0&&(t[n[1]]=mt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ar(t[n[1]]))}return t}function Db(r,t,e,n,a){a[r]!=null||t==null||t===""||(a[r]=t,t=sr(t),n[n.length]=e?Be(r,t,e):Ea(r,t))}function w8(r,t){var e=t||{},n=[pn,Be("cp:coreProperties",null,{"xmlns:cp":pr.CORE_PROPS,"xmlns:dc":pr.dc,"xmlns:dcterms":pr.dcterms,"xmlns:dcmitype":pr.dcmitype,"xmlns:xsi":pr.xsi})],a={};if(!r&&!e.Props)return n.join("");r&&(r.CreatedDate!=null&&Db("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:vb(r.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),r.ModifiedDate!=null&&Db("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:vb(r.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Rc.length;++i){var s=Rc[i],c=e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:r?r[s[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Db(s[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var XA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function YA(r,t,e,n){var a=[];if(typeof r=="string")a=gA(r,n);else for(var i=0;i<r.length;++i)a=a.concat(r[i].map(function(h){return{v:h}}));var s=typeof t=="string"?gA(t,n).map(function(h){return h.v}):t,c=0,l=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=s.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":e.NamedRanges=l,e.DefinedNames=s.slice(c,c+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=s.slice(c,c+l);break}c+=l}}function v8(r,t,e){var n={};return t||(t={}),r=Ct(r),XA.forEach(function(a){var i=(r.match(O0(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=mt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=r.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&YA(n.HeadingPairs,n.TitlesOfParts,t,e),t}function y8(r){var t=[],e=Be;return r||(r={}),r.Application="SheetJS",t[t.length]=pn,t[t.length]=Be("Properties",null,{xmlns:pr.EXT_PROPS,"xmlns:vt":pr.vt}),XA.forEach(function(n){if(r[n[1]]!==void 0){var a;switch(n[2]){case"string":a=sr(String(r[n[1]]));break;case"bool":a=r[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=e(n[0],a))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+sr(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var x8=/<[^>]+>[^<]*/g;function k8(r,t){var e={},n="",a=r.match(x8);if(a)for(var i=0;i!=a.length;++i){var s=a[i],c=qe(s);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=mt(c.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),u=l[0].slice(4),h=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":e[n]=mt(h);break;case"bool":e[n]=$t(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(h);break;case"filetime":case"date":e[n]=ar(h);break;case"cy":case"error":e[n]=mt(h);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return e}function b8(r){var t=[pn,Be("Properties",null,{xmlns:pr.CUST_PROPS,"xmlns:vt":pr.vt})];if(!r)return t.join("");var e=1;return fn(r).forEach(function(a){++e,t[t.length]=Be("property",ON(r[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:sr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var _8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ob;function E8(r,t,e){Ob||(Ob=pb(_8)),t=Ob[t]||t,r[t]=e}function Mb(r){var t=r.read_shift(4),e=r.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function JA(r,t,e){var n=r.l,a=r.read_shift(0,"lpstr-cp");if(e)for(;r.l-n&3;)++r.l;return a}function ZA(r,t,e){var n=r.read_shift(0,"lpwstr");return n}function QA(r,t,e){return t===31?ZA(r):JA(r,t,e)}function Rb(r,t,e){return QA(r,t,e===!1?0:4)}function S8(r,t){if(!t)throw new Error("VtUnalignedString must have positive length");return QA(r,t,0)}function C8(r){for(var t=r.read_shift(4),e=[],n=0;n!=t;++n){var a=r.l;e[n]=r.read_shift(0,"lpwstr").replace(hn,""),r.l-a&2&&(r.l+=2)}return e}function T8(r){for(var t=r.read_shift(4),e=[],n=0;n!=t;++n)e[n]=r.read_shift(0,"lpstr-cp").replace(hn,"");return e}function A8(r){var t=r.l,e=fv(r,zA);r[r.l]==0&&r[r.l+1]==0&&r.l-t&2&&(r.l+=2);var n=fv(r,Sn);return[e,n]}function F8(r){for(var t=r.read_shift(4),e=[],n=0;n<t/2;++n)e.push(A8(r));return e}function e3(r,t){for(var e=r.read_shift(4),n={},a=0;a!=e;++a){var i=r.read_shift(4),s=r.read_shift(4);n[i]=r.read_shift(s,t===1200?"utf16le":"utf8").replace(hn,"").replace(P0,"!"),t===1200&&s%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function t3(r){var t=r.read_shift(4),e=r.slice(r.l,r.l+t);return r.l+=t,(t&3)>0&&(r.l+=4-(t&3)&3),e}function P8(r){var t={};return t.Size=r.read_shift(4),r.l+=t.Size+3-(t.Size-1)%4,t}function fv(r,t,e){var n=r.read_shift(2),a,i=e||{};if(r.l+=2,t!==WA&&n!==t&&s8.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===WA?n:t){case 2:return a=r.read_shift(2,"i"),i.raw||(r.l+=2),a;case 3:return a=r.read_shift(4,"i"),a;case 11:return r.read_shift(4)!==0;case 19:return a=r.read_shift(4),a;case 30:return JA(r,n,4).replace(hn,"");case 31:return ZA(r);case 64:return Mb(r);case 65:return t3(r);case 71:return P8(r);case 80:return Rb(r,n,!i.raw).replace(hn,"");case 81:return S8(r,n).replace(hn,"");case 4108:return F8(r);case 4126:case 4127:return n==4127?C8(r):T8(r);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function r3(r,t){var e=r.l,n=r.read_shift(4),a=r.read_shift(4),i=[],s=0,c=0,l=-1,u={};for(s=0;s!=a;++s){var h=r.read_shift(4),d=r.read_shift(4);i[s]=[h,d+e]}i.sort(function(k,x){return k[1]-x[1]});var f={};for(s=0;s!=a;++s){if(r.l!==i[s][1]){var m=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:r.l+2===i[s][1]&&(r.l+=2,m=!1);break;case 80:r.l<=i[s][1]&&(r.l=i[s][1],m=!1);break;case 4108:r.l<=i[s][1]&&(r.l=i[s][1],m=!1);break}if((!t||s==0)&&r.l<=i[s][1]&&(m=!1,r.l=i[s][1]),m)throw new Error("Read Error: Expected address "+i[s][1]+" at "+r.l+" :"+s)}if(t){var w=t[i[s][0]];if(f[w.n]=fv(r,w.t,{raw:!0}),w.p==="version"&&(f[w.n]=String(f[w.n]>>16)+"."+("0000"+String(f[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(f[w.n]){case 0:f[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ka(c=f[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[w.n])}}else if(i[s][0]===1){if(c=f.CodePage=fv(r,Fb),ka(c),l!==-1){var p=r.l;r.l=i[l][1],u=e3(r,c),r.l=p}}else if(i[s][0]===0){if(c===0){l=s,r.l=i[s+1][1];continue}u=e3(r,c)}else{var g=u[i[s][0]],v;switch(r[r.l]){case 65:r.l+=4,v=t3(r);break;case 30:r.l+=4,v=Rb(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,v=Rb(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,v=r.read_shift(4,"i");break;case 19:r.l+=4,v=r.read_shift(4);break;case 5:r.l+=4,v=r.read_shift(8,"f");break;case 11:r.l+=4,v=Yt(r,4);break;case 64:r.l+=4,v=ar(Mb(r));break;default:throw new Error("unparsed value: "+r[r.l])}f[g]=v}}return r.l=e+n,f}function n3(r,t,e){var n=r.content;if(!n)return{};zr(n,0);var a,i,s,c,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==it.utils.consts.HEADER_CLSID&&h!==e)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var d=r3(n,t),f={SystemIdentifier:u};for(var m in d)f[m]=d[m];if(f.FMTID=i,a===1)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var w;try{w=r3(n,null)}catch{}for(m in w)f[m]=w[m];return f.FMTID=[i,s],f}function Ks(r,t){return r.read_shift(t),null}function I8(r,t,e){for(var n=[],a=r.l+t;r.l<a;)n.push(e(r,a-r.l));if(a!==r.l)throw new Error("Slurp error");return n}function Yt(r,t){return r.read_shift(t)===1}function cr(r){return r.read_shift(2,"u")}function a3(r,t){return I8(r,t,cr)}function D8(r){var t=r.read_shift(1),e=r.read_shift(1);return e===1?t:t===1}function $0(r,t,e){var n=r.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var i=r.read_shift(1);i&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var s=n?r.read_shift(n,a):"";return s}function O8(r){var t=r.read_shift(2),e=r.read_shift(1),n=e&4,a=e&8,i=1+(e&1),s=0,c,l={};a&&(s=r.read_shift(2)),n&&(c=r.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":r.read_shift(t,u);return a&&(r.l+=4*s),n&&(r.l+=c),l.t=h,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Nc(r,t,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return r.read_shift(t,"cpstr");if(e.biff>=12)return r.read_shift(t,"dbcs-cont")}var a=r.read_shift(1);return a===0?n=r.read_shift(t,"sbcs-cont"):n=r.read_shift(t,"dbcs-cont"),n}function j0(r,t,e){var n=r.read_shift(e&&e.biff==2?1:2);return n===0?(r.l++,""):Nc(r,n,e)}function Lc(r,t,e){if(e.biff>5)return j0(r,t,e);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,e.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function M8(r){var t=r.read_shift(1);r.l++;var e=r.read_shift(2);return r.l+=2,[t,e]}function R8(r){var t=r.read_shift(4),e=r.l,n=!1;t>24&&(r.l+=t-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=e);var a=r.read_shift((n?t-24:t)>>1,"utf16le").replace(hn,"");return n&&(r.l+=24),a}function N8(r){for(var t=r.read_shift(2),e="";t-- >0;)e+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=r.read_shift(4);if(a===0)return e+n.replace(/\\/g,"/");var i=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=r.read_shift(i>>1,"utf16le").replace(hn,"");return e+s}function L8(r,t){var e=r.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return R8(r);case"0303000000000000c000000000000046":return N8(r);default:throw new Error("Unsupported Moniker "+e)}}function pv(r){var t=r.read_shift(4),e=t>0?r.read_shift(t,"utf16le").replace(hn,""):"";return e}function B8(r,t){var e=r.l+t,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=r.read_shift(2);r.l+=2;var i,s,c,l,u="",h,d;a&16&&(i=pv(r,e-r.l)),a&128&&(s=pv(r,e-r.l)),(a&257)===257&&(c=pv(r,e-r.l)),(a&257)===1&&(l=L8(r,e-r.l)),a&8&&(u=pv(r,e-r.l)),a&32&&(h=r.read_shift(16)),a&64&&(d=Mb(r)),r.l=e;var f=s||c||l||"";f&&u&&(f+="#"+u),f||(f="#"+u),a&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var m={Target:f};return h&&(m.guid=h),d&&(m.time=d),i&&(m.Tooltip=i),m}function i3(r){var t=r.read_shift(1),e=r.read_shift(1),n=r.read_shift(1),a=r.read_shift(1);return[t,e,n,a]}function s3(r,t){var e=i3(r);return e[3]=0,e}function ei(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2);return{r:t,c:e,ixfe:n}}function U8(r){var t=r.read_shift(2),e=r.read_shift(2);return r.l+=8,{type:t,flags:e}}function $8(r,t,e){return t===0?"":Lc(r,t,e)}function j8(r,t,e){var n=e.biff>8?4:2,a=r.read_shift(n),i=r.read_shift(n,"i"),s=r.read_shift(n,"i");return[a,i,s]}function o3(r){var t=r.read_shift(2),e=Ab(r);return[t,e]}function H8(r,t,e){r.l+=4,t-=4;var n=r.l+t,a=$0(r,t,e),i=r.read_shift(2);if(n-=r.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return r.l+=i,a}function mv(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2);return{s:{c:n,r:t},e:{c:a,r:e}}}function c3(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(1),a=r.read_shift(1);return{s:{c:n,r:t},e:{c:a,r:e}}}var W8=c3;function l3(r){r.l+=4;var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[e,t,n]}function z8(r){var t={};return r.l+=4,r.l+=16,t.fSharedNote=r.read_shift(2),r.l+=4,t}function K8(r){var t={};return r.l+=4,r.cf=r.read_shift(2),t}function Qr(r){r.l+=2,r.l+=r.read_shift(2)}var V8={0:Qr,4:Qr,5:Qr,6:Qr,7:K8,8:Qr,9:Qr,10:Qr,11:Qr,12:Qr,13:z8,14:Qr,15:Qr,16:Qr,17:Qr,18:Qr,19:Qr,20:Qr,21:l3};function q8(r,t){for(var e=r.l+t,n=[];r.l<e;){var a=r.read_shift(2);r.l-=2;try{n.push(V8[a](r,e-r.l))}catch{return r.l=e,n}}return r.l!=e&&(r.l=e),n}function gv(r,t){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=r.read_shift(2),t-=2,t>=2&&(e.dt=r.read_shift(2),r.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return r.read_shift(t),e}function G8(r,t){return t===0||r.read_shift(2),1200}function X8(r,t,e){if(e.enc)return r.l+=t,"";var n=r.l,a=Lc(r,0,e);return r.read_shift(t+n-r.l),a}function Y8(r,t,e){var n=e&&e.biff==8||t==2?r.read_shift(2):(r.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function J8(r,t,e){var n=r.read_shift(4),a=r.read_shift(1)&3,i=r.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=$0(r,0,e);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function Z8(r,t){for(var e=r.l+t,n=r.read_shift(4),a=r.read_shift(4),i=[],s=0;s!=a&&r.l<e;++s)i.push(O8(r));return i.Count=n,i.Unique=a,i}function Q8(r,t){var e={};return e.dsst=r.read_shift(2),r.l+=t-2,e}function eL(r){var t={};t.r=r.read_shift(2),t.c=r.read_shift(2),t.cnt=r.read_shift(2)-t.c;var e=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=e/20),t}function tL(r){var t=U8(r);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var e=r.read_shift(4);return e!==0}function rL(r){return r.read_shift(2),r.read_shift(4)}function u3(r,t,e){var n=0;e&&e.biff==2||(n=r.read_shift(2));var a=r.read_shift(2);e&&e.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function nL(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),c=r.read_shift(2),l=r.read_shift(2),u=r.read_shift(2);return{Pos:[t,e],Dim:[n,a],Flags:i,CurTab:s,FirstTab:c,Selected:l,TabRatio:u}}function aL(r,t,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function iL(){}function sL(r,t,e){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=$0(r,0,e),n}function oL(r){var t=ei(r);return t.isst=r.read_shift(4),t}function cL(r,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=r.l+t,a=ei(r);e.biff==2&&r.l++;var i=j0(r,n-r.l,e);return a.val=i,a}function lL(r,t,e){var n=r.read_shift(2),a=Lc(r,0,e);return[n,a]}var uL=Lc;function h3(r,t,e){var n=r.l+t,a=e.biff==8||!e.biff?4:2,i=r.read_shift(a),s=r.read_shift(a),c=r.read_shift(2),l=r.read_shift(2);return r.l=n,{s:{r:i,c},e:{r:s,c:l}}}function hL(r){var t=r.read_shift(2),e=r.read_shift(2),n=o3(r);return{r:t,c:e,ixfe:n[0],rknum:n[1]}}function dL(r,t){for(var e=r.l+t-2,n=r.read_shift(2),a=r.read_shift(2),i=[];r.l<e;)i.push(o3(r));if(r.l!==e)throw new Error("MulRK read error");var s=r.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function fL(r,t){for(var e=r.l+t-2,n=r.read_shift(2),a=r.read_shift(2),i=[];r.l<e;)i.push(r.read_shift(2));if(r.l!==e)throw new Error("MulBlank read error");var s=r.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function pL(r,t,e,n){var a={},i=r.read_shift(4),s=r.read_shift(4),c=r.read_shift(4),l=r.read_shift(2);return a.patternType=l8[c>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function mL(r,t,e){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=pL(r,t,n.fStyle,e),n}function gL(r){r.l+=4;var t=[r.read_shift(2),r.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function d3(r,t,e){var n=ei(r);(e.biff==2||t==9)&&++r.l;var a=D8(r);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function wL(r,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=ei(r),a=Jr(r);return n.val=a,n}var f3=$8;function vL(r,t,e){var n=r.l+t,a=r.read_shift(2),i=r.read_shift(2);if(e.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Nc(r,i),c=[];n>r.l;)c.push(j0(r));return[i,a,s,c]}function p3(r,t,e){var n=r.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(a=H8(r,t-2,e)),i.body=a||r.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var yL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function m3(r,t,e){var n=r.l+t,a=r.read_shift(2),i=r.read_shift(1),s=r.read_shift(1),c=r.read_shift(e&&e.biff==2?1:2),l=0;(!e||e.biff>=5)&&(e.biff!=5&&(r.l+=2),l=r.read_shift(2),e.biff==5&&(r.l+=2),r.l+=4);var u=Nc(r,s,e);a&32&&(u=yL[u.charCodeAt(0)]);var h=n-r.l;e&&e.biff==2&&--h;var d=n==r.l||c===0||!(h>0)?[]:l9(r,h,e,c);return{chKey:i,Name:u,itab:l,rgce:d}}function g3(r,t,e){if(e.biff<8)return xL(r,t,e);for(var n=[],a=r.l+t,i=r.read_shift(e.biff>8?4:2);i--!==0;)n.push(j8(r,e.biff>8?12:6,e));if(r.l!=a)throw new Error("Bad ExternSheet: "+r.l+" != "+a);return n}function xL(r,t,e){r[r.l+1]==3&&r[r.l]++;var n=$0(r,t,e);return n.charCodeAt(0)==3?n.slice(1):n}function kL(r,t,e){if(e.biff<8){r.l+=t;return}var n=r.read_shift(2),a=r.read_shift(2),i=Nc(r,n,e),s=Nc(r,a,e);return[i,s]}function bL(r,t,e){var n=c3(r);r.l++;var a=r.read_shift(1);return t-=8,[u9(r,t,e),a,n]}function w3(r,t,e){var n=W8(r);switch(e.biff){case 2:r.l++,t-=7;break;case 3:case 4:r.l+=2,t-=8;break;default:r.l+=6,t-=12}return[n,o9(r,t,e)]}function _L(r){var t=r.read_shift(4)!==0,e=r.read_shift(4)!==0,n=r.read_shift(4);return[t,e,n]}function EL(r,t,e){if(!(e.biff<8)){var n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),c=Lc(r,0,e);return e.biff<8&&r.read_shift(1),[{r:n,c:a},c,s,i]}}function SL(r,t,e){return EL(r,t,e)}function CL(r,t){for(var e=[],n=r.read_shift(2);n--;)e.push(mv(r));return e}function TL(r,t,e){if(e&&e.biff<8)return FL(r,t,e);var n=l3(r),a=q8(r,t-22,n[1]);return{cmo:n,ft:a}}var AL={8:function(r,t){var e=r.l+t;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var a=r.read_shift(1);return r.l+=a,r.l=e,{fmt:n}}};function FL(r,t,e){r.l+=4;var n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,t-=36;var s=[];return s.push((AL[n]||Gr)(r,t,e)),{cmo:[a,n,i],ft:s}}function PL(r,t,e){var n=r.l,a="";try{r.l+=4;var i=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?r.l+=6:s=M8(r,6,e);var c=r.read_shift(2);r.read_shift(2),cr(r,2);var l=r.read_shift(2);r.l+=l;for(var u=1;u<r.lens.length-1;++u){if(r.l-n!=r.lens[u])throw new Error("TxO: bad continue record");var h=r[r.l],d=Nc(r,r.lens[u+1]-r.lens[u]-1);if(a+=d,a.length>=(h?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return r.l=n+t,{t:a}}catch{return r.l=n+t,{t:a}}}function IL(r,t){var e=mv(r);r.l+=16;var n=B8(r,t-24);return[e,n]}function DL(r,t){r.read_shift(2);var e=mv(r),n=r.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(hn,""),[e,n]}function OL(r){var t=[0,0],e;return e=r.read_shift(2),t[0]=KA[e]||e,e=r.read_shift(2),t[1]=KA[e]||e,t}function ML(r){for(var t=r.read_shift(2),e=[];t-- >0;)e.push(s3(r));return e}function RL(r){for(var t=r.read_shift(2),e=[];t-- >0;)e.push(s3(r));return e}function NL(r){r.l+=2;var t={cxfs:0,crc:0};return t.cxfs=r.read_shift(2),t.crc=r.read_shift(4),t}function v3(r,t,e){if(!e.cellStyles)return Gr(r,t);var n=e&&e.biff>=12?4:2,a=r.read_shift(n),i=r.read_shift(n),s=r.read_shift(n),c=r.read_shift(n),l=r.read_shift(2);n==2&&(r.l+=2);var u={s:a,e:i,w:s,ixfe:c,flags:l};return(e.biff>=5||!e.biff)&&(u.level=l>>8&7),u}function LL(r,t){var e={};return t<32||(r.l+=16,e.header=Jr(r),e.footer=Jr(r),r.l+=2),e}function BL(r,t,e){var n={area:!1};if(e.biff!=5)return r.l+=t,n;var a=r.read_shift(1);return r.l+=3,a&16&&(n.area=!0),n}var UL=ei,$L=a3,jL=j0;function HL(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(4),a={fmt:t,env:e,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,a}function WL(r,t,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=ei(r);++r.l;var a=Lc(r,t-7,e);return n.t="str",n.val=a,n}function zL(r){var t=ei(r);++r.l;var e=Jr(r);return t.t="n",t.val=e,t}function KL(r){var t=ei(r);++r.l;var e=r.read_shift(2);return t.t="n",t.val=e,t}function VL(r){var t=r.read_shift(1);return t===0?(r.l++,""):r.read_shift(t,"sbcs-cont")}function qL(r,t){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=t-13}function GL(r,t,e){var n=r.l+t,a=ei(r),i=r.read_shift(2),s=Nc(r,i,e);return r.l=n,a.t="str",a.val=s,a}var XL=[2,3,48,49,131,139,140,245],y3=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=pb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(c,l){var u=[],h=Bs(1);switch(l.type){case"base64":h=Zn(On(c));break;case"binary":h=Zn(c);break;case"buffer":case"array":h=c;break}zr(h,0);var d=h.read_shift(1),f=!!(d&136),m=!1,w=!1;switch(d){case 2:break;case 3:break;case 48:m=!0,f=!0;break;case 49:m=!0,f=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,g=521;d==2&&(p=h.read_shift(2)),h.l+=3,d!=2&&(p=h.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(g=h.read_shift(2));var v=h.read_shift(2),k=l.codepage||1252;d!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(k=r[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var x=[],S={},I=Math.min(h.length,d==2?521:g-10-(m?264:0)),O=w?32:11;h.l<I&&h[h.l]!=13;)switch(S={},S.name=Ns.utils.decode(k,h.slice(h.l,h.l+O)).replace(/[\u0000\r\n].*$/g,""),h.l+=O,S.type=String.fromCharCode(h.read_shift(1)),d!=2&&!w&&(S.offset=h.read_shift(4)),S.len=h.read_shift(1),d==2&&(S.offset=h.read_shift(2)),S.dec=h.read_shift(1),S.name.length&&x.push(S),d!=2&&(h.l+=w?13:14),S.type){case"B":(!m||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(h[h.l]!==13&&(h.l=g-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=g;var E=0,T=0;for(u[0]=[],T=0;T!=x.length;++T)u[0][T]=x[T].name;for(;p-- >0;){if(h[h.l]===42){h.l+=v;continue}for(++h.l,u[++E]=[],T=0,T=0;T!=x.length;++T){var P=h.slice(h.l,h.l+x[T].len);h.l+=x[T].len,zr(P,0);var W=Ns.utils.decode(k,P);switch(x[T].type){case"C":W.trim().length&&(u[E][T]=W.replace(/\s+$/,""));break;case"D":W.length===8?u[E][T]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):u[E][T]=W;break;case"F":u[E][T]=parseFloat(W.trim());break;case"+":case"I":u[E][T]=w?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":u[E][T]=!0;break;case"N":case"F":u[E][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[E][T]="##MEMO##"+(w?parseInt(W.trim(),10):P.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(u[E][T]=+W||0);break;case"@":u[E][T]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[E][T]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[E][T]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][T]=-P.read_shift(-8,"f");break;case"B":if(m&&x[T].len==8){u[E][T]=P.read_shift(8,"f");break}case"G":case"P":P.l+=x[T].len;break;case"0":if(x[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[T].type)}}}if(d!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=x,u}function n(c,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=ch(e(c,u),u);return h["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,h}function a(c,l){try{return Ws(n(c,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(c,l){var u=l||{};if(+u.codepage>=0&&ka(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=kb(),d=r_(c,{header:1,raw:!0,cellDates:!0}),f=d[0],m=d.slice(1),w=c["!cols"]||[],p=0,g=0,v=0,k=1;for(p=0;p<f.length;++p){if(((w[p]||{}).DBF||{}).name){f[p]=w[p].DBF.name,++v;continue}if(f[p]!=null){if(++v,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(g=0;g<1024;++g)if(f.indexOf(f[p]+"_"+g)==-1){f[p]+="_"+g;break}}}}var x=Dt(c["!ref"]),S=[],I=[],O=[];for(p=0;p<=x.e.c-x.s.c;++p){var E="",T="",P=0,W=[];for(g=0;g<m.length;++g)m[g][p]!=null&&W.push(m[g][p]);if(W.length==0||f[p]==null){S[p]="?";continue}for(g=0;g<W.length;++g){switch(typeof W[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=W[g]instanceof Date?"D":"C";break;default:T="C"}P=Math.max(P,String(W[g]).length),E=E&&E!=T?"C":T}P>250&&(P=250),T=((w[p]||{}).DBF||{}).type,T=="C"&&w[p].DBF.len>P&&(P=w[p].DBF.len),E=="B"&&T=="N"&&(E="N",O[p]=w[p].DBF.dec,P=w[p].DBF.len),I[p]=E=="C"||T=="N"?P:i[E]||0,k+=I[p],S[p]=E}var U=h.next(32);for(U.write_shift(4,318902576),U.write_shift(4,m.length),U.write_shift(2,296+32*v),U.write_shift(2,k),p=0;p<4;++p)U.write_shift(4,0);for(U.write_shift(4,0|(+t[FT]||3)<<8),p=0,g=0;p<f.length;++p)if(f[p]!=null){var A=h.next(32),N=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,N,"sbcs"),A.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),A.write_shift(4,g),A.write_shift(1,I[p]||i[S[p]]||0),A.write_shift(1,O[p]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),g+=I[p]||i[S[p]]||0}var C=h.next(264);for(C.write_shift(4,13),p=0;p<65;++p)C.write_shift(4,0);for(p=0;p<m.length;++p){var K=h.next(k);for(K.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(S[g]){case"L":K.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":K.write_shift(8,m[p][g]||0,"f");break;case"N":var ne="0";for(typeof m[p][g]=="number"&&(ne=m[p][g].toFixed(O[g]||0)),v=0;v<I[g]-ne.length;++v)K.write_shift(1,32);K.write_shift(1,ne,"sbcs");break;case"D":m[p][g]?(K.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var X=String(m[p][g]!=null?m[p][g]:"").slice(0,I[g]);for(K.write_shift(1,X,"sbcs"),v=0;v<I[g]-X.length;++v)K.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),YL=function(){var r={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+fn(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,m){var w=r[m];return typeof w=="number"?DT(w):w},n=function(f,m,w){var p=m.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return p==59?f:DT(p)};r["|"]=254;function a(f,m){switch(m.type){case"base64":return i(On(f),m);case"binary":return i(f,m);case"buffer":return i(ot&&Buffer.isBuffer(f)?f.toString("binary"):Us(f),m);case"array":return i(Ac(f),m)}throw new Error("Unrecognized type "+m.type)}function i(f,m){var w=f.split(/[\n\r]+/),p=-1,g=-1,v=0,k=0,x=[],S=[],I=null,O={},E=[],T=[],P=[],W=0,U;for(+m.codepage>=0&&ka(+m.codepage);v!==w.length;++v){W=0;var A=w[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,e),N=A.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),C=N[0],K;if(A.length>0)switch(C){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&S.push(A.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,X=!1,oe=!1,q=!1,se=-1,Q=-1;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"A":break;case"X":g=parseInt(N[k].slice(1))-1,X=!0;break;case"Y":for(p=parseInt(N[k].slice(1))-1,X||(g=0),U=x.length;U<=p;++U)x[U]=[];break;case"K":K=N[k].slice(1),K.charAt(0)==='"'?K=K.slice(1,K.length-1):K==="TRUE"?K=!0:K==="FALSE"?K=!1:isNaN(_a(K))?isNaN(sh(K).getDate())||(K=ar(K)):(K=_a(K),I!==null&&ih(I)&&(K=av(K))),ne=!0;break;case"E":q=!0;var R=uh(N[k].slice(1),{r:p,c:g});x[p][g]=[x[p][g],R];break;case"S":oe=!0,x[p][g]=[x[p][g],"S5S"];break;case"G":break;case"R":se=parseInt(N[k].slice(1))-1;break;case"C":Q=parseInt(N[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}if(ne&&(x[p][g]&&x[p][g].length==2?x[p][g][0]=K:x[p][g]=K,I=null),oe){if(q)throw new Error("SYLK shared formula cannot have own formula");var ae=se>-1&&x[se][Q];if(!ae||!ae[1])throw new Error("SYLK shared formula cannot find base");x[p][g][1]=I3(ae[1],{r:p-se,c:g-Q})}break;case"F":var L=0;for(k=1;k<N.length;++k)switch(N[k].charAt(0)){case"X":g=parseInt(N[k].slice(1))-1,++L;break;case"Y":for(p=parseInt(N[k].slice(1))-1,U=x.length;U<=p;++U)x[U]=[];break;case"M":W=parseInt(N[k].slice(1))/20;break;case"F":break;case"G":break;case"P":I=S[parseInt(N[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=N[k].slice(1).split(" "),U=parseInt(P[0],10);U<=parseInt(P[1],10);++U)W=parseInt(P[2],10),T[U-1]=W===0?{hidden:!0}:{wch:W},lh(T[U-1]);break;case"C":g=parseInt(N[k].slice(1))-1,T[g]||(T[g]={});break;case"R":p=parseInt(N[k].slice(1))-1,E[p]||(E[p]={}),W>0?(E[p].hpt=W,E[p].hpx=V0(W)):W===0&&(E[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}L<1&&(I=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}}return E.length>0&&(O["!rows"]=E),T.length>0&&(O["!cols"]=T),m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),[x,O]}function s(f,m){var w=a(f,m),p=w[0],g=w[1],v=ch(p,m);return fn(g).forEach(function(k){v[k]=g[k]}),v}function c(f,m){return Ws(s(f,m),m)}function l(f,m,w,p){var g="C;Y"+(w+1)+";X"+(p+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+K7(f.f,{r:w,c:p}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(f,m){m.forEach(function(w,p){var g="F;W"+(p+1)+" "+(p+1)+" ";w.hidden?g+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=vv(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=K0(w.wpx)),typeof w.wch=="number"&&(g+=Math.round(w.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function h(f,m){m.forEach(function(w,p){var g="F;";w.hidden?g+="M0;":w.hpt?g+="M"+20*w.hpt+";":w.hpx&&(g+="M"+20*xv(w.hpx)+";"),g.length>2&&f.push(g+"R"+(p+1))})}function d(f,m){var w=["ID;PWXL;N;E"],p=[],g=Dt(f["!ref"]),v,k=Array.isArray(f),x=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),f["!cols"]&&u(w,f["!cols"]),f["!rows"]&&h(w,f["!rows"]),w.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var I=g.s.c;I<=g.e.c;++I){var O=Ye({r:S,c:I});v=k?(f[S]||[])[I]:f[O],!(!v||v.v==null&&(!v.f||v.F))&&p.push(l(v,f,S,I))}return w.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:c,to_sheet:s,from_sheet:d}}(),JL=function(){function r(i,s){switch(s.type){case"base64":return t(On(i),s);case"binary":return t(i,s);case"buffer":return t(ot&&Buffer.isBuffer(i)?i.toString("binary"):Us(i),s);case"array":return t(Ac(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var c=i.split(`
`),l=-1,u=-1,h=0,d=[];h!==c.length;++h){if(c[h].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var f=c[h].trim().split(","),m=f[0],w=f[1];++h;for(var p=c[h]||"";(p.match(/["]/g)||[]).length&1&&h<c.length-1;)p+=`
`+c[++h];switch(p=p.trim(),+m){case-1:if(p==="BOT"){d[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[l][u]=!0:p==="FALSE"?d[l][u]=!1:isNaN(_a(w))?isNaN(sh(w).getDate())?d[l][u]=w:d[l][u]=ar(w):d[l][u]=_a(w),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function e(i,s){return ch(r(i,s),s)}function n(i,s){return Ws(e(i,s),s)}var a=function(){var i=function(l,u,h,d,f){l.push(u),l.push(h+","+d),l.push('"'+f.replace(/"/g,'""')+'"')},s=function(l,u,h,d){l.push(u+","+h),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],h=Dt(l["!ref"]),d,f=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,h.e.r-h.s.r+1,""),i(u,"TUPLES",0,h.e.c-h.s.c+1,""),i(u,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){s(u,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var p=Ye({r:m,c:w});if(d=f?(l[m]||[])[w]:l[p],!d){s(u,1,0,"");continue}switch(d.t){case"n":var g=d.w;!g&&d.v!=null&&(g=d.v),g==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,g,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ea(d.z||Xe[14],Vr(ar(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,k=u.join(v);return k}}();return{to_workbook:n,to_sheet:e,from_sheet:a}}(),ZL=function(){function r(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(d,f){for(var m=d.split(`
`),w=-1,p=-1,g=0,v=[];g!==m.length;++g){var k=m[g].trim().split(":");if(k[0]==="cell"){var x=Xr(k[1]);if(v.length<=x.r)for(w=v.length;w<=x.r;++w)v[w]||(v[w]=[]);switch(w=x.r,p=x.c,k[2]){case"t":v[w][p]=r(k[3]);break;case"v":v[w][p]=+k[3];break;case"vtf":var S=k[k.length-1];case"vtc":switch(k[3]){case"nl":v[w][p]=!!+k[4];break;default:v[w][p]=+k[4];break}k[2]=="vtf"&&(v[w][p]=[v[w][p],S])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function n(d,f){return ch(e(d,f),f)}function a(d,f){return Ws(n(d,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var f=[],m=[],w,p="",g=Hs(d["!ref"]),v=Array.isArray(d),k=g.s.r;k<=g.e.r;++k)for(var x=g.s.c;x<=g.e.c;++x)if(p=Ye({r:k,c:x}),w=v?(d[k]||[])[x]:d[p],!(!w||w.v==null||w.t==="z")){switch(m=["cell",p,"t"],w.t){case"s":case"str":m.push(t(w.v));break;case"n":w.f?(m[2]="vtf",m[3]="n",m[4]=w.v,m[5]=t(w.f)):(m[2]="v",m[3]=w.v);break;case"b":m[2]="vt"+(w.f?"f":"c"),m[3]="nl",m[4]=w.v?"1":"0",m[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var S=Vr(ar(w.v));m[2]="vtc",m[3]="nd",m[4]=""+S,m[5]=w.w||ea(w.z||Xe[14],S);break;case"e":continue}f.push(m.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function h(d){return[i,s,c,s,u(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),H0=function(){function r(h,d,f,m,w){w.raw?d[f][m]=h:h===""||(h==="TRUE"?d[f][m]=!0:h==="FALSE"?d[f][m]=!1:isNaN(_a(h))?isNaN(sh(h).getDate())?d[f][m]=h:d[f][m]=ar(h):d[f][m]=_a(h))}function t(h,d){var f=d||{},m=[];if(!h||h.length===0)return m;for(var w=h.split(/[\r\n]/),p=w.length-1;p>=0&&w[p].length===0;)--p;for(var g=10,v=0,k=0;k<=p;++k)v=w[k].indexOf(" "),v==-1?v=w[k].length:v++,g=Math.max(g,v);for(k=0;k<=p;++k){m[k]=[];var x=0;for(r(w[k].slice(0,g).trim(),m,k,x,f),x=1;x<=(w[k].length-g)/10+1;++x)r(w[k].slice(g+(x-1)*10,g+x*10).trim(),m,k,x,f)}return f.sheetRows&&(m=m.slice(0,f.sheetRows)),m}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var d={},f=!1,m=0,w=0;m<h.length;++m)(w=h.charCodeAt(m))==34?f=!f:!f&&w in e&&(d[w]=(d[w]||0)+1);w=[];for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&w.push([d[m],m]);if(!w.length){d=n;for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&w.push([d[m],m])}return w.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),e[w.pop()[1]]||44}function i(h,d){var f=d||{},m="",w=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=a(h.slice(0,1024)):f&&f.FS?m=f.FS:m=a(h.slice(0,1024));var g=0,v=0,k=0,x=0,S=0,I=m.charCodeAt(0),O=!1,E=0,T=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=f.dateNF!=null?lN(f.dateNF):null;function W(){var U=h.slice(x,S),A={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)A.t="z";else if(f.raw)A.t="s",A.v=U;else if(U.trim().length===0)A.t="s",A.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(A.t="s",A.v=U.slice(2,-1).replace(/""/g,'"')):q7(U)?(A.t="n",A.f=U.slice(1)):(A.t="s",A.v=U);else if(U=="TRUE")A.t="b",A.v=!0;else if(U=="FALSE")A.t="b",A.v=!1;else if(!isNaN(k=_a(U)))A.t="n",f.cellText!==!1&&(A.w=U),A.v=k;else if(!isNaN(sh(U).getDate())||P&&U.match(P)){A.z=f.dateNF||Xe[14];var N=0;P&&U.match(P)&&(U=uN(U,f.dateNF,U.match(P)||[]),N=1),f.cellDates?(A.t="d",A.v=ar(U,N)):(A.t="n",A.v=Vr(ar(U,N))),f.cellText!==!1&&(A.w=ea(A.z,A.v instanceof Date?Vr(A.v):A.v)),f.cellNF||delete A.z}else A.t="s",A.v=U;if(A.t=="z"||(f.dense?(w[g]||(w[g]=[]),w[g][v]=A):w[Ye({c:v,r:g})]=A),x=S+1,T=h.charCodeAt(x),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),E==I)++v;else if(v=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;S<h.length;++S)switch(E=h.charCodeAt(S)){case 34:T===34&&(O=!O);break;case I:case 10:case 13:if(!O&&W())break e;break}return S-x>0&&W(),w["!ref"]=st(p),w}function s(h,d){return!(d&&d.PRN)||d.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,d):ch(t(h,d),d)}function c(h,d){var f="",m=d.type=="string"?[0,0,0,0]:Qb(h,d);switch(d.type){case"base64":f=On(h);break;case"binary":f=h;break;case"buffer":d.codepage==65001?f=h.toString("utf8"):d.codepage&&typeof Ns<"u"?f=Ns.utils.decode(d.codepage,h):f=ot&&Buffer.isBuffer(h)?h.toString("binary"):Us(h);break;case"array":f=Ac(h);break;case"string":f=h;break;default:throw new Error("Unrecognized type "+d.type)}return m[0]==239&&m[1]==187&&m[2]==191?f=Ct(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=Ct(f):d.type=="binary"&&typeof Ns<"u"&&d.codepage&&(f=Ns.utils.decode(d.codepage,Ns.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?ZL.to_sheet(d.type=="string"?f:Ct(f),d):s(f,d)}function l(h,d){return Ws(c(h,d),d)}function u(h){for(var d=[],f=Dt(h["!ref"]),m,w=Array.isArray(h),p=f.s.r;p<=f.e.r;++p){for(var g=[],v=f.s.c;v<=f.e.c;++v){var k=Ye({r:p,c:v});if(m=w?(h[p]||[])[v]:h[k],!m||m.v==null){g.push("          ");continue}for(var x=(m.w||(Hi(m),m.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(v===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:u}}();function QL(r,t){var e=t||{},n=!!e.WTF;e.WTF=!0;try{var a=YL.to_workbook(r,e);return e.WTF=n,a}catch(i){if(e.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return H0.to_workbook(r,t)}}var W0=function(){function r(R,ae,L){if(R){zr(R,R.l||0);for(var M=L.Enum||se;R.l<R.length;){var ce=R.read_shift(2),ke=M[ce]||M[65535],ue=R.read_shift(2),ve=R.l+ue,ge=ke.f&&ke.f(R,ue,L);if(R.l=ve,ae(ge,ke,ce))return}}}function t(R,ae){switch(ae.type){case"base64":return e(Zn(On(R)),ae);case"binary":return e(Zn(R),ae);case"buffer":case"array":return e(R,ae)}throw"Unsupported type "+ae.type}function e(R,ae){if(!R)return R;var L=ae||{},M=L.dense?[]:{},ce="Sheet1",ke="",ue=0,ve={},ge=[],te=[],D={s:{r:0,c:0},e:{r:0,c:0}},he=L.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)L.Enum=se,r(R,function(j,z,ie){switch(ie){case 0:L.vers=j,j>=4096&&(L.qpro=!0);break;case 6:D=j;break;case 204:j&&(ke=j);break;case 222:ke=j;break;case 15:case 51:L.qpro||(j[1].v=j[1].v.slice(1));case 13:case 14:case 16:ie==14&&(j[2]&112)==112&&(j[2]&15)>1&&(j[2]&15)<15&&(j[1].z=L.dateNF||Xe[14],L.cellDates&&(j[1].t="d",j[1].v=av(j[1].v))),L.qpro&&j[3]>ue&&(M["!ref"]=st(D),ve[ce]=M,ge.push(ce),M=L.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ue=j[3],ce=ke||"Sheet"+(ue+1),ke="");var we=L.dense?(M[j[0].r]||[])[j[0].c]:M[Ye(j[0])];if(we){we.t=j[1].t,we.v=j[1].v,j[1].z!=null&&(we.z=j[1].z),j[1].f!=null&&(we.f=j[1].f);break}L.dense?(M[j[0].r]||(M[j[0].r]=[]),M[j[0].r][j[0].c]=j[1]):M[Ye(j[0])]=j[1];break}},L);else if(R[2]==26||R[2]==14)L.Enum=Q,R[2]==14&&(L.qpro=!0,R.l=0),r(R,function(j,z,ie){switch(ie){case 204:ce=j;break;case 22:j[1].v=j[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(j[3]>ue&&(M["!ref"]=st(D),ve[ce]=M,ge.push(ce),M=L.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ue=j[3],ce="Sheet"+(ue+1)),he>0&&j[0].r>=he)break;L.dense?(M[j[0].r]||(M[j[0].r]=[]),M[j[0].r][j[0].c]=j[1]):M[Ye(j[0])]=j[1],D.e.c<j[0].c&&(D.e.c=j[0].c),D.e.r<j[0].r&&(D.e.r=j[0].r);break;case 27:j[14e3]&&(te[j[14e3][0]]=j[14e3][1]);break;case 1537:te[j[0]]=j[1],j[0]==ue&&(ce=j[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(M["!ref"]=st(D),ve[ke||ce]=M,ge.push(ke||ce),!te.length)return{SheetNames:ge,Sheets:ve};for(var b={},ee=[],re=0;re<te.length;++re)ve[ge[re]]?(ee.push(te[re]||ge[re]),b[te[re]]=ve[te[re]]||ve[ge[re]]):(ee.push(te[re]),b[te[re]]={"!ref":"A1"});return{SheetNames:ee,Sheets:b}}function n(R,ae){var L=ae||{};if(+L.codepage>=0&&ka(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var M=kb(),ce=Dt(R["!ref"]),ke=Array.isArray(R),ue=[];Ca(M,0,i(1030)),Ca(M,6,l(ce));for(var ve=Math.min(ce.e.r,8191),ge=ce.s.r;ge<=ve;++ge)for(var te=Fr(ge),D=ce.s.c;D<=ce.e.c;++D){ge===ce.s.r&&(ue[D]=or(D));var he=ue[D]+te,b=ke?(R[ge]||[])[D]:R[he];if(!(!b||b.t=="z"))if(b.t=="n")(b.v|0)==b.v&&b.v>=-32768&&b.v<=32767?Ca(M,13,m(ge,D,b.v)):Ca(M,14,p(ge,D,b.v));else{var ee=Hi(b);Ca(M,15,d(ge,D,ee.slice(0,239)))}}return Ca(M,1),M.end()}function a(R,ae){var L=ae||{};if(+L.codepage>=0&&ka(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var M=kb();Ca(M,0,s(R));for(var ce=0,ke=0;ce<R.SheetNames.length;++ce)(R.Sheets[R.SheetNames[ce]]||{})["!ref"]&&Ca(M,27,q(R.SheetNames[ce],ke++));var ue=0;for(ce=0;ce<R.SheetNames.length;++ce){var ve=R.Sheets[R.SheetNames[ce]];if(!(!ve||!ve["!ref"])){for(var ge=Dt(ve["!ref"]),te=Array.isArray(ve),D=[],he=Math.min(ge.e.r,8191),b=ge.s.r;b<=he;++b)for(var ee=Fr(b),re=ge.s.c;re<=ge.e.c;++re){b===ge.s.r&&(D[re]=or(re));var j=D[re]+ee,z=te?(ve[b]||[])[re]:ve[j];if(!(!z||z.t=="z"))if(z.t=="n")Ca(M,23,W(b,re,ue,z.v));else{var ie=Hi(z);Ca(M,22,E(b,re,ue,ie.slice(0,239)))}}++ue}}return Ca(M,1),M.end()}function i(R){var ae=mr(2);return ae.write_shift(2,R),ae}function s(R){var ae=mr(26);ae.write_shift(2,4096),ae.write_shift(2,4),ae.write_shift(4,0);for(var L=0,M=0,ce=0,ke=0;ke<R.SheetNames.length;++ke){var ue=R.SheetNames[ke],ve=R.Sheets[ue];if(!(!ve||!ve["!ref"])){++ce;var ge=Hs(ve["!ref"]);L<ge.e.r&&(L=ge.e.r),M<ge.e.c&&(M=ge.e.c)}}return L>8191&&(L=8191),ae.write_shift(2,L),ae.write_shift(1,ce),ae.write_shift(1,M),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(1,1),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(4,0),ae}function c(R,ae,L){var M={s:{c:0,r:0},e:{c:0,r:0}};return ae==8&&L.qpro?(M.s.c=R.read_shift(1),R.l++,M.s.r=R.read_shift(2),M.e.c=R.read_shift(1),R.l++,M.e.r=R.read_shift(2),M):(M.s.c=R.read_shift(2),M.s.r=R.read_shift(2),ae==12&&L.qpro&&(R.l+=2),M.e.c=R.read_shift(2),M.e.r=R.read_shift(2),ae==12&&L.qpro&&(R.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function l(R){var ae=mr(8);return ae.write_shift(2,R.s.c),ae.write_shift(2,R.s.r),ae.write_shift(2,R.e.c),ae.write_shift(2,R.e.r),ae}function u(R,ae,L){var M=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(M[0].c=R.read_shift(1),M[3]=R.read_shift(1),M[0].r=R.read_shift(2),R.l+=2):(M[2]=R.read_shift(1),M[0].c=R.read_shift(2),M[0].r=R.read_shift(2)),M}function h(R,ae,L){var M=R.l+ae,ce=u(R,ae,L);if(ce[1].t="s",L.vers==20768){R.l++;var ke=R.read_shift(1);return ce[1].v=R.read_shift(ke,"utf8"),ce}return L.qpro&&R.l++,ce[1].v=R.read_shift(M-R.l,"cstr"),ce}function d(R,ae,L){var M=mr(7+L.length);M.write_shift(1,255),M.write_shift(2,ae),M.write_shift(2,R),M.write_shift(1,39);for(var ce=0;ce<M.length;++ce){var ke=L.charCodeAt(ce);M.write_shift(1,ke>=128?95:ke)}return M.write_shift(1,0),M}function f(R,ae,L){var M=u(R,ae,L);return M[1].v=R.read_shift(2,"i"),M}function m(R,ae,L){var M=mr(7);return M.write_shift(1,255),M.write_shift(2,ae),M.write_shift(2,R),M.write_shift(2,L,"i"),M}function w(R,ae,L){var M=u(R,ae,L);return M[1].v=R.read_shift(8,"f"),M}function p(R,ae,L){var M=mr(13);return M.write_shift(1,255),M.write_shift(2,ae),M.write_shift(2,R),M.write_shift(8,L,"f"),M}function g(R,ae,L){var M=R.l+ae,ce=u(R,ae,L);if(ce[1].v=R.read_shift(8,"f"),L.qpro)R.l=M;else{var ke=R.read_shift(2);S(R.slice(R.l,R.l+ke),ce),R.l+=ke}return ce}function v(R,ae,L){var M=ae&32768;return ae&=-32769,ae=(M?R:0)+(ae>=8192?ae-16384:ae),(M?"":"$")+(L?or(ae):Fr(ae))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(R,ae){zr(R,0);for(var L=[],M=0,ce="",ke="",ue="",ve="";R.l<R.length;){var ge=R[R.l++];switch(ge){case 0:L.push(R.read_shift(8,"f"));break;case 1:ke=v(ae[0].c,R.read_shift(2),!0),ce=v(ae[0].r,R.read_shift(2),!1),L.push(ke+ce);break;case 2:{var te=v(ae[0].c,R.read_shift(2),!0),D=v(ae[0].r,R.read_shift(2),!1);ke=v(ae[0].c,R.read_shift(2),!0),ce=v(ae[0].r,R.read_shift(2),!1),L.push(te+D+":"+ke+ce)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(R.read_shift(2));break;case 6:{for(var he="";ge=R[R.l++];)he+=String.fromCharCode(ge);L.push('"'+he.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ve=L.pop(),ue=L.pop(),L.push(["AND","OR"][ge-20]+"("+ue+","+ve+")");break;default:if(ge<32&&x[ge])ve=L.pop(),ue=L.pop(),L.push(ue+x[ge]+ve);else if(k[ge]){if(M=k[ge][1],M==69&&(M=R[R.l++]),M>L.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+L.join("|")+"|");return}var b=L.slice(-M);L.length-=M,L.push(k[ge][0]+"("+b.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}L.length==1?ae[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function I(R){var ae=[{c:0,r:0},{t:"n",v:0},0];return ae[0].r=R.read_shift(2),ae[3]=R[R.l++],ae[0].c=R[R.l++],ae}function O(R,ae){var L=I(R);return L[1].t="s",L[1].v=R.read_shift(ae-4,"cstr"),L}function E(R,ae,L,M){var ce=mr(6+M.length);ce.write_shift(2,R),ce.write_shift(1,L),ce.write_shift(1,ae),ce.write_shift(1,39);for(var ke=0;ke<M.length;++ke){var ue=M.charCodeAt(ke);ce.write_shift(1,ue>=128?95:ue)}return ce.write_shift(1,0),ce}function T(R,ae){var L=I(R);L[1].v=R.read_shift(2);var M=L[1].v>>1;if(L[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return L[1].v=M,L}function P(R,ae){var L=I(R),M=R.read_shift(4),ce=R.read_shift(4),ke=R.read_shift(2);if(ke==65535)return M===0&&ce===3221225472?(L[1].t="e",L[1].v=15):M===0&&ce===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var ue=ke&32768;return ke=(ke&32767)-16446,L[1].v=(1-ue*2)*(ce*Math.pow(2,ke+32)+M*Math.pow(2,ke)),L}function W(R,ae,L,M){var ce=mr(14);if(ce.write_shift(2,R),ce.write_shift(1,L),ce.write_shift(1,ae),M==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var ke=0,ue=0,ve=0,ge=0;return M<0&&(ke=1,M=-M),ue=Math.log2(M)|0,M/=Math.pow(2,ue-31),ge=M>>>0,ge&2147483648||(M/=2,++ue,ge=M>>>0),M-=ge,ge|=2147483648,ge>>>=0,M*=Math.pow(2,32),ve=M>>>0,ce.write_shift(4,ve),ce.write_shift(4,ge),ue+=16383+(ke?32768:0),ce.write_shift(2,ue),ce}function U(R,ae){var L=P(R);return R.l+=ae-14,L}function A(R,ae){var L=I(R),M=R.read_shift(4);return L[1].v=M>>6,L}function N(R,ae){var L=I(R),M=R.read_shift(8,"f");return L[1].v=M,L}function C(R,ae){var L=N(R);return R.l+=ae-10,L}function K(R,ae){return R[R.l+ae-1]==0?R.read_shift(ae,"cstr"):""}function ne(R,ae){var L=R[R.l++];L>ae-1&&(L=ae-1);for(var M="";M.length<L;)M+=String.fromCharCode(R[R.l++]);return M}function X(R,ae,L){if(!(!L.qpro||ae<21)){var M=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var ce=R.read_shift(ae-21,"cstr");return[M,ce]}}function oe(R,ae){for(var L={},M=R.l+ae;R.l<M;){var ce=R.read_shift(2);if(ce==14e3){for(L[ce]=[0,""],L[ce][0]=R.read_shift(2);R[R.l];)L[ce][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return L}function q(R,ae){var L=mr(5+R.length);L.write_shift(2,14e3),L.write_shift(2,ae);for(var M=0;M<R.length;++M){var ce=R.charCodeAt(M);L[L.l++]=ce>127?95:ce}return L[L.l++]=0,L}var se={0:{n:"BOF",f:cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:K},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:C},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:K},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function eB(r){var t={},e=r.match(qr),n=0,a=!1;if(e)for(;n!=e.length;++n){var i=qe(e[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=sb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var tB=function(){var r=O0("t"),t=O0("rPr");function e(i){var s=i.match(r);if(!s)return{t:"s",v:""};var c={t:"s",v:mt(s[1])},l=i.match(t);return l&&(c.s=eB(l[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(e).filter(function(c){return c.v})}}(),rB=function(){var t=/(\r\n|\n)/g;function e(a,i,s){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&e(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),nB=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,aB=/<(?:\w+:)?r>/,iB=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Nb(r,t){var e=t?t.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=mt(Ct(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ct(r),e&&(n.h=gb(n.t))):r.match(aB)&&(n.r=Ct(r),n.t=mt(Ct((r.replace(iB,"").match(nB)||[]).join("").replace(qr,""))),e&&(n.h=rB(tB(n.r)))),n):{t:""}}var sB=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,oB=/<(?:\w+:)?(?:si|sstItem)>/g,cB=/<\/(?:\w+:)?(?:si|sstItem)>/;function lB(r,t){var e=[],n="";if(!r)return e;var a=r.match(sB);if(a){n=a[2].replace(oB,"").split(cB);for(var i=0;i!=n.length;++i){var s=Nb(n[i].trim(),t);s!=null&&(e[e.length]=s)}a=qe(a[1]),e.Count=a.count,e.Unique=a.uniqueCount}return e}var uB=/^\s|\s$|[\t\n\r]/;function hB(r,t){if(!t.bookSST)return"";var e=[pn];e[e.length]=Be("sst",null,{xmlns:Pc[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var a=r[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(uB)&&(i+=' xml:space="preserve"'),i+=">"+sr(a.t)+"</t>"),i+="</si>",e[e.length]=i}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function dB(r){return[r.read_shift(4),r.read_shift(4)]}function fB(r,t){var e=[],n=!1;return ji(r,function(i,s,c){switch(c){case 159:e.Count=i[0],e.Unique=i[1];break;case 19:e.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),e}function x3(r){for(var t=[],e=r.split(""),n=0;n<e.length;++n)t[n]=e[n].charCodeAt(0);return t}function Wi(r,t){var e={};return e.Major=r.read_shift(2),e.Minor=r.read_shift(2),t>=4&&(r.l+=t-4),e}function pB(r){var t={};return t.id=r.read_shift(0,"lpp4"),t.R=Wi(r,4),t.U=Wi(r,4),t.W=Wi(r,4),t}function mB(r){for(var t=r.read_shift(4),e=r.l+t-4,n={},a=r.read_shift(4),i=[];a-- >0;)i.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=i,r.l!=e)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+e);return n}function gB(r){var t=[];r.l+=4;for(var e=r.read_shift(4);e-- >0;)t.push(mB(r));return t}function wB(r){var t=[];r.l+=4;for(var e=r.read_shift(4);e-- >0;)t.push(r.read_shift(0,"lpp4"));return t}function vB(r){var t={};return r.read_shift(4),r.l+=4,t.id=r.read_shift(0,"lpp4"),t.name=r.read_shift(0,"lpp4"),t.R=Wi(r,4),t.U=Wi(r,4),t.W=Wi(r,4),t}function yB(r){var t=vB(r);if(t.ename=r.read_shift(0,"8lpp4"),t.blksz=r.read_shift(4),t.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function k3(r,t){var e=r.l+t,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(e-r.l>>1,"utf16le"),r.l=e,n}function b3(r,t){var e={},n=r.l+t;return r.l+=4,e.Salt=r.slice(r.l,r.l+16),r.l+=16,e.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),e.VerifierHash=r.slice(r.l,n),r.l=n,e}function xB(r){var t=Wi(r);switch(t.Minor){case 2:return[t.Minor,kB(r)];case 3:return[t.Minor,bB()];case 4:return[t.Minor,_B(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function kB(r){var t=r.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var e=r.read_shift(4),n=k3(r,e),a=b3(r,r.length-r.l);return{t:"Std",h:n,v:a}}function bB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _B(r){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var e=r.read_shift(r.length-r.l,"utf8"),n={};return e.replace(qr,function(i){var s=qe(i);switch(Qa(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=s[c]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function EB(r,t){var e={},n=e.EncryptionVersionInfo=Wi(r,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=r.read_shift(4),t-=4;var a=r.read_shift(4);return t-=4,e.EncryptionHeader=k3(r,a),t-=a,e.EncryptionVerifier=b3(r,t),e}function SB(r){var t={},e=t.EncryptionVersionInfo=Wi(r,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return t.Salt=r.read_shift(16),t.EncryptedVerifier=r.read_shift(16),t.EncryptedVerifierHash=r.read_shift(16),t}function _3(r){var t=0,e,n=x3(r),a=n.length+1,i,s,c,l,u;for(e=Bs(a),e[0]=n.length,i=1;i!=a;++i)e[i]=n[i-1];for(i=a-1;i>=0;--i)s=e[i],c=t&16384?1:0,l=t<<1&32767,u=c|l,t=u^s;return t^52811}var E3=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,c){return n(s^c)},i=function(s){for(var c=t[s.length-1],l=104,u=s.length-1;u>=0;--u)for(var h=s[u],d=0;d!=7;++d)h&64&&(c^=e[l]),h*=2,--l;return c};return function(s){for(var c=x3(s),l=i(c),u=c.length,h=Bs(16),d=0;d!=16;++d)h[d]=0;var f,m,w;for((u&1)===1&&(f=l>>8,h[u]=a(r[0],f),--u,f=l&255,m=c[c.length-1],h[u]=a(m,f));u>0;)--u,f=l>>8,h[u]=a(c[u],f),--u,f=l&255,h[u]=a(c[u],f);for(u=15,w=15-c.length;w>0;)f=l>>8,h[u]=a(r[w],f),--u,--w,f=l&255,h[u]=a(c[u],f),--u,--w;return h}}(),CB=function(r,t,e,n,a){a||(a=t),n||(n=E3(r));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[e],s=(s>>5|s<<3)&255,a[i]=s,++e;return[a,e,n]},TB=function(r){var t=0,e=E3(r);return function(n){var a=CB("",n,t,e);return t=a[1],a[0]}};function AB(r,t,e,n){var a={key:cr(r),verificationBytes:cr(r)};return e.password&&(a.verifier=_3(e.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=TB(e.password)),a}function FB(r,t,e){var n=e||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=SB(r):n.Data=EB(r,t),n}function PB(r,t,e){var n={Type:e.biff>=8?r.read_shift(2):0};return n.Type?FB(r,t-2,n):AB(r,e.biff>=8?t:t-2,e,n),n}var IB=function(){function r(a,i){switch(i.type){case"base64":return t(On(a),i);case"binary":return t(a,i);case"buffer":return t(ot&&Buffer.isBuffer(a)?a.toString("binary"):Us(a),i);case"array":return t(Ac(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},c=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,d){Array.isArray(c)&&(c[d]=[]);for(var f=/\\\w+\b/g,m=0,w,p=-1;w=f.exec(h);){switch(w[0]){case"\\cell":var g=h.slice(m,f.lastIndex-w[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(c)?c[d][p]=v:c[Ye({r:d,c:p})]=v}break}m=f.lastIndex}p>u.e.c&&(u.e.c=p)}),c["!ref"]=st(u),c}function e(a,i){return Ws(r(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Dt(a["!ref"]),c,l=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var d=Ye({r:u,c:h});c=l?(a[u]||[])[h]:a[d],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Hi(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:n}}();function DB(r){var t=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function z0(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().slice(1)}function OB(r){var t=r[0]/255,e=r[1]/255,n=r[2]/255,a=Math.max(t,e,n),i=Math.min(t,e,n),s=a-i;if(s===0)return[0,0,t];var c=0,l=0,u=a+i;switch(l=s/(u>1?2-u:u),a){case t:c=((e-n)/s+6)%6;break;case e:c=(n-t)/s+2;break;case n:c=(t-e)/s+4;break}return[c/6,l,u/2]}function MB(r){var t=r[0],e=r[1],n=r[2],a=e*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],c=6*t,l;if(e!==0)switch(c|0){case 0:case 6:l=a*c,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-c),s[0]+=l,s[1]+=a;break;case 2:l=a*(c-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-c),s[1]+=l,s[2]+=a;break;case 4:l=a*(c-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-c),s[2]+=l,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function wv(r,t){if(t===0)return r;var e=OB(DB(r));return t<0?e[2]=e[2]*(1+t):e[2]=1-(1-e[2])*(1-t),z0(MB(e))}var S3=6,RB=15,NB=1,en=S3;function vv(r){return Math.floor((r+Math.round(128/en)/256)*en)}function K0(r){return Math.floor((r-5)/en*100+.5)/100}function yv(r){return Math.round((r*en+5)/en*256)/256}function Lb(r){return yv(K0(vv(r)))}function Bb(r){var t=Math.abs(r-Lb(r)),e=en;if(t>.005)for(en=NB;en<RB;++en)Math.abs(r-Lb(r))<=t&&(t=Math.abs(r-Lb(r)),e=en);en=e}function lh(r){r.width?(r.wpx=vv(r.width),r.wch=K0(r.wpx),r.MDW=en):r.wpx?(r.wch=K0(r.wpx),r.width=yv(r.wch),r.MDW=en):typeof r.wch=="number"&&(r.width=yv(r.wch),r.wpx=vv(r.width),r.MDW=en),r.customWidth&&delete r.customWidth}var LB=96,C3=LB;function xv(r){return r*96/C3}function V0(r){return r*C3/96}var BB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function UB(r,t,e,n){t.Borders=[];var a={},i=!1;(r[0].match(qr)||[]).forEach(function(s){var c=qe(s);switch(Qa(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=$t(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=$t(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function $B(r,t,e,n){t.Fills=[];var a={},i=!1;(r[0].match(qr)||[]).forEach(function(s){var c=qe(s);switch(Qa(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function jB(r,t,e,n){t.Fonts=[];var a={},i=!1;(r[0].match(qr)||[]).forEach(function(s){var c=qe(s);switch(Qa(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Ct(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?$t(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?$t(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?$t(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?$t(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?$t(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?$t(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?$t(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=sb[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=$t(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var l=Mc[a.color.index];a.color.index==81&&(l=Mc[1]),l||(l=Mc[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&e.themeElements&&e.themeElements.clrScheme&&(a.color.rgb=wv(e.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function HB(r,t,e){t.NumberFmt=[];for(var n=fn(Xe),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Xe[n[a]];var i=r[0].match(qr);if(i)for(a=0;a<i.length;++a){var s=qe(i[a]);switch(Qa(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=mt(Ct(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=c}Ui(c,l)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function WB(r){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)r[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:sr(r[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var kv=["numFmtId","fillId","fontId","borderId","xfId"],bv=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zB(r,t,e){t.CellXf=[];var n,a=!1;(r[0].match(qr)||[]).forEach(function(i){var s=qe(i),c=0;switch(Qa(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],c=0;c<kv.length;++c)n[kv[c]]&&(n[kv[c]]=parseInt(n[kv[c]],10));for(c=0;c<bv.length;++c)n[bv[c]]&&(n[bv[c]]=$t(n[bv[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=$t(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(e&&e.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function KB(r){var t=[];return t[t.length]=Be("cellXfs",null),r.forEach(function(e){t[t.length]=Be("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var VB=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,u){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=c.match(t))&&HB(d,h,u),(d=c.match(a))&&jB(d,h,l,u),(d=c.match(n))&&$B(d,h,l,u),(d=c.match(i))&&UB(d,h,l,u),(d=c.match(e))&&zB(d,h,u),h}}();function qB(r,t){var e=[pn,Be("styleSheet",null,{xmlns:Pc[0],"xmlns:vt":pr.vt})],n;return r.SSF&&(n=WB(r.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=KB(t.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function GB(r,t){var e=r.read_shift(2),n=Yr(r);return[e,n]}function XB(r,t,e){var n={};n.sz=r.read_shift(2)/20;var a=QN(r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=r.read_shift(2);switch(i===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=r.read_shift(1);s!=0&&(n.underline=s);var c=r.read_shift(1);c>0&&(n.family=c);var l=r.read_shift(1);switch(l>0&&(n.charset=l),r.l++,n.color=ZN(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Yr(r),n}var YB=Gr;function JB(r,t){var e=r.l+t,n=r.read_shift(2),a=r.read_shift(2);return r.l=e,{ixfe:n,numFmtId:a}}var ZB=Gr;function QB(r,t,e){var n={};n.NumberFmt=[];for(var a in Xe)n.NumberFmt[a]=Xe[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return ji(r,function(l,u,h){switch(h){case 44:n.NumberFmt[l[0]]=l[1],Ui(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=wv(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(h);else if(u.T<0)i.pop();else if(!s||e.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var e7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function t7(r,t,e){t.themeElements.clrScheme=[];var n={};(r[0].match(qr)||[]).forEach(function(a){var i=qe(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[e7.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function r7(){}function n7(){}var a7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,i7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,s7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function o7(r,t,e){t.themeElements={};var n;[["clrScheme",a7,t7],["fontScheme",i7,r7],["fmtScheme",s7,n7]].forEach(function(a){if(!(n=r.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,e)})}var c7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function T3(r,t){(!r||r.length===0)&&(r=A3());var e,n={};if(!(e=r.match(c7)))throw new Error("themeElements not found in theme");return o7(e[0],n,t),n.raw=r,n}function A3(r,t){if(t&&t.themeXLSX)return t.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var e=[pn];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function l7(r,t,e){var n=r.l+t,a=r.read_shift(4);if(a!==124226){if(!e.cellStyles){r.l=n;return}var i=r.slice(r.l);r.l=n;var s;try{s=oA(i,{type:"array"})}catch{return}var c=Mn(s,"theme/theme/theme1.xml",!0);if(c)return T3(c,e)}}function u7(r){return r.read_shift(4)}function h7(r){var t={};switch(t.xclrType=r.read_shift(2),t.nTintShade=r.read_shift(2),t.xclrType){case 0:r.l+=4;break;case 1:t.xclrValue=d7(r,4);break;case 2:t.xclrValue=i3(r);break;case 3:t.xclrValue=u7(r);break;case 4:r.l+=4;break}return r.l+=8,t}function d7(r,t){return Gr(r,t)}function f7(r,t){return Gr(r,t)}function p7(r){var t=r.read_shift(2),e=r.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=h7(r);break;case 6:n[1]=f7(r,e);break;case 14:case 15:n[1]=r.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+e)}return n}function m7(r,t){var e=r.l+t;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var a=r.read_shift(2),i=[];a-- >0;)i.push(p7(r,e-r.l));return{ixfe:n,ext:i}}function g7(r,t){t.forEach(function(e){switch(e[0]){}})}function w7(r,t){return{flags:r.read_shift(4),version:r.read_shift(4),name:Yr(r)}}function v7(r){for(var t=[],e=r.read_shift(4);e-- >0;)t.push([r.read_shift(4),r.read_shift(4)]);return t}function y7(r){return r.l+=4,r.read_shift(4)!=0}function x7(r,t,e){var n={Types:[],Cell:[],Value:[]},a=e||{},i=[],s=!1,c=2;return ji(r,function(l,u,h){switch(h){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){c==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):c==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function k7(r,t,e){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var a=!1,i=2,s;return r.replace(qr,function(c){var l=qe(c);switch(Qa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),n}function b7(){var r=[pn];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function _7(r){var t=[];if(!r)return t;var e=1;return(r.match(qr)||[]).forEach(function(n){var a=qe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?e=a.i:a.i=e,t.push(a);break}}),t}function E7(r){var t={};t.i=r.read_shift(4);var e={};e.r=r.read_shift(4),e.c=r.read_shift(4),t.r=Ye(e);var n=r.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function S7(r,t,e){var n=[];return ji(r,function(i,s,c){switch(c){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function oG(){}function C7(r,t,e,n){if(!r)return r;var a=n||{},i=!1;ji(r,function(c,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function T7(r,t){if(!r)return"??";var e=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][e].Target}var q0=1024;function A7(r,t){for(var e=[21600,21600],n=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":sv.v,"xmlns:o":sv.o,"xmlns:x":sv.x,"xmlns:mv":sv.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:n})];q0<r*1e3;)q0+=1e3;return t.forEach(function(i){var s=Xr(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var l=c.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Be("v:fill",l,c),h={on:"t",obscured:"t"};++q0,a=a.concat(["<v:shape"+vA({id:"_x0000_s"+q0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Be("v:shadow",null,h),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ea("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Ea("x:AutoFill","False"),Ea("x:Row",String(s.r)),Ea("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function F3(r,t,e,n){var a=Array.isArray(r),i;t.forEach(function(s){var c=Xr(s.ref);if(a?(r[c.r]||(r[c.r]=[]),i=r[c.r][c.c]):i=r[s.ref],!i){i={t:"z"},a?r[c.r][c.c]=i:r[s.ref]=i;var l=Dt(r["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var u=st(l);u!==r["!ref"]&&(r["!ref"]=u)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:e};s.h&&(h.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!e&&i.c[d].T)return;e&&!i.c[d].T&&i.c.splice(d,1)}if(e&&n){for(d=0;d<n.length;++d)if(h.a==n[d].id){h.a=n[d].name||h.a;break}}i.c.push(h)})}function F7(r,t){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],a=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&e.push(c[1])}});var i=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=qe(c[0]),u={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},h=Xr(l.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&Nb(d[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),n.push(u)}}}}),n}function P7(r){var t=[pn,Be("comments",null,{xmlns:Pc[0]})],e=[];return t.push("<authors>"),r.forEach(function(n){n[1].forEach(function(a){var i=sr(a.a);e.indexOf(i)==-1&&(e.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&e.indexOf("tc="+a.ID)==-1&&(e.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),r.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=e.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=e.indexOf(sr(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Ea("t",sr(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)s+=`Reply:
    `+i[c]+`
`;t.push(Ea("t",sr(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function I7(r,t){var e=[],n=!1,a={},i=0;return r.replace(qr,function(c,l){var u=qe(c);switch(Qa(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&e.push(a);break;case"<text>":case"<text":i=l+c.length;break;case"</text>":a.t=r.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),e}function D7(r,t,e){var n=[pn,Be("ThreadedComments",null,{xmlns:pr.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,c){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};c==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Be("threadedComment",Ea("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function O7(r,t){var e=[],n=!1;return r.replace(qr,function(i){var s=qe(i);switch(Qa(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),e}function M7(r){var t=[pn,Be("personList",null,{xmlns:pr.TCMNT,"xmlns:x":Pc[0]}).replace(/[\/]>/,">")];return r.forEach(function(e,n){t.push(Be("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function R7(r){var t={};t.iauthor=r.read_shift(4);var e=Oc(r);return t.rfx=e.s,t.ref=Ye(e.s),r.l+=16,t}var N7=Yr;function L7(r,t){var e=[],n=[],a={},i=!1;return ji(r,function(c,l,u){switch(u){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,e.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),e}var B7="application/vnd.ms-office.vbaProject";function U7(r){var t=it.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var a=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(t,a,r.FileIndex[n].content)}}),it.write(t)}var $7=["xlsb","xlsm","xlam","biff8","xla"];function j7(){return{"!type":"dialog"}}function H7(){return{"!type":"dialog"}}function W7(){return{"!type":"macro"}}function z7(){return{"!type":"macro"}}var uh=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(n,a,i,s){var c=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return c?h+=t.c:--h,l?u+=t.r:--u,a+(c?"":"$")+or(h)+(l?"":"$")+Fr(u)}return function(a,i){return t=i,a.replace(r,e)}}(),P3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,K7=function(){return function(t,e){return t.replace(P3,function(n,a,i,s,c,l){var u=Eb(s)-(i?0:e.c),h=_b(l)-(c?0:e.r),d=h==0?"":c?h+1:"["+h+"]",f=u==0?"":i?u+1:"["+u+"]";return a+"R"+d+"C"+f})}}();function I3(r,t){return r.replace(P3,function(e,n,a,i,s,c){return n+(a=="$"?a+i:or(Eb(i)+t.c))+(s=="$"?s+c:Fr(_b(c)+t.r))})}function V7(r,t,e){var n=Hs(t),a=n.s,i=Xr(e),s={r:i.r-a.r,c:i.c-a.c};return I3(r,s)}function q7(r){return r.length!=1}function D3(r){return r.replace(/_xlfn\./g,"")}function lr(r){r.l+=1}function Vs(r,t){var e=r.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function O3(r,t,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return M3(r);e.biff==12&&(n=4)}var a=r.read_shift(n),i=r.read_shift(n),s=Vs(r),c=Vs(r);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function M3(r){var t=Vs(r),e=Vs(r),n=r.read_shift(1),a=r.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function G7(r,t,e){if(e.biff<8)return M3(r);var n=r.read_shift(e.biff==12?4:2),a=r.read_shift(e.biff==12?4:2),i=Vs(r),s=Vs(r);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function R3(r,t,e){if(e&&e.biff>=2&&e.biff<=5)return X7(r);var n=r.read_shift(e&&e.biff==12?4:2),a=Vs(r);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function X7(r){var t=Vs(r),e=r.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function Y7(r){var t=r.read_shift(2),e=r.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function J7(r,t,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return Z7(r);var a=r.read_shift(n>=12?4:2),i=r.read_shift(2),s=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:c}}function Z7(r){var t=r.read_shift(2),e=r.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:a,rRel:n}}function Q7(r,t,e){var n=(r[r.l++]&96)>>5,a=O3(r,e.biff>=2&&e.biff<=5?6:8,e);return[n,a]}function eU(r,t,e){var n=(r[r.l++]&96)>>5,a=r.read_shift(2,"i"),i=8;if(e)switch(e.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}var s=O3(r,i,e);return[n,a,s]}function tU(r,t,e){var n=(r[r.l++]&96)>>5;return r.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function rU(r,t,e){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),i=8;if(e)switch(e.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}return r.l+=i,[n,a]}function nU(r,t,e){var n=(r[r.l++]&96)>>5,a=G7(r,t-1,e);return[n,a]}function aU(r,t,e){var n=(r[r.l++]&96)>>5;return r.l+=e.biff==2?6:e.biff==12?14:7,[n]}function N3(r){var t=r[r.l+1]&1,e=1;return r.l+=4,[t,e]}function iU(r,t,e){r.l+=2;for(var n=r.read_shift(e&&e.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(r.read_shift(e&&e.biff==2?1:2));return a}function sU(r,t,e){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(e&&e.biff==2?1:2)]}function oU(r,t,e){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(e&&e.biff==2?1:2)]}function cU(r){var t=r[r.l+1]&255?1:0;return r.l+=2,[t,r.read_shift(2)]}function lU(r,t,e){var n=r[r.l+1]&255?1:0;return r.l+=e&&e.biff==2?3:4,[n]}function L3(r){var t=r.read_shift(1),e=r.read_shift(1);return[t,e]}function uU(r){return r.read_shift(2),L3(r)}function hU(r){return r.read_shift(2),L3(r)}function dU(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=R3(r,0,e);return[n,a]}function fU(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=J7(r,0,e);return[n,a]}function pU(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(2);e&&e.biff==5&&(r.l+=12);var i=R3(r,0,e);return[n,a,i]}function mU(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(e&&e.biff<=3?1:2);return[g9[a],H3[a],n]}function gU(r,t,e){var n=r[r.l++],a=r.read_shift(1),i=e&&e.biff<=3?[n==88?-1:0,r.read_shift(1)]:wU(r);return[a,(i[0]===0?H3:m9)[i[1]]]}function wU(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function vU(r,t,e){r.l+=e&&e.biff==2?3:4}function yU(r,t,e){if(r.l++,e&&e.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),a=r.read_shift(e&&e.biff==2?1:2);return[n,a]}function xU(r){return r.l++,zs[r.read_shift(1)]}function kU(r){return r.l++,r.read_shift(2)}function bU(r){return r.l++,r.read_shift(1)!==0}function _U(r){return r.l++,Jr(r)}function EU(r,t,e){return r.l++,$0(r,t-1,e)}function SU(r,t){var e=[r.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Yt(r,1)?"TRUE":"FALSE",t!=12&&(r.l+=7);break;case 37:case 16:e[1]=zs[r[r.l]],r.l+=t==12?4:8;break;case 0:r.l+=8;break;case 1:e[1]=Jr(r);break;case 2:e[1]=Lc(r,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function CU(r,t,e){for(var n=r.read_shift(e.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((e.biff==12?Oc:mv)(r));return a}function TU(r,t,e){var n=0,a=0;e.biff==12?(n=r.read_shift(4),a=r.read_shift(4)):(a=1+r.read_shift(1),n=1+r.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var c=0;c!=a;++c)s[i][c]=SU(r,e.biff);return s}function AU(r,t,e){var n=r.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,i=r.read_shift(a);switch(e.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,i]}function FU(r,t,e){if(e.biff==5)return PU(r);var n=r.read_shift(1)>>>5&3,a=r.read_shift(2),i=r.read_shift(4);return[n,a,i]}function PU(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[t,e,n]}function IU(r,t,e){var n=r.read_shift(1)>>>5&3;r.l+=e&&e.biff==2?3:4;var a=r.read_shift(e&&e.biff==2?1:2);return[n,a]}function DU(r,t,e){var n=r.read_shift(1)>>>5&3,a=r.read_shift(e&&e.biff==2?1:2);return[n,a]}function OU(r,t,e){var n=r.read_shift(1)>>>5&3;return r.l+=4,e.biff<8&&r.l--,e.biff==12&&(r.l+=2),[n]}function MU(r,t,e){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),i=4;if(e)switch(e.biff){case 5:i=15;break;case 12:i=6;break}return r.l+=i,[n,a]}var RU=Gr,NU=Gr,LU=Gr;function G0(r,t,e){return r.l+=2,[Y7(r)]}function Ub(r){return r.l+=6,[]}var BU=G0,UU=Ub,$U=Ub,jU=G0;function B3(r){return r.l+=2,[cr(r),r.read_shift(2)&1]}var HU=G0,WU=B3,zU=Ub,KU=G0,VU=G0,qU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function GU(r){r.l+=2;var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(4),a=r.read_shift(2),i=r.read_shift(2),s=qU[e>>2&31];return{ixti:t,coltype:e&3,rt:s,idx:n,c:a,C:i}}function XU(r){return r.l+=2,[r.read_shift(4)]}function YU(r,t,e){return r.l+=5,r.l+=2,r.l+=e.biff==2?1:4,["PTGSHEET"]}function JU(r,t,e){return r.l+=e.biff==2?4:5,["PTGENDSHEET"]}function ZU(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function QU(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function e9(r){return r.l+=4,[0,0]}var U3={1:{n:"PtgExp",f:yU},2:{n:"PtgTbl",f:LU},3:{n:"PtgAdd",f:lr},4:{n:"PtgSub",f:lr},5:{n:"PtgMul",f:lr},6:{n:"PtgDiv",f:lr},7:{n:"PtgPower",f:lr},8:{n:"PtgConcat",f:lr},9:{n:"PtgLt",f:lr},10:{n:"PtgLe",f:lr},11:{n:"PtgEq",f:lr},12:{n:"PtgGe",f:lr},13:{n:"PtgGt",f:lr},14:{n:"PtgNe",f:lr},15:{n:"PtgIsect",f:lr},16:{n:"PtgUnion",f:lr},17:{n:"PtgRange",f:lr},18:{n:"PtgUplus",f:lr},19:{n:"PtgUminus",f:lr},20:{n:"PtgPercent",f:lr},21:{n:"PtgParen",f:lr},22:{n:"PtgMissArg",f:lr},23:{n:"PtgStr",f:EU},26:{n:"PtgSheet",f:YU},27:{n:"PtgEndSheet",f:JU},28:{n:"PtgErr",f:xU},29:{n:"PtgBool",f:bU},30:{n:"PtgInt",f:kU},31:{n:"PtgNum",f:_U},32:{n:"PtgArray",f:aU},33:{n:"PtgFunc",f:mU},34:{n:"PtgFuncVar",f:gU},35:{n:"PtgName",f:AU},36:{n:"PtgRef",f:dU},37:{n:"PtgArea",f:Q7},38:{n:"PtgMemArea",f:IU},39:{n:"PtgMemErr",f:RU},40:{n:"PtgMemNoMem",f:NU},41:{n:"PtgMemFunc",f:DU},42:{n:"PtgRefErr",f:OU},43:{n:"PtgAreaErr",f:tU},44:{n:"PtgRefN",f:fU},45:{n:"PtgAreaN",f:nU},46:{n:"PtgMemAreaN",f:ZU},47:{n:"PtgMemNoMemN",f:QU},57:{n:"PtgNameX",f:FU},58:{n:"PtgRef3d",f:pU},59:{n:"PtgArea3d",f:eU},60:{n:"PtgRefErr3d",f:MU},61:{n:"PtgAreaErr3d",f:rU},255:{}},t9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},r9={1:{n:"PtgElfLel",f:B3},2:{n:"PtgElfRw",f:KU},3:{n:"PtgElfCol",f:BU},6:{n:"PtgElfRwV",f:VU},7:{n:"PtgElfColV",f:jU},10:{n:"PtgElfRadical",f:HU},11:{n:"PtgElfRadicalS",f:zU},13:{n:"PtgElfColS",f:UU},15:{n:"PtgElfColSV",f:$U},16:{n:"PtgElfRadicalLel",f:WU},25:{n:"PtgList",f:GU},29:{n:"PtgSxName",f:XU},255:{}},n9={0:{n:"PtgAttrNoop",f:e9},1:{n:"PtgAttrSemi",f:lU},2:{n:"PtgAttrIf",f:oU},4:{n:"PtgAttrChoose",f:iU},8:{n:"PtgAttrGoto",f:sU},16:{n:"PtgAttrSum",f:vU},32:{n:"PtgAttrBaxcel",f:N3},33:{n:"PtgAttrBaxcel",f:N3},64:{n:"PtgAttrSpace",f:uU},65:{n:"PtgAttrSpaceSemi",f:hU},128:{n:"PtgAttrIfError",f:cU},255:{}};function X0(r,t,e,n){if(n.biff<8)return Gr(r,t);for(var a=r.l+t,i=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=TU(r,0,n),i.push(e[s][1]);break;case"PtgMemArea":e[s][2]=CU(r,e[s][1],n),i.push(e[s][2]);break;case"PtgExp":n&&n.biff==12&&(e[s][1][1]=r.read_shift(4),i.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0]}return t=a-r.l,t!==0&&i.push(Gr(r,t)),i}function Y0(r,t,e){for(var n=r.l+t,a,i,s=[];n!=r.l;)t=n-r.l,i=r[r.l],a=U3[i]||U3[t9[i]],(i===24||i===25)&&(a=(i===24?r9:n9)[r[r.l+1]]),!a||!a.f?Gr(r,t):s.push([a.n,a.f(r,t,e)]);return s}function a9(r){for(var t=[],e=0;e<r.length;++e){for(var n=r[e],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var i9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function s9(r,t){if(!r&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function $3(r,t,e){if(!r)return"SH33TJSERR0";if(e.biff>8&&(!r.XTI||!r.XTI[t]))return r.SheetNames[t];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":r.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(e.biff>8)switch(r[n[0]][0]){case 357:return a=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 358:return e.SID!=null?r.SheetNames[e.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return r[n[0]][0][3]?(a=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function j3(r,t,e){var n=$3(r,t,e);return n=="#REF"?n:s9(n,e)}function tn(r,t,e,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},c=[],l,u,h,d=0,f=0,m,w="";if(!r[0]||!r[0][0])return"";for(var p=-1,g="",v=0,k=r[0].length;v<k;++v){var x=r[0][v];switch(x[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),u=c.pop(),p>=0){switch(r[0][p][1][0]){case 0:g=qt(" ",r[0][p][1][1]);break;case 1:g=qt("\r",r[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}u=u+g,p=-1}c.push(u+i9[x[0]]+l);break;case"PtgIsect":l=c.pop(),u=c.pop(),c.push(u+" "+l);break;case"PtgUnion":l=c.pop(),u=c.pop(),c.push(u+","+l);break;case"PtgRange":l=c.pop(),u=c.pop(),c.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=L0(x[1][1],s,a),c.push(B0(h,i));break;case"PtgRefN":h=e?L0(x[1][1],e,a):x[1][1],c.push(B0(h,i));break;case"PtgRef3d":d=x[1][1],h=L0(x[1][2],s,a),w=j3(n,d,a),c.push(w+"!"+B0(h,i));break;case"PtgFunc":case"PtgFuncVar":var S=x[1][0],I=x[1][1];S||(S=0),S&=127;var O=S==0?[]:c.slice(-S);c.length-=S,I==="User"&&(I=O.shift()),c.push(I+"("+O.join(",")+")");break;case"PtgBool":c.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(x[1]);break;case"PtgNum":c.push(String(x[1]));break;case"PtgStr":c.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(x[1]);break;case"PtgAreaN":m=BA(x[1][1],e?{s:e}:s,a),c.push(bb(m,a));break;case"PtgArea":m=BA(x[1][1],s,a),c.push(bb(m,a));break;case"PtgArea3d":d=x[1][1],m=x[1][2],w=j3(n,d,a),c.push(w+"!"+bb(m,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=x[1][2];var E=(n.names||[])[f-1]||(n[0]||[])[f],T=E?E.Name:"SH33TJSNAME"+String(f);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),c.push(T);break;case"PtgNameX":var P=x[1][1];f=x[1][2];var W;if(a.biff<=5)P<0&&(P=-P),n[P]&&(W=n[P][f]);else{var U="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][f]&&n[P][f].itab>0&&(U=n.SheetNames[n[P][f].itab-1]+"!"):U=n.SheetNames[f-1]+"!"),n[P]&&n[P][f])U+=n[P][f].Name;else if(n[0]&&n[0][f])U+=n[0][f].Name;else{var A=($3(n,P,a)||"").split(";;");A[f-1]?U=A[f-1]:U+="SH33TJSERRX"}c.push(U);break}W||(W={Name:"SH33TJSERRY"}),c.push(W.Name);break;case"PtgParen":var N="(",C=")";if(p>=0){switch(g="",r[0][p][1][0]){case 2:N=qt(" ",r[0][p][1][1])+N;break;case 3:N=qt("\r",r[0][p][1][1])+N;break;case 4:C=qt(" ",r[0][p][1][1])+C;break;case 5:C=qt("\r",r[0][p][1][1])+C;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}p=-1}c.push(N+c.pop()+C);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:x[1][1],r:x[1][0]};var K={c:e.c,r:e.r};if(n.sharedf[Ye(h)]){var ne=n.sharedf[Ye(h)];c.push(tn(ne,s,K,n,a))}else{var X=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){c.push(tn(u[1],s,K,n,a)),X=!0;break}X||c.push(x[1])}break;case"PtgArray":c.push("{"+a9(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&oe.indexOf(r[0][v][0])==-1){x=r[0][p];var q=!0;switch(x[1][0]){case 4:q=!1;case 0:g=qt(" ",x[1][1]);break;case 5:q=!1;case 1:g=qt("\r",x[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}c.push((q?g:"")+c.pop()+(q?"":g)),p=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function o9(r,t,e){var n=r.l+t,a=e.biff==2?1:2,i,s=r.read_shift(a);if(s==65535)return[[],Gr(r,t-2)];var c=Y0(r,s,e);return t!==s+a&&(i=X0(r,t-s-a,c,e)),r.l=n,[c,i]}function c9(r,t,e){var n=r.l+t,a=e.biff==2?1:2,i,s=r.read_shift(a);if(s==65535)return[[],Gr(r,t-2)];var c=Y0(r,s,e);return t!==s+a&&(i=X0(r,t-s-a,c,e)),r.l=n,[c,i]}function l9(r,t,e,n){var a=r.l+t,i=Y0(r,n,e),s;return a!==r.l&&(s=X0(r,a-r.l,i,e)),[i,s]}function u9(r,t,e){var n=r.l+t,a,i=r.read_shift(2),s=Y0(r,i,e);return i==65535?[[],Gr(r,t-2)]:(t!==i+2&&(a=X0(r,n-i-2,s,e)),[s,a])}function h9(r){var t;if($i(r,r.l+6)!==65535)return[Jr(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return t=r[r.l+2]===1,r.l+=8,[t,"b"];case 2:return t=r[r.l+2],r.l+=8,[t,"e"];case 3:return r.l+=8,["","s"]}return[]}function $b(r,t,e){var n=r.l+t,a=ei(r);e.biff==2&&++r.l;var i=h9(r),s=r.read_shift(1);e.biff!=2&&(r.read_shift(1),e.biff>=5&&r.read_shift(4));var c=c9(r,n-r.l,e);return{cell:a,val:i[0],formula:c,shared:s>>3&1,tt:i[1]}}function _v(r,t,e){var n=r.read_shift(4),a=Y0(r,n,e),i=r.read_shift(4),s=i>0?X0(r,i,a,e):null;return[a,s]}var d9=_v,Ev=_v,f9=_v,p9=_v,m9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},H3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},g9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function W3(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,e){return e.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function jb(r){var t=r.split(":"),e=t[0].split(".")[0];return[e,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var J0={},hh={},Sv=typeof Map<"u";function w9(r,t,e){var n=0,a=r.length;if(e){if(Sv?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var i=Sv?e.get(t):e[t];n<i.length;++n)if(r[i[n]].t===t)return r.Count++,i[n]}}else for(;n<a;++n)if(r[n].t===t)return r.Count++,n;return r[a]={t},r.Count++,r.Unique++,e&&(Sv?(e.has(t)||e.set(t,[]),e.get(t).push(a)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(a))),a}function v9(r,t){var e={min:r+1,max:r+1},n=-1;return t.MDW&&(en=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?n=K0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(e.width=yv(n),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function dh(r,t){if(r){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),r.left==null&&(r.left=e[0]),r.right==null&&(r.right=e[1]),r.top==null&&(r.top=e[2]),r.bottom==null&&(r.bottom=e[3]),r.header==null&&(r.header=e[4]),r.footer==null&&(r.footer=e[5])}}function z3(r,t,e){var n=e.revssf[t.z!=null?t.z:"General"],a=60,i=r.length;if(n==null&&e.ssf){for(;a<392;++a)if(e.ssf[a]==null){Ui(t.z,a),e.ssf[a]=t.z,e.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(r[a].numFmtId===n)return a;return r[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function K3(r,t,e,n,a,i){try{n.cellNF&&(r.z=Xe[t])}catch(c){if(n.WTF)throw c}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=ar(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(Xe[t]==null&&Ui(cN[t]||"General",t),r.t==="e")r.w=r.w||zs[r.v];else if(t===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=I0(r.v);else if(r.t==="d"){var s=Vr(r.v);(s|0)===s?r.w=s.toString(10):r.w=I0(s)}else{if(r.v===void 0)return"";r.w=Tc(r.v,hh)}else r.t==="d"?r.w=ea(t,Vr(r.v),hh):r.w=ea(t,r.v,hh)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&e!=null)try{r.s=i.Fills[e],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=wv(a.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=a.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=wv(a.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=a.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function y9(r,t,e){if(r&&r["!ref"]){var n=Dt(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+r["!ref"])}}function x9(r,t){var e=Dt(t);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(r["!ref"]=st(e))}var k9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,b9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_9=/<(?:\w:)?hyperlink [^>]*>/mg,E9=/"(\w*:\w*)"/,S9=/<(?:\w:)?col\b[^>]*[\/]?>/g,C9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,T9=/<(?:\w:)?pageMargins[^>]*\/>/g,V3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,A9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,F9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function P9(r,t,e,n,a,i,s){if(!r)return r;n||(n={"!id":{}});var c=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",d=r.match(b9);d?(u=r.slice(0,d.index),h=r.slice(d.index+d[0].length)):u=h=r;var f=u.match(V3);f?Hb(f[0],c,a,e):(f=u.match(A9))&&D9(f[0],f[1]||"",c,a,e);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var w=u.slice(m,m+50).match(E9);w&&x9(c,w[1])}var p=u.match(F9);p&&p[1]&&K9(p[1],a);var g=[];if(t.cellStyles){var v=u.match(S9);v&&$9(g,v)}d&&G9(d[1],c,t,l,i,s);var k=h.match(C9);k&&(c["!autofilter"]=H9(k[0]));var x=[],S=h.match(k9);if(S)for(m=0;m!=S.length;++m)x[m]=Dt(S[m].slice(S[m].indexOf('"')+1));var I=h.match(_9);I&&L9(c,I,n);var O=h.match(T9);if(O&&(c["!margins"]=B9(qe(O[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=st(l)),t.sheetRows>0&&c["!ref"]){var E=Dt(c["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),c["!fullref"]=c["!ref"],c["!ref"]=st(E))}return g.length>0&&(c["!cols"]=g),x.length>0&&(c["!merges"]=x),c}function I9(r){if(r.length===0)return"";for(var t='<mergeCells count="'+r.length+'">',e=0;e!=r.length;++e)t+='<mergeCell ref="'+st(r[e])+'"/>';return t+"</mergeCells>"}function Hb(r,t,e,n){var a=qe(r);e.Sheets[n]||(e.Sheets[n]={}),a.codeName&&(e.Sheets[n].CodeName=mt(Ct(a.codeName)))}function D9(r,t,e,n,a){Hb(r.slice(0,r.indexOf(">")),e,n,a)}function O9(r,t,e,n,a){var i=!1,s={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[e];try{t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch{}i=!0,s.codeName=Fc(sr(l))}if(r&&r["!outline"]){var u={summaryBelow:1,summaryRight:1};r["!outline"].above&&(u.summaryBelow=0),r["!outline"].left&&(u.summaryRight=0),c=(c||"")+Be("outlinePr",null,u)}!i&&!c||(a[a.length]=Be("sheetPr",c,s))}var M9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],R9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function N9(r){var t={sheet:1};return M9.forEach(function(e){r[e]!=null&&r[e]&&(t[e]="1")}),R9.forEach(function(e){r[e]!=null&&!r[e]&&(t[e]="0")}),r.password&&(t.password=_3(r.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function L9(r,t,e){for(var n=Array.isArray(r),a=0;a!=t.length;++a){var i=qe(Ct(t[a]),!0);if(!i.ref)return;var s=((e||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+mt(i.location))):(i.Target="#"+mt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Dt(i.ref),l=c.s.r;l<=c.e.r;++l)for(var u=c.s.c;u<=c.e.c;++u){var h=Ye({c:u,r:l});n?(r[l]||(r[l]=[]),r[l][u]||(r[l][u]={t:"z",v:void 0}),r[l][u].l=i):(r[h]||(r[h]={t:"z",v:void 0}),r[h].l=i)}}}function B9(r){var t={};return["left","right","top","bottom","header","footer"].forEach(function(e){r[e]&&(t[e]=parseFloat(r[e]))}),t}function U9(r){return dh(r),Be("pageMargins",null,r)}function $9(r,t){for(var e=!1,n=0;n!=t.length;++n){var a=qe(t[n],!0);a.hidden&&(a.hidden=$t(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!e&&a.width&&(e=!0,Bb(a.width)),lh(a);i<=s;)r[i++]=Xt(a)}}function j9(r,t){for(var e=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(e[e.length]=Be("col",null,v9(a,n)));return e[e.length]="</cols>",e.join("")}function H9(r){var t={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return t}function W9(r,t,e,n){var a=typeof r.ref=="string"?r.ref:st(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var i=e.Workbook.Names,s=Hs(a);s.s.r==s.e.r&&(s.e.r=Hs(t["!ref"]).e.r,a=st(s));for(var c=0;c<i.length;++c){var l=i[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+e.SheetNames[n]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+a}),Be("autoFilter",null,{ref:a})}var z9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function K9(r,t){t.Views||(t.Views=[{}]),(r.match(z9)||[]).forEach(function(e,n){var a=qe(e);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),$t(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function V9(r,t,e,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function q9(r,t,e,n){if(r.c&&e["!comments"].push([t,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var a="",i=r.t,s=r.v;if(r.t!=="z")switch(r.t){case"b":a=r.v?"1":"0";break;case"n":a=""+r.v;break;case"e":a=zs[r.v];break;case"d":n&&n.cellDates?a=ar(r.v,-1).toISOString():(r=Xt(r),r.t="n",a=""+(r.v=Vr(ar(r.v)))),typeof r.z>"u"&&(r.z=Xe[14]);break;default:a=r.v;break}var c=Ea("v",sr(a)),l={r:t},u=z3(n.cellXfs,r,n);switch(u!==0&&(l.s=u),r.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Ea("v",""+w9(n.Strings,r.v,n.revStrings)),l.t="s";break}l.t="str";break}if(r.t!=i&&(r.t=i,r.v=s),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,t.length)==t?{t:"array",ref:r.F}:null;c=Be("f",sr(r.f),h)+(r.v!=null?c:"")}return r.l&&e["!links"].push([t,r.l]),r.D&&(l.cm=1),Be("c",c,l)}var G9=function(){var r=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=O0("v"),s=O0("f");return function(l,u,h,d,f,m){for(var w=0,p="",g=[],v=[],k=0,x=0,S=0,I="",O,E,T=0,P=0,W,U,A=0,N=0,C=Array.isArray(m.CellXf),K,ne=[],X=[],oe=Array.isArray(u),q=[],se={},Q=!1,R=!!h.sheetStubs,ae=l.split(t),L=0,M=ae.length;L!=M;++L){p=ae[L].trim();var ce=p.length;if(ce!==0){var ke=0;e:for(w=0;w<ce;++w)switch(p[w]){case">":if(p[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(E=qe(p.slice(ke,w),!0),T=E.r!=null?parseInt(E.r,10):T+1,P=-1,h.sheetRows&&h.sheetRows<T)continue;se={},Q=!1,E.ht&&(Q=!0,se.hpt=parseFloat(E.ht),se.hpx=V0(se.hpt)),E.hidden=="1"&&(Q=!0,se.hidden=!0),E.outlineLevel!=null&&(Q=!0,se.level=+E.outlineLevel),Q&&(q[T-1]=se)}break;case"<":ke=w;break}if(ke>=w)break;if(E=qe(p.slice(ke,w),!0),T=E.r!=null?parseInt(E.r,10):T+1,P=-1,!(h.sheetRows&&h.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),h&&h.cellStyles&&(se={},Q=!1,E.ht&&(Q=!0,se.hpt=parseFloat(E.ht),se.hpx=V0(se.hpt)),E.hidden=="1"&&(Q=!0,se.hidden=!0),E.outlineLevel!=null&&(Q=!0,se.level=+E.outlineLevel),Q&&(q[T-1]=se)),g=p.slice(w).split(r);for(var ue=0;ue!=g.length&&g[ue].trim().charAt(0)=="<";++ue);for(g=g.slice(ue),w=0;w!=g.length;++w)if(p=g[w].trim(),p.length!==0){if(v=p.match(e),k=w,x=0,S=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(k=0,I=v[1],x=0;x!=I.length&&!((S=I.charCodeAt(x)-64)<1||S>26);++x)k=26*k+S;--k,P=k}else++P;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,E=qe(p.slice(0,x),!0),E.r||(E.r=Ye({r:T-1,c:P})),I=p.slice(x),O={t:""},(v=I.match(i))!=null&&v[1]!==""&&(O.v=mt(v[1])),h.cellFormula){if((v=I.match(s))!=null&&v[1]!==""){if(O.f=mt(Ct(v[1])).replace(/\r\n/g,`
`),h.xlfn||(O.f=D3(O.f)),v[0].indexOf('t="array"')>-1)O.F=(I.match(a)||[])[1],O.F.indexOf(":")>-1&&ne.push([Dt(O.F),O.F]);else if(v[0].indexOf('t="shared"')>-1){U=qe(v[0]);var ve=mt(Ct(v[1]));h.xlfn||(ve=D3(ve)),X[parseInt(U.si,10)]=[U,ve,E.r]}}else(v=I.match(/<f[^>]*\/>/))&&(U=qe(v[0]),X[U.si]&&(O.f=V7(X[U.si][1],X[U.si][2],E.r)));var ge=Xr(E.r);for(x=0;x<ne.length;++x)ge.r>=ne[x][0].s.r&&ge.r<=ne[x][0].e.r&&ge.c>=ne[x][0].s.c&&ge.c<=ne[x][0].e.c&&(O.F=ne[x][1])}if(E.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(R)O.t="z";else continue;else O.t=E.t||"n";switch(d.s.c>P&&(d.s.c=P),d.e.c<P&&(d.e.c=P),O.t){case"n":if(O.v==""||O.v==null){if(!R)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!R)continue;O.t="z"}else W=J0[parseInt(O.v,10)],O.v=W.t,O.r=W.r,h.cellHTML&&(O.h=W.h);break;case"str":O.t="s",O.v=O.v!=null?Ct(O.v):"",h.cellHTML&&(O.h=gb(O.v));break;case"inlineStr":v=I.match(n),O.t="s",v!=null&&(W=Nb(v[1]))?(O.v=W.t,h.cellHTML&&(O.h=W.h)):O.v="";break;case"b":O.v=$t(O.v);break;case"d":h.cellDates?O.v=ar(O.v,1):(O.v=Vr(ar(O.v,1)),O.t="n");break;case"e":(!h||h.cellText!==!1)&&(O.w=O.v),O.v=VA[O.v];break}if(A=N=0,K=null,C&&E.s!==void 0&&(K=m.CellXf[E.s],K!=null&&(K.numFmtId!=null&&(A=K.numFmtId),h.cellStyles&&K.fillId!=null&&(N=K.fillId))),K3(O,A,N,h,f,m),h.cellDates&&C&&O.t=="n"&&ih(Xe[A])&&(O.t="d",O.v=av(O.v)),E.cm&&h.xlmeta){var te=(h.xlmeta.Cell||[])[+E.cm-1];te&&te.type=="XLDAPR"&&(O.D=!0)}if(oe){var D=Xr(E.r);u[D.r]||(u[D.r]=[]),u[D.r][D.c]=O}else u[E.r]=O}}}}q.length>0&&(u["!rows"]=q)}}();function X9(r,t,e,n){var a=[],i=[],s=Dt(r["!ref"]),c="",l,u="",h=[],d=0,f=0,m=r["!rows"],w=Array.isArray(r),p={r:u},g,v=-1;for(f=s.s.c;f<=s.e.c;++f)h[f]=or(f);for(d=s.s.r;d<=s.e.r;++d){for(i=[],u=Fr(d),f=s.s.c;f<=s.e.c;++f){l=h[f]+u;var k=w?(r[d]||[])[f]:r[l];k!==void 0&&(c=q9(k,l,r,t))!=null&&i.push(c)}(i.length>0||m&&m[d])&&(p={r:u},m&&m[d]&&(g=m[d],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=xv(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=Be("row",i.join(""),p))}if(m)for(;d<m.length;++d)m&&m[d]&&(p={r:d+1},g=m[d],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=xv(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=Be("row","",p));return a.join("")}function Y9(r,t,e,n){var a=[pn,Be("worksheet",null,{xmlns:Pc[0],"xmlns:r":pr.r})],i=e.SheetNames[r],s=0,c="",l=e.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",h=Dt(u);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=st(h)}n||(n={}),l["!comments"]=[];var d=[];O9(l,e,r,t,a),a[a.length]=Be("dimension",null,{ref:u}),a[a.length]=V9(l,t,r,e),t.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=j9(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(c=X9(l,t),c.length>0&&(a[a.length]=c)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=N9(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=W9(l["!autofilter"],l,e,r)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=I9(l["!merges"]));var f=-1,m,w=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(w=Zr(n,-1,sr(p[1].Target).replace(/#.*$/,""),Ot.HLINK),m["r:id"]="rId"+w),(f=p[1].Target.indexOf("#"))>-1&&(m.location=sr(p[1].Target.slice(f+1))),p[1].Tooltip&&(m.tooltip=sr(p[1].Tooltip)),a[a.length]=Be("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=U9(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ea("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(w=Zr(n,-1,"../drawings/drawing"+(r+1)+".xml",Ot.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+w}),l["!drawing"]=d),l["!comments"].length>0&&(w=Zr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ot.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+w}),l["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function J9(r,t){var e={},n=r.l+t;e.r=r.read_shift(4),r.l+=4;var a=r.read_shift(2);r.l+=1;var i=r.read_shift(1);return r.l=n,i&7&&(e.level=i&7),i&16&&(e.hidden=!0),i&32&&(e.hpt=a/20),e}var Z9=Oc;function Q9(){}function e$(r,t){var e={},n=r[r.l];return++r.l,e.above=!(n&64),e.left=!(n&128),r.l+=18,e.name=YN(r),e}function t$(r){var t=ra(r);return[t]}function r$(r){var t=Dc(r);return[t]}function n$(r){var t=ra(r),e=r.read_shift(1);return[t,e,"b"]}function a$(r){var t=Dc(r),e=r.read_shift(1);return[t,e,"b"]}function i$(r){var t=ra(r),e=r.read_shift(1);return[t,e,"e"]}function s$(r){var t=Dc(r),e=r.read_shift(1);return[t,e,"e"]}function o$(r){var t=ra(r),e=r.read_shift(4);return[t,e,"s"]}function c$(r){var t=Dc(r),e=r.read_shift(4);return[t,e,"s"]}function l$(r){var t=ra(r),e=Jr(r);return[t,e,"n"]}function q3(r){var t=Dc(r),e=Jr(r);return[t,e,"n"]}function u$(r){var t=ra(r),e=Ab(r);return[t,e,"n"]}function h$(r){var t=Dc(r),e=Ab(r);return[t,e,"n"]}function d$(r){var t=ra(r),e=Sb(r);return[t,e,"is"]}function f$(r){var t=ra(r),e=Yr(r);return[t,e,"str"]}function p$(r){var t=Dc(r),e=Yr(r);return[t,e,"str"]}function m$(r,t,e){var n=r.l+t,a=ra(r);a.r=e["!row"];var i=r.read_shift(1),s=[a,i,"b"];if(e.cellFormula){r.l+=2;var c=Ev(r,n-r.l,e);s[3]=tn(c,null,a,e.supbooks,e)}else r.l=n;return s}function g$(r,t,e){var n=r.l+t,a=ra(r);a.r=e["!row"];var i=r.read_shift(1),s=[a,i,"e"];if(e.cellFormula){r.l+=2;var c=Ev(r,n-r.l,e);s[3]=tn(c,null,a,e.supbooks,e)}else r.l=n;return s}function w$(r,t,e){var n=r.l+t,a=ra(r);a.r=e["!row"];var i=Jr(r),s=[a,i,"n"];if(e.cellFormula){r.l+=2;var c=Ev(r,n-r.l,e);s[3]=tn(c,null,a,e.supbooks,e)}else r.l=n;return s}function v$(r,t,e){var n=r.l+t,a=ra(r);a.r=e["!row"];var i=Yr(r),s=[a,i,"str"];if(e.cellFormula){r.l+=2;var c=Ev(r,n-r.l,e);s[3]=tn(c,null,a,e.supbooks,e)}else r.l=n;return s}var y$=Oc;function x$(r,t){var e=r.l+t,n=Oc(r),a=Cb(r),i=Yr(r),s=Yr(r),c=Yr(r);r.l=e;var l={rfx:n,relId:a,loc:i,display:c};return s&&(l.Tooltip=s),l}function k$(){}function b$(r,t,e){var n=r.l+t,a=jA(r),i=r.read_shift(1),s=[a];if(s[2]=i,e.cellFormula){var c=d9(r,n-r.l,e);s[1]=c}else r.l=n;return s}function _$(r,t,e){var n=r.l+t,a=Oc(r),i=[a];if(e.cellFormula){var s=p9(r,n-r.l,e);i[1]=s,r.l=n}else r.l=n;return i}var E$=["left","right","top","bottom","header","footer"];function S$(r){var t={};return E$.forEach(function(e){t[e]=Jr(r)}),t}function C$(r){var t=r.read_shift(2);return r.l+=28,{RTL:t&32}}function T$(){}function A$(){}function F$(r,t,e,n,a,i,s){if(!r)return r;var c=t||{};n||(n={"!id":{}});var l=c.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,m,w,p,g,v,k,x,S,I,O=[];c.biff=12,c["!row"]=0;var E=0,T=!1,P=[],W={},U=c.supbooks||a.supbooks||[[]];if(U.sharedf=W,U.arrayf=P,U.SheetNames=a.SheetNames||a.Sheets.map(function(oe){return oe.name}),!c.supbooks&&(c.supbooks=U,a.Names))for(var A=0;A<a.Names.length;++A)U[0][A+1]=a.Names[A];var N=[],C=[],K=!1;Tv[16]={n:"BrtShortReal",f:q3};var ne;if(ji(r,function(q,se,Q){if(!f)switch(Q){case 148:u=q;break;case 0:m=q,c.sheetRows&&c.sheetRows<=m.r&&(f=!0),S=Fr(g=m.r),c["!row"]=m.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=V0(q.hpt)),C[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:q[2]},q[2]){case"n":w.v=q[1];break;case"s":x=J0[q[1]],w.v=x.t,w.r=x.r;break;case"b":w.v=!!q[1];break;case"e":w.v=q[1],c.cellText!==!1&&(w.w=zs[w.v]);break;case"str":w.t="s",w.v=q[1];break;case"is":w.t="s",w.v=q[1].t;break}if((p=s.CellXf[q[0].iStyleRef])&&K3(w,p.numFmtId,null,c,i,s),v=q[0].c==-1?v+1:q[0].c,c.dense?(l[g]||(l[g]=[]),l[g][v]=w):l[or(v)+S]=w,c.cellFormula){for(T=!1,E=0;E<P.length;++E){var R=P[E];m.r>=R[0].s.r&&m.r<=R[0].e.r&&v>=R[0].s.c&&v<=R[0].e.c&&(w.F=st(R[0]),T=!0)}!T&&q.length>3&&(w.f=q[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>v&&(h.s.c=v),h.e.r<m.r&&(h.e.r=m.r),h.e.c<v&&(h.e.c=v),c.cellDates&&p&&w.t=="n"&&ih(Xe[p.numFmtId])){var ae=Cc(w.v);ae&&(w.t="d",w.v=new Date(ae.y,ae.m-1,ae.d,ae.H,ae.M,ae.S,ae.u))}ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 1:case 12:if(!c.sheetStubs||d)break;w={t:"z",v:void 0},v=q[0].c==-1?v+1:q[0].c,c.dense?(l[g]||(l[g]=[]),l[g][v]=w):l[or(v)+S]=w,h.s.r>m.r&&(h.s.r=m.r),h.s.c>v&&(h.s.c=v),h.e.r<m.r&&(h.e.r=m.r),h.e.c<v&&(h.e.c=v),ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 176:O.push(q);break;case 49:ne=((c.xlmeta||{}).Cell||[])[q-1];break;case 494:var L=n["!id"][q.relId];for(L?(q.Target=L.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=L):q.relId==""&&(q.Target="#"+q.loc),g=q.rfx.s.r;g<=q.rfx.e.r;++g)for(v=q.rfx.s.c;v<=q.rfx.e.c;++v)c.dense?(l[g]||(l[g]=[]),l[g][v]||(l[g][v]={t:"z",v:void 0}),l[g][v].l=q):(k=Ye({c:v,r:g}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=q);break;case 426:if(!c.cellFormula)break;P.push(q),I=c.dense?l[g][v]:l[or(v)+S],I.f=tn(q[1],h,{r:m.r,c:v},U,c),I.F=st(q[0]);break;case 427:if(!c.cellFormula)break;W[Ye(q[0].s)]=q[1],I=c.dense?l[g][v]:l[or(v)+S],I.f=tn(q[1],h,{r:m.r,c:v},U,c);break;case 60:if(!c.cellStyles)break;for(;q.e>=q.s;)N[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},K||(K=!0,Bb(q.w/256)),lh(N[q.e+1]);break;case 161:l["!autofilter"]={ref:st(q)};break;case 476:l["!margins"]=q;break;case 147:a.Sheets[e]||(a.Sheets[e]={}),q.name&&(a.Sheets[e].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!se.T){if(!d||c.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=st(u||h)),c.sheetRows&&l["!ref"]){var X=Dt(l["!ref"]);c.sheetRows<=+X.e.r&&(X.e.r=c.sheetRows-1,X.e.r>h.e.r&&(X.e.r=h.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>h.e.c&&(X.e.c=h.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),l["!fullref"]=l["!ref"],l["!ref"]=st(X))}return O.length>0&&(l["!merges"]=O),N.length>0&&(l["!cols"]=N),C.length>0&&(l["!rows"]=C),l}function P$(r){var t=[],e=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=e?+s[2]:s[2])});var a=mt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function I$(r,t,e,n,a,i){var s=i||{"!type":"chart"};if(!r)return i;var c=0,l=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=P$(d);h.s.r=h.s.c=0,h.e.c=c,u=or(c),f[0].forEach(function(m,w){s[u+Fr(w)]={t:"n",v:m,z:f[1]},l=w}),h.e.r<l&&(h.e.r=l),++c}),c>0&&(s["!ref"]=st(h)),s}function D$(r,t,e,n,a){if(!r)return r;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,c=r.match(V3);return c&&Hb(c[0],i,a,e),(s=r.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function O$(r,t){r.l+=10;var e=Yr(r);return{name:e}}function M$(r,t,e,n,a){if(!r)return r;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ji(r,function(l,u,h){switch(h){case 550:i["!rel"]=l;break;case 651:a.Sheets[e]||(a.Sheets[e]={}),l.name&&(a.Sheets[e].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Wb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],R$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],N$=[],L$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function G3(r,t){for(var e=0;e!=r.length;++e)for(var n=r[e],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=$t(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function X3(r,t){for(var e=0;e!=t.length;++e){var n=t[e];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=$t(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function Y3(r){X3(r.WBProps,Wb),X3(r.CalcPr,L$),G3(r.WBView,R$),G3(r.Sheets,N$),hh.date1904=$t(r.WBProps.date1904)}var B$="][*?/\\".split("");function J3(r,t){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return B$.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function U$(r,t,e){r.forEach(function(n,a){J3(n);for(var i=0;i<a;++i)if(n==r[i])throw new Error("Duplicate Sheet Name: "+n);if(e){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function $$(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var t=r.Workbook&&r.Workbook.Sheets||[];U$(r.SheetNames,t,!!r.vbaraw);for(var e=0;e<r.SheetNames.length;++e)y9(r.Sheets[r.SheetNames[e]],r.SheetNames[e],e)}var j$=/<\w+:workbook/;function H$(r,t){if(!r)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(r.replace(qr,function(l,u){var h=qe(l);switch(Qa(h[0])){case"<?xml":break;case"<workbook":l.match(j$)&&(a="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],e.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Wb.forEach(function(d){if(h[d[0]]!=null)switch(d[2]){case"bool":e.WBProps[d[0]]=$t(h[d[0]]);break;case"int":e.WBProps[d[0]]=parseInt(h[d[0]],10);break;default:e.WBProps[d[0]]=h[d[0]]}}),h.codeName&&(e.WBProps.CodeName=Ct(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],e.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=mt(Ct(h.name)),delete h[0],e.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ct(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),$t(h.hidden||"0")&&(i.Hidden=!0),s=u+l.length;break;case"</definedName>":i.Ref=mt(Ct(r.slice(s,u))),e.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],e.CalcPr=h;break;case"<calcPr/>":delete h[0],e.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return l}),Pc.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return Y3(e),e}function W$(r){var t=[pn];t[t.length]=Be("workbook",null,{xmlns:Pc[0],"xmlns:r":pr.r});var e=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Wb.forEach(function(c){r.Workbook.WBProps[c[0]]!=null&&r.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=r.Workbook.WBProps[c[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var a=r.Workbook&&r.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=r.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==r.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=r.SheetNames.length;++i){var s={name:sr(r.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Be("sheet",null,s)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(c){var l={name:c.Name};c.Comment&&(l.comment=c.Comment),c.Sheet!=null&&(l.localSheetId=""+c.Sheet),c.Hidden&&(l.hidden="1"),c.Ref&&(t[t.length]=Be("definedName",sr(c.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function z$(r,t){var e={};return e.Hidden=r.read_shift(4),e.iTabID=r.read_shift(4),e.strRelID=Tb(r),e.name=Yr(r),e}function K$(r,t){var e={},n=r.read_shift(4);e.defaultThemeVersion=r.read_shift(4);var a=t>8?Yr(r):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function V$(r,t){var e={};return r.read_shift(4),e.ArchID=r.read_shift(4),r.l+=t-8,e}function q$(r,t,e){var n=r.l+t;r.l+=4,r.l+=1;var a=r.read_shift(4),i=JN(r),s=f9(r,0,e),c=Cb(r);r.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),c&&(l.Comment=c),l}function G$(r,t){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Tv[16]={n:"BrtFRTArchID$",f:V$},ji(r,function(l,u,h){switch(h){case 156:s.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=tn(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,l]):s[0]=[h,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),Y3(e),e.Names=i,e.supbooks=s,e}function X$(r,t,e){return t.slice(-4)===".bin"?G$(r,e):H$(r,e)}function Y$(r,t,e,n,a,i,s,c){return t.slice(-4)===".bin"?F$(r,n,e,a,i,s,c):P9(r,n,e,a,i,s,c)}function J$(r,t,e,n,a,i,s,c){return t.slice(-4)===".bin"?M$(r,n,e,a,i):D$(r,n,e,a,i)}function Z$(r,t,e,n,a,i,s,c){return t.slice(-4)===".bin"?W7():z7()}function Q$(r,t,e,n,a,i,s,c){return t.slice(-4)===".bin"?j7():H7()}function ej(r,t,e,n){return t.slice(-4)===".bin"?QB(r,e,n):VB(r,e,n)}function tj(r,t,e){return T3(r,e)}function rj(r,t,e){return t.slice(-4)===".bin"?fB(r,e):lB(r,e)}function nj(r,t,e){return t.slice(-4)===".bin"?L7(r,e):F7(r,e)}function aj(r,t,e){return t.slice(-4)===".bin"?S7(r):_7(r)}function ij(r,t,e,n){return e.slice(-4)===".bin"?C7(r,t,e,n):void 0}function sj(r,t,e){return t.slice(-4)===".bin"?x7(r,t,e):k7(r,t,e)}var Z3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Q3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Sa(r,t){var e=r.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var a=r.match(Z3),i,s,c,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(Q3),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(s+1),n[c]=i[2].slice(1,i[2].length-1));return n}function oj(r){var t=r.split(/\s+/),e={};if(t.length===1)return e;var n=r.match(Z3),a,i,s,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(Q3),(i=a[1].indexOf(":"))===-1?e[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),e[s]=a[2].slice(1,a[2].length-1));return e}var Z0;function cj(r,t){var e=Z0[r]||mt(r);return e==="General"?Tc(t):ea(e,t)}function lj(r,t,e,n){var a=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=$t(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ar(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}r[mt(t)]=a}function uj(r,t,e){if(r.t!=="z"){if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||zs[r.v]:t==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=I0(r.v):r.w=Tc(r.v):r.w=cj(t||"General",r.v)}catch(i){if(e.WTF)throw i}try{var n=Z0[t]||t||"General";if(e.cellNF&&(r.z=n),e.cellDates&&r.t=="n"&&ih(n)){var a=Cc(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(e.WTF)throw i}}}function hj(r,t,e){if(e.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=BB[n.Pattern]||n.Pattern)}r[t.ID]=t}function dj(r,t,e,n,a,i,s,c,l,u){var h="General",d=n.StyleID,f={};u=u||{};var m=[],w=0;for(d===void 0&&c&&(d=c.StyleID),d===void 0&&s&&(d=s.StyleID);i[d]!==void 0&&(i[d].nf&&(h=i[d].nf),i[d].Interior&&m.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=$t(r);break;case"String":n.t="s",n.r=dA(mt(r)),n.v=r.indexOf("<")>-1?mt(t||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(ar(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=mt(r):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=VA[r],u.cellText!==!1&&(n.w=r);break;default:r==""&&t==""?n.t="z":(n.t="s",n.v=dA(t||r));break}if(uj(n,h,u),u.cellFormula!==!1)if(n.Formula){var p=mt(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=uh(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=uh("RC:RC",a):n.ArrayRange&&(n.F=uh(n.ArrayRange,a),l.push([Dt(n.F),n.F]))}else for(w=0;w<l.length;++w)a.r>=l[w][0].s.r&&a.r<=l[w][0].e.r&&a.c>=l[w][0].s.c&&a.c<=l[w][0].e.c&&(n.F=l[w][1]);u.cellStyles&&(m.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fj(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function zb(r,t){var e=t||{};fb();var n=F0(yb(r));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=Ct(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Xt(e);return s.type="string",H0.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(z){a.indexOf("<"+z)>=0&&(i=!0)}),i)return bj(n,e);Z0={"General Number":"General","General Date":Xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Xe[15],"Short Date":Xe[14],"Long Time":Xe[19],"Medium Time":Xe[18],"Short Time":Xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Xe[2],Standard:Xe[4],Percent:Xe[10],Scientific:Xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],u,h={},d=[],f=e.dense?[]:{},m="",w={},p={},g=Sa('<Data ss:Type="String">'),v=0,k=0,x=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},O={},E="",T=0,P=[],W={},U={},A=0,N=[],C=[],K={},ne=[],X,oe=!1,q=[],se=[],Q={},R=0,ae=0,L={Sheets:[],WBProps:{date1904:!1}},M={};M0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";c=M0.exec(n);)switch(c[3]=(ce=c[3]).toLowerCase()){case"data":if(ce=="data"){if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?dj(n.slice(v,c.index),E,g,l[l.length-1][0]=="comment"?K:w,{c:k,r:x},I,ne[k],p,q,e):(E="",g=Sa(c[0]),v=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(C.length>0&&(w.c=C),(!e.sheetRows||e.sheetRows>x)&&w.v!==void 0&&(e.dense?(f[x]||(f[x]=[]),f[x][k]=w):f[or(k)+Fr(x)]=w),w.HRef&&(w.l={Target:mt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(R=k+(parseInt(w.MergeAcross,10)|0),ae=x+(parseInt(w.MergeDown,10)|0),P.push({s:{c:k,r:x},e:{c:R,r:ae}})),!e.sheetStubs)w.MergeAcross?k=R+1:++k;else if(w.MergeAcross||w.MergeDown){for(var ke=k;ke<=R;++ke)for(var ue=x;ue<=ae;++ue)(ke>k||ue>x)&&(e.dense?(f[ue]||(f[ue]=[]),f[ue][ke]={t:"z"}):f[or(ke)+Fr(ue)]={t:"z"});k=R+1}else++k;else w=oj(c[0]),w.Index&&(k=+w.Index-1),k<S.s.c&&(S.s.c=k),k>S.e.c&&(S.e.c=k),c[0].slice(-2)==="/>"&&++k,C=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(x<S.s.r&&(S.s.r=x),x>S.e.r&&(S.e.r=x),c[0].slice(-2)==="/>"&&(p=Sa(c[0]),p.Index&&(x=+p.Index-1)),k=0,++x):(p=Sa(c[0]),p.Index&&(x=+p.Index-1),Q={},(p.AutoFitHeight=="0"||p.Height)&&(Q.hpx=parseInt(p.Height,10),Q.hpt=xv(Q.hpx),se[x]=Q),p.Hidden=="1"&&(Q.hidden=!0,se[x]=Q));break;case"worksheet":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));d.push(m),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(f["!ref"]=st(S),e.sheetRows&&e.sheetRows<=S.e.r&&(f["!fullref"]=f["!ref"],S.e.r=e.sheetRows-1,f["!ref"]=st(S))),P.length&&(f["!merges"]=P),ne.length>0&&(f["!cols"]=ne),se.length>0&&(f["!rows"]=se),h[m]=f}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=k=0,l.push([c[3],!1]),u=Sa(c[0]),m=mt(u.Name),f=e.dense?[]:{},P=[],q=[],se=[],M={name:m,Hidden:0},L.Sheets.push(M);break;case"table":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),ne=[],oe=!1}break;case"style":c[1]==="/"?hj(I,O,e):O=Sa(c[0]);break;case"numberformat":O.nf=mt(Sa(c[0]).Format||"General"),Z0[O.nf]&&(O.nf=Z0[O.nf]);for(var ve=0;ve!=392&&Xe[ve]!=O.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(Xe[ve]==null){Ui(O.nf,ve);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(X=Sa(c[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!oe&&X.wpx>10){oe=!0,en=S3;for(var ge=0;ge<ne.length;++ge)ne[ge]&&lh(ne[ge])}oe&&lh(X),ne[X.Index-1||ne.length]=X;for(var te=0;te<+X.Span;++te)ne[ne.length]=Xt(X);break;case"namedrange":if(c[1]==="/")break;L.Names||(L.Names=[]);var D=qe(c[0]),he={Name:D.Name,Ref:uh(D.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(he.Sheet=L.Sheets.length-1),L.Names.push(he);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?E+=n.slice(T,c.index):T=c.index+c[0].length;break;case"interior":if(!e.cellStyles)break;O.Interior=Sa(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?E8(W,ce,n.slice(A,c.index)):A=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));fj(K),C.push(K)}else l.push([c[3],!1]),u=Sa(c[0]),K={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var b=Sa(c[0]);f["!autofilter"]={ref:uh(b.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return lF(n,e);var ee=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ee=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ee=!1}break;case"excelworkbook":switch(c[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ee=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ee=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(A,c.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else A=c.index+c[0].length;break;case"header":f["!margins"]||dh(f["!margins"]={},"xlml"),isNaN(+qe(c[0]).Margin)||(f["!margins"].header=+qe(c[0]).Margin);break;case"footer":f["!margins"]||dh(f["!margins"]={},"xlml"),isNaN(+qe(c[0]).Margin)||(f["!margins"].footer=+qe(c[0]).Margin);break;case"pagemargins":var re=qe(c[0]);f["!margins"]||dh(f["!margins"]={},"xlml"),isNaN(+re.Top)||(f["!margins"].top=+re.Top),isNaN(+re.Left)||(f["!margins"].left=+re.Left),isNaN(+re.Right)||(f["!margins"].right=+re.Right),isNaN(+re.Bottom)||(f["!margins"].bottom=+re.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ee=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ee=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ee=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ee=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ee=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ee=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ee=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ee=!1}break;case"smarttags":break;default:ee=!1;break}if(ee||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?lj(U,ce,N,n.slice(A,c.index)):(N=c,A=c.index+c[0].length);break}if(e.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var j={};return!e.bookSheets&&!e.bookProps&&(j.Sheets=h),j.SheetNames=d,j.Workbook=L,j.SSF=Xt(Xe),j.Props=W,j.Custprops=U,j}function Kb(r,t){switch(Zb(t=t||{}),t.type||"base64"){case"base64":return zb(On(r),t);case"binary":case"buffer":case"file":return zb(r,t);case"array":return zb(Us(r),t)}}function pj(r){var t={},e=r.content;if(e.l=28,t.AnsiUserType=e.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=e8(e),e.length-e.l<=4)return t;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,t.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=t8(e),n=e.read_shift(4),n==0||n>40))return t;e.l-=4,t.Reserved2=e.read_shift(0,"lpwstr")}var mj=[60,1084,2066,2165,2175];function gj(r,t,e,n,a){var i=n,s=[],c=e.slice(e.l,e.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}s.push(c),e.l+=i;for(var l=$i(e,e.l),u=Vb[l],h=0;u!=null&&mj.indexOf(l)>-1;)i=$i(e,e.l+2),h=e.l+4,l==2066?h+=4:(l==2165||l==2175)&&(h+=12),c=e.slice(h,e.l+4+i),s.push(c),e.l+=4+i,u=Vb[l=$i(e,e.l)];var d=$s(s);zr(d,0);var f=0;d.lens=[];for(var m=0;m<s.length;++m)d.lens.push(f),f+=s[m].length;if(d.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function ti(r,t,e){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,t.cellNF&&(r.z=Xe[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||zs[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=I0(r.v):r.w=Tc(r.v):r.w=ea(n,r.v,{date1904:!!e,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&r.t=="n"&&ih(Xe[n]||String(n))){var a=Cc(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Cv(r,t,e){return{v:r,ixfe:t,t:e}}function wj(r,t){var e={opts:{}},n={},a=t.dense?[]:{},i={},s={},c=null,l=[],u="",h={},d,f="",m,w,p,g,v={},k=[],x,S,I=[],O=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},P=function(Ze){return Ze<8?Mc[Ze]:Ze<64&&O[Ze-8]||Mc[Ze]},W=function(Ze,yt,Br){var tt=yt.XF.data;if(!(!tt||!tt.patternType||!Br||!Br.cellStyles)){yt.s={},yt.s.patternType=tt.patternType;var ga;(ga=z0(P(tt.icvFore)))&&(yt.s.fgColor={rgb:ga}),(ga=z0(P(tt.icvBack)))&&(yt.s.bgColor={rgb:ga})}},U=function(Ze,yt,Br){if(!(Q>1)&&!(Br.sheetRows&&Ze.r>=Br.sheetRows)){if(Br.cellStyles&&yt.XF&&yt.XF.data&&W(Ze,yt,Br),delete yt.ixfe,delete yt.XF,d=Ze,f=Ye(Ze),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<s.s.r&&(s.s.r=Ze.r),Ze.c<s.s.c&&(s.s.c=Ze.c),Ze.r+1>s.e.r&&(s.e.r=Ze.r+1),Ze.c+1>s.e.c&&(s.e.c=Ze.c+1),Br.cellFormula&&yt.f){for(var tt=0;tt<k.length;++tt)if(!(k[tt][0].s.c>Ze.c||k[tt][0].s.r>Ze.r)&&!(k[tt][0].e.c<Ze.c||k[tt][0].e.r<Ze.r)){yt.F=st(k[tt][0]),(k[tt][0].s.c!=Ze.c||k[tt][0].s.r!=Ze.r)&&delete yt.f,yt.f&&(yt.f=""+tn(k[tt][1],s,Ze,q,A));break}}Br.dense?(a[Ze.r]||(a[Ze.r]=[]),a[Ze.r][Ze.c]=yt):a[f]=yt}},A={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var N,C=[],K=[],ne=[],X=[],oe=!1,q=[];q.SheetNames=A.snames,q.sharedf=A.sharedf,q.arrayf=A.arrayf,q.names=[],q.XTI=[];var se=0,Q=0,R=0,ae=[],L=[],M;A.codepage=1200,ka(1200);for(var ce=!1;r.l<r.length-1;){var ke=r.l,ue=r.read_shift(2);if(ue===0&&se===10)break;var ve=r.l===r.length?0:r.read_shift(2),ge=Vb[ue];if(ge&&ge.f){if(t.bookSheets&&se===133&&ue!==133)break;if(se=ue,ge.r===2||ge.r==12){var te=r.read_shift(2);if(ve-=2,!A.enc&&te!==ue&&((te&255)<<8|te>>8)!==ue)throw new Error("rt mismatch: "+te+"!="+ue);ge.r==12&&(r.l+=10,ve-=10)}var D={};if(ue===10?D=ge.f(r,ve,A):D=gj(ue,ge,r,ve,A),Q==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(ue){case 34:e.opts.Date1904=E.WBProps.date1904=D;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(A.enc||(r.l=0),A.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=D;break;case 66:var he=Number(D);switch(he){case 21010:he=1200;break;case 32768:he=1e4;break;case 32769:he=1252;break}ka(A.codepage=he),ce=!0;break;case 317:A.rrtabid=D;break;case 25:A.winlocked=D;break;case 439:e.opts.RefreshAll=D;break;case 12:e.opts.CalcCount=D;break;case 16:e.opts.CalcDelta=D;break;case 17:e.opts.CalcIter=D;break;case 13:e.opts.CalcMode=D;break;case 14:e.opts.CalcPrecision=D;break;case 95:e.opts.CalcSaveRecalc=D;break;case 15:A.CalcRefMode=D;break;case 2211:e.opts.FullCalc=D;break;case 129:D.fDialog&&(a["!type"]="dialog"),D.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),D.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(D);break;case 430:q.push([D]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(D);break;case 24:case 536:M={Name:D.Name,Ref:tn(D.rgce,s,null,q,A)},D.itab>0&&(M.Sheet=D.itab-1),q.names.push(M),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(L[D.itab-1]={ref:st(D.rgce[0][0][1][2])});break;case 22:A.ExternCount=D;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(D),q.XTI=q.XTI.concat(D);break;case 2196:if(A.biff<8)break;M!=null&&(M.Comment=D[1]);break;case 18:a["!protect"]=D;break;case 19:D!==0&&A.WTF&&console.error("Password verifier: "+D);break;case 133:i[D.pos]=D,A.snames.push(D.name);break;case 10:{if(--Q)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=st(s),t.sheetRows&&t.sheetRows<=s.e.r){var b=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=st(s),s.e.r=b}s.e.r++,s.e.c++}C.length>0&&(a["!merges"]=C),K.length>0&&(a["!objects"]=K),ne.length>0&&(a["!cols"]=ne),X.length>0&&(a["!rows"]=X),E.Sheets.push(T)}u===""?h=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),A.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(A.biff=5,ce=!0,ka(A.codepage=28591)),A.biff==8&&D.BIFFVer==0&&D.dt==16&&(A.biff=2),Q++)break;if(a=t.dense?[]:{},A.biff<8&&!ce&&(ce=!0,ka(A.codepage=t.codepage||1252)),A.biff<5||D.BIFFVer==0&&D.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ee={pos:r.l-ve,name:u};i[ee.pos]=ee,A.snames.push(u)}else u=(i[ke]||{name:""}).name;D.dt==32&&(a["!type"]="chart"),D.dt==64&&(a["!type"]="macro"),C=[],K=[],A.arrayf=k=[],ne=[],X=[],oe=!1,T={Hidden:(i[ke]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[D.r]||[])[D.c]:a[Ye({c:D.c,r:D.r})])&&++D.c,x={ixfe:D.ixfe,XF:I[D.ixfe]||{},v:D.val,t:"n"},R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:D.c,r:D.r},x,t);break;case 5:case 517:x={ixfe:D.ixfe,XF:I[D.ixfe],v:D.val,t:D.t},R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:D.c,r:D.r},x,t);break;case 638:x={ixfe:D.ixfe,XF:I[D.ixfe],v:D.rknum,t:"n"},R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:D.c,r:D.r},x,t);break;case 189:for(var re=D.c;re<=D.C;++re){var j=D.rkrec[re-D.c][0];x={ixfe:j,XF:I[j],v:D.rkrec[re-D.c][1],t:"n"},R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:re,r:D.r},x,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){c=D;break}if(x=Cv(D.val,D.cell.ixfe,D.tt),x.XF=I[x.ixfe],t.cellFormula){var z=D.formula;if(z&&z[0]&&z[0][0]&&z[0][0][0]=="PtgExp"){var ie=z[0][0][1][0],we=z[0][0][1][1],ye=Ye({r:ie,c:we});v[ye]?x.f=""+tn(D.formula,s,D.cell,q,A):x.F=((t.dense?(a[ie]||[])[we]:a[ye])||{}).F}else x.f=""+tn(D.formula,s,D.cell,q,A)}R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U(D.cell,x,t),c=D}break;case 7:case 519:if(c)c.val=D,x=Cv(D,c.cell.ixfe,"s"),x.XF=I[x.ixfe],t.cellFormula&&(x.f=""+tn(c.formula,s,c.cell,q,A)),R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U(c.cell,x,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(D);var le=Ye(D[0].s);if(m=t.dense?(a[D[0].s.r]||[])[D[0].s.c]:a[le],t.cellFormula&&m){if(!c||!le||!m)break;m.f=""+tn(D[1],s,D[0],q,A),m.F=st(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!c)break;v[Ye(c.cell)]=D[0],m=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[Ye(c.cell)],(m||{}).f=""+tn(D[0],s,d,q,A)}}break;case 253:x=Cv(l[D.isst].t,D.ixfe,"s"),l[D.isst].h&&(x.h=l[D.isst].h),x.XF=I[x.ixfe],R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:D.c,r:D.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:D.ixfe,XF:I[D.ixfe],t:"z"},R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:D.c,r:D.r},x,t));break;case 190:if(t.sheetStubs)for(var be=D.c;be<=D.C;++be){var Pe=D.ixfe[be-D.c];x={ixfe:Pe,XF:I[Pe],t:"z"},R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:be,r:D.r},x,t)}break;case 214:case 516:case 4:x=Cv(D.val,D.ixfe,"s"),x.XF=I[x.ixfe],R>0&&(x.z=ae[x.ixfe>>8&63]),ti(x,t,e.opts.Date1904),U({c:D.c,r:D.r},x,t);break;case 0:case 512:Q===1&&(s=D);break;case 252:l=D;break;case 1054:if(A.biff==4){ae[R++]=D[1];for(var Ce=0;Ce<R+163&&Xe[Ce]!=D[1];++Ce);Ce>=163&&Ui(D[1],R+163)}else Ui(D[1],D[0]);break;case 30:{ae[R++]=D;for(var $e=0;$e<R+163&&Xe[$e]!=D;++$e);$e>=163&&Ui(D,R+163)}break;case 229:C=C.concat(D);break;case 93:K[D.cmo[0]]=A.lastobj=D;break;case 438:A.lastobj.TxO=D;break;case 127:A.lastobj.ImData=D;break;case 440:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)m=t.dense?(a[g]||[])[p]:a[Ye({c:p,r:g})],m&&(m.l=D[1]);break;case 2048:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)m=t.dense?(a[g]||[])[p]:a[Ye({c:p,r:g})],m&&m.l&&(m.l.Tooltip=D[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;m=t.dense?(a[D[0].r]||[])[D[0].c]:a[Ye(D[0])];var vt=K[D[2]];m||(t.dense?(a[D[0].r]||(a[D[0].r]=[]),m=a[D[0].r][D[0].c]={t:"z"}):m=a[Ye(D[0])]={t:"z"},s.e.r=Math.max(s.e.r,D[0].r),s.s.r=Math.min(s.s.r,D[0].r),s.e.c=Math.max(s.e.c,D[0].c),s.s.c=Math.min(s.s.c,D[0].c)),m.c||(m.c=[]),w={a:D[1],t:vt.TxO.t},m.c.push(w)}break;case 2173:g7(I[D.ixfe],D.ext);break;case 125:{if(!A.cellStyles)break;for(;D.e>=D.s;)ne[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},oe||(oe=!0,Bb(D.w/256)),lh(ne[D.e+1])}break;case 520:{var Ve={};D.level!=null&&(X[D.r]=Ve,Ve.level=D.level),D.hidden&&(X[D.r]=Ve,Ve.hidden=!0),D.hpt&&(X[D.r]=Ve,Ve.hpt=D.hpt,Ve.hpx=V0(D.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||dh(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=D;break;case 161:a["!margins"]||dh(a["!margins"]={}),a["!margins"].header=D.header,a["!margins"].footer=D.footer;break;case 574:D.RTL&&(E.Views[0].RTL=!0);break;case 146:O=D;break;case 2198:N=D;break;case 140:S=D;break;case 442:u?T.CodeName=D||T.name:E.WBProps.CodeName=D||"ThisWorkbook";break}}else ge||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),r.l+=ve}return e.SheetNames=fn(i).sort(function(zt,Ze){return Number(zt)-Number(Ze)}).map(function(zt){return i[zt].name}),t.bookSheets||(e.Sheets=n),!e.SheetNames.length&&h["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=h)):e.Preamble=h,e.Sheets&&L.forEach(function(zt,Ze){e.Sheets[e.SheetNames[Ze]]["!autofilter"]=zt}),e.Strings=l,e.SSF=Xt(Xe),A.enc&&(e.Encryption=A.enc),N&&(e.Themes=N),e.Metadata={},S!==void 0&&(e.Metadata.Country=S),q.names.length>0&&(E.Names=q.names),e.Workbook=E,e}var eF={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vj(r,t,e){var n=it.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=n3(n,o8,eF.DSI);for(var i in a)t[i]=a[i]}catch(u){if(e.WTF)throw u}var s=it.find(r,"/!SummaryInformation");if(s&&s.size>0)try{var c=n3(s,c8,eF.SI);for(var l in c)t[l]==null&&(t[l]=c[l])}catch(u){if(e.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(YA(t.HeadingPairs,t.TitlesOfParts,t,e),delete t.HeadingPairs,delete t.TitlesOfParts)}function tF(r,t){t||(t={}),Zb(t),cb(),t.codepage&&ob(t.codepage);var e,n;if(r.FullPaths){if(it.find(r,"/encryption"))throw new Error("File is password-protected");e=it.find(r,"!CompObj"),n=it.find(r,"/Workbook")||it.find(r,"/Book")}else{switch(t.type){case"base64":r=Zn(On(r));break;case"binary":r=Zn(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}zr(r,0),n={content:r}}var a,i;if(e&&pj(e),t.bookProps&&!t.bookSheets)a={};else{var s=ot?"buffer":"array";if(n&&n.content)a=wj(n.content,t);else if((i=it.find(r,"PerfectOffice_MAIN"))&&i.content)a=W0.to_workbook(i.content,(t.type=s,t));else if((i=it.find(r,"NativeContent_MAIN"))&&i.content)a=W0.to_workbook(i.content,(t.type=s,t));else throw(i=it.find(r,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&r.FullPaths&&it.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=U7(r))}var c={};return r.FullPaths&&vj(r,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=r),a}var Tv={0:{f:J9},1:{f:t$},2:{f:u$},3:{f:i$},4:{f:n$},5:{f:l$},6:{f:f$},7:{f:o$},8:{f:v$},9:{f:w$},10:{f:m$},11:{f:g$},12:{f:r$},13:{f:h$},14:{f:s$},15:{f:a$},16:{f:q3},17:{f:p$},18:{f:c$},19:{f:Sb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:q$},40:{},42:{},43:{f:XB},44:{f:GB},45:{f:YB},46:{f:ZB},47:{f:JB},48:{},49:{f:qN},50:{},51:{f:v7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:v3},62:{f:d$},63:{f:E7},64:{f:T$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:C$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:e$},148:{f:Z9,p:16},151:{f:k$},152:{},153:{f:K$},154:{},155:{},156:{f:z$},157:{},158:{},159:{T:1,f:dB},160:{T:-1},161:{T:1,f:Oc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:y$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:w7},336:{T:-1},337:{f:y7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Tb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:g3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:b$},427:{f:_$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:S$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Q9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:x$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Tb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:N7},633:{T:1},634:{T:-1},635:{T:1,f:R7},636:{T:-1},637:{f:XN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:O$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:A$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vb={6:{f:$b},10:{f:Ks},12:{f:cr},13:{f:cr},14:{f:Yt},15:{f:Yt},16:{f:Jr},17:{f:Yt},18:{f:Yt},19:{f:cr},20:{f:f3},21:{f:f3},23:{f:g3},24:{f:m3},25:{f:Yt},26:{},27:{},28:{f:SL},29:{},34:{f:Yt},35:{f:p3},38:{f:Jr},39:{f:Jr},40:{f:Jr},41:{f:Jr},42:{f:Yt},43:{f:Yt},47:{f:PB},49:{f:sL},51:{f:cr},60:{},61:{f:nL},64:{f:Yt},65:{f:iL},66:{f:cr},77:{},80:{},81:{},82:{},85:{f:cr},89:{},90:{},91:{},92:{f:X8},93:{f:TL},94:{},95:{f:Yt},96:{},97:{},99:{f:Yt},125:{f:v3},128:{f:gL},129:{f:Y8},130:{f:cr},131:{f:Yt},132:{f:Yt},133:{f:J8},134:{},140:{f:OL},141:{f:cr},144:{},146:{f:RL},151:{},152:{},153:{},154:{},155:{},156:{f:cr},157:{},158:{},160:{f:$L},161:{f:LL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:dL},190:{f:fL},193:{f:Ks},197:{},198:{},199:{},200:{},201:{},202:{f:Yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:cr},220:{},221:{f:Yt},222:{},224:{f:mL},225:{f:G8},226:{f:Ks},227:{},229:{f:CL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z8},253:{f:oL},255:{f:Q8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:a3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Yt},353:{f:Ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vL},431:{f:Yt},432:{},433:{},434:{},437:{},438:{f:PL},439:{f:Yt},440:{f:IL},441:{},442:{f:j0},443:{},444:{f:cr},445:{},446:{},448:{f:Ks},449:{f:rL,r:2},450:{f:Ks},512:{f:h3},513:{f:UL},515:{f:wL},516:{f:cL},517:{f:d3},519:{f:jL},520:{f:eL},523:{},545:{f:w3},549:{f:u3},566:{},574:{f:aL},638:{f:hL},659:{},1048:{},1054:{f:lL},1084:{},1212:{f:bL},2048:{f:DL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gv},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:NL,r:12},2173:{f:m7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:kL,r:12},2197:{},2198:{f:l7,r:12},2199:{},2200:{},2201:{},2202:{f:_L,r:12},2203:{f:Ks},2204:{},2205:{},2206:{},2207:{},2211:{f:tL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:BL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ML},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:h3},1:{},2:{f:KL},3:{f:zL},4:{f:WL},5:{f:d3},7:{f:VL},8:{},9:{f:gv},11:{},22:{f:cr},30:{f:uL},31:{},32:{},33:{f:w3},36:{},37:{f:u3},50:{f:qL},62:{},52:{},67:{},68:{f:cr},69:{},86:{},126:{},127:{f:HL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:GL},223:{},234:{},354:{},421:{},518:{f:$b},521:{f:gv},536:{f:m3},547:{f:p3},561:{},579:{},1030:{f:$b},1033:{f:gv},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ca(r,t,e,n){var a=t;if(!isNaN(a)){var i=(e||[]).length||0,s=r.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&NA(e)&&r.push(e)}}function rF(r,t){var e=t||{},n=e.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var a=r.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=r.match(/<\/table/i),s=a.index,c=i&&i.index||r.length,l=xN(r.slice(s,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,d=0,f=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(s=0;s<l.length;++s){var p=l[s].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,e.sheetRows&&e.sheetRows<=u){--u;break}h=0;continue}if(!(g!="<td"&&g!="<th")){var v=p.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var k=v[c].trim();if(k.match(/<t[dh]/i)){for(var x=k,S=0;x.charAt(0)=="<"&&(S=x.indexOf(">"))>-1;)x=x.slice(S+1);for(var I=0;I<w.length;++I){var O=w[I];O.s.c==h&&O.s.r<u&&u<=O.e.r&&(h=O.e.c+1,I=-1)}var E=qe(k.slice(0,k.indexOf(">")));f=E.colspan?+E.colspan:1,((d=+E.rowspan)>1||f>1)&&w.push({s:{r:u,c:h},e:{r:u+(d||1)-1,c:h+f-1}});var T=E.t||E["data-t"]||"";if(!x.length){h+=f;continue}if(x=mA(x),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!x.length){h+=f;continue}var P={t:"s",v:x};e.raw||!x.trim().length||T=="s"||(x==="TRUE"?P={t:"b",v:!0}:x==="FALSE"?P={t:"b",v:!1}:isNaN(_a(x))?isNaN(sh(x).getDate())||(P={t:"d",v:ar(x)},e.cellDates||(P={t:"n",v:Vr(P.v)}),P.z=e.dateNF||Xe[14]):P={t:"n",v:_a(x)}),e.dense?(n[u]||(n[u]=[]),n[u][h]=P):n[Ye({r:u,c:h})]=P,h+=f}}}}return n["!ref"]=st(m),w.length&&(n["!merges"]=w),n}function yj(r,t,e,n){for(var a=r["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var c=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>e||a[u].s.c>s)&&!(a[u].e.r<e||a[u].e.c<s)){if(a[u].s.r<e||a[u].s.c<s){c=-1;break}c=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var h=Ye({r:e,c:s}),d=n.dense?(r[e]||[])[s]:r[h],f=d&&d.v!=null&&(d.h||gb(d.w||(Hi(d),d.w)||""))||"",m={};c>1&&(m.rowspan=c),l>1&&(m.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(m["data-t"]=d&&d.t||"z",d.v!=null&&(m["data-v"]=d.v),d.z!=null&&(m["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),m.id=(n.id||"sjs")+"-"+h,i.push(Be("td",f,m))}}var w="<tr>";return w+i.join("")+"</tr>"}var xj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',kj="</body></html>";function bj(r,t){var e=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return Ws(rF(e[0],t),t);var n=n_();return e.forEach(function(a,i){a_(n,rF(a,t),"Sheet"+(i+1))}),n}function _j(r,t,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function Ej(r,t){var e=t||{},n=e.header!=null?e.header:xj,a=e.footer!=null?e.footer:kj,i=[n],s=Hs(r["!ref"]);e.dense=Array.isArray(r),i.push(_j(r,s,e));for(var c=s.s.r;c<=s.e.r;++c)i.push(yj(r,s,c,e));return i.push("</table>"+a),i.join("")}function nF(r,t,e){var n=e||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Xr(n.origin):n.origin;a=s.r,i=s.c}var c=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(r["!ref"]){var h=Hs(r["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),a==-1&&(u.e.r=a=h.e.r+1)}var d=[],f=0,m=r["!rows"]||(r["!rows"]=[]),w=0,p=0,g=0,v=0,k=0,x=0;for(r["!cols"]||(r["!cols"]=[]);w<c.length&&p<l;++w){var S=c[w];if(iF(S)){if(n.display)continue;m[p]={hidden:!0}}var I=S.children;for(g=v=0;g<I.length;++g){var O=I[g];if(!(n.display&&iF(O))){var E=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):mA(O.innerHTML),T=O.getAttribute("data-z")||O.getAttribute("z");for(f=0;f<d.length;++f){var P=d[f];P.s.c==v+i&&P.s.r<p+a&&p+a<=P.e.r&&(v=P.e.c+1-i,f=-1)}x=+O.getAttribute("colspan")||1,((k=+O.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:p+a,c:v+i},e:{r:p+a+(k||1)-1,c:v+i+(x||1)-1}});var W={t:"s",v:E},U=O.getAttribute("data-t")||O.getAttribute("t")||"";E!=null&&(E.length==0?W.t=U||"z":n.raw||E.trim().length==0||U=="s"||(E==="TRUE"?W={t:"b",v:!0}:E==="FALSE"?W={t:"b",v:!1}:isNaN(_a(E))?isNaN(sh(E).getDate())||(W={t:"d",v:ar(E)},n.cellDates||(W={t:"n",v:Vr(W.v)}),W.z=n.dateNF||Xe[14]):W={t:"n",v:_a(E)})),W.z===void 0&&T!=null&&(W.z=T);var A="",N=O.getElementsByTagName("A");if(N&&N.length)for(var C=0;C<N.length&&!(N[C].hasAttribute("href")&&(A=N[C].getAttribute("href"),A.charAt(0)!="#"));++C);A&&A.charAt(0)!="#"&&(W.l={Target:A}),n.dense?(r[p+a]||(r[p+a]=[]),r[p+a][v+i]=W):r[Ye({c:v+i,r:p+a})]=W,u.e.c<v+i&&(u.e.c=v+i),v+=x}}++p}return d.length&&(r["!merges"]=(r["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,p-1+a),r["!ref"]=st(u),p>=l&&(r["!fullref"]=st((u.e.r=c.length-w+p-1+a,u))),r}function aF(r,t){var e=t||{},n=e.dense?[]:{};return nF(n,r,t)}function Sj(r,t){return Ws(aF(r,t),t)}function iF(r){var t="",e=Cj(r);return e&&(t=e(r).getPropertyValue("display")),t||(t=r.style&&r.style.display),t==="none"}function Cj(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Tj(r){var t=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=mt(t.replace(/<[^>]*>/g,""));return[e]}var sF={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function oF(r,t){var e=t||{},n=yb(r),a=[],i,s,c={name:""},l="",u=0,h,d,f={},m=[],w=e.dense?[]:{},p,g,v={value:""},k="",x=0,S=[],I=-1,O=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,P={},W=[],U={},A=0,N=0,C=[],K=1,ne=1,X=[],oe={Names:[]},q={},se=["",""],Q=[],R={},ae="",L=0,M=!1,ce=!1,ke=0;for(M0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=M0.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?w["!ref"]=st(E):w["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=E.e.r&&(w["!fullref"]=w["!ref"],E.e.r=e.sheetRows-1,w["!ref"]=st(E)),W.length&&(w["!merges"]=W),C.length&&(w["!rows"]=C),h.name=h.名称||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),f[h.name]=w,ce=!1):p[0].charAt(p[0].length-2)!=="/"&&(h=qe(p[0],!1),I=O=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,w=e.dense?[]:{},W=[],C=[],ce=!0);break;case"table-row-group":p[1]==="/"?--T:++T;break;case"table-row":case"行":if(p[1]==="/"){I+=K,K=1;break}if(d=qe(p[0],!1),d.行号?I=d.行号-1:I==-1&&(I=0),K=+d["number-rows-repeated"]||1,K<10)for(ke=0;ke<K;++ke)T>0&&(C[I+ke]={level:T});O=-1;break;case"covered-table-cell":p[1]!=="/"&&++O,e.sheetStubs&&(e.dense?(w[I]||(w[I]=[]),w[I][O]={t:"z"}):w[Ye({r:I,c:O})]={t:"z"}),k="",S=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++O,v=qe(p[0],!1),ne=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&e.cellFormula!=!1&&(g.f=W3(mt(v.formula))),(v.数据类型||v["value-type"])=="string"&&(g.t="s",g.v=mt(v["string-value"]||""),e.dense?(w[I]||(w[I]=[]),w[I][O]=g):w[Ye({r:I,c:O})]=g),O+=ne-1;else if(p[1]!=="/"){++O,k="",x=0,S=[],ne=1;var ue=K?I+K-1:I;if(O>E.e.c&&(E.e.c=O),O<E.s.c&&(E.s.c=O),I<E.s.r&&(E.s.r=I),ue>E.e.r&&(E.e.r=ue),v=qe(p[0],!1),Q=[],R={},g={t:v.数据类型||v["value-type"],v:null},e.cellFormula)if(v.formula&&(v.formula=mt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(A=parseInt(v["number-matrix-rows-spanned"],10)||0,N=parseInt(v["number-matrix-columns-spanned"],10)||0,U={s:{r:I,c:O},e:{r:I+A-1,c:O+N-1}},g.F=st(U),X.push([U,g.F])),v.formula)g.f=W3(v.formula);else for(ke=0;ke<X.length;++ke)I>=X[ke][0].s.r&&I<=X[ke][0].e.r&&O>=X[ke][0].s.c&&O<=X[ke][0].e.c&&(g.F=X[ke][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(A=parseInt(v["number-rows-spanned"],10)||0,N=parseInt(v["number-columns-spanned"],10)||0,U={s:{r:I,c:O},e:{r:I+A-1,c:O+N-1}},W.push(U)),v["number-columns-repeated"]&&(ne=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=$t(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=ar(v["date-value"]),e.cellDates||(g.t="n",g.v=Vr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=wN(v["time-value"])/86400,e.cellDates&&(g.t="d",g.v=av(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(k=mt(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(M=!1,g.t==="s"&&(g.v=k||"",S.length&&(g.R=S),M=x==0),q.Target&&(g.l=q),Q.length>0&&(g.c=Q,Q=[]),k&&e.cellText!==!1&&(g.w=k),M&&(g.t="z",delete g.v),(!M||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=I))for(var ve=0;ve<K;++ve){if(ne=parseInt(v["number-columns-repeated"]||"1",10),e.dense)for(w[I+ve]||(w[I+ve]=[]),w[I+ve][O]=ve==0?g:Xt(g);--ne>0;)w[I+ve][O+ne]=Xt(g);else for(w[Ye({r:I+ve,c:O})]=g;--ne>0;)w[Ye({r:I+ve,c:O+ne})]=Xt(g);E.e.c<=O&&(E.e.c=O)}ne=parseInt(v["number-columns-repeated"]||"1",10),O+=ne-1,ne=0,g={},k="",S=[]}q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;R.t=k,S.length&&(R.R=S),R.a=ae,Q.push(R)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);ae="",L=0,k="",x=0,S=[];break;case"creator":p[1]==="/"?ae=n.slice(L,p.index):L=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);k="",x=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(P[c.name]=l,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(l="",c=qe(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=qe(p[0],!1),l+=sF[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=qe(p[0],!1),l+=sF[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":s=qe(p[0],!1),se=jb(s["cell-range-address"]);var ge={Name:s.name,Ref:se[0]+"!"+se[1]};ce&&(ge.Sheet=m.length),oe.Names.push(ge);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var te=Tj(n.slice(x,p.index));k=(k.length>0?k+`
`:"")+te[0]}else qe(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{se=jb(qe(p[0])["target-range-address"]),f[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(q=qe(p[0],!1),!q.href)break;q.Target=mt(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(se=jb(q.Target.slice(1)),q.Target="#"+se[0]+"!"+se[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(e.WTF)throw new Error(p)}}var D={Sheets:f,SheetNames:m,Workbook:oe};return e.bookSheets&&delete D.Sheets,D}function cF(r,t){t=t||{},ta(r,"META-INF/manifest.xml")&&m8(ir(r,"META-INF/manifest.xml"),t);var e=Mn(r,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=oF(Ct(e),t);return ta(r,"meta.xml")&&(n.Props=GA(ir(r,"meta.xml"))),n}function lF(r,t){return oF(r,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function qb(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Gb(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Ct(Us(r))}function Xb(r){var t=r.reduce(function(a,i){return a+i.length},0),e=new Uint8Array(t),n=0;return r.forEach(function(a){e.set(a,n),n+=a.length}),e}function uF(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function Aj(r,t){for(var e=(r[t+15]&127)<<7|r[t+14]>>1,n=r[t+14]&1,a=t+13;a>=t;--a)n=n*256+r[a];return(r[t+15]&128?-n:n)*Math.pow(10,e-6176)}function Q0(r,t){var e=t?t[0]:0,n=r[e]&127;e:if(r[e++]>=128&&(n|=(r[e]&127)<<7,r[e++]<128||(n|=(r[e]&127)<<14,r[e++]<128)||(n|=(r[e]&127)<<21,r[e++]<128)||(n+=(r[e]&127)*Math.pow(2,28),++e,r[e++]<128)||(n+=(r[e]&127)*Math.pow(2,35),++e,r[e++]<128)||(n+=(r[e]&127)*Math.pow(2,42),++e,r[e++]<128)))break e;return t&&(t[0]=e),n}function gr(r){var t=0,e=r[t]&127;e:if(r[t++]>=128){if(e|=(r[t]&127)<<7,r[t++]<128||(e|=(r[t]&127)<<14,r[t++]<128)||(e|=(r[t]&127)<<21,r[t++]<128))break e;e|=(r[t]&127)<<28}return e}function rn(r){for(var t=[],e=[0];e[0]<r.length;){var n=e[0],a=Q0(r,e),i=a&7;a=Math.floor(a/8);var s=0,c;if(a==0)break;switch(i){case 0:{for(var l=e[0];r[e[0]++]>=128;);c=r.slice(l,e[0])}break;case 5:s=4,c=r.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,c=r.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Q0(r,e),c=r.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:c,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Yb(r,t){return(r==null?void 0:r.map(function(e){return t(e.data)}))||[]}function Fj(r){for(var t,e=[],n=[0];n[0]<r.length;){var a=Q0(r,n),i=rn(r.slice(n[0],n[0]+a));n[0]+=a;var s={id:gr(i[1][0].data),messages:[]};i[2].forEach(function(c){var l=rn(c.data),u=gr(l[3][0].data);s.messages.push({meta:l,data:r.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=gr(i[3][0].data)>>>0>0),e.push(s)}return e}function Pj(r,t){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var e=[0],n=Q0(t,e),a=[];e[0]<t.length;){var i=t[e[0]]&3;if(i==0){var s=t[e[0]++]>>2;if(s<60)++s;else{var c=s-59;s=t[e[0]],c>1&&(s|=t[e[0]+1]<<8),c>2&&(s|=t[e[0]+2]<<16),c>3&&(s|=t[e[0]+3]<<24),s>>>=0,s++,e[0]+=c}a.push(t.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var l=0,u=0;if(i==1?(u=(t[e[0]]>>2&7)+4,l=(t[e[0]++]&224)<<3,l|=t[e[0]++]):(u=(t[e[0]++]>>2)+1,i==2?(l=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(l=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),a=[Xb(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var h=Xb(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Ij(r){for(var t=[],e=0;e<r.length;){var n=r[e++],a=r[e]|r[e+1]<<8|r[e+2]<<16;e+=3,t.push(Pj(n,r.slice(e,e+a))),e+=a}if(e!==r.length)throw new Error("data is not a valid framed stream!");return Xb(t)}function Dj(r,t,e,n){var a=qb(r),i=a.getUint32(4,!0),s=(n>1?12:8)+uF(i&(n>1?3470:398))*4,c=-1,l=-1,u=NaN,h=new Date(2001,0,1);i&512&&(c=a.getUint32(s,!0),s+=4),s+=uF(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var d;switch(r[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(c>-1)d={t:"s",v:e[c]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return d}function Oj(r,t,e){var n=qb(r),a=n.getUint32(8,!0),i=12,s=-1,c=-1,l=NaN,u=NaN,h=new Date(2001,0,1);a&1&&(l=Aj(r,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var d;switch(r[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)))}return d}function Mj(r,t,e){switch(r[0]){case 0:case 1:case 2:case 3:return Dj(r,t,e,r[0]);case 5:return Oj(r,t,e);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function qs(r){var t=rn(r);return Q0(t[1][0].data)}function hF(r,t){var e=rn(t.data),n=gr(e[1][0].data),a=e[3],i=[];return(a||[]).forEach(function(s){var c=rn(s.data),l=gr(c[1][0].data)>>>0;switch(n){case 1:i[l]=Gb(c[3][0].data);break;case 8:{var u=r[qs(c[9][0].data)][0],h=rn(u.data),d=r[qs(h[1][0].data)][0],f=gr(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var m=rn(d.data);i[l]=m[3].map(function(w){return Gb(w.data)}).join("")}break}}),i}function Rj(r,t){var e,n,a,i,s,c,l,u,h,d,f,m,w,p,g=rn(r),v=gr(g[1][0].data)>>>0,k=gr(g[2][0].data)>>>0,x=((n=(e=g[8])==null?void 0:e[0])==null?void 0:n.data)&&gr(g[8][0].data)>0||!1,S,I;if((i=(a=g[7])==null?void 0:a[0])!=null&&i.data&&t!=0)S=(c=(s=g[7])==null?void 0:s[0])==null?void 0:c.data,I=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(h=g[4])==null?void 0:h[0])!=null&&d.data&&t!=1)S=(m=(f=g[4])==null?void 0:f[0])==null?void 0:m.data,I=(p=(w=g[3])==null?void 0:w[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=x?4:1,E=qb(S),T=[],P=0;P<S.length/2;++P){var W=E.getUint16(P*2,!0);W<65535&&T.push([P,W])}if(T.length!=k)throw"Expected ".concat(k," cells, found ").concat(T.length);var U=[];for(P=0;P<T.length-1;++P)U[T[P][0]]=I.subarray(T[P][1]*O,T[P+1][1]*O);return T.length>=1&&(U[T[T.length-1][0]]=I.subarray(T[T.length-1][1]*O)),{R:v,cells:U}}function Nj(r,t){var e,n=rn(t.data),a=(e=n==null?void 0:n[7])!=null&&e[0]?gr(n[7][0].data)>>>0>0?1:0:-1,i=Yb(n[5],function(s){return Rj(s,a)});return{nrows:gr(n[4][0].data)>>>0,data:i.reduce(function(s,c){return s[c.R]||(s[c.R]=[]),c.cells.forEach(function(l,u){if(s[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));s[c.R][u]=l}),s},[])}}function Lj(r,t,e){var n,a=rn(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(gr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(gr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));e["!ref"]=st(i);var s=rn(a[4][0].data),c=hF(r,r[qs(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?hF(r,r[qs(s[17][0].data)][0]):[],u=rn(s[3][0].data),h=0;u[1].forEach(function(d){var f=rn(d.data),m=r[qs(f[2][0].data)][0],w=gr(m.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var p=Nj(r,m);p.data.forEach(function(g,v){g.forEach(function(k,x){var S=Ye({r:h+v,c:x}),I=Mj(k,c,l);I&&(e[S]=I)})}),h+=p.nrows})}function Bj(r,t){var e=rn(t.data),n={"!ref":"A1"},a=r[qs(e[2][0].data)],i=gr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Lj(r,a[0],n),n}function Uj(r,t){var e,n=rn(t.data),a={name:(e=n[1])!=null&&e[0]?Gb(n[1][0].data):"",sheets:[]},i=Yb(n[2],qs);return i.forEach(function(s){r[s].forEach(function(c){var l=gr(c.meta[1][0].data);l==6e3&&a.sheets.push(Bj(r,c))})}),a}function $j(r,t){var e=n_(),n=rn(t.data),a=Yb(n[1],qs);if(a.forEach(function(i){r[i].forEach(function(s){var c=gr(s.meta[1][0].data);if(c==2){var l=Uj(r,s);l.sheets.forEach(function(u,h){a_(e,u,h==0?l.name:l.name+"_"+h,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Jb(r){var t,e,n,a,i={},s=[];if(r.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Ij(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var h;try{h=Fj(u)}catch(d){return console.log("## "+(d.message||d))}h.forEach(function(d){i[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var c=((a=(n=(e=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&gr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||s.forEach(function(l){i[l].forEach(function(u){var h=gr(u.meta[1][0].data)>>>0;if(h==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return $j(i,c)}function dF(r){return function(e){for(var n=0;n!=r.length;++n){var a=r[n];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function Zb(r){dF([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function jj(r){dF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function Hj(r){return Ot.WS.indexOf(r)>-1?"sheet":r==Ot.CS?"chart":r==Ot.DS?"dialog":r==Ot.MS?"macro":r&&r.length?r:"sheet"}function Wj(r,t){if(!r)return 0;try{r=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,Hj(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function zj(r,t,e,n,a,i,s,c,l,u,h,d){try{i[n]=U0(Mn(r,e,!0),t);var f=ir(r,t),m;switch(c){case"sheet":m=Y$(f,t,a,l,i[n],u,h,d);break;case"chart":if(m=J$(f,t,a,l,i[n],u,h,d),!m||!m["!drawel"])break;var w=D0(m["!drawel"].Target,t),p=dv(w),g=T7(Mn(r,w,!0),U0(Mn(r,p,!0),w)),v=D0(g,w),k=dv(v);m=I$(Mn(r,v,!0),v,l,U0(Mn(r,k,!0),v),u,m);break;case"macro":m=Z$(f,t,a,l,i[n],u,h,d);break;case"dialog":m=Q$(f,t,a,l,i[n],u,h,d);break;default:throw new Error("Unrecognized sheet type "+c)}s[n]=m;var x=[];i&&i[n]&&fn(i[n]).forEach(function(S){var I="";if(i[n][S].Type==Ot.CMNT){I=D0(i[n][S].Target,t);var O=nj(ir(r,I,!0),I,l);if(!O||!O.length)return;F3(m,O,!1)}i[n][S].Type==Ot.TCMNT&&(I=D0(i[n][S].Target,t),x=x.concat(I7(ir(r,I,!0),l)))}),x&&x.length&&F3(m,x,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function na(r){return r.charAt(0)=="/"?r.slice(1):r}function Kj(r,t){if(fb(),t=t||{},Zb(t),ta(r,"META-INF/manifest.xml")||ta(r,"objectdata.xml"))return cF(r,t);if(ta(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Jb<"u"){if(r.FileIndex)return Jb(r);var e=it.utils.cfb_new();return sA(r).forEach(function(C){fr(e,C,bN(r,C))}),Jb(e)}throw new Error("Unsupported NUMBERS file")}if(!ta(r,"[Content_Types].xml"))throw ta(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ta(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=sA(r),a=d8(Mn(r,"[Content_Types].xml")),i=!1,s,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",ir(r,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!ir(r,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(J0=[],a.sst)try{J0=rj(ir(r,na(a.sst)),a.sst,t)}catch(C){if(t.WTF)throw C}t.cellStyles&&a.themes.length&&(l=tj(Mn(r,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=ej(ir(r,na(a.style)),a.style,l,t))}a.links.map(function(C){try{var K=U0(Mn(r,dv(na(C))),C);return ij(ir(r,na(C)),K,C,t)}catch{}});var h=X$(ir(r,na(a.workbooks[0])),a.workbooks[0],t),d={},f="";a.coreprops.length&&(f=ir(r,na(a.coreprops[0]),!0),f&&(d=GA(f)),a.extprops.length!==0&&(f=ir(r,na(a.extprops[0]),!0),f&&v8(f,d,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(f=Mn(r,na(a.custprops[0]),!0),f&&(m=k8(f,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?s=h.Sheets.map(function(K){return K.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),t.bookProps&&(w.Props=d,w.Custprops=m),t.bookSheets&&typeof s<"u"&&(w.SheetNames=s),t.bookSheets?w.SheetNames:t.bookProps))return w;s={};var p={};t.bookDeps&&a.calcchain&&(p=aj(ir(r,na(a.calcchain)),a.calcchain));var g=0,v={},k,x;{var S=h.Sheets;d.Worksheets=S.length,d.SheetNames=[];for(var I=0;I!=S.length;++I)d.SheetNames[I]=S[I].name}var O=i?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");ta(r,T)||(T="xl/_rels/workbook."+O+".rels");var P=U0(Mn(r,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=sj(ir(r,na(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=O7(ir(r,na(a.people[0])),t)),P&&(P=Wj(P,h.Sheets));var W=ir(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var U="sheet";if(P&&P[g]?(k="xl/"+P[g][1].replace(/[\/]?xl\//,""),ta(r,k)||(k=P[g][1]),ta(r,k)||(k=T.replace(/_rels\/.*$/,"")+P[g][1]),U=P[g][2]):(k="xl/worksheets/sheet"+(g+1-W)+"."+O,k=k.replace(/sheet0\./,"sheet.")),x=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,N=0;N!=t.sheets.length;++N)typeof t.sheets[N]=="number"&&t.sheets[N]==g&&(A=1),typeof t.sheets[N]=="string"&&t.sheets[N].toLowerCase()==d.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}zj(r,k,x,d.SheetNames[g],g,v,s,U,t,h,l,u)}return w={Directory:a,Workbook:h,Props:d,Custprops:m,Deps:p,Sheets:s,SheetNames:d.SheetNames,Strings:J0,Styles:u,Themes:l,SSF:Xt(Xe)},t&&t.bookFiles&&(r.files?(w.keys=n,w.files=r.files):(w.keys=[],w.files={},r.FullPaths.forEach(function(C,K){C=C.replace(/^Root Entry[\/]/,""),w.keys.push(C),w.files[C]=r.FileIndex[K]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=ir(r,na(a.vba[0]),!0):a.defaults&&a.defaults.bin===B7&&(w.vbaraw=ir(r,"xl/vbaProject.bin",!0))),w}function Vj(r,t){var e=t||{},n="Workbook",a=it.find(r,n);try{if(n="/!DataSpaces/Version",a=it.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(pB(a.content),n="/!DataSpaces/DataSpaceMap",a=it.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=gB(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=it.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=wB(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=it.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);yB(a.content)}catch{}if(n="/EncryptionInfo",a=it.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=xB(a.content);if(n="/EncryptedPackage",a=it.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,e.password||"",e);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,e.password||"",e);throw new Error("File is password-protected")}function qj(r,t){q0=1024,r&&!r.SSF&&(r.SSF=Xt(Xe)),r&&r.SSF&&(fb(),oN(r.SSF),t.revssf=pN(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sv?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",n=$7.indexOf(t.bookType)>-1,a=qA();jj(t=t||{});var i=_N(),s="",c=0;if(t.cellXfs=[],z3(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),s="docProps/core.xml",fr(i,s,w8(r.Props,t)),a.coreprops.push(s),Zr(t.rels,2,s,Ot.CORE_PROPS),s="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(r.SheetNames[u]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,fr(i,s,y8(r.Props)),a.extprops.push(s),Zr(t.rels,3,s,Ot.EXT_PROPS),r.Custprops!==r.Props&&fn(r.Custprops||{}).length>0&&(s="docProps/custom.xml",fr(i,s,b8(r.Custprops)),a.custprops.push(s),Zr(t.rels,4,s,Ot.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,c=1;c<=r.SheetNames.length;++c){var d={"!id":{}},f=r.Sheets[r.SheetNames[c-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+c+"."+e,fr(i,s,Y9(c-1,t,r,d)),a.sheets.push(s),Zr(t.wbrels,-1,"worksheets/sheet"+c+"."+e,Ot.WS[0])}if(f){var w=f["!comments"],p=!1,g="";if(w&&w.length>0){var v=!1;w.forEach(function(k){k[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+c+"."+e,fr(i,g,D7(w,h,t)),a.threadedcomments.push(g),Zr(d,-1,"../threadedComments/threadedComment"+c+"."+e,Ot.TCMNT)),g="xl/comments"+c+"."+e,fr(i,g,P7(w)),a.comments.push(g),Zr(d,-1,"../comments"+c+"."+e,Ot.CMNT),p=!0}f["!legacy"]&&p&&fr(i,"xl/drawings/vmlDrawing"+c+".vml",A7(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&fr(i,dv(s),Ib(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+e,fr(i,s,hB(t.Strings,t)),a.strs.push(s),Zr(t.wbrels,-1,"sharedStrings."+e,Ot.SST)),s="xl/workbook."+e,fr(i,s,W$(r)),a.workbooks.push(s),Zr(t.rels,1,s,Ot.WB),s="xl/theme/theme1.xml",fr(i,s,A3(r.Themes,t)),a.themes.push(s),Zr(t.wbrels,-1,"theme/theme1.xml",Ot.THEME),s="xl/styles."+e,fr(i,s,qB(r,t)),a.styles.push(s),Zr(t.wbrels,-1,"styles."+e,Ot.STY),r.vbaraw&&n&&(s="xl/vbaProject.bin",fr(i,s,r.vbaraw),a.vba.push(s),Zr(t.wbrels,-1,"vbaProject.bin",Ot.VBA)),s="xl/metadata."+e,fr(i,s,b7()),a.metadata.push(s),Zr(t.wbrels,-1,"metadata."+e,Ot.XLMETA),h.length>1&&(s="xl/persons/person.xml",fr(i,s,M7(h)),a.people.push(s),Zr(t.wbrels,-1,"persons/person.xml",Ot.PEOPLE)),fr(i,"[Content_Types].xml",f8(a,t)),fr(i,"_rels/.rels",Ib(t.rels)),fr(i,"xl/_rels/workbook."+e+".rels",Ib(t.wbrels)),delete t.revssf,delete t.ssf,i}function Qb(r,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":e=On(r.slice(0,12));break;case"binary":e=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Gj(r,t){return it.find(r,"EncryptedPackage")?Vj(r,t):tF(r,t)}function Xj(r,t){var e,n=r,a=t||{};return a.type||(a.type=ot&&Buffer.isBuffer(r)?"buffer":"base64"),e=oA(n,a),Kj(e,a)}function fF(r,t){var e=0;e:for(;e<r.length;)switch(r.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return Kb(r.slice(e),t);default:break e}return H0.to_workbook(r,t)}function Yj(r,t){var e="",n=Qb(r,t);switch(t.type){case"base64":e=On(r);break;case"binary":e=r;break;case"buffer":e=r.toString("binary");break;case"array":e=Ac(r);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=Ct(e)),t.type="binary",fF(e,t)}function Jj(r,t){var e=r;return t.type=="base64"&&(e=On(e)),e=Ns.utils.decode(1200,e.slice(2),"str"),t.type="binary",fF(e,t)}function Zj(r){return r.match(/[^\x00-\x7F]/)?Fc(r):r}function e_(r,t,e,n){return n?(e.type="string",H0.to_workbook(r,e)):H0.to_workbook(t,e)}function t_(r,t){cb();var e=t||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return t_(new Uint8Array(r),(e=Xt(e),e.type="array",e));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=r,a=[0,0,0,0],i=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),hh={},e.dateNF&&(hh.dateNF=e.dateNF),e.type||(e.type=ot&&Buffer.isBuffer(r)?"buffer":"base64"),e.type=="file"&&(e.type=ot?"buffer":"binary",n=fN(r),typeof Uint8Array<"u"&&!ot&&(e.type="array")),e.type=="string"&&(i=!0,e.type="binary",e.codepage=65001,n=Zj(r)),e.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),c=new Uint8Array(s);if(c.foo="bar",!c.foo)return e=Xt(e),e.type="array",t_(lb(n),e)}switch((a=Qb(n,e))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Gj(it.read(n,e),e);break;case 9:if(a[1]<=8)return tF(n,e);break;case 60:return Kb(n,e);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return QL(n,e);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return JL.to_workbook(n,e);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Xj(n,e):e_(r,n,e,i);case 239:return a[3]===60?Kb(n,e):e_(r,n,e,i);case 255:if(a[1]===254)return Jj(n,e);if(a[1]===0&&a[2]===2&&a[3]===0)return W0.to_workbook(n,e);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return W0.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return y3.to_workbook(n,e);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return IB.to_workbook(n,e);break;case 10:case 13:case 32:return Yj(n,e);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XL.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?y3.to_workbook(n,e):e_(r,n,e,i)}function Qj(r,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return QT(t.file,it.write(r,{type:ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return it.write(r,t)}function eH(r,t){var e=Xt(t||{}),n=qj(r,e);return tH(n,e)}function tH(r,t){var e={},n=ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=n;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=r.FullPaths?it.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):r.generate(e);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Qw(a))}return t.password&&typeof encrypt_agile<"u"?Qj(encrypt_agile(a,t.password),t):t.type==="file"?QT(t.file,a):t.type=="string"?Ct(a):a}function pF(r,t){cb(),$$(r);var e=Xt(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=pF(r,e);return e.type="array",Qw(n)}return eH(r,e)}function rH(r,t,e,n,a,i,s,c){var l=Fr(e),u=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),d=!0,f=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch{f.__rowNum__=e}else f.__rowNum__=e;if(!s||r[e])for(var m=t.s.c;m<=t.e.c;++m){var w=s?r[e][m]:r[n[m]+l];if(w===void 0||w.t===void 0){if(u===void 0)continue;i[m]!=null&&(f[i[m]]=u);continue}var p=w.v;switch(w.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[m]!=null){if(p==null)if(w.t=="e"&&p===null)f[i[m]]=null;else if(u!==void 0)f[i[m]]=u;else if(h&&p===null)f[i[m]]=null;else continue;else f[i[m]]=h&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?p:Hi(w,p,c);p!=null&&(d=!1)}}return{row:f,isempty:d}}function r_(r,t){if(r==null||r["!ref"]==null)return[];var e={t:"n",v:0},n=0,a=1,i=[],s=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=u.range!=null?u.range:r["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":l=Dt(h);break;case"number":l=Dt(r["!ref"]),l.s.r=h;break;default:l=h}n>0&&(a=0);var d=Fr(l.s.r),f=[],m=[],w=0,p=0,g=Array.isArray(r),v=l.s.r,k=0,x={};g&&!r[v]&&(r[v]=[]);var S=u.skipHidden&&r["!cols"]||[],I=u.skipHidden&&r["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(S[k]||{}).hidden)switch(f[k]=or(k),e=g?r[v][k]:r[f[k]+d],n){case 1:i[k]=k-l.s.c;break;case 2:i[k]=f[k];break;case 3:i[k]=u.header[k-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),c=s=Hi(e,null,u),p=x[s]||0,!p)x[s]=1;else{do c=s+"_"+p++;while(x[c]);x[s]=p,x[c]=1}i[k]=c}for(v=l.s.r+a;v<=l.e.r;++v)if(!(I[v]||{}).hidden){var O=rH(r,l,v,f,n,i,g,u);(O.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[w++]=O.row)}return m.length=w,m}var mF=/"/g;function nH(r,t,e,n,a,i,s,c){for(var l=!0,u=[],h="",d=Fr(e),f=t.s.c;f<=t.e.c;++f)if(n[f]){var m=c.dense?(r[e]||[])[f]:r[n[f]+d];if(m==null)h="";else if(m.v!=null){l=!1,h=""+(c.rawNumbers&&m.t=="n"?m.v:Hi(m,null,c));for(var w=0,p=0;w!==h.length;++w)if((p=h.charCodeAt(w))===a||p===i||p===34||c.forceQuotes){h='"'+h.replace(mF,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(l=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(mF,'""')+'"')):h="";u.push(h)}return c.blankrows===!1&&l?null:u.join(s)}function gF(r,t){var e=[],n=t??{};if(r==null||r["!ref"]==null)return"";var a=Dt(r["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,l=c.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),h="",d=[];n.dense=Array.isArray(r);for(var f=n.skipHidden&&r["!cols"]||[],m=n.skipHidden&&r["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(f[w]||{}).hidden||(d[w]=or(w));for(var p=0,g=a.s.r;g<=a.e.r;++g)(m[g]||{}).hidden||(h=nH(r,a,g,d,s,l,i,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&e.push((p++?c:"")+h)));return delete n.dense,e.join("")}function aH(r,t){t||(t={}),t.FS="	",t.RS=`
`;var e=gF(r,t);return e}function iH(r){var t="",e,n="";if(r==null||r["!ref"]==null)return[];var a=Dt(r["!ref"]),i="",s=[],c,l=[],u=Array.isArray(r);for(c=a.s.c;c<=a.e.c;++c)s[c]=or(c);for(var h=a.s.r;h<=a.e.r;++h)for(i=Fr(h),c=a.s.c;c<=a.e.c;++c)if(t=s[c]+i,e=u?(r[h]||[])[c]:r[t],n="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;n=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}l[l.length]=t+"="+n}return l}function wF(r,t,e){var n=e||{},a=+!n.skipHeader,i=r||{},s=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Xr(n.origin):n.origin;s=l.r,c=l.c}var u,h={s:{c:0,r:0},e:{c,r:s+t.length-1+a}};if(i["!ref"]){var d=Dt(i["!ref"]);h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),s==-1&&(s=d.e.r+1,h.e.r=s+t.length-1+a)}else s==-1&&(s=0,h.e.r=t.length-1+a);var f=n.header||[],m=0;t.forEach(function(p,g){fn(p).forEach(function(v){(m=f.indexOf(v))==-1&&(f[m=f.length]=v);var k=p[v],x="z",S="",I=Ye({c:c+m,r:s+g+a});u=ep(i,I),k&&typeof k=="object"&&!(k instanceof Date)?i[I]=k:(typeof k=="number"?x="n":typeof k=="boolean"?x="b":typeof k=="string"?x="s":k instanceof Date?(x="d",n.cellDates||(x="n",k=Vr(k)),S=n.dateNF||Xe[14]):k===null&&n.nullError&&(x="e",k=0),u?(u.t=x,u.v=k,delete u.w,delete u.R,S&&(u.z=S)):i[I]=u={t:x,v:k},S&&(u.z=S))})}),h.e.c=Math.max(h.e.c,c+f.length-1);var w=Fr(s);if(a)for(m=0;m<f.length;++m)i[or(m+c)+w]={t:"s",v:f[m]};return i["!ref"]=st(h),i}function sH(r,t){return wF(null,r,t)}function ep(r,t,e){if(typeof t=="string"){if(Array.isArray(r)){var n=Xr(t);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[t]||(r[t]={t:"z"})}return typeof t!="number"?ep(r,Ye(t)):ep(r,Ye({r:t,c:e||0}))}function oH(r,t){if(typeof t=="number"){if(t>=0&&r.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=r.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function n_(){return{SheetNames:[],Sheets:{}}}function a_(r,t,e,n){var a=1;if(!e)for(;a<=65535&&r.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(e)>=0){var i=e.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||e;for(++a;a<=65535&&r.SheetNames.indexOf(e=s+a)!=-1;++a);}if(J3(e),r.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return r.SheetNames.push(e),r.Sheets[e]=t,e}function cH(r,t,e){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=oH(r,t);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}r.Workbook.Sheets[n].Hidden=e}function lH(r,t){return r.z=t,r}function vF(r,t,e){return t?(r.l={Target:t},e&&(r.l.Tooltip=e)):delete r.l,r}function uH(r,t,e){return vF(r,"#"+t,e)}function hH(r,t,e){r.c||(r.c=[]),r.c.push({t,a:e||"SheetJS"})}function dH(r,t,e,n){for(var a=typeof t!="string"?t:Dt(t),i=typeof t=="string"?t:st(t),s=a.s.r;s<=a.e.r;++s)for(var c=a.s.c;c<=a.e.c;++c){var l=ep(r,s,c);l.t="n",l.F=i,delete l.v,s==a.s.r&&c==a.s.c&&(l.f=e,n&&(l.D=!0))}return r}var tp={encode_col:or,encode_row:Fr,encode_cell:Ye,encode_range:st,decode_col:Eb,decode_row:_b,split_cell:VN,decode_cell:Xr,decode_range:Hs,format_cell:Hi,sheet_add_aoa:$A,sheet_add_json:wF,sheet_add_dom:nF,aoa_to_sheet:ch,json_to_sheet:sH,table_to_sheet:aF,table_to_book:Sj,sheet_to_csv:gF,sheet_to_txt:aH,sheet_to_json:r_,sheet_to_html:Ej,sheet_to_formulae:iH,sheet_to_row_object_array:r_,sheet_get_cell:ep,book_new:n_,book_append_sheet:a_,book_set_sheet_visibility:cH,cell_set_number_format:lH,cell_set_hyperlink:vF,cell_set_internal_link:uH,cell_add_comment:hH,sheet_set_array_formula:dH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const fH=(r,t)=>{let e=0,n=new Map;for(let a=0;a<t.length;a++)n.set(t[a],null);if(r.length>0){let a=r[0];for(let i=0;i<a.length;i++){let s=a[i];n.has(s)&&(e++,n.delete(s))}}return{validResult:e==t.length,lackColumn:n.keys().toArray()}},pH=["职位自编号","发布平台","职位访问地址","职位","公司","公司是否为全称","地区","地址","经度","纬度","职位描述","学历","所需经验","最低薪资","最高薪资","首次发布时间","招聘人","招聘公司","招聘者职位","首次扫描日期","记录更新日期"],mH=r=>{let t=[];for(let e=0;e<r.length;e++){let n=r[e];t.push({职位自编号:n.jobId,发布平台:n.jobPlatform,职位访问地址:n.jobUrl,职位:n.jobName,公司:n.jobCompanyName,公司是否为全称:n.isFullCompanyName,地区:n.jobLocationName,地址:n.jobAddress,经度:n.jobLongitude,纬度:n.jobLatitude,职位描述:n.jobDescription,学历:n.jobDegreeName,所需经验:n.jobYear,最低薪资:n.jobSalaryMin,最高薪资:n.jobSalaryMax,几薪:n.jobSalaryTotalMonth,首次发布时间:n.jobFirstPublishDatetime,招聘人:n.bossName,招聘公司:n.bossCompanyName,招聘者职位:n.bossPosition,首次扫描日期:n.createDatetime,记录更新日期:n.updateDatetime})}return t},gH=r=>{let t=[];for(let e=0;e<r.length;e++){let n=r[e],a=new RO;a.jobId=n.职位自编号,a.jobPlatform=n.发布平台,a.jobUrl=n.职位访问地址,a.jobName=n.职位,a.jobCompanyName=n.公司,a.isFullCompanyName=n.公司是否为全称,a.jobLocationName=n.地区,a.jobAddress=n.地址,a.jobLongitude=n.经度,a.jobLatitude=n.纬度,a.jobDescription=n.职位描述,a.jobDegreeName=n.学历,a.jobYear=n.所需经验,a.jobSalaryMin=n.最低薪资,a.jobSalaryMax=n.最高薪资,a.jobSalaryTotalMonth=n.几薪,a.jobFirstPublishDatetime=n.首次发布时间,a.bossName=n.招聘人,a.bossCompanyName=n.招聘公司,a.bossPosition=n.招聘者职位,a.createDatetime=n.首次扫描日期,a.updateDatetime=n.记录更新日期,t.push(a)}return t},wH=["公司","公司描述","成立时间","经营状态","法人","统一社会信用代码","官网","社保人数","自身风险数","关联风险数","地址","经营范围","纳税人识别号","所属行业","工商注册号","经度","纬度","数据来源地址","数据来源平台","数据来源记录编号","数据来源更新时间"],vH=r=>{let t=[];for(let e=0;e<r.length;e++){let n=r[e];t.push({公司:n.companyName,公司描述:n.companyDesc,成立时间:n.companyStartDate,经营状态:n.companyStatus,法人:n.companyLegalPerson,统一社会信用代码:n.companyUnifiedCode,官网:n.companyWebSite,社保人数:n.companyInsuranceNum,自身风险数:n.companySelfRisk,关联风险数:n.companyUnionRisk,地址:n.companyAddress,经营范围:n.companyScope,纳税人识别号:n.companyTaxNo,所属行业:n.companyIndustry,工商注册号:n.companyLicenseNumber,经度:n.companyLongitude,纬度:n.companyLatitude,数据来源地址:n.sourceUrl,数据来源平台:n.sourcePlatform,数据来源记录编号:n.sourceRecordId,数据来源更新时间:n.sourceRefreshDatetime})}return t},yH=r=>{let t=[];for(let e=0;e<r.length;e++){let n=r[e],a=new KO;a.companyId=w2(n.公司),a.companyName=n.公司,a.companyDesc=n.公司描述,a.companyStartDate=m2(n.成立时间),a.companyStatus=n.经营状态,a.companyLegalPerson=n.法人,a.companyUnifiedCode=n.统一社会信用代码,a.companyWebSite=n.官网,a.companyInsuranceNum=n.社保人数,a.companySelfRisk=n.自身风险数,a.companyUnionRisk=n.关联风险数,a.companyAddress=n.地址,a.companyScope=n.经营范围,a.companyTaxNo=n.纳税人识别号,a.companyIndustry=n.所属行业,a.companyLicenseNumber=n.工商注册号,a.companyLongitude=n.经度,a.companyLatitude=n.纬度,a.sourceUrl=n.数据来源地址,a.sourcePlatform=n.数据来源平台,a.sourceRecordId=n.数据来源记录编号,a.sourceRefreshDatetime=m2(n.数据来源更新时间),t.push(a)}return t},xH=["公司","标签"],kH=r=>{let t=[];for(let e=0;e<r.length;e++){let n=r[e];t.push({公司:n.companyName,标签:n.tagNameArray.join(",")})}return t},bH=r=>{let t=[];for(let e=0;e<r.length;e++){let n=r[e],a=new HO;a.companyName=n.公司,a.tags=n.标签.split(","),t.push(a)}return t},aa={NO_LOGIN:"NO_LOGIN",NOT_FOUND:"NOT_FOUND",NO_PERMISSION:"NO_PERMISSION",CREATION_FAILED:"CREATION_FAILED"},Bc={async queryComment({first:r,after:t,last:e,before:n,id:a}={}){var c;let i=_H({first:r,after:t,last:e,before:n,id:a}),s=await ri(`${sM}?t=${new Date().getTime()}`,i);if(((c=s.errors)==null?void 0:c.length)>0)throw s.errors;return s==null?void 0:s.data},async addComment(r,t){await ri(lk,{title:r,body:t})},async getUser(){let r=await ri(_2,null,{method:"GET"});return hw(new hk,r)},async listIssueComment(r,{pageSize:t,pageNum:e}={pageSize:2,pageNum:1}){return await ri(`${lk}/${r}/comments?per_page=${t}&page=${e}&t=${new Date().getTime()}`,null,{method:"GET",responseHeaderCallback:(a,i)=>{var g;let s={};s.items=a;let c=(g=i.get("Link"))==null?void 0:g.split(",");const{url:l,pageNum:u}=Fv(c,"next");s.nextUrl=l,s.nextPageNum=u;const{url:h,pageNum:d}=Fv(c,"prev");s.prevUrl=h,s.prevPageNum=d;const{url:f,pageNum:m}=Fv(c,"last");s.lastUrl=f,s.lastPageNum=m;const{url:w,pageNum:p}=Fv(c,"first");return s.firstUrl=w,s.firstPageNum=p,s}})},async createIssueComment(r,t){await ri(`${lk}/${r}/comments`,{body:t})},async getTrafficClone(){let r=await Av(),t=await Pv(`${cM}?t=${new Date().getTime()}`,null,{method:"GET",token:r});return t.items=t.clones,delete t.clones,t},async getTrafficPopularPaths(){let r=await Av(),t=await Pv(`${lM}?t=${new Date().getTime()}`,null,{method:"GET",token:r});return t.forEach(e=>{e.url=`https://github.com${e.path}`,delete e.path}),t},async getTrafficPopularReferrers(){let r=await Av(),t=await Pv(`${uM}?t=${new Date().getTime()}`,null,{method:"GET",token:r});return t.forEach(e=>{e.url=`http://${e.referrer}`,e.title=`${e.referrer}`,delete e.referrer}),t},async getTrafficViews(){let r=await Av(),t=await Pv(`${hM}?t=${new Date().getTime()}`,null,{method:"GET",token:r});return t.items=t.views,delete t.views,t},async queryVersion(){return await ri(dM,null,{method:"GET",skipLogin:!0})},async getRepo(r,t,{getTokenFunction:e,setTokenFunction:n}){return await ri(`${fw}/repos/${r}/${t}`,null,{method:"GET",getTokenFunction:e,setTokenFunction:n})},async newRepo(r,{getTokenFunction:t,setTokenFunction:e}){return await ri(`${fw}/user/repos`,{name:r},{method:"POST",getTokenFunction:t,setTokenFunction:e})},async createFileContent(r,t,e,n,a,{getTokenFunction:i,setTokenFunction:s}){return await ri(`${fw}/repos/${r}/${t}/contents${e}`,{message:a,content:n},{method:"PUT",getTokenFunction:i,setTokenFunction:s})},async listRepoContents(r,t,e,{getTokenFunction:n,setTokenFunction:a}){return await ri(`${fw}/repos/${r}/${t}/contents${e}`,null,{method:"GET",getTokenFunction:n,setTokenFunction:a})}};async function Av(){return await QO.developerGetToken()}function Fv(r,t){let e=null,n=null;if(r&&r.length>0){let a=r.filter(i=>i.includes(`rel="${t}"`));a&&a.length>0&&(e=a[0].match(/<(?<url>.*)>/).groups.url)}return e&&(n=Number.parseInt(new URL(e).searchParams.get("page"))),{url:e,pageNum:n}}function _H({first:r,after:t,last:e,before:n,id:a}){return{query:`
    {
        search(query:"${a} in:title sort:updated-desc is:issue is:open repo:${oM}", type: ISSUE, first: ${r??null}, after: ${t?'"'+t+'"':null},last:${e??null},before:${n?'"'+n+'"':null}){
          nodes{
            ... on Issue{
              id
              number
              title
              bodyUrl
              author{
                avatarUrl
                login
              }
              createdAt
              lastEditedAt
              bodyText
              bodyHTML
            }
          }
          issueCount
          pageInfo {
            endCursor
            startCursor
            hasNextPage
            hasPreviousPage
          }
          }
        }
    `}}async function ri(r,t,{method:e,responseHeaderCallback:n,skipLogin:a,getTokenFunction:i,setTokenFunction:s}={method:"POST",skipLogin:!1}){try{let c=null;if(i?c=await i():c=await dw.authGetToken(),!c&&!a)throw aa.NO_LOGIN;let l=await i_(r,t,{method:e,skipLogin:a,getTokenFunction:i}),u=l.status;if(s_(l)){const h=await l.json();return n?n(h,l.headers):h}else if(u==401&&(c!=null&&c.refreshToken)){lt("start refresh token");let h=`${b2}?client_id=${ck}&client_secret=${k2}&grant_type=refresh_token&refresh_token=${c.refreshToken}`;try{let d=null;try{let f=await fetch(h,{headers:{Accept:"application/json"}});if(f.status==200)d=await f.json();else throw`unknown status = ${f.status}`}catch(f){throw lt("get refresh token error"),f}if(lt("get refresh token response"),d.error)throw lt("refresh token error"),s?await s(null):await dw.authSetToken(null),`${d.error_description}`;{lt("refresh token success");let f=hw(new ak,d);if(s?await s(f):await dw.authSetToken(f),lt("continue request"),l=await i_(r,t,{method:e,getTokenFunction:i}),s_(l))return await l.json();throw lt("continue error"),`unknown error,status code = ${l.status}`}}catch(d){throw d}}else throw u==403?aa.NO_PERMISSION:u==404?aa.NOT_FOUND:u==422?aa.CREATION_FAILED:`unknown error,status code = ${u}`}catch(c){throw c}}async function Pv(r,t,{method:e,token:n,responseHeaderCallback:a}){let i=await i_(r,t,{method:e,token:n}),s=i.status;if(s_(i)){const c=await i.json();return a?a(c,i.headers):c}else throw`unknown error,status code = ${s}`}async function i_(r,t,{method:e,token:n,skipLogin:a,getTokenFunction:i}={method:"POST",skipLogin:!1}){let s=n;if(!s){let h=null;i?h=await i():h=await dw.authGetToken(),s=h==null?void 0:h.accessToken}if(!s&&!a)throw aa.NO_LOGIN;let c={"Content-Type":"application/json"};s&&(c.Authorization=`Bearer ${s}`);let l={method:e,headers:c};return t&&(l.body=JSON.stringify(t)),await fetch(r,l)}function s_(r){return r.status==200||r.status==201}var yF={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Ke,function(){return function(e,n,a){var i=function(s,c){if(!c||!c.length||c.length===1&&!c[0]||c.length===1&&Array.isArray(c[0])&&!c[0].length)return null;var l;c.length===1&&c[0].length>0&&(c=c[0]),l=(c=c.filter(function(h){return h}))[0];for(var u=1;u<c.length;u+=1)c[u].isValid()&&!c[u][s](l)||(l=c[u]);return l};a.max=function(){var s=[].slice.call(arguments,0);return i("isAfter",s)},a.min=function(){var s=[].slice.call(arguments,0);return i("isBefore",s)}}})})(yF);var EH=yF.exports;const SH=at(EH);class o_{constructor(){H(this,"id");H(this,"type");H(this,"dataId");H(this,"status");H(this,"errorReason");H(this,"costTime");H(this,"retryCount");H(this,"createDatetime");H(this,"updateDatetime")}}async function xF(r,t,e,n){let a=r.flatMap(l=>l[t]),i=await e(a),s=new Map;for(let l=0;l<i.length;l++){let u=i[l];s.set(u[t],u)}let c=[];for(let l=0;l<r.length;l++){let u=r[l],h=s.get(u[t]);if(h)if(n){let d=n(h,u);d&&c.push(d)}else kt(u.createDatetime).isAfter(kt(h.createDatetime))&&c.push(u);else c.push(u)}return c}async function CH(r,t,e){return await xF(r,t,e,(n,a)=>{if(kt(a.sourceRefreshDatetime).isAfter(kt(n.sourceRefreshDatetime)))return a})}async function TH(r,t,e){return await xF(r,t,e,(n,a)=>kt(a.createDatetime).isAfter(kt(n.createDatetime))?(!a.isFullCompanyName&&n.isFullCompanyName&&(a.jobCompanyName=n.jobCompanyName,a.isFullCompanyName=1),a):!n.isFullCompanyName&&a.isFullCompanyName?(n.jobCompanyName=a.jobCompanyName,n.isFullCompanyName=1,n):null)}async function AH(r,t){let e=r.flatMap(s=>w2(s.companyName)),n=[],a=await t(e),i=new Map;for(let s=0;s<a.length;s++){let c=a[s],l=c.companyName;i.has(l)||i.set(l,[]),i.get(l).push(c.tagName)}for(let s=0;s<r.length;s++){let c=r[s],l=c.companyName;if(i.has(l)){let u=c.tags,h=i.get(l),d=new Map;for(let m=0;m<h.length;m++)d.set(h[m],null);let f=[];f.push(...h);for(let m=0;m<u.length;m++){let w=u[m];d.has(w)||f.push(w)}c.tags=f}n.push(c)}return n}var kF={exports:{}};/*!

	JSZip v3.10.1 - A JavaScript class for generating and reading zip files
	<http://stuartk.com/jszip>

	(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
	Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

	JSZip uses the library pako released under the MIT license :
	https://github.com/nodeca/pako/blob/main/LICENSE
	*/(function(r,t){(function(e){r.exports=e()})(function(){return function e(n,a,i){function s(u,h){if(!a[u]){if(!n[u]){var d=typeof d0=="function"&&d0;if(!h&&d)return d(u,!0);if(c)return c(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var m=a[u]={exports:{}};n[u][0].call(m.exports,function(w){var p=n[u][1][w];return s(p||w)},m,m.exports,e,n,a,i)}return a[u].exports}for(var c=typeof d0=="function"&&d0,l=0;l<i.length;l++)s(i[l]);return s}({1:[function(e,n,a){var i=e("./utils"),s=e("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(l){for(var u,h,d,f,m,w,p,g=[],v=0,k=l.length,x=k,S=i.getTypeOf(l)!=="string";v<l.length;)x=k-v,d=S?(u=l[v++],h=v<k?l[v++]:0,v<k?l[v++]:0):(u=l.charCodeAt(v++),h=v<k?l.charCodeAt(v++):0,v<k?l.charCodeAt(v++):0),f=u>>2,m=(3&u)<<4|h>>4,w=1<x?(15&h)<<2|d>>6:64,p=2<x?63&d:64,g.push(c.charAt(f)+c.charAt(m)+c.charAt(w)+c.charAt(p));return g.join("")},a.decode=function(l){var u,h,d,f,m,w,p=0,g=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var k,x=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===c.charAt(64)&&x--,l.charAt(l.length-2)===c.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(k=s.uint8array?new Uint8Array(0|x):new Array(0|x);p<l.length;)u=c.indexOf(l.charAt(p++))<<2|(f=c.indexOf(l.charAt(p++)))>>4,h=(15&f)<<4|(m=c.indexOf(l.charAt(p++)))>>2,d=(3&m)<<6|(w=c.indexOf(l.charAt(p++))),k[g++]=u,m!==64&&(k[g++]=h),w!==64&&(k[g++]=d);return k}},{"./support":30,"./utils":32}],2:[function(e,n,a){var i=e("./external"),s=e("./stream/DataWorker"),c=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function u(h,d,f,m,w){this.compressedSize=h,this.uncompressedSize=d,this.crc32=f,this.compression=m,this.compressedContent=w}u.prototype={getContentWorker:function(){var h=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return h.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(h,d,f){return h.pipe(new c).pipe(new l("uncompressedSize")).pipe(d.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,a){var i=e("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,a){var i=e("./utils"),s=function(){for(var c,l=[],u=0;u<256;u++){c=u;for(var h=0;h<8;h++)c=1&c?3988292384^c>>>1:c>>>1;l[u]=c}return l}();n.exports=function(c,l){return c!==void 0&&c.length?i.getTypeOf(c)!=="string"?function(u,h,d,f){var m=s,w=f+d;u^=-1;for(var p=f;p<w;p++)u=u>>>8^m[255&(u^h[p])];return-1^u}(0|l,c,c.length,0):function(u,h,d,f){var m=s,w=f+d;u^=-1;for(var p=f;p<w;p++)u=u>>>8^m[255&(u^h.charCodeAt(p))];return-1^u}(0|l,c,c.length,0):0}},{"./utils":32}],5:[function(e,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(e,n,a){var i=null;i=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:i}},{lie:37}],7:[function(e,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=e("pako"),c=e("./utils"),l=e("./stream/GenericWorker"),u=i?"uint8array":"array";function h(d,f){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=f,this.meta={}}a.magic="\b\0",c.inherits(h,l),h.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(u,d.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(f){d.push({data:f,meta:d.meta})}},a.compressWorker=function(d){return new h("Deflate",d)},a.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,a){function i(m,w){var p,g="";for(p=0;p<w;p++)g+=String.fromCharCode(255&m),m>>>=8;return g}function s(m,w,p,g,v,k){var x,S,I=m.file,O=m.compression,E=k!==u.utf8encode,T=c.transformTo("string",k(I.name)),P=c.transformTo("string",u.utf8encode(I.name)),W=I.comment,U=c.transformTo("string",k(W)),A=c.transformTo("string",u.utf8encode(W)),N=P.length!==I.name.length,C=A.length!==W.length,K="",ne="",X="",oe=I.dir,q=I.date,se={crc32:0,compressedSize:0,uncompressedSize:0};w&&!p||(se.crc32=m.crc32,se.compressedSize=m.compressedSize,se.uncompressedSize=m.uncompressedSize);var Q=0;w&&(Q|=8),E||!N&&!C||(Q|=2048);var R=0,ae=0;oe&&(R|=16),v==="UNIX"?(ae=798,R|=function(M,ce){var ke=M;return M||(ke=ce?16893:33204),(65535&ke)<<16}(I.unixPermissions,oe)):(ae=20,R|=function(M){return 63&(M||0)}(I.dosPermissions)),x=q.getUTCHours(),x<<=6,x|=q.getUTCMinutes(),x<<=5,x|=q.getUTCSeconds()/2,S=q.getUTCFullYear()-1980,S<<=4,S|=q.getUTCMonth()+1,S<<=5,S|=q.getUTCDate(),N&&(ne=i(1,1)+i(h(T),4)+P,K+="up"+i(ne.length,2)+ne),C&&(X=i(1,1)+i(h(U),4)+A,K+="uc"+i(X.length,2)+X);var L="";return L+=`
\0`,L+=i(Q,2),L+=O.magic,L+=i(x,2),L+=i(S,2),L+=i(se.crc32,4),L+=i(se.compressedSize,4),L+=i(se.uncompressedSize,4),L+=i(T.length,2),L+=i(K.length,2),{fileRecord:d.LOCAL_FILE_HEADER+L+T+K,dirRecord:d.CENTRAL_FILE_HEADER+i(ae,2)+L+i(U.length,2)+"\0\0\0\0"+i(R,4)+i(g,4)+T+K+U}}var c=e("../utils"),l=e("../stream/GenericWorker"),u=e("../utf8"),h=e("../crc32"),d=e("../signature");function f(m,w,p,g){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=p,this.encodeFileName=g,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(f,l),f.prototype.push=function(m){var w=m.meta.percent||0,p=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:p?(w+100*(p-g-1))/p:100}}))},f.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var w=this.streamFiles&&!m.file.dir;if(w){var p=s(m,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(m){this.accumulate=!1;var w=this.streamFiles&&!m.file.dir,p=s(m,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),w)this.push({data:function(g){return d.DATA_DESCRIPTOR+i(g.crc32,4)+i(g.compressedSize,4)+i(g.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var m=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var p=this.bytesWritten-m,g=function(v,k,x,S,I){var O=c.transformTo("string",I(S));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(v,2)+i(v,2)+i(k,4)+i(x,4)+i(O.length,2)+O}(this.dirRecords.length,p,m,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(m){this._sources.push(m);var w=this;return m.on("data",function(p){w.processChunk(p)}),m.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),m.on("error",function(p){w.error(p)}),this},f.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(m){var w=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var p=0;p<w.length;p++)try{w[p].error(m)}catch{}return!0},f.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,w=0;w<m.length;w++)m[w].lock()},n.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,a){var i=e("../compressions"),s=e("./ZipFileWorker");a.generateWorker=function(c,l,u){var h=new s(l.streamFiles,u,l.platform,l.encodeFileName),d=0;try{c.forEach(function(f,m){d++;var w=function(k,x){var S=k||x,I=i[S];if(!I)throw new Error(S+" is not a valid compression method !");return I}(m.options.compression,l.compression),p=m.options.compressionOptions||l.compressionOptions||{},g=m.dir,v=m.date;m._compressWorker(w,p).withStreamInfo("file",{name:f,dir:g,date:v,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(h)}),h.entriesCount=d}catch(f){h.error(f)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var c in this)typeof this[c]!="function"&&(s[c]=this[c]);return s}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(s,c){return new i().loadAsync(s,c)},i.external=e("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,a){var i=e("./utils"),s=e("./external"),c=e("./utf8"),l=e("./zipEntries"),u=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function d(f){return new s.Promise(function(m,w){var p=f.decompressed.getContentWorker().pipe(new u);p.on("error",function(g){w(g)}).on("end",function(){p.streamInfo.crc32!==f.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}n.exports=function(f,m){var w=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),h.isNode&&h.isStream(f)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",f,!0,m.optimizedBinaryString,m.base64).then(function(p){var g=new l(m);return g.load(p),g}).then(function(p){var g=[s.Promise.resolve(p)],v=p.files;if(m.checkCRC32)for(var k=0;k<v.length;k++)g.push(d(v[k]));return s.Promise.all(g)}).then(function(p){for(var g=p.shift(),v=g.files,k=0;k<v.length;k++){var x=v[k],S=x.fileNameStr,I=i.resolve(x.fileNameStr);w.file(I,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:m.createFolders}),x.dir||(w.file(I).unsafeOriginalName=S)}return g.zipComment.length&&(w.comment=g.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,a){var i=e("../utils"),s=e("../stream/GenericWorker");function c(l,u){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(c,s),c.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(h){u.push({data:h,meta:{percent:0}})}).on("error",function(h){u.isPaused?this.generatedError=h:u.error(h)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},c.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,a){var i=e("readable-stream").Readable;function s(c,l,u){i.call(this,l),this._helper=c;var h=this;c.on("data",function(d,f){h.push(d)||h._helper.pause(),u&&u(f)}).on("error",function(d){h.emit("error",d)}).on("end",function(){h.push(null)})}e("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,n,a){function i(I,O,E){var T,P=c.getTypeOf(O),W=c.extend(E||{},h);W.date=W.date||new Date,W.compression!==null&&(W.compression=W.compression.toUpperCase()),typeof W.unixPermissions=="string"&&(W.unixPermissions=parseInt(W.unixPermissions,8)),W.unixPermissions&&16384&W.unixPermissions&&(W.dir=!0),W.dosPermissions&&16&W.dosPermissions&&(W.dir=!0),W.dir&&(I=v(I)),W.createFolders&&(T=g(I))&&k.call(this,T,!0);var U=P==="string"&&W.binary===!1&&W.base64===!1;E&&E.binary!==void 0||(W.binary=!U),(O instanceof d&&O.uncompressedSize===0||W.dir||!O||O.length===0)&&(W.base64=!1,W.binary=!0,O="",W.compression="STORE",P="string");var A=null;A=O instanceof d||O instanceof l?O:w.isNode&&w.isStream(O)?new p(I,O):c.prepareContent(I,O,W.binary,W.optimizedBinaryString,W.base64);var N=new f(I,A,W);this.files[I]=N}var s=e("./utf8"),c=e("./utils"),l=e("./stream/GenericWorker"),u=e("./stream/StreamHelper"),h=e("./defaults"),d=e("./compressedObject"),f=e("./zipObject"),m=e("./generate"),w=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),g=function(I){I.slice(-1)==="/"&&(I=I.substring(0,I.length-1));var O=I.lastIndexOf("/");return 0<O?I.substring(0,O):""},v=function(I){return I.slice(-1)!=="/"&&(I+="/"),I},k=function(I,O){return O=O!==void 0?O:h.createFolders,I=v(I),this.files[I]||i.call(this,I,null,{dir:!0,createFolders:O}),this.files[I]};function x(I){return Object.prototype.toString.call(I)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(I){var O,E,T;for(O in this.files)T=this.files[O],(E=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&I(E,T)},filter:function(I){var O=[];return this.forEach(function(E,T){I(E,T)&&O.push(T)}),O},file:function(I,O,E){if(arguments.length!==1)return I=this.root+I,i.call(this,I,O,E),this;if(x(I)){var T=I;return this.filter(function(W,U){return!U.dir&&T.test(W)})}var P=this.files[this.root+I];return P&&!P.dir?P:null},folder:function(I){if(!I)return this;if(x(I))return this.filter(function(P,W){return W.dir&&I.test(P)});var O=this.root+I,E=k.call(this,O),T=this.clone();return T.root=E.name,T},remove:function(I){I=this.root+I;var O=this.files[I];if(O||(I.slice(-1)!=="/"&&(I+="/"),O=this.files[I]),O&&!O.dir)delete this.files[I];else for(var E=this.filter(function(P,W){return W.name.slice(0,I.length)===I}),T=0;T<E.length;T++)delete this.files[E[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(I){var O,E={};try{if((E=c.extend(I||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");c.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var T=E.comment||this.comment||"";O=m.generateWorker(this,E,T)}catch(P){(O=new l("error")).error(P)}return new u(O,E.type||"string",E.mimeType)},generateAsync:function(I,O){return this.generateInternalStream(I).accumulate(O)},generateNodeStream:function(I,O){return(I=I||{}).type||(I.type="nodebuffer"),this.generateInternalStream(I).toNodejsStream(O)}};n.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,a){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,a){var i=e("./DataReader");function s(c){i.call(this,c);for(var l=0;l<this.data.length;l++)c[l]=255&c[l]}e("../utils").inherits(s,i),s.prototype.byteAt=function(c){return this.data[this.zero+c]},s.prototype.lastIndexOfSignature=function(c){for(var l=c.charCodeAt(0),u=c.charCodeAt(1),h=c.charCodeAt(2),d=c.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===l&&this.data[f+1]===u&&this.data[f+2]===h&&this.data[f+3]===d)return f-this.zero;return-1},s.prototype.readAndCheckSignature=function(c){var l=c.charCodeAt(0),u=c.charCodeAt(1),h=c.charCodeAt(2),d=c.charCodeAt(3),f=this.readData(4);return l===f[0]&&u===f[1]&&h===f[2]&&d===f[3]},s.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(e,n,a){var i=e("../utils");function s(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var l,u=0;for(this.checkOffset(c),l=this.index+c-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=c,u},readString:function(c){return i.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},n.exports=s},{"../utils":32}],19:[function(e,n,a){var i=e("./Uint8ArrayReader");function s(c){i.call(this,c)}e("../utils").inherits(s,i),s.prototype.readData=function(c){this.checkOffset(c);var l=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,a){var i=e("./DataReader");function s(c){i.call(this,c)}e("../utils").inherits(s,i),s.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},s.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},s.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},s.prototype.readData=function(c){this.checkOffset(c);var l=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(e,n,a){var i=e("./ArrayReader");function s(c){i.call(this,c)}e("../utils").inherits(s,i),s.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,a){var i=e("../utils"),s=e("../support"),c=e("./ArrayReader"),l=e("./StringReader"),u=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");n.exports=function(d){var f=i.getTypeOf(d);return i.checkSupport(f),f!=="string"||s.uint8array?f==="nodebuffer"?new u(d):s.uint8array?new h(i.transformTo("uint8array",d)):new c(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,a){var i=e("./GenericWorker"),s=e("../utils");function c(l){i.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(c,i),c.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},n.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,a){var i=e("./GenericWorker"),s=e("../crc32");function c(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(c,i),c.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,a){var i=e("../utils"),s=e("./GenericWorker");function c(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(c,s),c.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}s.prototype.processChunk.call(this,l)},n.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,a){var i=e("../utils"),s=e("./GenericWorker");function c(l){s.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(h){u.dataIsReady=!0,u.data=h,u.max=h&&h.length||0,u.type=i.getTypeOf(h),u.isPaused||u._tickAndRepeat()},function(h){u.error(h)})}i.inherits(c,s),c.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,c){return this._listeners[s].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,c){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,c)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var c=this;return s.on("data",function(l){c.processChunk(l)}),s.on("end",function(){c.end()}),s.on("error",function(l){c.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,c){return this.extraStreamInfo[s]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(e,n,a){var i=e("../utils"),s=e("./ConvertWorker"),c=e("./GenericWorker"),l=e("../base64"),u=e("../support"),h=e("../external"),d=null;if(u.nodestream)try{d=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(w,p){return new h.Promise(function(g,v){var k=[],x=w._internalType,S=w._outputType,I=w._mimeType;w.on("data",function(O,E){k.push(O),p&&p(E)}).on("error",function(O){k=[],v(O)}).on("end",function(){try{var O=function(E,T,P){switch(E){case"blob":return i.newBlob(i.transformTo("arraybuffer",T),P);case"base64":return l.encode(T);default:return i.transformTo(E,T)}}(S,function(E,T){var P,W=0,U=null,A=0;for(P=0;P<T.length;P++)A+=T[P].length;switch(E){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(U=new Uint8Array(A),P=0;P<T.length;P++)U.set(T[P],W),W+=T[P].length;return U;case"nodebuffer":return Buffer.concat(T);default:throw new Error("concat : unsupported type '"+E+"'")}}(x,k),I);g(O)}catch(E){v(E)}k=[]}).resume()})}function m(w,p,g){var v=p;switch(p){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=p,this._mimeType=g,i.checkSupport(v),this._worker=w.pipe(new s(v)),w.lock()}catch(k){this._worker=new c("error"),this._worker.error(k)}}m.prototype={accumulate:function(w){return f(this,w)},on:function(w,p){var g=this;return w==="data"?this._worker.on(w,function(v){p.call(g,v.data,v.meta)}):this._worker.on(w,function(){i.delay(p,arguments,g)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},w)}},n.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!e("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,a){for(var i=e("./utils"),s=e("./support"),c=e("./nodejsUtils"),l=e("./stream/GenericWorker"),u=new Array(256),h=0;h<256;h++)u[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;u[254]=u[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function f(){l.call(this,"utf-8 encode")}a.utf8encode=function(m){return s.nodebuffer?c.newBufferFrom(m,"utf-8"):function(w){var p,g,v,k,x,S=w.length,I=0;for(k=0;k<S;k++)(64512&(g=w.charCodeAt(k)))==55296&&k+1<S&&(64512&(v=w.charCodeAt(k+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),k++),I+=g<128?1:g<2048?2:g<65536?3:4;for(p=s.uint8array?new Uint8Array(I):new Array(I),k=x=0;x<I;k++)(64512&(g=w.charCodeAt(k)))==55296&&k+1<S&&(64512&(v=w.charCodeAt(k+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),k++),g<128?p[x++]=g:(g<2048?p[x++]=192|g>>>6:(g<65536?p[x++]=224|g>>>12:(p[x++]=240|g>>>18,p[x++]=128|g>>>12&63),p[x++]=128|g>>>6&63),p[x++]=128|63&g);return p}(m)},a.utf8decode=function(m){return s.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(w){var p,g,v,k,x=w.length,S=new Array(2*x);for(p=g=0;p<x;)if((v=w[p++])<128)S[g++]=v;else if(4<(k=u[v]))S[g++]=65533,p+=k-1;else{for(v&=k===2?31:k===3?15:7;1<k&&p<x;)v=v<<6|63&w[p++],k--;1<k?S[g++]=65533:v<65536?S[g++]=v:(v-=65536,S[g++]=55296|v>>10&1023,S[g++]=56320|1023&v)}return S.length!==g&&(S.subarray?S=S.subarray(0,g):S.length=g),i.applyFromCharCode(S)}(m=i.transformTo(s.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var w=i.transformTo(s.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var p=w;(w=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),w.set(p,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var g=function(k,x){var S;for((x=x||k.length)>k.length&&(x=k.length),S=x-1;0<=S&&(192&k[S])==128;)S--;return S<0||S===0?x:S+u[k[S]]>x?S:x}(w),v=w;g!==w.length&&(s.uint8array?(v=w.subarray(0,g),this.leftOver=w.subarray(g,w.length)):(v=w.slice(0,g),this.leftOver=w.slice(g,w.length))),this.push({data:a.utf8decode(v),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=d,i.inherits(f,l),f.prototype.processChunk=function(m){this.push({data:a.utf8encode(m.data),meta:m.meta})},a.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,a){var i=e("./support"),s=e("./base64"),c=e("./nodejsUtils"),l=e("./external");function u(p){return p}function h(p,g){for(var v=0;v<p.length;++v)g[v]=255&p.charCodeAt(v);return g}e("setimmediate"),a.newBlob=function(p,g){a.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(p),v.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(p,g,v){var k=[],x=0,S=p.length;if(S<=v)return String.fromCharCode.apply(null,p);for(;x<S;)g==="array"||g==="nodebuffer"?k.push(String.fromCharCode.apply(null,p.slice(x,Math.min(x+v,S)))):k.push(String.fromCharCode.apply(null,p.subarray(x,Math.min(x+v,S)))),x+=v;return k.join("")},stringifyByChar:function(p){for(var g="",v=0;v<p.length;v++)g+=String.fromCharCode(p[v]);return g},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}}()}};function f(p){var g=65536,v=a.getTypeOf(p),k=!0;if(v==="uint8array"?k=d.applyCanBeUsed.uint8array:v==="nodebuffer"&&(k=d.applyCanBeUsed.nodebuffer),k)for(;1<g;)try{return d.stringifyByChunk(p,v,g)}catch{g=Math.floor(g/2)}return d.stringifyByChar(p)}function m(p,g){for(var v=0;v<p.length;v++)g[v]=p[v];return g}a.applyFromCharCode=f;var w={};w.string={string:u,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return w.string.uint8array(p).buffer},uint8array:function(p){return h(p,new Uint8Array(p.length))},nodebuffer:function(p){return h(p,c.allocBuffer(p.length))}},w.array={string:f,array:u,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return c.newBufferFrom(p)}},w.arraybuffer={string:function(p){return f(new Uint8Array(p))},array:function(p){return m(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:u,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return c.newBufferFrom(new Uint8Array(p))}},w.uint8array={string:f,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:u,nodebuffer:function(p){return c.newBufferFrom(p)}},w.nodebuffer={string:f,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return w.nodebuffer.uint8array(p).buffer},uint8array:function(p){return m(p,new Uint8Array(p.length))},nodebuffer:u},a.transformTo=function(p,g){if(g=g||"",!p)return g;a.checkSupport(p);var v=a.getTypeOf(g);return w[v][p](g)},a.resolve=function(p){for(var g=p.split("/"),v=[],k=0;k<g.length;k++){var x=g[k];x==="."||x===""&&k!==0&&k!==g.length-1||(x===".."?v.pop():v.push(x))}return v.join("/")},a.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":i.nodebuffer&&c.isBuffer(p)?"nodebuffer":i.uint8array&&p instanceof Uint8Array?"uint8array":i.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(p){if(!i[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(p){var g,v,k="";for(v=0;v<(p||"").length;v++)k+="\\x"+((g=p.charCodeAt(v))<16?"0":"")+g.toString(16).toUpperCase();return k},a.delay=function(p,g,v){setImmediate(function(){p.apply(v||null,g||[])})},a.inherits=function(p,g){function v(){}v.prototype=g.prototype,p.prototype=new v},a.extend=function(){var p,g,v={};for(p=0;p<arguments.length;p++)for(g in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],g)&&v[g]===void 0&&(v[g]=arguments[p][g]);return v},a.prepareContent=function(p,g,v,k,x){return l.Promise.resolve(g).then(function(S){return i.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new l.Promise(function(I,O){var E=new FileReader;E.onload=function(T){I(T.target.result)},E.onerror=function(T){O(T.target.error)},E.readAsArrayBuffer(S)}):S}).then(function(S){var I=a.getTypeOf(S);return I?(I==="arraybuffer"?S=a.transformTo("uint8array",S):I==="string"&&(x?S=s.decode(S):v&&k!==!0&&(S=function(O){return h(O,i.uint8array?new Uint8Array(O.length):new Array(O.length))}(S))),S):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,a){var i=e("./reader/readerFor"),s=e("./utils"),c=e("./signature"),l=e("./zipEntry"),u=e("./support");function h(d){this.files=[],this.loadOptions=d}h.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(f)+", expected "+s.pretty(d)+")")}},isSignature:function(d,f){var m=this.reader.index;this.reader.setIndex(d);var w=this.reader.readString(4)===f;return this.reader.setIndex(m),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),f=u.uint8array?"uint8array":"array",m=s.transformTo(f,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,f,m,w=this.zip64EndOfCentralSize-44;0<w;)d=this.reader.readInt(2),f=this.reader.readInt(4),m=this.reader.readData(f),this.zip64ExtensibleData[d]={id:d,length:f,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,f;for(d=0;d<this.files.length;d++)f=this.files[d],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var f=d;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var w=f-m;if(0<w)this.isSignature(f,c.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,a){var i=e("./reader/readerFor"),s=e("./utils"),c=e("./compressedObject"),l=e("./crc32"),u=e("./utf8"),h=e("./compressions"),d=e("./support");function f(m,w){this.options=m,this.loadOptions=w}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var w,p;if(m.skip(22),this.fileNameLength=m.readInt(2),p=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(g){for(var v in h)if(Object.prototype.hasOwnProperty.call(h,v)&&h[v].magic===g)return h[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,w,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var w=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(w),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var w,p,g,v=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<v;)w=m.readInt(2),p=m.readInt(2),g=m.readData(p),this.extraFields[w]={id:w,length:p,value:g};m.setIndex(v)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var p=s.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var v=s.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var w=i(m.value);return w.readInt(1)!==1||l(this.fileName)!==w.readInt(4)?null:u.utf8decode(w.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var w=i(m.value);return w.readInt(1)!==1||l(this.fileComment)!==w.readInt(4)?null:u.utf8decode(w.readData(m.length-5))}return null}},n.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,a){function i(w,p,g){this.name=w,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=p,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var s=e("./stream/StreamHelper"),c=e("./stream/DataWorker"),l=e("./utf8"),u=e("./compressedObject"),h=e("./stream/GenericWorker");i.prototype={internalStream:function(w){var p=null,g="string";try{if(!w)throw new Error("No output type specified.");var v=(g=w.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),p=this._decompressWorker();var k=!this._dataBinary;k&&!v&&(p=p.pipe(new l.Utf8EncodeWorker)),!k&&v&&(p=p.pipe(new l.Utf8DecodeWorker))}catch(x){(p=new h("error")).error(x)}return new s(p,g,"")},async:function(w,p){return this.internalStream(w).accumulate(p)},nodeStream:function(w,p){return this.internalStream(w||"nodebuffer").toNodejsStream(p)},_compressWorker:function(w,p){if(this._data instanceof u&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(g,w,p)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof h?this._data:new c(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=f;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,a){(function(i){var s,c,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var u=0,h=new l(w),d=i.document.createTextNode("");h.observe(d,{characterData:!0}),s=function(){d.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var p=i.document.createElement("script");p.onreadystatechange=function(){w(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:function(){setTimeout(w,0)};else{var f=new i.MessageChannel;f.port1.onmessage=w,s=function(){f.port2.postMessage(0)}}var m=[];function w(){var p,g;c=!0;for(var v=m.length;v;){for(g=m,m=[],p=-1;++p<v;)g[p]();v=m.length}c=!1}n.exports=function(p){m.push(p)!==1||c||s()}}).call(this,typeof Ke<"u"?Ke:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,a){var i=e("immediate");function s(){}var c={},l=["REJECTED"],u=["FULFILLED"],h=["PENDING"];function d(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,v!==s&&p(this,v)}function f(v,k,x){this.promise=v,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function m(v,k,x){i(function(){var S;try{S=k(x)}catch(I){return c.reject(v,I)}S===v?c.reject(v,new TypeError("Cannot resolve promise with itself")):c.resolve(v,S)})}function w(v){var k=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof k=="function")return function(){k.apply(v,arguments)}}function p(v,k){var x=!1;function S(E){x||(x=!0,c.reject(v,E))}function I(E){x||(x=!0,c.resolve(v,E))}var O=g(function(){k(I,S)});O.status==="error"&&S(O.value)}function g(v,k){var x={};try{x.value=v(k),x.status="success"}catch(S){x.status="error",x.value=S}return x}(n.exports=d).prototype.finally=function(v){if(typeof v!="function")return this;var k=this.constructor;return this.then(function(x){return k.resolve(v()).then(function(){return x})},function(x){return k.resolve(v()).then(function(){throw x})})},d.prototype.catch=function(v){return this.then(null,v)},d.prototype.then=function(v,k){if(typeof v!="function"&&this.state===u||typeof k!="function"&&this.state===l)return this;var x=new this.constructor(s);return this.state!==h?m(x,this.state===u?v:k,this.outcome):this.queue.push(new f(x,v,k)),x},f.prototype.callFulfilled=function(v){c.resolve(this.promise,v)},f.prototype.otherCallFulfilled=function(v){m(this.promise,this.onFulfilled,v)},f.prototype.callRejected=function(v){c.reject(this.promise,v)},f.prototype.otherCallRejected=function(v){m(this.promise,this.onRejected,v)},c.resolve=function(v,k){var x=g(w,k);if(x.status==="error")return c.reject(v,x.value);var S=x.value;if(S)p(v,S);else{v.state=u,v.outcome=k;for(var I=-1,O=v.queue.length;++I<O;)v.queue[I].callFulfilled(k)}return v},c.reject=function(v,k){v.state=l,v.outcome=k;for(var x=-1,S=v.queue.length;++x<S;)v.queue[x].callRejected(k);return v},d.resolve=function(v){return v instanceof this?v:c.resolve(new this(s),v)},d.reject=function(v){var k=new this(s);return c.reject(k,v)},d.all=function(v){var k=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=v.length,S=!1;if(!x)return this.resolve([]);for(var I=new Array(x),O=0,E=-1,T=new this(s);++E<x;)P(v[E],E);return T;function P(W,U){k.resolve(W).then(function(A){I[U]=A,++O!==x||S||(S=!0,c.resolve(T,I))},function(A){S||(S=!0,c.reject(T,A))})}},d.race=function(v){var k=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=v.length,S=!1;if(!x)return this.resolve([]);for(var I=-1,O=new this(s);++I<x;)E=v[I],k.resolve(E).then(function(T){S||(S=!0,c.resolve(O,T))},function(T){S||(S=!0,c.reject(O,T))});var E;return O}},{immediate:36}],38:[function(e,n,a){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,a){var i=e("./zlib/deflate"),s=e("./utils/common"),c=e("./utils/strings"),l=e("./zlib/messages"),u=e("./zlib/zstream"),h=Object.prototype.toString,d=0,f=-1,m=0,w=8;function p(v){if(!(this instanceof p))return new p(v);this.options=s.assign({level:f,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},v||{});var k=this.options;k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(x!==d)throw new Error(l[x]);if(k.header&&i.deflateSetHeader(this.strm,k.header),k.dictionary){var S;if(S=typeof k.dictionary=="string"?c.string2buf(k.dictionary):h.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(x=i.deflateSetDictionary(this.strm,S))!==d)throw new Error(l[x]);this._dict_set=!0}}function g(v,k){var x=new p(k);if(x.push(v,!0),x.err)throw x.msg||l[x.err];return x.result}p.prototype.push=function(v,k){var x,S,I=this.strm,O=this.options.chunkSize;if(this.ended)return!1;S=k===~~k?k:k===!0?4:0,typeof v=="string"?I.input=c.string2buf(v):h.call(v)==="[object ArrayBuffer]"?I.input=new Uint8Array(v):I.input=v,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new s.Buf8(O),I.next_out=0,I.avail_out=O),(x=i.deflate(I,S))!==1&&x!==d)return this.onEnd(x),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(s.shrinkBuf(I.output,I.next_out))):this.onData(s.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&x!==1);return S===4?(x=i.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===d):S!==2||(this.onEnd(d),!(I.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},a.Deflate=p,a.deflate=g,a.deflateRaw=function(v,k){return(k=k||{}).raw=!0,g(v,k)},a.gzip=function(v,k){return(k=k||{}).gzip=!0,g(v,k)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,a){var i=e("./zlib/inflate"),s=e("./utils/common"),c=e("./utils/strings"),l=e("./zlib/constants"),u=e("./zlib/messages"),h=e("./zlib/zstream"),d=e("./zlib/gzheader"),f=Object.prototype.toString;function m(p){if(!(this instanceof m))return new m(p);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||p&&p.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var v=i.inflateInit2(this.strm,g.windowBits);if(v!==l.Z_OK)throw new Error(u[v]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function w(p,g){var v=new m(g);if(v.push(p,!0),v.err)throw v.msg||u[v.err];return v.result}m.prototype.push=function(p,g){var v,k,x,S,I,O,E=this.strm,T=this.options.chunkSize,P=this.options.dictionary,W=!1;if(this.ended)return!1;k=g===~~g?g:g===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?E.input=c.binstring2buf(p):f.call(p)==="[object ArrayBuffer]"?E.input=new Uint8Array(p):E.input=p,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new s.Buf8(T),E.next_out=0,E.avail_out=T),(v=i.inflate(E,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&P&&(O=typeof P=="string"?c.string2buf(P):f.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,v=i.inflateSetDictionary(this.strm,O)),v===l.Z_BUF_ERROR&&W===!0&&(v=l.Z_OK,W=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&v!==l.Z_STREAM_END&&(E.avail_in!==0||k!==l.Z_FINISH&&k!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=c.utf8border(E.output,E.next_out),S=E.next_out-x,I=c.buf2string(E.output,x),E.next_out=S,E.avail_out=T-S,S&&s.arraySet(E.output,E.output,x,S,0),this.onData(I)):this.onData(s.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(W=!0)}while((0<E.avail_in||E.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(k=l.Z_FINISH),k===l.Z_FINISH?(v=i.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):k!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(E.avail_out=0))},m.prototype.onData=function(p){this.chunks.push(p)},m.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},a.Inflate=m,a.inflate=w,a.inflateRaw=function(p,g){return(g=g||{}).raw=!0,w(p,g)},a.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var h=u.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var d in h)h.hasOwnProperty(d)&&(l[d]=h[d])}}return l},a.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var s={arraySet:function(l,u,h,d,f){if(u.subarray&&l.subarray)l.set(u.subarray(h,h+d),f);else for(var m=0;m<d;m++)l[f+m]=u[h+m]},flattenChunks:function(l){var u,h,d,f,m,w;for(u=d=0,h=l.length;u<h;u++)d+=l[u].length;for(w=new Uint8Array(d),u=f=0,h=l.length;u<h;u++)m=l[u],w.set(m,f),f+=m.length;return w}},c={arraySet:function(l,u,h,d,f){for(var m=0;m<d;m++)l[f+m]=u[h+m]},flattenChunks:function(l){return[].concat.apply([],l)}};a.setTyped=function(l){l?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,c))},a.setTyped(i)},{}],42:[function(e,n,a){var i=e("./common"),s=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function h(d,f){if(f<65537&&(d.subarray&&c||!d.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(d,f));for(var m="",w=0;w<f;w++)m+=String.fromCharCode(d[w]);return m}l[254]=l[254]=1,a.string2buf=function(d){var f,m,w,p,g,v=d.length,k=0;for(p=0;p<v;p++)(64512&(m=d.charCodeAt(p)))==55296&&p+1<v&&(64512&(w=d.charCodeAt(p+1)))==56320&&(m=65536+(m-55296<<10)+(w-56320),p++),k+=m<128?1:m<2048?2:m<65536?3:4;for(f=new i.Buf8(k),p=g=0;g<k;p++)(64512&(m=d.charCodeAt(p)))==55296&&p+1<v&&(64512&(w=d.charCodeAt(p+1)))==56320&&(m=65536+(m-55296<<10)+(w-56320),p++),m<128?f[g++]=m:(m<2048?f[g++]=192|m>>>6:(m<65536?f[g++]=224|m>>>12:(f[g++]=240|m>>>18,f[g++]=128|m>>>12&63),f[g++]=128|m>>>6&63),f[g++]=128|63&m);return f},a.buf2binstring=function(d){return h(d,d.length)},a.binstring2buf=function(d){for(var f=new i.Buf8(d.length),m=0,w=f.length;m<w;m++)f[m]=d.charCodeAt(m);return f},a.buf2string=function(d,f){var m,w,p,g,v=f||d.length,k=new Array(2*v);for(m=w=0;m<v;)if((p=d[m++])<128)k[w++]=p;else if(4<(g=l[p]))k[w++]=65533,m+=g-1;else{for(p&=g===2?31:g===3?15:7;1<g&&m<v;)p=p<<6|63&d[m++],g--;1<g?k[w++]=65533:p<65536?k[w++]=p:(p-=65536,k[w++]=55296|p>>10&1023,k[w++]=56320|1023&p)}return h(k,w)},a.utf8border=function(d,f){var m;for((f=f||d.length)>d.length&&(f=d.length),m=f-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?f:m+l[d[m]]>f?m:f}},{"./common":41}],43:[function(e,n,a){n.exports=function(i,s,c,l){for(var u=65535&i|0,h=i>>>16&65535|0,d=0;c!==0;){for(c-=d=2e3<c?2e3:c;h=h+(u=u+s[l++]|0)|0,--d;);u%=65521,h%=65521}return u|h<<16|0}},{}],44:[function(e,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,a){var i=function(){for(var s,c=[],l=0;l<256;l++){s=l;for(var u=0;u<8;u++)s=1&s?3988292384^s>>>1:s>>>1;c[l]=s}return c}();n.exports=function(s,c,l,u){var h=i,d=u+l;s^=-1;for(var f=u;f<d;f++)s=s>>>8^h[255&(s^c[f])];return-1^s}},{}],46:[function(e,n,a){var i,s=e("../utils/common"),c=e("./trees"),l=e("./adler32"),u=e("./crc32"),h=e("./messages"),d=0,f=4,m=0,w=-2,p=-1,g=4,v=2,k=8,x=9,S=286,I=30,O=19,E=2*S+1,T=15,P=3,W=258,U=W+P+1,A=42,N=113,C=1,K=2,ne=3,X=4;function oe(b,ee){return b.msg=h[ee],ee}function q(b){return(b<<1)-(4<b?9:0)}function se(b){for(var ee=b.length;0<=--ee;)b[ee]=0}function Q(b){var ee=b.state,re=ee.pending;re>b.avail_out&&(re=b.avail_out),re!==0&&(s.arraySet(b.output,ee.pending_buf,ee.pending_out,re,b.next_out),b.next_out+=re,ee.pending_out+=re,b.total_out+=re,b.avail_out-=re,ee.pending-=re,ee.pending===0&&(ee.pending_out=0))}function R(b,ee){c._tr_flush_block(b,0<=b.block_start?b.block_start:-1,b.strstart-b.block_start,ee),b.block_start=b.strstart,Q(b.strm)}function ae(b,ee){b.pending_buf[b.pending++]=ee}function L(b,ee){b.pending_buf[b.pending++]=ee>>>8&255,b.pending_buf[b.pending++]=255&ee}function M(b,ee){var re,j,z=b.max_chain_length,ie=b.strstart,we=b.prev_length,ye=b.nice_match,le=b.strstart>b.w_size-U?b.strstart-(b.w_size-U):0,be=b.window,Pe=b.w_mask,Ce=b.prev,$e=b.strstart+W,vt=be[ie+we-1],Ve=be[ie+we];b.prev_length>=b.good_match&&(z>>=2),ye>b.lookahead&&(ye=b.lookahead);do if(be[(re=ee)+we]===Ve&&be[re+we-1]===vt&&be[re]===be[ie]&&be[++re]===be[ie+1]){ie+=2,re++;do;while(be[++ie]===be[++re]&&be[++ie]===be[++re]&&be[++ie]===be[++re]&&be[++ie]===be[++re]&&be[++ie]===be[++re]&&be[++ie]===be[++re]&&be[++ie]===be[++re]&&be[++ie]===be[++re]&&ie<$e);if(j=W-($e-ie),ie=$e-W,we<j){if(b.match_start=ee,ye<=(we=j))break;vt=be[ie+we-1],Ve=be[ie+we]}}while((ee=Ce[ee&Pe])>le&&--z!=0);return we<=b.lookahead?we:b.lookahead}function ce(b){var ee,re,j,z,ie,we,ye,le,be,Pe,Ce=b.w_size;do{if(z=b.window_size-b.lookahead-b.strstart,b.strstart>=Ce+(Ce-U)){for(s.arraySet(b.window,b.window,Ce,Ce,0),b.match_start-=Ce,b.strstart-=Ce,b.block_start-=Ce,ee=re=b.hash_size;j=b.head[--ee],b.head[ee]=Ce<=j?j-Ce:0,--re;);for(ee=re=Ce;j=b.prev[--ee],b.prev[ee]=Ce<=j?j-Ce:0,--re;);z+=Ce}if(b.strm.avail_in===0)break;if(we=b.strm,ye=b.window,le=b.strstart+b.lookahead,be=z,Pe=void 0,Pe=we.avail_in,be<Pe&&(Pe=be),re=Pe===0?0:(we.avail_in-=Pe,s.arraySet(ye,we.input,we.next_in,Pe,le),we.state.wrap===1?we.adler=l(we.adler,ye,Pe,le):we.state.wrap===2&&(we.adler=u(we.adler,ye,Pe,le)),we.next_in+=Pe,we.total_in+=Pe,Pe),b.lookahead+=re,b.lookahead+b.insert>=P)for(ie=b.strstart-b.insert,b.ins_h=b.window[ie],b.ins_h=(b.ins_h<<b.hash_shift^b.window[ie+1])&b.hash_mask;b.insert&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[ie+P-1])&b.hash_mask,b.prev[ie&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=ie,ie++,b.insert--,!(b.lookahead+b.insert<P)););}while(b.lookahead<U&&b.strm.avail_in!==0)}function ke(b,ee){for(var re,j;;){if(b.lookahead<U){if(ce(b),b.lookahead<U&&ee===d)return C;if(b.lookahead===0)break}if(re=0,b.lookahead>=P&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+P-1])&b.hash_mask,re=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),re!==0&&b.strstart-re<=b.w_size-U&&(b.match_length=M(b,re)),b.match_length>=P)if(j=c._tr_tally(b,b.strstart-b.match_start,b.match_length-P),b.lookahead-=b.match_length,b.match_length<=b.max_lazy_match&&b.lookahead>=P){for(b.match_length--;b.strstart++,b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+P-1])&b.hash_mask,re=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart,--b.match_length!=0;);b.strstart++}else b.strstart+=b.match_length,b.match_length=0,b.ins_h=b.window[b.strstart],b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+1])&b.hash_mask;else j=c._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++;if(j&&(R(b,!1),b.strm.avail_out===0))return C}return b.insert=b.strstart<P-1?b.strstart:P-1,ee===f?(R(b,!0),b.strm.avail_out===0?ne:X):b.last_lit&&(R(b,!1),b.strm.avail_out===0)?C:K}function ue(b,ee){for(var re,j,z;;){if(b.lookahead<U){if(ce(b),b.lookahead<U&&ee===d)return C;if(b.lookahead===0)break}if(re=0,b.lookahead>=P&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+P-1])&b.hash_mask,re=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),b.prev_length=b.match_length,b.prev_match=b.match_start,b.match_length=P-1,re!==0&&b.prev_length<b.max_lazy_match&&b.strstart-re<=b.w_size-U&&(b.match_length=M(b,re),b.match_length<=5&&(b.strategy===1||b.match_length===P&&4096<b.strstart-b.match_start)&&(b.match_length=P-1)),b.prev_length>=P&&b.match_length<=b.prev_length){for(z=b.strstart+b.lookahead-P,j=c._tr_tally(b,b.strstart-1-b.prev_match,b.prev_length-P),b.lookahead-=b.prev_length-1,b.prev_length-=2;++b.strstart<=z&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+P-1])&b.hash_mask,re=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),--b.prev_length!=0;);if(b.match_available=0,b.match_length=P-1,b.strstart++,j&&(R(b,!1),b.strm.avail_out===0))return C}else if(b.match_available){if((j=c._tr_tally(b,0,b.window[b.strstart-1]))&&R(b,!1),b.strstart++,b.lookahead--,b.strm.avail_out===0)return C}else b.match_available=1,b.strstart++,b.lookahead--}return b.match_available&&(j=c._tr_tally(b,0,b.window[b.strstart-1]),b.match_available=0),b.insert=b.strstart<P-1?b.strstart:P-1,ee===f?(R(b,!0),b.strm.avail_out===0?ne:X):b.last_lit&&(R(b,!1),b.strm.avail_out===0)?C:K}function ve(b,ee,re,j,z){this.good_length=b,this.max_lazy=ee,this.nice_length=re,this.max_chain=j,this.func=z}function ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*E),this.dyn_dtree=new s.Buf16(2*(2*I+1)),this.bl_tree=new s.Buf16(2*(2*O+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(T+1),this.heap=new s.Buf16(2*S+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*S+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function te(b){var ee;return b&&b.state?(b.total_in=b.total_out=0,b.data_type=v,(ee=b.state).pending=0,ee.pending_out=0,ee.wrap<0&&(ee.wrap=-ee.wrap),ee.status=ee.wrap?A:N,b.adler=ee.wrap===2?0:1,ee.last_flush=d,c._tr_init(ee),m):oe(b,w)}function D(b){var ee=te(b);return ee===m&&function(re){re.window_size=2*re.w_size,se(re.head),re.max_lazy_match=i[re.level].max_lazy,re.good_match=i[re.level].good_length,re.nice_match=i[re.level].nice_length,re.max_chain_length=i[re.level].max_chain,re.strstart=0,re.block_start=0,re.lookahead=0,re.insert=0,re.match_length=re.prev_length=P-1,re.match_available=0,re.ins_h=0}(b.state),ee}function he(b,ee,re,j,z,ie){if(!b)return w;var we=1;if(ee===p&&(ee=6),j<0?(we=0,j=-j):15<j&&(we=2,j-=16),z<1||x<z||re!==k||j<8||15<j||ee<0||9<ee||ie<0||g<ie)return oe(b,w);j===8&&(j=9);var ye=new ge;return(b.state=ye).strm=b,ye.wrap=we,ye.gzhead=null,ye.w_bits=j,ye.w_size=1<<ye.w_bits,ye.w_mask=ye.w_size-1,ye.hash_bits=z+7,ye.hash_size=1<<ye.hash_bits,ye.hash_mask=ye.hash_size-1,ye.hash_shift=~~((ye.hash_bits+P-1)/P),ye.window=new s.Buf8(2*ye.w_size),ye.head=new s.Buf16(ye.hash_size),ye.prev=new s.Buf16(ye.w_size),ye.lit_bufsize=1<<z+6,ye.pending_buf_size=4*ye.lit_bufsize,ye.pending_buf=new s.Buf8(ye.pending_buf_size),ye.d_buf=1*ye.lit_bufsize,ye.l_buf=3*ye.lit_bufsize,ye.level=ee,ye.strategy=ie,ye.method=re,D(b)}i=[new ve(0,0,0,0,function(b,ee){var re=65535;for(re>b.pending_buf_size-5&&(re=b.pending_buf_size-5);;){if(b.lookahead<=1){if(ce(b),b.lookahead===0&&ee===d)return C;if(b.lookahead===0)break}b.strstart+=b.lookahead,b.lookahead=0;var j=b.block_start+re;if((b.strstart===0||b.strstart>=j)&&(b.lookahead=b.strstart-j,b.strstart=j,R(b,!1),b.strm.avail_out===0)||b.strstart-b.block_start>=b.w_size-U&&(R(b,!1),b.strm.avail_out===0))return C}return b.insert=0,ee===f?(R(b,!0),b.strm.avail_out===0?ne:X):(b.strstart>b.block_start&&(R(b,!1),b.strm.avail_out),C)}),new ve(4,4,8,4,ke),new ve(4,5,16,8,ke),new ve(4,6,32,32,ke),new ve(4,4,16,16,ue),new ve(8,16,32,32,ue),new ve(8,16,128,128,ue),new ve(8,32,128,256,ue),new ve(32,128,258,1024,ue),new ve(32,258,258,4096,ue)],a.deflateInit=function(b,ee){return he(b,ee,k,15,8,0)},a.deflateInit2=he,a.deflateReset=D,a.deflateResetKeep=te,a.deflateSetHeader=function(b,ee){return b&&b.state?b.state.wrap!==2?w:(b.state.gzhead=ee,m):w},a.deflate=function(b,ee){var re,j,z,ie;if(!b||!b.state||5<ee||ee<0)return b?oe(b,w):w;if(j=b.state,!b.output||!b.input&&b.avail_in!==0||j.status===666&&ee!==f)return oe(b,b.avail_out===0?-5:w);if(j.strm=b,re=j.last_flush,j.last_flush=ee,j.status===A)if(j.wrap===2)b.adler=0,ae(j,31),ae(j,139),ae(j,8),j.gzhead?(ae(j,(j.gzhead.text?1:0)+(j.gzhead.hcrc?2:0)+(j.gzhead.extra?4:0)+(j.gzhead.name?8:0)+(j.gzhead.comment?16:0)),ae(j,255&j.gzhead.time),ae(j,j.gzhead.time>>8&255),ae(j,j.gzhead.time>>16&255),ae(j,j.gzhead.time>>24&255),ae(j,j.level===9?2:2<=j.strategy||j.level<2?4:0),ae(j,255&j.gzhead.os),j.gzhead.extra&&j.gzhead.extra.length&&(ae(j,255&j.gzhead.extra.length),ae(j,j.gzhead.extra.length>>8&255)),j.gzhead.hcrc&&(b.adler=u(b.adler,j.pending_buf,j.pending,0)),j.gzindex=0,j.status=69):(ae(j,0),ae(j,0),ae(j,0),ae(j,0),ae(j,0),ae(j,j.level===9?2:2<=j.strategy||j.level<2?4:0),ae(j,3),j.status=N);else{var we=k+(j.w_bits-8<<4)<<8;we|=(2<=j.strategy||j.level<2?0:j.level<6?1:j.level===6?2:3)<<6,j.strstart!==0&&(we|=32),we+=31-we%31,j.status=N,L(j,we),j.strstart!==0&&(L(j,b.adler>>>16),L(j,65535&b.adler)),b.adler=1}if(j.status===69)if(j.gzhead.extra){for(z=j.pending;j.gzindex<(65535&j.gzhead.extra.length)&&(j.pending!==j.pending_buf_size||(j.gzhead.hcrc&&j.pending>z&&(b.adler=u(b.adler,j.pending_buf,j.pending-z,z)),Q(b),z=j.pending,j.pending!==j.pending_buf_size));)ae(j,255&j.gzhead.extra[j.gzindex]),j.gzindex++;j.gzhead.hcrc&&j.pending>z&&(b.adler=u(b.adler,j.pending_buf,j.pending-z,z)),j.gzindex===j.gzhead.extra.length&&(j.gzindex=0,j.status=73)}else j.status=73;if(j.status===73)if(j.gzhead.name){z=j.pending;do{if(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>z&&(b.adler=u(b.adler,j.pending_buf,j.pending-z,z)),Q(b),z=j.pending,j.pending===j.pending_buf_size)){ie=1;break}ie=j.gzindex<j.gzhead.name.length?255&j.gzhead.name.charCodeAt(j.gzindex++):0,ae(j,ie)}while(ie!==0);j.gzhead.hcrc&&j.pending>z&&(b.adler=u(b.adler,j.pending_buf,j.pending-z,z)),ie===0&&(j.gzindex=0,j.status=91)}else j.status=91;if(j.status===91)if(j.gzhead.comment){z=j.pending;do{if(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>z&&(b.adler=u(b.adler,j.pending_buf,j.pending-z,z)),Q(b),z=j.pending,j.pending===j.pending_buf_size)){ie=1;break}ie=j.gzindex<j.gzhead.comment.length?255&j.gzhead.comment.charCodeAt(j.gzindex++):0,ae(j,ie)}while(ie!==0);j.gzhead.hcrc&&j.pending>z&&(b.adler=u(b.adler,j.pending_buf,j.pending-z,z)),ie===0&&(j.status=103)}else j.status=103;if(j.status===103&&(j.gzhead.hcrc?(j.pending+2>j.pending_buf_size&&Q(b),j.pending+2<=j.pending_buf_size&&(ae(j,255&b.adler),ae(j,b.adler>>8&255),b.adler=0,j.status=N)):j.status=N),j.pending!==0){if(Q(b),b.avail_out===0)return j.last_flush=-1,m}else if(b.avail_in===0&&q(ee)<=q(re)&&ee!==f)return oe(b,-5);if(j.status===666&&b.avail_in!==0)return oe(b,-5);if(b.avail_in!==0||j.lookahead!==0||ee!==d&&j.status!==666){var ye=j.strategy===2?function(le,be){for(var Pe;;){if(le.lookahead===0&&(ce(le),le.lookahead===0)){if(be===d)return C;break}if(le.match_length=0,Pe=c._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,Pe&&(R(le,!1),le.strm.avail_out===0))return C}return le.insert=0,be===f?(R(le,!0),le.strm.avail_out===0?ne:X):le.last_lit&&(R(le,!1),le.strm.avail_out===0)?C:K}(j,ee):j.strategy===3?function(le,be){for(var Pe,Ce,$e,vt,Ve=le.window;;){if(le.lookahead<=W){if(ce(le),le.lookahead<=W&&be===d)return C;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=P&&0<le.strstart&&(Ce=Ve[$e=le.strstart-1])===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]){vt=le.strstart+W;do;while(Ce===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]&&Ce===Ve[++$e]&&$e<vt);le.match_length=W-(vt-$e),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=P?(Pe=c._tr_tally(le,1,le.match_length-P),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(Pe=c._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),Pe&&(R(le,!1),le.strm.avail_out===0))return C}return le.insert=0,be===f?(R(le,!0),le.strm.avail_out===0?ne:X):le.last_lit&&(R(le,!1),le.strm.avail_out===0)?C:K}(j,ee):i[j.level].func(j,ee);if(ye!==ne&&ye!==X||(j.status=666),ye===C||ye===ne)return b.avail_out===0&&(j.last_flush=-1),m;if(ye===K&&(ee===1?c._tr_align(j):ee!==5&&(c._tr_stored_block(j,0,0,!1),ee===3&&(se(j.head),j.lookahead===0&&(j.strstart=0,j.block_start=0,j.insert=0))),Q(b),b.avail_out===0))return j.last_flush=-1,m}return ee!==f?m:j.wrap<=0?1:(j.wrap===2?(ae(j,255&b.adler),ae(j,b.adler>>8&255),ae(j,b.adler>>16&255),ae(j,b.adler>>24&255),ae(j,255&b.total_in),ae(j,b.total_in>>8&255),ae(j,b.total_in>>16&255),ae(j,b.total_in>>24&255)):(L(j,b.adler>>>16),L(j,65535&b.adler)),Q(b),0<j.wrap&&(j.wrap=-j.wrap),j.pending!==0?m:1)},a.deflateEnd=function(b){var ee;return b&&b.state?(ee=b.state.status)!==A&&ee!==69&&ee!==73&&ee!==91&&ee!==103&&ee!==N&&ee!==666?oe(b,w):(b.state=null,ee===N?oe(b,-3):m):w},a.deflateSetDictionary=function(b,ee){var re,j,z,ie,we,ye,le,be,Pe=ee.length;if(!b||!b.state||(ie=(re=b.state).wrap)===2||ie===1&&re.status!==A||re.lookahead)return w;for(ie===1&&(b.adler=l(b.adler,ee,Pe,0)),re.wrap=0,Pe>=re.w_size&&(ie===0&&(se(re.head),re.strstart=0,re.block_start=0,re.insert=0),be=new s.Buf8(re.w_size),s.arraySet(be,ee,Pe-re.w_size,re.w_size,0),ee=be,Pe=re.w_size),we=b.avail_in,ye=b.next_in,le=b.input,b.avail_in=Pe,b.next_in=0,b.input=ee,ce(re);re.lookahead>=P;){for(j=re.strstart,z=re.lookahead-(P-1);re.ins_h=(re.ins_h<<re.hash_shift^re.window[j+P-1])&re.hash_mask,re.prev[j&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=j,j++,--z;);re.strstart=j,re.lookahead=P-1,ce(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=P-1,re.match_available=0,b.next_in=ye,b.input=le,b.avail_in=we,re.wrap=ie,m},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,a){n.exports=function(i,s){var c,l,u,h,d,f,m,w,p,g,v,k,x,S,I,O,E,T,P,W,U,A,N,C,K;c=i.state,l=i.next_in,C=i.input,u=l+(i.avail_in-5),h=i.next_out,K=i.output,d=h-(s-i.avail_out),f=h+(i.avail_out-257),m=c.dmax,w=c.wsize,p=c.whave,g=c.wnext,v=c.window,k=c.hold,x=c.bits,S=c.lencode,I=c.distcode,O=(1<<c.lenbits)-1,E=(1<<c.distbits)-1;e:do{x<15&&(k+=C[l++]<<x,x+=8,k+=C[l++]<<x,x+=8),T=S[k&O];t:for(;;){if(k>>>=P=T>>>24,x-=P,(P=T>>>16&255)===0)K[h++]=65535&T;else{if(!(16&P)){if(!(64&P)){T=S[(65535&T)+(k&(1<<P)-1)];continue t}if(32&P){c.mode=12;break e}i.msg="invalid literal/length code",c.mode=30;break e}W=65535&T,(P&=15)&&(x<P&&(k+=C[l++]<<x,x+=8),W+=k&(1<<P)-1,k>>>=P,x-=P),x<15&&(k+=C[l++]<<x,x+=8,k+=C[l++]<<x,x+=8),T=I[k&E];r:for(;;){if(k>>>=P=T>>>24,x-=P,!(16&(P=T>>>16&255))){if(!(64&P)){T=I[(65535&T)+(k&(1<<P)-1)];continue r}i.msg="invalid distance code",c.mode=30;break e}if(U=65535&T,x<(P&=15)&&(k+=C[l++]<<x,(x+=8)<P&&(k+=C[l++]<<x,x+=8)),m<(U+=k&(1<<P)-1)){i.msg="invalid distance too far back",c.mode=30;break e}if(k>>>=P,x-=P,(P=h-d)<U){if(p<(P=U-P)&&c.sane){i.msg="invalid distance too far back",c.mode=30;break e}if(N=v,(A=0)===g){if(A+=w-P,P<W){for(W-=P;K[h++]=v[A++],--P;);A=h-U,N=K}}else if(g<P){if(A+=w+g-P,(P-=g)<W){for(W-=P;K[h++]=v[A++],--P;);if(A=0,g<W){for(W-=P=g;K[h++]=v[A++],--P;);A=h-U,N=K}}}else if(A+=g-P,P<W){for(W-=P;K[h++]=v[A++],--P;);A=h-U,N=K}for(;2<W;)K[h++]=N[A++],K[h++]=N[A++],K[h++]=N[A++],W-=3;W&&(K[h++]=N[A++],1<W&&(K[h++]=N[A++]))}else{for(A=h-U;K[h++]=K[A++],K[h++]=K[A++],K[h++]=K[A++],2<(W-=3););W&&(K[h++]=K[A++],1<W&&(K[h++]=K[A++]))}break}}break}}while(l<u&&h<f);l-=W=x>>3,k&=(1<<(x-=W<<3))-1,i.next_in=l,i.next_out=h,i.avail_in=l<u?u-l+5:5-(l-u),i.avail_out=h<f?f-h+257:257-(h-f),c.hold=k,c.bits=x}},{}],49:[function(e,n,a){var i=e("../utils/common"),s=e("./adler32"),c=e("./crc32"),l=e("./inffast"),u=e("./inftrees"),h=1,d=2,f=0,m=-2,w=1,p=852,g=592;function v(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(A){var N;return A&&A.state?(N=A.state,A.total_in=A.total_out=N.total=0,A.msg="",N.wrap&&(A.adler=1&N.wrap),N.mode=w,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new i.Buf32(p),N.distcode=N.distdyn=new i.Buf32(g),N.sane=1,N.back=-1,f):m}function S(A){var N;return A&&A.state?((N=A.state).wsize=0,N.whave=0,N.wnext=0,x(A)):m}function I(A,N){var C,K;return A&&A.state?(K=A.state,N<0?(C=0,N=-N):(C=1+(N>>4),N<48&&(N&=15)),N&&(N<8||15<N)?m:(K.window!==null&&K.wbits!==N&&(K.window=null),K.wrap=C,K.wbits=N,S(A))):m}function O(A,N){var C,K;return A?(K=new k,(A.state=K).window=null,(C=I(A,N))!==f&&(A.state=null),C):m}var E,T,P=!0;function W(A){if(P){var N;for(E=new i.Buf32(512),T=new i.Buf32(32),N=0;N<144;)A.lens[N++]=8;for(;N<256;)A.lens[N++]=9;for(;N<280;)A.lens[N++]=7;for(;N<288;)A.lens[N++]=8;for(u(h,A.lens,0,288,E,0,A.work,{bits:9}),N=0;N<32;)A.lens[N++]=5;u(d,A.lens,0,32,T,0,A.work,{bits:5}),P=!1}A.lencode=E,A.lenbits=9,A.distcode=T,A.distbits=5}function U(A,N,C,K){var ne,X=A.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new i.Buf8(X.wsize)),K>=X.wsize?(i.arraySet(X.window,N,C-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(K<(ne=X.wsize-X.wnext)&&(ne=K),i.arraySet(X.window,N,C-K,ne,X.wnext),(K-=ne)?(i.arraySet(X.window,N,C-K,K,0),X.wnext=K,X.whave=X.wsize):(X.wnext+=ne,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=ne))),0}a.inflateReset=S,a.inflateReset2=I,a.inflateResetKeep=x,a.inflateInit=function(A){return O(A,15)},a.inflateInit2=O,a.inflate=function(A,N){var C,K,ne,X,oe,q,se,Q,R,ae,L,M,ce,ke,ue,ve,ge,te,D,he,b,ee,re,j,z=0,ie=new i.Buf8(4),we=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return m;(C=A.state).mode===12&&(C.mode=13),oe=A.next_out,ne=A.output,se=A.avail_out,X=A.next_in,K=A.input,q=A.avail_in,Q=C.hold,R=C.bits,ae=q,L=se,ee=f;e:for(;;)switch(C.mode){case w:if(C.wrap===0){C.mode=13;break}for(;R<16;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(2&C.wrap&&Q===35615){ie[C.check=0]=255&Q,ie[1]=Q>>>8&255,C.check=c(C.check,ie,2,0),R=Q=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&Q)<<8)+(Q>>8))%31){A.msg="incorrect header check",C.mode=30;break}if((15&Q)!=8){A.msg="unknown compression method",C.mode=30;break}if(R-=4,b=8+(15&(Q>>>=4)),C.wbits===0)C.wbits=b;else if(b>C.wbits){A.msg="invalid window size",C.mode=30;break}C.dmax=1<<b,A.adler=C.check=1,C.mode=512&Q?10:12,R=Q=0;break;case 2:for(;R<16;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(C.flags=Q,(255&C.flags)!=8){A.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){A.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=Q>>8&1),512&C.flags&&(ie[0]=255&Q,ie[1]=Q>>>8&255,C.check=c(C.check,ie,2,0)),R=Q=0,C.mode=3;case 3:for(;R<32;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}C.head&&(C.head.time=Q),512&C.flags&&(ie[0]=255&Q,ie[1]=Q>>>8&255,ie[2]=Q>>>16&255,ie[3]=Q>>>24&255,C.check=c(C.check,ie,4,0)),R=Q=0,C.mode=4;case 4:for(;R<16;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}C.head&&(C.head.xflags=255&Q,C.head.os=Q>>8),512&C.flags&&(ie[0]=255&Q,ie[1]=Q>>>8&255,C.check=c(C.check,ie,2,0)),R=Q=0,C.mode=5;case 5:if(1024&C.flags){for(;R<16;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}C.length=Q,C.head&&(C.head.extra_len=Q),512&C.flags&&(ie[0]=255&Q,ie[1]=Q>>>8&255,C.check=c(C.check,ie,2,0)),R=Q=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(q<(M=C.length)&&(M=q),M&&(C.head&&(b=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),i.arraySet(C.head.extra,K,X,M,b)),512&C.flags&&(C.check=c(C.check,K,M,X)),q-=M,X+=M,C.length-=M),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(q===0)break e;for(M=0;b=K[X+M++],C.head&&b&&C.length<65536&&(C.head.name+=String.fromCharCode(b)),b&&M<q;);if(512&C.flags&&(C.check=c(C.check,K,M,X)),q-=M,X+=M,b)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(q===0)break e;for(M=0;b=K[X+M++],C.head&&b&&C.length<65536&&(C.head.comment+=String.fromCharCode(b)),b&&M<q;);if(512&C.flags&&(C.check=c(C.check,K,M,X)),q-=M,X+=M,b)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;R<16;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(Q!==(65535&C.check)){A.msg="header crc mismatch",C.mode=30;break}R=Q=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),A.adler=C.check=0,C.mode=12;break;case 10:for(;R<32;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}A.adler=C.check=v(Q),R=Q=0,C.mode=11;case 11:if(C.havedict===0)return A.next_out=oe,A.avail_out=se,A.next_in=X,A.avail_in=q,C.hold=Q,C.bits=R,2;A.adler=C.check=1,C.mode=12;case 12:if(N===5||N===6)break e;case 13:if(C.last){Q>>>=7&R,R-=7&R,C.mode=27;break}for(;R<3;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}switch(C.last=1&Q,R-=1,3&(Q>>>=1)){case 0:C.mode=14;break;case 1:if(W(C),C.mode=20,N!==6)break;Q>>>=2,R-=2;break e;case 2:C.mode=17;break;case 3:A.msg="invalid block type",C.mode=30}Q>>>=2,R-=2;break;case 14:for(Q>>>=7&R,R-=7&R;R<32;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if((65535&Q)!=(Q>>>16^65535)){A.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&Q,R=Q=0,C.mode=15,N===6)break e;case 15:C.mode=16;case 16:if(M=C.length){if(q<M&&(M=q),se<M&&(M=se),M===0)break e;i.arraySet(ne,K,X,M,oe),q-=M,X+=M,se-=M,oe+=M,C.length-=M;break}C.mode=12;break;case 17:for(;R<14;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(C.nlen=257+(31&Q),Q>>>=5,R-=5,C.ndist=1+(31&Q),Q>>>=5,R-=5,C.ncode=4+(15&Q),Q>>>=4,R-=4,286<C.nlen||30<C.ndist){A.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;R<3;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}C.lens[we[C.have++]]=7&Q,Q>>>=3,R-=3}for(;C.have<19;)C.lens[we[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,re={bits:C.lenbits},ee=u(0,C.lens,0,19,C.lencode,0,C.work,re),C.lenbits=re.bits,ee){A.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;ve=(z=C.lencode[Q&(1<<C.lenbits)-1])>>>16&255,ge=65535&z,!((ue=z>>>24)<=R);){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(ge<16)Q>>>=ue,R-=ue,C.lens[C.have++]=ge;else{if(ge===16){for(j=ue+2;R<j;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(Q>>>=ue,R-=ue,C.have===0){A.msg="invalid bit length repeat",C.mode=30;break}b=C.lens[C.have-1],M=3+(3&Q),Q>>>=2,R-=2}else if(ge===17){for(j=ue+3;R<j;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}R-=ue,b=0,M=3+(7&(Q>>>=ue)),Q>>>=3,R-=3}else{for(j=ue+7;R<j;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}R-=ue,b=0,M=11+(127&(Q>>>=ue)),Q>>>=7,R-=7}if(C.have+M>C.nlen+C.ndist){A.msg="invalid bit length repeat",C.mode=30;break}for(;M--;)C.lens[C.have++]=b}}if(C.mode===30)break;if(C.lens[256]===0){A.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,re={bits:C.lenbits},ee=u(h,C.lens,0,C.nlen,C.lencode,0,C.work,re),C.lenbits=re.bits,ee){A.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,re={bits:C.distbits},ee=u(d,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,re),C.distbits=re.bits,ee){A.msg="invalid distances set",C.mode=30;break}if(C.mode=20,N===6)break e;case 20:C.mode=21;case 21:if(6<=q&&258<=se){A.next_out=oe,A.avail_out=se,A.next_in=X,A.avail_in=q,C.hold=Q,C.bits=R,l(A,L),oe=A.next_out,ne=A.output,se=A.avail_out,X=A.next_in,K=A.input,q=A.avail_in,Q=C.hold,R=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;ve=(z=C.lencode[Q&(1<<C.lenbits)-1])>>>16&255,ge=65535&z,!((ue=z>>>24)<=R);){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(ve&&!(240&ve)){for(te=ue,D=ve,he=ge;ve=(z=C.lencode[he+((Q&(1<<te+D)-1)>>te)])>>>16&255,ge=65535&z,!(te+(ue=z>>>24)<=R);){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}Q>>>=te,R-=te,C.back+=te}if(Q>>>=ue,R-=ue,C.back+=ue,C.length=ge,ve===0){C.mode=26;break}if(32&ve){C.back=-1,C.mode=12;break}if(64&ve){A.msg="invalid literal/length code",C.mode=30;break}C.extra=15&ve,C.mode=22;case 22:if(C.extra){for(j=C.extra;R<j;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}C.length+=Q&(1<<C.extra)-1,Q>>>=C.extra,R-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;ve=(z=C.distcode[Q&(1<<C.distbits)-1])>>>16&255,ge=65535&z,!((ue=z>>>24)<=R);){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(!(240&ve)){for(te=ue,D=ve,he=ge;ve=(z=C.distcode[he+((Q&(1<<te+D)-1)>>te)])>>>16&255,ge=65535&z,!(te+(ue=z>>>24)<=R);){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}Q>>>=te,R-=te,C.back+=te}if(Q>>>=ue,R-=ue,C.back+=ue,64&ve){A.msg="invalid distance code",C.mode=30;break}C.offset=ge,C.extra=15&ve,C.mode=24;case 24:if(C.extra){for(j=C.extra;R<j;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}C.offset+=Q&(1<<C.extra)-1,Q>>>=C.extra,R-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){A.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(se===0)break e;if(M=L-se,C.offset>M){if((M=C.offset-M)>C.whave&&C.sane){A.msg="invalid distance too far back",C.mode=30;break}ce=M>C.wnext?(M-=C.wnext,C.wsize-M):C.wnext-M,M>C.length&&(M=C.length),ke=C.window}else ke=ne,ce=oe-C.offset,M=C.length;for(se<M&&(M=se),se-=M,C.length-=M;ne[oe++]=ke[ce++],--M;);C.length===0&&(C.mode=21);break;case 26:if(se===0)break e;ne[oe++]=C.length,se--,C.mode=21;break;case 27:if(C.wrap){for(;R<32;){if(q===0)break e;q--,Q|=K[X++]<<R,R+=8}if(L-=se,A.total_out+=L,C.total+=L,L&&(A.adler=C.check=C.flags?c(C.check,ne,L,oe-L):s(C.check,ne,L,oe-L)),L=se,(C.flags?Q:v(Q))!==C.check){A.msg="incorrect data check",C.mode=30;break}R=Q=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;R<32;){if(q===0)break e;q--,Q+=K[X++]<<R,R+=8}if(Q!==(4294967295&C.total)){A.msg="incorrect length check",C.mode=30;break}R=Q=0}C.mode=29;case 29:ee=1;break e;case 30:ee=-3;break e;case 31:return-4;case 32:default:return m}return A.next_out=oe,A.avail_out=se,A.next_in=X,A.avail_in=q,C.hold=Q,C.bits=R,(C.wsize||L!==A.avail_out&&C.mode<30&&(C.mode<27||N!==4))&&U(A,A.output,A.next_out,L-A.avail_out)?(C.mode=31,-4):(ae-=A.avail_in,L-=A.avail_out,A.total_in+=ae,A.total_out+=L,C.total+=L,C.wrap&&L&&(A.adler=C.check=C.flags?c(C.check,ne,L,A.next_out-L):s(C.check,ne,L,A.next_out-L)),A.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),(ae==0&&L===0||N===4)&&ee===f&&(ee=-5),ee)},a.inflateEnd=function(A){if(!A||!A.state)return m;var N=A.state;return N.window&&(N.window=null),A.state=null,f},a.inflateGetHeader=function(A,N){var C;return A&&A.state&&2&(C=A.state).wrap?((C.head=N).done=!1,f):m},a.inflateSetDictionary=function(A,N){var C,K=N.length;return A&&A.state?(C=A.state).wrap!==0&&C.mode!==11?m:C.mode===11&&s(1,N,K,0)!==C.check?-3:U(A,N,K,K)?(C.mode=31,-4):(C.havedict=1,f):m},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,a){var i=e("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(h,d,f,m,w,p,g,v){var k,x,S,I,O,E,T,P,W,U=v.bits,A=0,N=0,C=0,K=0,ne=0,X=0,oe=0,q=0,se=0,Q=0,R=null,ae=0,L=new i.Buf16(16),M=new i.Buf16(16),ce=null,ke=0;for(A=0;A<=15;A++)L[A]=0;for(N=0;N<m;N++)L[d[f+N]]++;for(ne=U,K=15;1<=K&&L[K]===0;K--);if(K<ne&&(ne=K),K===0)return w[p++]=20971520,w[p++]=20971520,v.bits=1,0;for(C=1;C<K&&L[C]===0;C++);for(ne<C&&(ne=C),A=q=1;A<=15;A++)if(q<<=1,(q-=L[A])<0)return-1;if(0<q&&(h===0||K!==1))return-1;for(M[1]=0,A=1;A<15;A++)M[A+1]=M[A]+L[A];for(N=0;N<m;N++)d[f+N]!==0&&(g[M[d[f+N]]++]=N);if(E=h===0?(R=ce=g,19):h===1?(R=s,ae-=257,ce=c,ke-=257,256):(R=l,ce=u,-1),A=C,O=p,oe=N=Q=0,S=-1,I=(se=1<<(X=ne))-1,h===1&&852<se||h===2&&592<se)return 1;for(;;){for(T=A-oe,W=g[N]<E?(P=0,g[N]):g[N]>E?(P=ce[ke+g[N]],R[ae+g[N]]):(P=96,0),k=1<<A-oe,C=x=1<<X;w[O+(Q>>oe)+(x-=k)]=T<<24|P<<16|W|0,x!==0;);for(k=1<<A-1;Q&k;)k>>=1;if(k!==0?(Q&=k-1,Q+=k):Q=0,N++,--L[A]==0){if(A===K)break;A=d[f+g[N]]}if(ne<A&&(Q&I)!==S){for(oe===0&&(oe=ne),O+=C,q=1<<(X=A-oe);X+oe<K&&!((q-=L[X+oe])<=0);)X++,q<<=1;if(se+=1<<X,h===1&&852<se||h===2&&592<se)return 1;w[S=Q&I]=ne<<24|X<<16|O-p|0}}return Q!==0&&(w[O+Q]=A-oe<<24|64<<16|0),v.bits=ne,0}},{"../utils/common":41}],51:[function(e,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,a){var i=e("../utils/common"),s=0,c=1;function l(z){for(var ie=z.length;0<=--ie;)z[ie]=0}var u=0,h=29,d=256,f=d+1+h,m=30,w=19,p=2*f+1,g=15,v=16,k=7,x=256,S=16,I=17,O=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=new Array(2*(f+2));l(U);var A=new Array(2*m);l(A);var N=new Array(512);l(N);var C=new Array(256);l(C);var K=new Array(h);l(K);var ne,X,oe,q=new Array(m);function se(z,ie,we,ye,le){this.static_tree=z,this.extra_bits=ie,this.extra_base=we,this.elems=ye,this.max_length=le,this.has_stree=z&&z.length}function Q(z,ie){this.dyn_tree=z,this.max_code=0,this.stat_desc=ie}function R(z){return z<256?N[z]:N[256+(z>>>7)]}function ae(z,ie){z.pending_buf[z.pending++]=255&ie,z.pending_buf[z.pending++]=ie>>>8&255}function L(z,ie,we){z.bi_valid>v-we?(z.bi_buf|=ie<<z.bi_valid&65535,ae(z,z.bi_buf),z.bi_buf=ie>>v-z.bi_valid,z.bi_valid+=we-v):(z.bi_buf|=ie<<z.bi_valid&65535,z.bi_valid+=we)}function M(z,ie,we){L(z,we[2*ie],we[2*ie+1])}function ce(z,ie){for(var we=0;we|=1&z,z>>>=1,we<<=1,0<--ie;);return we>>>1}function ke(z,ie,we){var ye,le,be=new Array(g+1),Pe=0;for(ye=1;ye<=g;ye++)be[ye]=Pe=Pe+we[ye-1]<<1;for(le=0;le<=ie;le++){var Ce=z[2*le+1];Ce!==0&&(z[2*le]=ce(be[Ce]++,Ce))}}function ue(z){var ie;for(ie=0;ie<f;ie++)z.dyn_ltree[2*ie]=0;for(ie=0;ie<m;ie++)z.dyn_dtree[2*ie]=0;for(ie=0;ie<w;ie++)z.bl_tree[2*ie]=0;z.dyn_ltree[2*x]=1,z.opt_len=z.static_len=0,z.last_lit=z.matches=0}function ve(z){8<z.bi_valid?ae(z,z.bi_buf):0<z.bi_valid&&(z.pending_buf[z.pending++]=z.bi_buf),z.bi_buf=0,z.bi_valid=0}function ge(z,ie,we,ye){var le=2*ie,be=2*we;return z[le]<z[be]||z[le]===z[be]&&ye[ie]<=ye[we]}function te(z,ie,we){for(var ye=z.heap[we],le=we<<1;le<=z.heap_len&&(le<z.heap_len&&ge(ie,z.heap[le+1],z.heap[le],z.depth)&&le++,!ge(ie,ye,z.heap[le],z.depth));)z.heap[we]=z.heap[le],we=le,le<<=1;z.heap[we]=ye}function D(z,ie,we){var ye,le,be,Pe,Ce=0;if(z.last_lit!==0)for(;ye=z.pending_buf[z.d_buf+2*Ce]<<8|z.pending_buf[z.d_buf+2*Ce+1],le=z.pending_buf[z.l_buf+Ce],Ce++,ye===0?M(z,le,ie):(M(z,(be=C[le])+d+1,ie),(Pe=E[be])!==0&&L(z,le-=K[be],Pe),M(z,be=R(--ye),we),(Pe=T[be])!==0&&L(z,ye-=q[be],Pe)),Ce<z.last_lit;);M(z,x,ie)}function he(z,ie){var we,ye,le,be=ie.dyn_tree,Pe=ie.stat_desc.static_tree,Ce=ie.stat_desc.has_stree,$e=ie.stat_desc.elems,vt=-1;for(z.heap_len=0,z.heap_max=p,we=0;we<$e;we++)be[2*we]!==0?(z.heap[++z.heap_len]=vt=we,z.depth[we]=0):be[2*we+1]=0;for(;z.heap_len<2;)be[2*(le=z.heap[++z.heap_len]=vt<2?++vt:0)]=1,z.depth[le]=0,z.opt_len--,Ce&&(z.static_len-=Pe[2*le+1]);for(ie.max_code=vt,we=z.heap_len>>1;1<=we;we--)te(z,be,we);for(le=$e;we=z.heap[1],z.heap[1]=z.heap[z.heap_len--],te(z,be,1),ye=z.heap[1],z.heap[--z.heap_max]=we,z.heap[--z.heap_max]=ye,be[2*le]=be[2*we]+be[2*ye],z.depth[le]=(z.depth[we]>=z.depth[ye]?z.depth[we]:z.depth[ye])+1,be[2*we+1]=be[2*ye+1]=le,z.heap[1]=le++,te(z,be,1),2<=z.heap_len;);z.heap[--z.heap_max]=z.heap[1],function(Ve,zt){var Ze,yt,Br,tt,ga,r0,Ha=zt.dyn_tree,bx=zt.max_code,_x=zt.stat_desc.static_tree,Ex=zt.stat_desc.has_stree,Sx=zt.stat_desc.extra_bits,Cx=zt.stat_desc.extra_base,Pu=zt.stat_desc.max_length,Cs=0;for(tt=0;tt<=g;tt++)Ve.bl_count[tt]=0;for(Ha[2*Ve.heap[Ve.heap_max]+1]=0,Ze=Ve.heap_max+1;Ze<p;Ze++)Pu<(tt=Ha[2*Ha[2*(yt=Ve.heap[Ze])+1]+1]+1)&&(tt=Pu,Cs++),Ha[2*yt+1]=tt,bx<yt||(Ve.bl_count[tt]++,ga=0,Cx<=yt&&(ga=Sx[yt-Cx]),r0=Ha[2*yt],Ve.opt_len+=r0*(tt+ga),Ex&&(Ve.static_len+=r0*(_x[2*yt+1]+ga)));if(Cs!==0){do{for(tt=Pu-1;Ve.bl_count[tt]===0;)tt--;Ve.bl_count[tt]--,Ve.bl_count[tt+1]+=2,Ve.bl_count[Pu]--,Cs-=2}while(0<Cs);for(tt=Pu;tt!==0;tt--)for(yt=Ve.bl_count[tt];yt!==0;)bx<(Br=Ve.heap[--Ze])||(Ha[2*Br+1]!==tt&&(Ve.opt_len+=(tt-Ha[2*Br+1])*Ha[2*Br],Ha[2*Br+1]=tt),yt--)}}(z,ie),ke(be,vt,z.bl_count)}function b(z,ie,we){var ye,le,be=-1,Pe=ie[1],Ce=0,$e=7,vt=4;for(Pe===0&&($e=138,vt=3),ie[2*(we+1)+1]=65535,ye=0;ye<=we;ye++)le=Pe,Pe=ie[2*(ye+1)+1],++Ce<$e&&le===Pe||(Ce<vt?z.bl_tree[2*le]+=Ce:le!==0?(le!==be&&z.bl_tree[2*le]++,z.bl_tree[2*S]++):Ce<=10?z.bl_tree[2*I]++:z.bl_tree[2*O]++,be=le,vt=(Ce=0)===Pe?($e=138,3):le===Pe?($e=6,3):($e=7,4))}function ee(z,ie,we){var ye,le,be=-1,Pe=ie[1],Ce=0,$e=7,vt=4;for(Pe===0&&($e=138,vt=3),ye=0;ye<=we;ye++)if(le=Pe,Pe=ie[2*(ye+1)+1],!(++Ce<$e&&le===Pe)){if(Ce<vt)for(;M(z,le,z.bl_tree),--Ce!=0;);else le!==0?(le!==be&&(M(z,le,z.bl_tree),Ce--),M(z,S,z.bl_tree),L(z,Ce-3,2)):Ce<=10?(M(z,I,z.bl_tree),L(z,Ce-3,3)):(M(z,O,z.bl_tree),L(z,Ce-11,7));be=le,vt=(Ce=0)===Pe?($e=138,3):le===Pe?($e=6,3):($e=7,4)}}l(q);var re=!1;function j(z,ie,we,ye){L(z,(u<<1)+(ye?1:0),3),function(le,be,Pe,Ce){ve(le),ae(le,Pe),ae(le,~Pe),i.arraySet(le.pending_buf,le.window,be,Pe,le.pending),le.pending+=Pe}(z,ie,we)}a._tr_init=function(z){re||(function(){var ie,we,ye,le,be,Pe=new Array(g+1);for(le=ye=0;le<h-1;le++)for(K[le]=ye,ie=0;ie<1<<E[le];ie++)C[ye++]=le;for(C[ye-1]=le,le=be=0;le<16;le++)for(q[le]=be,ie=0;ie<1<<T[le];ie++)N[be++]=le;for(be>>=7;le<m;le++)for(q[le]=be<<7,ie=0;ie<1<<T[le]-7;ie++)N[256+be++]=le;for(we=0;we<=g;we++)Pe[we]=0;for(ie=0;ie<=143;)U[2*ie+1]=8,ie++,Pe[8]++;for(;ie<=255;)U[2*ie+1]=9,ie++,Pe[9]++;for(;ie<=279;)U[2*ie+1]=7,ie++,Pe[7]++;for(;ie<=287;)U[2*ie+1]=8,ie++,Pe[8]++;for(ke(U,f+1,Pe),ie=0;ie<m;ie++)A[2*ie+1]=5,A[2*ie]=ce(ie,5);ne=new se(U,E,d+1,f,g),X=new se(A,T,0,m,g),oe=new se(new Array(0),P,0,w,k)}(),re=!0),z.l_desc=new Q(z.dyn_ltree,ne),z.d_desc=new Q(z.dyn_dtree,X),z.bl_desc=new Q(z.bl_tree,oe),z.bi_buf=0,z.bi_valid=0,ue(z)},a._tr_stored_block=j,a._tr_flush_block=function(z,ie,we,ye){var le,be,Pe=0;0<z.level?(z.strm.data_type===2&&(z.strm.data_type=function(Ce){var $e,vt=4093624447;for($e=0;$e<=31;$e++,vt>>>=1)if(1&vt&&Ce.dyn_ltree[2*$e]!==0)return s;if(Ce.dyn_ltree[18]!==0||Ce.dyn_ltree[20]!==0||Ce.dyn_ltree[26]!==0)return c;for($e=32;$e<d;$e++)if(Ce.dyn_ltree[2*$e]!==0)return c;return s}(z)),he(z,z.l_desc),he(z,z.d_desc),Pe=function(Ce){var $e;for(b(Ce,Ce.dyn_ltree,Ce.l_desc.max_code),b(Ce,Ce.dyn_dtree,Ce.d_desc.max_code),he(Ce,Ce.bl_desc),$e=w-1;3<=$e&&Ce.bl_tree[2*W[$e]+1]===0;$e--);return Ce.opt_len+=3*($e+1)+5+5+4,$e}(z),le=z.opt_len+3+7>>>3,(be=z.static_len+3+7>>>3)<=le&&(le=be)):le=be=we+5,we+4<=le&&ie!==-1?j(z,ie,we,ye):z.strategy===4||be===le?(L(z,2+(ye?1:0),3),D(z,U,A)):(L(z,4+(ye?1:0),3),function(Ce,$e,vt,Ve){var zt;for(L(Ce,$e-257,5),L(Ce,vt-1,5),L(Ce,Ve-4,4),zt=0;zt<Ve;zt++)L(Ce,Ce.bl_tree[2*W[zt]+1],3);ee(Ce,Ce.dyn_ltree,$e-1),ee(Ce,Ce.dyn_dtree,vt-1)}(z,z.l_desc.max_code+1,z.d_desc.max_code+1,Pe+1),D(z,z.dyn_ltree,z.dyn_dtree)),ue(z),ye&&ve(z)},a._tr_tally=function(z,ie,we){return z.pending_buf[z.d_buf+2*z.last_lit]=ie>>>8&255,z.pending_buf[z.d_buf+2*z.last_lit+1]=255&ie,z.pending_buf[z.l_buf+z.last_lit]=255&we,z.last_lit++,ie===0?z.dyn_ltree[2*we]++:(z.matches++,ie--,z.dyn_ltree[2*(C[we]+d+1)]++,z.dyn_dtree[2*R(ie)]++),z.last_lit===z.lit_bufsize-1},a._tr_align=function(z){L(z,2,3),M(z,x,U),function(ie){ie.bi_valid===16?(ae(ie,ie.bi_buf),ie.bi_buf=0,ie.bi_valid=0):8<=ie.bi_valid&&(ie.pending_buf[ie.pending++]=255&ie.bi_buf,ie.bi_buf>>=8,ie.bi_valid-=8)}(z)}},{"../utils/common":41}],53:[function(e,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,a){(function(i){(function(s,c){if(!s.setImmediate){var l,u,h,d,f=1,m={},w=!1,p=s.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(s);g=g&&g.setTimeout?g:s,l={}.toString.call(s.process)==="[object process]"?function(S){process.nextTick(function(){k(S)})}:function(){if(s.postMessage&&!s.importScripts){var S=!0,I=s.onmessage;return s.onmessage=function(){S=!1},s.postMessage("","*"),s.onmessage=I,S}}()?(d="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",x,!1):s.attachEvent("onmessage",x),function(S){s.postMessage(d+S,"*")}):s.MessageChannel?((h=new MessageChannel).port1.onmessage=function(S){k(S.data)},function(S){h.port2.postMessage(S)}):p&&"onreadystatechange"in p.createElement("script")?(u=p.documentElement,function(S){var I=p.createElement("script");I.onreadystatechange=function(){k(S),I.onreadystatechange=null,u.removeChild(I),I=null},u.appendChild(I)}):function(S){setTimeout(k,0,S)},g.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var I=new Array(arguments.length-1),O=0;O<I.length;O++)I[O]=arguments[O+1];var E={callback:S,args:I};return m[f]=E,l(f),f++},g.clearImmediate=v}function v(S){delete m[S]}function k(S){if(w)setTimeout(k,0,S);else{var I=m[S];if(I){w=!0;try{(function(O){var E=O.callback,T=O.args;switch(T.length){case 0:E();break;case 1:E(T[0]);break;case 2:E(T[0],T[1]);break;case 3:E(T[0],T[1],T[2]);break;default:E.apply(c,T)}})(I)}finally{v(S),w=!1}}}}function x(S){S.source===s&&typeof S.data=="string"&&S.data.indexOf(d)===0&&k(+S.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Ke<"u"?Ke:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(kF);var FH=kF.exports;const bF=at(FH);kt.extend(SH);function PH(r){let t=r.filter(n=>n.name.match("^2[0-9]{3}$")),e=null;return t.length>0&&(t.length>1&&t.sort((n,a)=>Number.parseInt(a.name)-Number.parseInt(n.name)),e=Number.parseInt(t[0].name)),e}function IH(r){let t=r.filter(n=>n.name.match("^[01][0-9]-[0123][0-9]$")),e=null;return t.length>0&&(t.length>1&&t.sort((n,a)=>Number.parseInt(a.name.replace("-",""))-Number.parseInt(n.name.replace("-",""))),e=t[0].name),e}async function DH({userName:r,repoName:t}){let e=null;try{let n=await Bc.listRepoContents(r,t,"/",{getTokenFunction:za,setTokenFunction:Mi}),a=PH(n);if(a){let i=await Bc.listRepoContents(r,t,`/${a}`,{getTokenFunction:za,setTokenFunction:Mi}),s=IH(i);s||(s="01-01");let c=`${a}-${s}`;e=kt(c).startOf("day").toDate()}}catch(n){if(n!=aa.NOT_FOUND)throw n}return e}async function OH(){let r=new ZO;return r.pageNum=1,r.pageSize=eh,r.orderByColumn="updateDatetime",r.orderBy="DESC",(await eM.searchDataSharePartner(r,{invokeEnv:je})).items}async function MH({userName:r,repoName:t}){let e=await ik.taskDataUploadGetMaxEndDatetime({},{invokeEnv:je}),n=e?kt(e):null,a=kt(new Date).startOf("day");if(!a.isSame(n))try{let i=await DH({userName:r,repoName:t}),s=kt.min(n,kt(i));`${s}`;try{await Xn.dbBeginTransaction({},{invokeEnv:je}),await d_({type:xT,startDatetime:s,endDatetime:a,userName:r,repoName:t,total:(await EF({startDatetime:s,endDatetime:a})).total}),await d_({type:kT,startDatetime:s,endDatetime:a,userName:r,repoName:t,total:(await SF({startDatetime:s,endDatetime:a})).total}),await d_({type:bT,startDatetime:null,endDatetime:null,userName:r,repoName:t,total:(await CF({startDatetime:null,endDatetime:null})).total}),await Xn.dbCommitTransaction({},{invokeEnv:je})}catch(c){await Xn.dbRollbackTransaction({},{invokeEnv:je}),Gn(c)}}catch(i){Gn(i)}}async function RH({userName:r,repoName:t}){let e=kt(),n=kt(e),a=kt(e).subtract(S2,"day"),i=new Map;i.set(n.year(),null),i.set(a.year(),null);let s=Array.from(i.keys()),c=[];for(let d=0;d<s.length;d++){let f=s[d];try{let m=await Bc.listRepoContents(r,t,`/${f}`,{getTokenFunction:za,setTokenFunction:Mi});for(let w=0;w<m.length;w++){let p=m[w];c.push(kt(`${f}-${p.name}`).toDate())}}catch(m){if(m!=aa.NOT_FOUND)throw m}}c=c.sort((d,f)=>d.getTime()-f.getTime());let l=e.toDate();c=c.filter(d=>l.getTime()-d.getTime()<1e3*60*60*24*S2);let u=null,h=null;if(c.length>0){u=c[c.length-1],h=c[0];let d=new XO;d.pageNum=1,d.pageSize=eh,d.userName=r,d.repoName=t,d.startDatetime=h,d.endDatetime=kt(u).add(1,"day").toDate(),d.orderByColumn="createDatetime",d.orderBy="ASC";let f=await sk.searchTaskDataDownload(d,{invokeEnv:je}),m=new Map,w=f.items;if(w.length>0)for(let g=0;g<w.length;g++){let v=w[g];m.set(v.datetime,null)}let p=c.filter(g=>!m.has(g2(g)));if(`${p.length}${p.toString()}`,p.length>0)try{await Xn.dbBeginTransaction({},{invokeEnv:je});for(let g=0;g<p.length;g++){let v=p[g];await h_({type:_T,datetime:v,userName:r,repoName:t}),await h_({type:ET,datetime:v,userName:r,repoName:t}),await h_({type:ST,datetime:v,userName:r,repoName:t})}await Xn.dbCommitTransaction({},{invokeEnv:je})}catch(g){await Xn.dbRollbackTransaction({},{invokeEnv:je}),Gn(g)}}}const Ta=new Map,c_="job",l_="company",u_="company_tag";Ta.set(xT,async r=>m_(r,c_,EF,mH)),Ta.set(kT,async r=>m_(r,l_,SF,vH)),Ta.set(bT,async r=>m_(r,u_,CF,kH)),Ta.set(_T,async r=>p_(r,c_,nb)),Ta.set(ET,async r=>p_(r,l_,ab)),Ta.set(ST,async r=>p_(r,u_,ib)),Ta.set(nb,async r=>f_(r,nb,c_,pH,gH,async t=>{let e=await TH(t,"jobId",async n=>p0.jobGetByIds(n,{invokeEnv:je}));return await p0.batchAddOrUpdateJob(e,{invokeEnv:je}),e.length})),Ta.set(ab,async r=>f_(r,ab,l_,wH,yH,async t=>{let e=await CH(t,"companyId",async n=>Uu.companyGetByIds(n,{invokeEnv:je}));return await Uu.batchAddOrUpdateCompany(e,{invokeEnv:je}),e.length})),Ta.set(ib,async r=>f_(r,ib,u_,xH,bH,async t=>{let e=await AH(t,async n=>await Uu.getAllCompanyTagDTOByCompanyIds(n,{invokeEnv:je}));return await Uu.batchAddOrUpdateCompanyTag(e,{invokeEnv:je}),e.length}));async function _F(){return!!await za()}async function NH(){let r=new VO;r.pageNum=1,r.pageSize=eh,r.statusList=[Jw,CT,TT],r.orderByColumn="createDatetime",r.orderBy="ASC";let t=await fc.searchTask(r,{invokeEnv:je});if(`${t.total}`,t.total>0)for(let e=0;e<t.items.length;e++){let n=t.items[e];`${e}${n.id}${n.type}${n.retryCount}`,n.retryCount=n.retryCount+1;let a=kt();try{if(n.status=CT,await fc.taskAddOrUpdate(n,{invokeEnv:je}),Ta.has(n.type)){let i=await Ta.get(n.type)(n.dataId);i?(n.errorReason=i,n.status=S6):n.status=E6,n.costTime=kt().diff(a),await fc.taskAddOrUpdate(n,{invokeEnv:je})}else throw`[TASK RUN] not supported task type = ${n.type}`}catch(i){n.status=TT,n.errorReason=JSON.stringify(i),n.costTime=kt().diff(a),await fc.taskAddOrUpdate(n,{invokeEnv:je})}}}async function h_({type:r,datetime:t,userName:e,repoName:n}){let a=new YO;a.type=r,a.username=e,a.reponame=n,a.datetime=t;let i=await sk.taskDataDownloadAddOrUpdate(a,{invokeEnv:je}),s=new o_;s.type=r,s.dataId=i.id,s.retryCount=0,s.costTime=0,s.status=Jw,await fc.taskAddOrUpdate(s,{invokeEnv:je})}async function d_({type:r,startDatetime:t,endDatetime:e,userName:n,repoName:a,total:i}){let s=new qO;s.type=r,s.username=n,s.reponame=a,s.startDatetime=t,s.endDatetime=e,s.dataCount=i;let c=await ik.taskDataUploadAddOrUpdate(s,{invokeEnv:je}),l=new o_;l.type=r,l.dataId=c.id,l.retryCount=0,l.costTime=0,l.status=Jw,await fc.taskAddOrUpdate(l,{invokeEnv:je})}async function LH(r){const t=tp.json_to_sheet(r),e=tp.book_new();return tp.book_append_sheet(e,t,"Data"),pF(e,{type:"buffer"})}async function EF({startDatetime:r,endDatetime:t}){let e=new $O;return e.pageNum=1,e.pageSize=eh,e.startDatetimeForUpdate=r,e.endDatetimeForUpdate=t,e.orderByColumn="updateDatetime",e.orderBy="DESC",p0.searchJob(e,{invokeEnv:je})}async function SF({startDatetime:r,endDatetime:t}){let e=new zO;return e.pageNum=1,e.pageSize=eh,e.startDatetimeForUpdate=r,e.endDatetimeForUpdate=t,e.orderByColumn="updateDatetime",e.orderBy="DESC",Uu.searchCompany(e,{invokeEnv:je})}async function CF({startDatetime:r,endDatetime:t}){let e=new WO;return e.pageNum=1,e.pageSize=eh,e.startDatetimeForUpdate=r,e.endDatetimeForUpdate=t,e.orderByColumn="updateDatetime",e.orderBy="DESC",Uu.searchCompanyTag(e,{invokeEnv:je})}async function BH({userName:r,repoName:t,dirPath:e,dataTypeName:n,dataList:a,jsonObjectToExcelJsonArrayFunction:i}){if(a.length>0){lt(`[Task Data Upload ${n}] data length = ${a.length}`);let s=i(a),c=await LH(s),l=await UH(n,c),u=`${e}/${n}.zip`;try{let h=await Bc.createFileContent(r,t,u,l,"upload job data",{getTokenFunction:za,setTokenFunction:Mi});return lt(`[Task Data Upload ${n}] create file ${u} success`),h}catch(h){if(h==aa.CREATION_FAILED)lt(`[Task Data Upload ${n}] create file ${u} failure`);else throw h}}else lt(`[Task Data Upload ${n}] no data`)}async function UH(r,t){return new Promise((n,a)=>{const i=new bF;i.file(`${r}.xlsx`,t),i.generateAsync({compression:"DEFLATE",compressionOptions:{level:9},type:"base64"}).then(function(s){n(s)}).catch(s=>{a(s)})})}async function $H({userName:r,repoName:t}){try{await Bc.getRepo(r,t,{getTokenFunction:za,setTokenFunction:Mi}),lt(`[Task Data] repo ${t} exists`)}catch(e){if(lt(`[Task Data] repo ${t} exists not exists`),lt(`[Task Data] create a new repo ${t}`),e==aa.NOT_FOUND)await Bc.newRepo(t,{getTokenFunction:za,setTokenFunction:Mi}),lt(`create a new repo ${t} success`);else throw e}}async function f_(r,t,e,n,a,i){const s=await ok.taskDataMergeGetById(r,{invokeEnv:je});`${s.dataId}`;const c=await v2.fileGetById(s.dataId,{invokeEnv:je});`${c.id}${c.name}`;let l=c.content,u=await jH(l,e),h=t_(u,{type:"buffer"}),d=fH(tp.sheet_to_json(h.Sheets[h.SheetNames[0]],{header:1}),n);if(!d.validResult)return`${c.name}${c.id}`,`职位文件校验失败，缺少数据列(${d.lackColumn.length}):${d.lackColumn.join(",")}`;`${c.name}${c.id}`;const f=tp.sheet_to_json(h.Sheets[h.SheetNames[0]],{header:2});try{await Xn.dbBeginTransaction({},{invokeEnv:je});let m=await i(a(f));s.dataCount=m,await ok.taskDataMergeAddOrUpdate(s,{invokeEnv:je}),await Xn.dbCommitTransaction({},{invokeEnv:je}),`${c.name}${c.id}${m}`}catch(m){throw await Xn.dbRollbackTransaction({},{invokeEnv:je}),m}}async function jH(r,t){return new Promise((n,a)=>{bF.loadAsync(r,{base64:!0}).then(async i=>{let s=i.file(`${t}.xlsx`);n(await s.async("arraybuffer"))}).catch(i=>{a(i)})})}async function p_(r,t,e){if(!await _F())throw lt(`[TASK HANDLE]No login info, skip run task dataId = ${r}, dataTypeName = ${t}`),aa.NO_LOGIN;let n=await sk.taskDataDownloadGetById(r,{invokeEnv:je}),a=n.username,i=n.reponame,s=n.datetime;const c=TF({datetime:s})+`/${t}.zip`;let l=null;try{if(l=await Bc.listRepoContents(a,i,c,{getTokenFunction:za,setTokenFunction:Mi}),l.type=="file")try{await Xn.dbBeginTransaction({},{invokeEnv:je});const u=new GO;u.name=l.name,u.sha=l.sha,u.encoding=l.encoding,u.content=l.content,u.size=l.size,u.type=l.type;const h=await v2.fileAddOrUpdate(u,{invokeEnv:je});lt(`[TASK DOWNLOAD DATA] save file to database from ${a}.${i}.${c}, id = ${h.id}`);const d=new JO;d.type=e,d.username=a,d.reponame=i,d.datetime=s,d.dataId=h.id;const f=await ok.taskDataMergeAddOrUpdate(d,{invokeEnv:je});lt(`[TASK DOWNLOAD DATA] merge task to database from ${a}.${i}.${c}, id = ${f.id}, dataId = ${r}`);let m=new o_;m.type=e,m.dataId=f.id,m.retryCount=0,m.costTime=0,m.status=Jw;const w=await fc.taskAddOrUpdate(m,{invokeEnv:je});lt(`[TASK DOWNLOAD DATA] add task to database from task type = ${e}, dataId = ${m.dataId}, id = ${w.id}`),await Xn.dbCommitTransaction({},{invokeEnv:je})}catch(u){throw await Xn.dbRollbackTransaction({},{invokeEnv:je}),u}else throw`unknown content type = ${l.type}`}catch(u){if(u==aa.NOT_FOUND){let h=new Date;if(kt(s).isBefore(kt(h).startOf("day").subtract(1,"day")))return`${a}${i}${c}${s}${g2(h)}`,`file ${a}.${i}.${c} never upload`;throw`File not found,file ${a}.${i}.${c} continue download in next time`}else throw u}}async function m_(r,t,e,n){if(!await _F())throw aa.NO_LOGIN;let a=await ik.taskDataUploadGetById(r,{invokeEnv:je}),i=a.username,s=a.reponame,c=a.startDatetime,l=a.endDatetime,u=TF({endDatetime:l});await $H({userName:i,repoName:s}),await BH({userName:i,repoName:s,dirPath:u,dataTypeName:t,dataList:(await e({startDatetime:c,endDatetime:l})).items,jsonObjectToExcelJsonArrayFunction:n})}function TF({datetime:r}){return`/${kt(r).format("YYYY")}/${kt(r).format("MM-DD")}`}class HH{constructor(){H(this,"enable")}}chrome.runtime.onInstalled.addListener(async()=>{const r=[{id:1,action:{type:chrome.declarativeNetRequest.RuleActionType.MODIFY_HEADERS,requestHeaders:[{header:"Referer",operation:chrome.declarativeNetRequest.HeaderOperation.SET,value:"https://creditbj.jxj.beijing.gov.cn/credit-portal/credit_service/publicity/record/black"}]},condition:{initiatorDomains:[chrome.runtime.id],urlFilter:"|https://creditbj.jxj.beijing.gov.cn/credit-portal/api/publicity/record/BLACK/0",resourceTypes:[chrome.declarativeNetRequest.ResourceType.XMLHTTPREQUEST]}}];await chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:r.map(t=>t.id),addRules:r})});const AF=()=>setInterval(chrome.runtime.getPlatformInfo,2e4);chrome.runtime.onStartup.addListener(AF),AF(),chrome.action.onClicked.addListener(()=>{chrome.tabs.create({url:"src/sidepanel/index.html"})});const FF=new Map,PF=new Map;chrome.tabs.onUpdated.addListener(async(r,t,e)=>{let n=e.url;if(n!=null&&n.startsWith(iM)&&!WH(n)){let a=gM();zH(n);let i=new URL(n);if(i.searchParams.has("error"))a.keys().forEach(s=>{Wa(s)}),a.clear();else{let s=i.searchParams.get("code");try{const c=new URLSearchParams({client_id:ck,client_secret:k2,code:s});let l=`${b2}?${c.toString()}`,u=await tM(l,g=>{},{invokeEnv:je}),h=new URLSearchParams(u);const d=MO(h);let f=hw(new ak,d);await Mi(f);let m=await rM({url:_2,headers:{Authorization:`Bearer ${f.accessToken}`}},g=>{},{invokeEnv:je}),w=hw(new hk,m);await A2(w);let p=await za();a.keys().forEach(g=>{pc(g,p)}),chrome.tabs.remove(r),a.clear()}catch(c){Gn(c),a.keys().forEach(l=>{Wa(l)})}}return}if((t==null?void 0:t.status)=="complete"&&!KH(e.id)&&e.url){let a=OO(e.url),i=await p0.getJobByDetailUrl(a,{invokeEnv:je});i&&(lt(`save jobBrowseDetailHistory start jobId = ${i.jobId}`),await p0.addJobBrowseDetailHistory(i.jobId,{invokeEnv:je}),lt(`save jobBrowseDetailHistory success jobId = ${i.jobId}`),VH(e.id))}});function WH(r){return PF.has(r)}function zH(r){PF.set(r,null)}function KH(r){return FF.has(r)}function VH(r){FF.set(r,null)}const fh=new Map;function Iv(r,t){let e=Object.keys(t);for(let n=0;n<e.length;n++){let a=e[n];r.set(a,t[a])}}Iv(fh,mM),Iv(fh,wM),Iv(fh,vM),Iv(fh,T6);let rp;async function qH(r){var t,e;if(!await((e=(t=chrome.offscreen).hasDocument)==null?void 0:e.call(t))){if(rp)await rp;else{rp=chrome.offscreen.createDocument({url:chrome.runtime.getURL(r),reasons:[chrome.offscreen.Reason.WORKERS||chrome.offscreen.Reason.BLOBS],justification:"To run web worker to run sqlite"}),await rp,rp=null;let n=0,a=!1;const i=async()=>{if(!a){a=!0;try{n+=1,lt(`[Task] Task run seq = < ${n} >`);let s=new HH,c=await m0.getConfigByKey(pM,{invokeEnv:je});if(c&&c.value&&(s=JSON.parse(c.value)),s.enable){lt("[TASK] Data share plan enable"),lt("[TASK] Data share plan task running");let l=await F2();if(l){let u=l.login,h=E2;lt(`[Task] has login info userName = ${u}`),lt("[Task] calculateUploadTask"),await MH({userName:u,repoName:h});let d=[{username:u,reponame:E2}],f=await OH();d.push(...f),lt(`[TASK] Share data plan list length = ${d.length}`);for(let m=0;m<d.length;m++){let w=d[m];await RH({userName:w.username,repoName:w.reponame})}lt("[TASK] runTask"),await NH()}else lt("[TASK] no login info"),lt("[TASK] skip data share plan")}else lt("[TASK] Data share plan disable"),lt("[TASK] Data share plan task skip")}catch(s){Gn(s)}a=!1,await f0(fM,0),i()}};i()}chrome.runtime.onMessage.addListener(async function(n,a,i){if(n){if(n.from==Le&&n.to==je){a.tab&&(n.tabId=a.tab.id),""+n.from+n.to+n.action+n.invokeEnv+n.callbackId+n.error;let s=n.action;fh.has(s)?fh.get(s)(n,n.param):(n.from=je,n.to=ek,""+n.from+n.to+n.action+n.invokeEnv+n.callbackId+n.error,chrome.runtime.sendMessage(n))}else if(n.from==ek&&n.to==je){if(""+n.from+n.to+n.action+n.invokeEnv+n.callbackId+n.error,n.invokeEnv==Le)n.from=je,n.to=Le,""+n.from+n.to+n.action+n.invokeEnv+n.callbackId+n.error,n.tabId?chrome.tabs.sendMessage(n.tabId,n):chrome.runtime.sendMessage(n);else if(n.invokeEnv==je){let s=BO(n.callbackId);s?n.error?(n.message=n.error,s.reject(n)):s.resolve(n):Gn(`callbackId = ${n.callbackId} lost callback promiseHook`)}}}})}}qH("src/offscreen/offscreen.html");var g_={exports:{}},w_,IF;function GH(){if(IF)return w_;IF=1;var r=1e3,t=r*60,e=t*60,n=e*24,a=n*7,i=n*365.25;w_=function(h,d){d=d||{};var f=typeof h;if(f==="string"&&h.length>0)return s(h);if(f==="number"&&isFinite(h))return d.long?l(h):c(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))};function s(h){if(h=String(h),!(h.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(d){var f=parseFloat(d[1]),m=(d[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return f*i;case"weeks":case"week":case"w":return f*a;case"days":case"day":case"d":return f*n;case"hours":case"hour":case"hrs":case"hr":case"h":return f*e;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function c(h){var d=Math.abs(h);return d>=n?Math.round(h/n)+"d":d>=e?Math.round(h/e)+"h":d>=t?Math.round(h/t)+"m":d>=r?Math.round(h/r)+"s":h+"ms"}function l(h){var d=Math.abs(h);return d>=n?u(h,d,n,"day"):d>=e?u(h,d,e,"hour"):d>=t?u(h,d,t,"minute"):d>=r?u(h,d,r,"second"):h+" ms"}function u(h,d,f,m){var w=d>=f*1.5;return Math.round(h/f)+" "+m+(w?"s":"")}return w_}function XH(r){e.debug=e,e.default=e,e.coerce=l,e.disable=i,e.enable=a,e.enabled=s,e.humanize=GH(),e.destroy=u,Object.keys(r).forEach(h=>{e[h]=r[h]}),e.names=[],e.skips=[],e.formatters={};function t(h){let d=0;for(let f=0;f<h.length;f++)d=(d<<5)-d+h.charCodeAt(f),d|=0;return e.colors[Math.abs(d)%e.colors.length]}e.selectColor=t;function e(h){let d,f=null,m,w;function p(...g){if(!p.enabled)return;const v=p,k=Number(new Date),x=k-(d||k);v.diff=x,v.prev=d,v.curr=k,d=k,g[0]=e.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let S=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(O,E)=>{if(O==="%%")return"%";S++;const T=e.formatters[E];if(typeof T=="function"){const P=g[S];O=T.call(v,P),g.splice(S,1),S--}return O}),e.formatArgs.call(v,g),(v.log||e.log).apply(v,g)}return p.namespace=h,p.useColors=e.useColors(),p.color=e.selectColor(h),p.extend=n,p.destroy=e.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(m!==e.namespaces&&(m=e.namespaces,w=e.enabled(h)),w),set:g=>{f=g}}),typeof e.init=="function"&&e.init(p),p}function n(h,d){const f=e(this.namespace+(typeof d>"u"?":":d)+h);return f.log=this.log,f}function a(h){e.save(h),e.namespaces=h,e.names=[],e.skips=[];let d;const f=(typeof h=="string"?h:"").split(/[\s,]+/),m=f.length;for(d=0;d<m;d++)f[d]&&(h=f[d].replace(/\*/g,".*?"),h[0]==="-"?e.skips.push(new RegExp("^"+h.slice(1)+"$")):e.names.push(new RegExp("^"+h+"$")))}function i(){const h=[...e.names.map(c),...e.skips.map(c).map(d=>"-"+d)].join(",");return e.enable(""),h}function s(h){if(h[h.length-1]==="*")return!0;let d,f;for(d=0,f=e.skips.length;d<f;d++)if(e.skips[d].test(h))return!1;for(d=0,f=e.names.length;d<f;d++)if(e.names[d].test(h))return!0;return!1}function c(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function l(h){return h instanceof Error?h.stack||h.message:h}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}var YH=XH;(function(r,t){t.formatArgs=n,t.save=a,t.load=i,t.useColors=e,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function e(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let h=0,d=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(h++,f==="%c"&&(d=h))}),l.splice(d,0,u)}t.log=console.debug||console.log||(()=>{});function a(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=process.env.DEBUG),l}function s(){try{return localStorage}catch{}}r.exports=YH(t);const{formatters:c}=r.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(g_,g_.exports);var JH=g_.exports;const ZH=Object.freeze(Object.defineProperty({__proto__:null,default:at(JH)},Symbol.toStringTag,{value:"Module"}));var Dv={},Ov={},Uc={};function QH(r){return{all:r=r||new Map,on:function(t,e){var n=r.get(t);n?n.push(e):r.set(t,[e])},off:function(t,e){var n=r.get(t);n&&(e?n.splice(n.indexOf(e)>>>0,1):r.set(t,[]))},emit:function(t,e){var n=r.get(t);n&&n.slice().map(function(a){a(e)}),(n=r.get("*"))&&n.slice().map(function(a){a(t,e)})}}}const eW=Ut(Object.freeze(Object.defineProperty({__proto__:null,default:QH},Symbol.toStringTag,{value:"Module"})));var tW=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.EventEmitter=void 0;const rW=tW(eW);class nW{constructor(){y(this,$o,(0,rW.default)())}on(t,e){return o(this,$o).on(t,e),this}once(t,e){const n=a=>{e(a),this.off(t,n)};return this.on(t,n)}off(t,e){return o(this,$o).off(t,e),this}emit(t,e){o(this,$o).emit(t,e)}removeAllListeners(t){return t?o(this,$o).all.delete(t):o(this,$o).all.clear(),this}}$o=new WeakMap,Uc.EventEmitter=nW;var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.LogType=void 0;var DF;(function(r){r.bidi="bidi",r.cdp="cdp",r.debug="debug",r.debugError="debug:error",r.debugInfo="debug:info"})(DF||(Cn.LogType=DF={}));var Mv={},OF;Object.defineProperty(Mv,"__esModule",{value:!0}),Mv.ProcessingQueue=void 0;const v_=Cn;class y_{constructor(t,e){y(this,Xy);y(this,zl);y(this,Ag);y(this,Kd,[]);y(this,Vd,!1);_(this,Ag,t),_(this,zl,e)}add(t,e){o(this,Kd).push([t,e]),F(this,Xy,PI).call(this)}}zl=new WeakMap,Ag=new WeakMap,Kd=new WeakMap,Vd=new WeakMap,Xy=new WeakSet,PI=async function(){var t;if(!o(this,Vd)){for(_(this,Vd,!0);o(this,Kd).length>0;){const e=o(this,Kd).shift();if(!e)continue;const[n,a]=e;(t=o(this,zl))==null||t.call(this,OF.LOGGER_PREFIX,"Processing event:",a),await n.then(i=>{var s;if(i.kind==="error"){(s=o(this,zl))==null||s.call(this,v_.LogType.debugError,"Event threw before sending:",i.error.message,i.error.stack);return}return o(this,Ag).call(this,i.value)}).catch(i=>{var s;(s=o(this,zl))==null||s.call(this,v_.LogType.debugError,"Event was not processed:",i==null?void 0:i.message)})}_(this,Vd,!1)}},H(y_,"LOGGER_PREFIX",`${v_.LogType.debug}:queue`),Mv.ProcessingQueue=y_,OF=y_;var Rv={},At={},MF={};Object.defineProperty(MF,"__esModule",{value:!0});var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.EVENT_NAMES=Kr.Bluetooth=Kr.Network=Kr.BrowsingContext=Kr.Log=Kr.Script=Kr.BiDiModule=void 0;var x_;(function(r){r.Bluetooth="bluetooth",r.Browser="browser",r.BrowsingContext="browsingContext",r.Cdp="cdp",r.Input="input",r.Log="log",r.Network="network",r.Script="script",r.Session="session"})(x_||(Kr.BiDiModule=x_={}));var k_;(function(r){(function(t){t.Message="script.message",t.RealmCreated="script.realmCreated",t.RealmDestroyed="script.realmDestroyed"})(r.EventNames||(r.EventNames={}))})(k_||(Kr.Script=k_={}));var b_;(function(r){(function(t){t.LogEntryAdded="log.entryAdded"})(r.EventNames||(r.EventNames={}))})(b_||(Kr.Log=b_={}));var __;(function(r){(function(t){t.ContextCreated="browsingContext.contextCreated",t.ContextDestroyed="browsingContext.contextDestroyed",t.DomContentLoaded="browsingContext.domContentLoaded",t.DownloadWillBegin="browsingContext.downloadWillBegin",t.FragmentNavigated="browsingContext.fragmentNavigated",t.Load="browsingContext.load",t.NavigationAborted="browsingContext.navigationAborted",t.NavigationFailed="browsingContext.navigationFailed",t.NavigationStarted="browsingContext.navigationStarted",t.UserPromptClosed="browsingContext.userPromptClosed",t.UserPromptOpened="browsingContext.userPromptOpened"})(r.EventNames||(r.EventNames={}))})(__||(Kr.BrowsingContext=__={}));var E_;(function(r){(function(t){t.AuthRequired="network.authRequired",t.BeforeRequestSent="network.beforeRequestSent",t.FetchError="network.fetchError",t.ResponseCompleted="network.responseCompleted",t.ResponseStarted="network.responseStarted"})(r.EventNames||(r.EventNames={}))})(E_||(Kr.Network=E_={}));var RF;(function(r){(function(t){t.RequestDevicePromptUpdated="bluetooth.requestDevicePromptUpdated"})(r.EventNames||(r.EventNames={}))})(RF||(Kr.Bluetooth=RF={})),Kr.EVENT_NAMES=new Set([...Object.values(x_),...Object.values(__.EventNames),...Object.values(b_.EventNames),...Object.values(E_.EventNames),...Object.values(k_.EventNames)]);var NF={};Object.defineProperty(NF,"__esModule",{value:!0});var We={};Object.defineProperty(We,"__esModule",{value:!0}),We.UnderspecifiedStoragePartitionException=We.UnableToSetFileInputException=We.UnableToSetCookieException=We.NoSuchStoragePartitionException=We.UnsupportedOperationException=We.UnableToCloseBrowserException=We.UnableToCaptureScreenException=We.UnknownErrorException=We.UnknownCommandException=We.SessionNotCreatedException=We.NoSuchUserContextException=We.NoSuchScriptException=We.NoSuchRequestException=We.NoSuchNodeException=We.NoSuchInterceptException=We.NoSuchHistoryEntryException=We.NoSuchHandleException=We.NoSuchFrameException=We.NoSuchElementException=We.NoSuchAlertException=We.MoveTargetOutOfBoundsException=We.InvalidSessionIdException=We.InvalidSelectorException=We.InvalidArgumentException=We.Exception=void 0;class Mt extends Error{constructor(e,n,a){super();H(this,"error");H(this,"message");H(this,"stacktrace");this.error=e,this.message=n,this.stacktrace=a}toErrorResponse(e){return{type:"error",id:e,error:this.error,message:this.message,stacktrace:this.stacktrace}}}We.Exception=Mt;class aW extends Mt{constructor(t,e){super("invalid argument",t,e)}}We.InvalidArgumentException=aW;class iW extends Mt{constructor(t,e){super("invalid selector",t,e)}}We.InvalidSelectorException=iW;class sW extends Mt{constructor(t,e){super("invalid session id",t,e)}}We.InvalidSessionIdException=sW;class oW extends Mt{constructor(t,e){super("move target out of bounds",t,e)}}We.MoveTargetOutOfBoundsException=oW;class cW extends Mt{constructor(t,e){super("no such alert",t,e)}}We.NoSuchAlertException=cW;class lW extends Mt{constructor(t,e){super("no such element",t,e)}}We.NoSuchElementException=lW;class uW extends Mt{constructor(t,e){super("no such frame",t,e)}}We.NoSuchFrameException=uW;class hW extends Mt{constructor(t,e){super("no such handle",t,e)}}We.NoSuchHandleException=hW;class dW extends Mt{constructor(t,e){super("no such history entry",t,e)}}We.NoSuchHistoryEntryException=dW;class fW extends Mt{constructor(t,e){super("no such intercept",t,e)}}We.NoSuchInterceptException=fW;class pW extends Mt{constructor(t,e){super("no such node",t,e)}}We.NoSuchNodeException=pW;class mW extends Mt{constructor(t,e){super("no such request",t,e)}}We.NoSuchRequestException=mW;class gW extends Mt{constructor(t,e){super("no such script",t,e)}}We.NoSuchScriptException=gW;class wW extends Mt{constructor(t,e){super("no such user context",t,e)}}We.NoSuchUserContextException=wW;class vW extends Mt{constructor(t,e){super("session not created",t,e)}}We.SessionNotCreatedException=vW;class yW extends Mt{constructor(t,e){super("unknown command",t,e)}}We.UnknownCommandException=yW;class xW extends Mt{constructor(t,e=new Error().stack){super("unknown error",t,e)}}We.UnknownErrorException=xW;class kW extends Mt{constructor(t,e){super("unable to capture screen",t,e)}}We.UnableToCaptureScreenException=kW;class bW extends Mt{constructor(t,e){super("unable to close browser",t,e)}}We.UnableToCloseBrowserException=bW;class _W extends Mt{constructor(t,e){super("unsupported operation",t,e)}}We.UnsupportedOperationException=_W;class EW extends Mt{constructor(t,e){super("no such storage partition",t,e)}}We.NoSuchStoragePartitionException=EW;class SW extends Mt{constructor(t,e){super("unable to set cookie",t,e)}}We.UnableToSetCookieException=SW;class CW extends Mt{constructor(t,e){super("unable to set file input",t,e)}}We.UnableToSetFileInputException=CW;class TW extends Mt{constructor(t,e){super("underspecified storage partition",t,e)}}We.UnderspecifiedStoragePartitionException=TW;var LF={};Object.defineProperty(LF,"__esModule",{value:!0});var BF={};Object.defineProperty(BF,"__esModule",{value:!0}),function(r){var t=Ke&&Ke.__createBinding||(Object.create?function(i,s,c,l){l===void 0&&(l=c);var u=Object.getOwnPropertyDescriptor(s,c);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[c]}}),Object.defineProperty(i,l,u)}:function(i,s,c,l){l===void 0&&(l=c),i[l]=s[c]}),e=Ke&&Ke.__setModuleDefault||(Object.create?function(i,s){Object.defineProperty(i,"default",{enumerable:!0,value:s})}:function(i,s){i.default=s}),n=Ke&&Ke.__importStar||function(i){if(i&&i.__esModule)return i;var s={};if(i!=null)for(var c in i)c!=="default"&&Object.prototype.hasOwnProperty.call(i,c)&&t(s,i,c);return e(s,i),s},a=Ke&&Ke.__exportStar||function(i,s){for(var c in i)c!=="default"&&!Object.prototype.hasOwnProperty.call(s,c)&&t(s,i,c)};Object.defineProperty(r,"__esModule",{value:!0}),r.ChromiumBidi=r.Cdp=void 0,r.Cdp=n(MF),r.ChromiumBidi=n(Kr),a(NF,r),a(We,r),a(LF,r),a(BF,r)}(At);var Nv={};Object.defineProperty(Nv,"__esModule",{value:!0}),Nv.BidiNoOpParser=void 0;class AW{parseHandleRequestDevicePromptParams(t){return t}parseRemoveUserContextParams(t){return t}parseActivateParams(t){return t}parseCaptureScreenshotParams(t){return t}parseCloseParams(t){return t}parseCreateParams(t){return t}parseGetTreeParams(t){return t}parseHandleUserPromptParams(t){return t}parseLocateNodesParams(t){return t}parseNavigateParams(t){return t}parsePrintParams(t){return t}parseReloadParams(t){return t}parseSetViewportParams(t){return t}parseTraverseHistoryParams(t){return t}parseGetSessionParams(t){return t}parseResolveRealmParams(t){return t}parseSendCommandParams(t){return t}parseAddPreloadScriptParams(t){return t}parseCallFunctionParams(t){return t}parseDisownParams(t){return t}parseEvaluateParams(t){return t}parseGetRealmsParams(t){return t}parseRemovePreloadScriptParams(t){return t}parsePerformActionsParams(t){return t}parseReleaseActionsParams(t){return t}parseSetFilesParams(t){return t}parseAddInterceptParams(t){return t}parseContinueRequestParams(t){return t}parseContinueResponseParams(t){return t}parseContinueWithAuthParams(t){return t}parseFailRequestParams(t){return t}parseProvideResponseParams(t){return t}parseRemoveInterceptParams(t){return t}parseSetCacheBehavior(t){return t}parseSetPermissionsParams(t){return t}parseSubscribeParams(t){return t}parseDeleteCookiesParams(t){return t}parseGetCookiesParams(t){return t}parseSetCookieParams(t){return t}}Nv.BidiNoOpParser=AW;var Lv={};Object.defineProperty(Lv,"__esModule",{value:!0}),Lv.BrowserProcessor=void 0;const UF=At;class FW{constructor(t){y(this,jo);_(this,jo,t)}close(){return setTimeout(()=>o(this,jo).sendCommand("Browser.close"),0),{}}async createUserContext(t){const e={proxyServer:t["goog:proxyServer"]??void 0},n=t["goog:proxyBypassList"]??void 0;return n&&(e.proxyBypassList=n.join(",")),{userContext:(await o(this,jo).sendCommand("Target.createBrowserContext",e)).browserContextId}}async removeUserContext(t){const e=t.userContext;if(e==="default")throw new UF.InvalidArgumentException("`default` user context cannot be removed");try{await o(this,jo).sendCommand("Target.disposeBrowserContext",{browserContextId:e})}catch(n){throw n.message.startsWith("Failed to find context with id")?new UF.NoSuchUserContextException(n.message):n}return{}}async getUserContexts(){const t=await o(this,jo).sendCommand("Target.getBrowserContexts");return{userContexts:[{userContext:"default"},...t.browserContextIds.map(e=>({userContext:e}))]}}}jo=new WeakMap,Lv.BrowserProcessor=FW;var Bv={};Object.defineProperty(Bv,"__esModule",{value:!0}),Bv.CdpProcessor=void 0;const PW=At;class IW{constructor(t,e,n,a){y(this,Fg);y(this,Pg);y(this,Ig);y(this,Dg);_(this,Fg,t),_(this,Pg,e),_(this,Ig,n),_(this,Dg,a)}getSession(t){const e=t.context,n=o(this,Fg).getContext(e).cdpTarget.cdpSessionId;return n===void 0?{}:{session:n}}resolveRealm(t){const e=t.realm,n=o(this,Pg).getRealm({realmId:e});if(n===void 0)throw new PW.UnknownErrorException(`Could not find realm ${t.realm}`);return{executionContextId:n.executionContextId}}async sendCommand(t){return{result:await(t.session?o(this,Ig).getCdpClient(t.session):o(this,Dg)).sendCommand(t.method,t.params),session:t.session}}}Fg=new WeakMap,Pg=new WeakMap,Ig=new WeakMap,Dg=new WeakMap,Bv.CdpProcessor=IW;var Uv={};Object.defineProperty(Uv,"__esModule",{value:!0}),Uv.BrowsingContextProcessor=void 0;const ni=At;class DW{constructor(t,e,n){y(this,Yy);y(this,Ho);y(this,Qt);y(this,qd);_(this,Ho,t),_(this,Qt,e),_(this,qd,n),o(this,qd).addSubscribeHook(ni.ChromiumBidi.BrowsingContext.EventNames.ContextCreated,F(this,Yy,II).bind(this))}getTree(t){return{contexts:(t.root===void 0?o(this,Qt).getTopLevelContexts():[o(this,Qt).getContext(t.root)]).map(n=>n.serializeToBidiValue(t.maxDepth??Number.MAX_VALUE))}}async create(t){let e,n="default";if(t.referenceContext!==void 0){if(e=o(this,Qt).getContext(t.referenceContext),!e.isTopLevelContext())throw new ni.InvalidArgumentException("referenceContext should be a top-level context");n=e.userContext}t.userContext!==void 0&&(n=t.userContext);const a=o(this,Qt).getAllContexts().filter(u=>u.userContext===n);let i=!1;switch(t.type){case"tab":i=!1;break;case"window":i=!0;break}a.length||(i=!0);let s;try{s=await o(this,Ho).sendCommand("Target.createTarget",{url:"about:blank",newWindow:i,browserContextId:n==="default"?void 0:n,background:t.background===!0})}catch(u){throw u.message.startsWith("Failed to find browser context with id")||u.message==="browserContextId"?new ni.NoSuchUserContextException(`The context ${n} was not found`):u}const c=s.targetId,l=o(this,Qt).getContext(c);return await l.lifecycleLoaded(),{context:l.id}}navigate(t){return o(this,Qt).getContext(t.context).navigate(t.url,t.wait??"none")}reload(t){return o(this,Qt).getContext(t.context).reload(t.ignoreCache??!1,t.wait??"none")}async activate(t){const e=o(this,Qt).getContext(t.context);if(!e.isTopLevelContext())throw new ni.InvalidArgumentException("Activation is only supported on the top-level context");return await e.activate(),{}}async captureScreenshot(t){return await o(this,Qt).getContext(t.context).captureScreenshot(t)}async print(t){return await o(this,Qt).getContext(t.context).print(t)}async setViewport(t){const e=o(this,Qt).getContext(t.context);if(!e.isTopLevelContext())throw new ni.InvalidArgumentException("Emulating viewport is only supported on the top-level context");return await e.setViewport(t.viewport,t.devicePixelRatio),{}}async traverseHistory(t){const e=o(this,Qt).getContext(t.context);if(!e)throw new ni.InvalidArgumentException(`No browsing context with id ${t.context}`);if(!e.isTopLevelContext())throw new ni.InvalidArgumentException("Traversing history is only supported on the top-level context");return await e.traverseHistory(t.delta),{}}async handleUserPrompt(t){var n;const e=o(this,Qt).getContext(t.context);try{await e.handleUserPrompt(t.accept,t.userText)}catch(a){throw(n=a.message)!=null&&n.includes("No dialog is showing")?new ni.NoSuchAlertException("No dialog is showing"):a}return{}}async close(t){const e=o(this,Qt).getContext(t.context);if(!e.isTopLevelContext())throw new ni.InvalidArgumentException(`Non top-level browsing context ${e.id} cannot be closed.`);try{const n=new Promise(a=>{const i=s=>{s.targetId===t.context&&(o(this,Ho).off("Target.detachedFromTarget",i),a())};o(this,Ho).on("Target.detachedFromTarget",i)});t.promptUnload?await e.close():await o(this,Ho).sendCommand("Target.closeTarget",{targetId:t.context}),await n}catch(n){if(!(n.code===-32e3&&n.message==="Not attached to an active page"))throw n}return{}}async locateNodes(t){return await o(this,Qt).getContext(t.context).locateNodes(t)}}Ho=new WeakMap,Qt=new WeakMap,qd=new WeakMap,Yy=new WeakSet,II=function(t){return[o(this,Qt).getContext(t),...o(this,Qt).getContext(t).allChildren].forEach(a=>{o(this,qd).registerEvent({type:"event",method:ni.ChromiumBidi.BrowsingContext.EventNames.ContextCreated,params:a.serializeToBidiValue()},a.id)}),Promise.resolve()},Uv.BrowsingContextProcessor=DW;var $v={},zi={};Object.defineProperty(zi,"__esModule",{value:!0}),zi.assert=OW;function OW(r,t){if(!r)throw new Error(t??"Internal assertion failed.")}var jv={},Hv={};Object.defineProperty(Hv,"__esModule",{value:!0}),Hv.isSingleComplexGrapheme=MW,Hv.isSingleGrapheme=$F;function MW(r){return $F(r)&&r.length>1}function $F(r){return[...new Intl.Segmenter("en",{granularity:"grapheme"}).segment(r)].length===1}var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.WheelSource=Aa.PointerSource=Aa.KeySource=Aa.NoneSource=void 0;class RW{constructor(){H(this,"type","none")}}Aa.NoneSource=RW;class NW{constructor(){y(this,Kl);H(this,"type","key");H(this,"pressed",new Set);y(this,pi,0)}get modifiers(){return o(this,pi)}get alt(){return(o(this,pi)&1)===1}set alt(t){F(this,Kl,aw).call(this,t,1)}get ctrl(){return(o(this,pi)&2)===2}set ctrl(t){F(this,Kl,aw).call(this,t,2)}get meta(){return(o(this,pi)&4)===4}set meta(t){F(this,Kl,aw).call(this,t,4)}get shift(){return(o(this,pi)&8)===8}set shift(t){F(this,Kl,aw).call(this,t,8)}}pi=new WeakMap,Kl=new WeakSet,aw=function(t,e){t?_(this,pi,o(this,pi)|e):_(this,pi,o(this,pi)&~e)},Aa.KeySource=NW;class jF{constructor(t,e){H(this,"type","pointer");H(this,"subtype");H(this,"pointerId");H(this,"pressed",new Set);H(this,"x",0);H(this,"y",0);H(this,"radiusX");H(this,"radiusY");H(this,"force");y(this,Jd,new Map);this.pointerId=t,this.subtype=e}get buttons(){let t=0;for(const e of this.pressed)switch(e){case 0:t|=1;break;case 1:t|=4;break;case 2:t|=2;break;case 3:t|=8;break;case 4:t|=16;break}return t}setClickCount(t,e){let n=o(this,Jd).get(t);return(!n||n.compare(e))&&(n=e),++n.count,o(this,Jd).set(t,n),n.count}getClickCount(t){var e;return((e=o(this,Jd).get(t))==null?void 0:e.count)??0}}Jd=new WeakMap,H(jF,"ClickContext",(mi=class{constructor(e,n,a){H(this,"count",0);y(this,Gd);y(this,Xd);y(this,Yd);_(this,Gd,e),_(this,Xd,n),_(this,Yd,a)}compare(e){return o(e,Yd)-o(this,Yd)>o(mi,Jy)||Math.abs(o(e,Gd)-o(this,Gd))>o(mi,Og)||Math.abs(o(e,Xd)-o(this,Xd))>o(mi,Og)}},Jy=new WeakMap,Og=new WeakMap,Gd=new WeakMap,Xd=new WeakMap,Yd=new WeakMap,y(mi,Jy,500),y(mi,Og,2),mi)),Aa.PointerSource=jF;class LW{constructor(){H(this,"type","wheel")}}Aa.WheelSource=LW;var np={};Object.defineProperty(np,"__esModule",{value:!0}),np.getNormalizedKey=BW,np.getKeyCode=UW,np.getKeyLocation=$W;function BW(r){switch(r){case"":return"Unidentified";case"":return"Cancel";case"":return"Help";case"":return"Backspace";case"":return"Tab";case"":return"Clear";case"":case"":return"Enter";case"":return"Shift";case"":return"Control";case"":return"Alt";case"":return"Pause";case"":return"Escape";case"":return" ";case"":return"PageUp";case"":return"PageDown";case"":return"End";case"":return"Home";case"":return"ArrowLeft";case"":return"ArrowUp";case"":return"ArrowRight";case"":return"ArrowDown";case"":return"Insert";case"":return"Delete";case"":return";";case"":return"=";case"":return"0";case"":return"1";case"":return"2";case"":return"3";case"":return"4";case"":return"5";case"":return"6";case"":return"7";case"":return"8";case"":return"9";case"":return"*";case"":return"+";case"":return",";case"":return"-";case"":return".";case"":return"/";case"":return"F1";case"":return"F2";case"":return"F3";case"":return"F4";case"":return"F5";case"":return"F6";case"":return"F7";case"":return"F8";case"":return"F9";case"":return"F10";case"":return"F11";case"":return"F12";case"":return"Meta";case"":return"ZenkakuHankaku";case"":return"Shift";case"":return"Control";case"":return"Alt";case"":return"Meta";case"":return"PageUp";case"":return"PageDown";case"":return"End";case"":return"Home";case"":return"ArrowLeft";case"":return"ArrowUp";case"":return"ArrowRight";case"":return"ArrowDown";case"":return"Insert";case"":return"Delete";default:return r}}function UW(r){switch(r){case"`":case"~":return"Backquote";case"\\":case"|":return"Backslash";case"":return"Backspace";case"[":case"{":return"BracketLeft";case"]":case"}":return"BracketRight";case",":case"<":return"Comma";case"0":case")":return"Digit0";case"1":case"!":return"Digit1";case"2":case"@":return"Digit2";case"3":case"#":return"Digit3";case"4":case"$":return"Digit4";case"5":case"%":return"Digit5";case"6":case"^":return"Digit6";case"7":case"&":return"Digit7";case"8":case"*":return"Digit8";case"9":case"(":return"Digit9";case"=":case"+":return"Equal";case">":return"IntlBackslash";case"a":case"A":return"KeyA";case"b":case"B":return"KeyB";case"c":case"C":return"KeyC";case"d":case"D":return"KeyD";case"e":case"E":return"KeyE";case"f":case"F":return"KeyF";case"g":case"G":return"KeyG";case"h":case"H":return"KeyH";case"i":case"I":return"KeyI";case"j":case"J":return"KeyJ";case"k":case"K":return"KeyK";case"l":case"L":return"KeyL";case"m":case"M":return"KeyM";case"n":case"N":return"KeyN";case"o":case"O":return"KeyO";case"p":case"P":return"KeyP";case"q":case"Q":return"KeyQ";case"r":case"R":return"KeyR";case"s":case"S":return"KeyS";case"t":case"T":return"KeyT";case"u":case"U":return"KeyU";case"v":case"V":return"KeyV";case"w":case"W":return"KeyW";case"x":case"X":return"KeyX";case"y":case"Y":return"KeyY";case"z":case"Z":return"KeyZ";case"-":case"_":return"Minus";case".":return"Period";case"'":case'"':return"Quote";case";":case":":return"Semicolon";case"/":case"?":return"Slash";case"":return"AltLeft";case"":return"AltRight";case"":return"ControlLeft";case"":return"ControlRight";case"":return"Enter";case"":return"Pause";case"":return"MetaLeft";case"":return"MetaRight";case"":return"ShiftLeft";case"":return"ShiftRight";case" ":case"":return"Space";case"":return"Tab";case"":return"Delete";case"":return"End";case"":return"Help";case"":return"Home";case"":return"Insert";case"":return"PageDown";case"":return"PageUp";case"":return"ArrowDown";case"":return"ArrowLeft";case"":return"ArrowRight";case"":return"ArrowUp";case"":return"Escape";case"":return"F1";case"":return"F2";case"":return"F3";case"":return"F4";case"":return"F5";case"":return"F6";case"":return"F7";case"":return"F8";case"":return"F9";case"":return"F10";case"":return"F11";case"":return"F12";case"":return"NumpadEqual";case"":case"":return"Numpad0";case"":case"":return"Numpad1";case"":case"":return"Numpad2";case"":case"":return"Numpad3";case"":case"":return"Numpad4";case"":return"Numpad5";case"":case"":return"Numpad6";case"":case"":return"Numpad7";case"":case"":return"Numpad8";case"":case"":return"Numpad9";case"":return"NumpadAdd";case"":return"NumpadComma";case"":case"":return"NumpadDecimal";case"":return"NumpadDivide";case"":return"NumpadEnter";case"":return"NumpadMultiply";case"":return"NumpadSubtract";default:return}}function $W(r){switch(r){case"":case"":case"":case"":case"":return 1;case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":return 3;case"":case"":case"":case"":return 2;default:return 0}}var Wv={};Object.defineProperty(Wv,"__esModule",{value:!0}),Wv.KeyToKeyCode=void 0,Wv.KeyToKeyCode={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,Abort:3,Help:6,Backspace:8,Tab:9,Numpad5:12,NumpadEnter:13,Enter:13,"\\r":13,"\\n":13,ShiftLeft:16,ShiftRight:16,ControlLeft:17,ControlRight:17,AltLeft:18,AltRight:18,Pause:19,CapsLock:20,Escape:27,Convert:28,NonConvert:29,Space:32,Numpad9:33,PageUp:33,Numpad3:34,PageDown:34,End:35,Numpad1:35,Home:36,Numpad7:36,ArrowLeft:37,Numpad4:37,Numpad8:38,ArrowUp:38,ArrowRight:39,Numpad6:39,Numpad2:40,ArrowDown:40,Select:41,Open:43,PrintScreen:44,Insert:45,Numpad0:45,Delete:46,NumpadDecimal:46,Digit0:48,Digit1:49,Digit2:50,Digit3:51,Digit4:52,Digit5:53,Digit6:54,Digit7:55,Digit8:56,Digit9:57,KeyA:65,KeyB:66,KeyC:67,KeyD:68,KeyE:69,KeyF:70,KeyG:71,KeyH:72,KeyI:73,KeyJ:74,KeyK:75,KeyL:76,KeyM:77,KeyN:78,KeyO:79,KeyP:80,KeyQ:81,KeyR:82,KeyS:83,KeyT:84,KeyU:85,KeyV:86,KeyW:87,KeyX:88,KeyY:89,KeyZ:90,MetaLeft:91,MetaRight:92,ContextMenu:93,NumpadMultiply:106,NumpadAdd:107,NumpadSubtract:109,NumpadDivide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,F20:131,F21:132,F22:133,F23:134,F24:135,NumLock:144,ScrollLock:145,AudioVolumeMute:173,AudioVolumeDown:174,AudioVolumeUp:175,MediaTrackNext:176,MediaTrackPrevious:177,MediaStop:178,MediaPlayPause:179,Semicolon:186,Equal:187,NumpadEqual:187,Comma:188,Minus:189,Period:190,Slash:191,Backquote:192,BracketLeft:219,Backslash:220,BracketRight:221,Quote:222,AltGraph:225,Props:247,Cancel:3,Clear:12,Shift:16,Control:17,Alt:18,Accept:30,ModeChange:31," ":32,Print:42,Execute:43,"\\u0000":46,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,Meta:91,"*":106,"+":107,"-":109,"/":111,";":186,"=":187,",":188,".":190,"`":192,"[":219,"\\\\":220,"]":221,"'":222,Attn:246,CrSel:247,ExSel:248,EraseEof:249,Play:250,ZoomOut:251,")":48,"!":49,"@":50,"#":51,$:52,"%":53,"^":54,"&":55,"(":57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,":":186,"<":188,_:189,">":190,"?":191,"~":192,"{":219,"|":220,"}":221,'"':222,Camera:44,EndCall:95,VolumeDown:182,VolumeUp:183},Object.defineProperty(jv,"__esModule",{value:!0}),jv.ActionDispatcher=void 0;const ph=At,ap=zi,zv=Hv,jW=Aa,mh=np,HF=Wv,HW=(r=>{const t=r.getClientRects()[0],e=Math.max(0,Math.min(t.x,t.x+t.width)),n=Math.min(window.innerWidth,Math.max(t.x,t.x+t.width)),a=Math.max(0,Math.min(t.y,t.y+t.height)),i=Math.min(window.innerHeight,Math.max(t.y,t.y+t.height));return[e+(n-e>>1),a+(i-a>>1)]}).toString(),WW=(()=>navigator.platform.toLowerCase().includes("mac")).toString();async function zW(r,t){var s,c,l,u;const n=await(await r.getOrCreateSandbox(void 0)).callFunction(HW,!1,{type:"undefined"},[t]);if(n.type==="exception")throw new ph.NoSuchElementException(`Origin element ${t.sharedId} was not found`);(0,ap.assert)(n.result.type==="array"),(0,ap.assert)(((c=(s=n.result.value)==null?void 0:s[0])==null?void 0:c.type)==="number"),(0,ap.assert)(((u=(l=n.result.value)==null?void 0:l[1])==null?void 0:u.type)==="number");const{result:{value:[{value:a},{value:i}]}}=n;return{x:a,y:i}}class WF{constructor(t,e,n){y(this,vr);y(this,Zd,0);y(this,ls,0);y(this,us);y(this,on);y(this,Vl);_(this,us,t),_(this,on,e),_(this,Vl,n)}async dispatchActions(t){await o(this,us).queue.run(async()=>{for(const e of t)await this.dispatchTickActions(e)})}async dispatchTickActions(t){_(this,Zd,performance.now()),_(this,ls,0);for(const{action:n}of t)"duration"in n&&n.duration!==void 0&&_(this,ls,Math.max(o(this,ls),n.duration));const e=[new Promise(n=>setTimeout(n,o(this,ls)))];for(const n of t)e.push(F(this,vr,DI).call(this,n));await Promise.all(e)}}Zd=new WeakMap,ls=new WeakMap,us=new WeakMap,on=new WeakMap,Vl=new WeakMap,vr=new WeakSet,DI=async function({id:t,action:e}){const n=o(this,us).get(t),a=o(this,us).getGlobalKeyState();switch(e.type){case"keyDown":{await F(this,vr,LI).call(this,n,e),o(this,us).cancelList.push({id:t,action:{...e,type:"keyUp"}});break}case"keyUp":{await F(this,vr,BI).call(this,n,e);break}case"pause":break;case"pointerDown":{await F(this,vr,OI).call(this,n,a,e),o(this,us).cancelList.push({id:t,action:{...e,type:"pointerUp"}});break}case"pointerMove":{await F(this,vr,RI).call(this,n,a,e);break}case"pointerUp":{await F(this,vr,MI).call(this,n,a,e);break}case"scroll":{await F(this,vr,NI).call(this,n,a,e);break}}},OI=async function(t,e,n){const{button:a}=n;if(t.pressed.has(a))return;t.pressed.add(a);const{x:i,y:s,subtype:c}=t,{width:l,height:u,pressure:h,twist:d,tangentialPressure:f}=n,{tiltX:m,tiltY:w}=VF(n),{modifiers:p}=e,{radiusX:g,radiusY:v}=qF(l??1,u??1);switch(c){case"mouse":case"pen":await o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mousePressed",x:i,y:s,modifiers:p,button:Kv(a),buttons:t.buttons,clickCount:t.setClickCount(a,new jW.PointerSource.ClickContext(i,s,performance.now())),pointerType:c,tangentialPressure:f,tiltX:m,tiltY:w,twist:d,force:h});break;case"touch":await o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchTouchEvent",{type:"touchStart",touchPoints:[{x:i,y:s,radiusX:g,radiusY:v,tangentialPressure:f,tiltX:m,tiltY:w,twist:d,force:h,id:t.pointerId}],modifiers:p});break}t.radiusX=g,t.radiusY=v,t.force=h},MI=function(t,e,n){const{button:a}=n;if(!t.pressed.has(a))return;t.pressed.delete(a);const{x:i,y:s,force:c,radiusX:l,radiusY:u,subtype:h}=t,{modifiers:d}=e;switch(h){case"mouse":case"pen":return o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseReleased",x:i,y:s,modifiers:d,button:Kv(a),buttons:t.buttons,clickCount:t.getClickCount(a),pointerType:h});case"touch":return o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchTouchEvent",{type:"touchEnd",touchPoints:[{x:i,y:s,id:t.pointerId,force:c,radiusX:l,radiusY:u}],modifiers:d})}},RI=async function(t,e,n){const{x:a,y:i,subtype:s}=t,{width:c,height:l,pressure:u,twist:h,tangentialPressure:d,x:f,y:m,origin:w="viewport",duration:p=o(this,ls)}=n,{tiltX:g,tiltY:v}=VF(n),{radiusX:k,radiusY:x}=qF(c??1,l??1),{targetX:S,targetY:I}=await F(this,vr,SS).call(this,w,f,m,a,i);if(S<0||I<0)throw new ph.MoveTargetOutOfBoundsException(`Cannot move beyond viewport (x: ${S}, y: ${I})`);let O;do{const E=p>0?(performance.now()-o(this,Zd))/p:1;O=E>=1;let T,P;if(O?(T=S,P=I):(T=Math.round(E*(S-a)+a),P=Math.round(E*(I-i)+i)),t.x!==T||t.y!==P){const{modifiers:W}=e;switch(s){case"mouse":await o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseMoved",x:T,y:P,modifiers:W,clickCount:0,button:Kv(t.pressed.values().next().value??5),buttons:t.buttons,pointerType:s,tangentialPressure:d,tiltX:g,tiltY:v,twist:h,force:u});break;case"pen":t.pressed.size!==0&&await o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseMoved",x:T,y:P,modifiers:W,clickCount:0,button:Kv(t.pressed.values().next().value??5),buttons:t.buttons,pointerType:s,tangentialPressure:d,tiltX:g,tiltY:v,twist:h,force:u??.5});break;case"touch":t.pressed.size!==0&&await o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchTouchEvent",{type:"touchMove",touchPoints:[{x:T,y:P,radiusX:k,radiusY:x,tangentialPressure:d,tiltX:g,tiltY:v,twist:h,force:u,id:t.pointerId}],modifiers:W});break}t.x=T,t.y=P,t.radiusX=k,t.radiusY=x,t.force=u}}while(!O)},SS=async function(t,e,n,a,i){let s,c;switch(t){case"viewport":s=e,c=n;break;case"pointer":s=a+e,c=i+n;break;default:{const{x:l,y:u}=await zW(o(this,on),t.element);s=l+e,c=u+n;break}}return{targetX:s,targetY:c}},NI=async function(t,e,n){const{deltaX:a,deltaY:i,x:s,y:c,origin:l="viewport",duration:u=o(this,ls)}=n;if(l==="pointer")throw new ph.InvalidArgumentException('"pointer" origin is invalid for scrolling.');const{targetX:h,targetY:d}=await F(this,vr,SS).call(this,l,s,c,0,0);if(h<0||d<0)throw new ph.MoveTargetOutOfBoundsException(`Cannot move beyond viewport (x: ${h}, y: ${d})`);let f=0,m=0,w;do{const p=u>0?(performance.now()-o(this,Zd))/u:1;w=p>=1;let g,v;if(w?(g=a-f,v=i-m):(g=Math.round(p*a-f),v=Math.round(p*i-m)),g!==0||v!==0){const{modifiers:k}=e;await o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseWheel",deltaX:g,deltaY:v,x:h,y:d,modifiers:k}),f+=g,m+=v}}while(!w)},LI=async function(t,e){const n=e.value;if(!(0,zv.isSingleGrapheme)(n))throw new ph.InvalidArgumentException(`Invalid key value: ${n}`);const a=(0,zv.isSingleComplexGrapheme)(n),i=(0,mh.getNormalizedKey)(n),s=t.pressed.has(i),c=(0,mh.getKeyCode)(n),l=(0,mh.getKeyLocation)(n);switch(i){case"Alt":t.alt=!0;break;case"Shift":t.shift=!0;break;case"Control":t.ctrl=!0;break;case"Meta":t.meta=!0;break}t.pressed.add(i);const{modifiers:u}=t,h=zF(i,t,a),d=KF(c??"",t)??h;let f;if(o(this,Vl)&&t.meta)switch(c){case"KeyA":f="SelectAll";break;case"KeyC":f="Copy";break;case"KeyV":f=t.shift?"PasteAndMatchStyle":"Paste";break;case"KeyX":f="Cut";break;case"KeyZ":f=t.shift?"Redo":"Undo";break}const m=[o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchKeyEvent",{type:d?"keyDown":"rawKeyDown",windowsVirtualKeyCode:HF.KeyToKeyCode[i],key:i,code:c,text:d,unmodifiedText:h,autoRepeat:s,isSystemKey:t.alt||void 0,location:l<3?l:void 0,isKeypad:l===3,modifiers:u,commands:f?[f]:void 0})];i==="Escape"&&!t.alt&&(o(this,Vl)&&!t.ctrl&&!t.meta||!o(this,Vl))&&m.push(o(this,on).cdpTarget.cdpClient.sendCommand("Input.cancelDragging")),await Promise.all(m)},BI=function(t,e){const n=e.value;if(!(0,zv.isSingleGrapheme)(n))throw new ph.InvalidArgumentException(`Invalid key value: ${n}`);const a=(0,zv.isSingleComplexGrapheme)(n),i=(0,mh.getNormalizedKey)(n);if(!t.pressed.has(i))return;const s=(0,mh.getKeyCode)(n),c=(0,mh.getKeyLocation)(n);switch(i){case"Alt":t.alt=!1;break;case"Shift":t.shift=!1;break;case"Control":t.ctrl=!1;break;case"Meta":t.meta=!1;break}t.pressed.delete(i);const{modifiers:l}=t,u=zF(i,t,a),h=KF(s??"",t)??u;return o(this,on).cdpTarget.cdpClient.sendCommand("Input.dispatchKeyEvent",{type:"keyUp",windowsVirtualKeyCode:HF.KeyToKeyCode[i],key:i,code:s,text:h,unmodifiedText:u,location:c<3?c:void 0,isSystemKey:t.alt||void 0,isKeypad:c===3,modifiers:l})},H(WF,"isMacOS",async t=>{const e=await(await t.getOrCreateSandbox(void 0)).callFunction(WW,!1);return(0,ap.assert)(e.type!=="exception"),(0,ap.assert)(e.result.type==="boolean"),e.result.value}),jv.ActionDispatcher=WF;const zF=(r,t,e)=>e?r:r==="Enter"?"\r":[...r].length===1?t.shift?r.toLocaleUpperCase("en-US"):r:void 0,KF=(r,t)=>{if(t.ctrl){switch(r){case"Digit2":if(t.shift)return"\0";break;case"KeyA":return"";case"KeyB":return"";case"KeyC":return"";case"KeyD":return"";case"KeyE":return"";case"KeyF":return"";case"KeyG":return"\x07";case"KeyH":return"\b";case"KeyI":return"	";case"KeyJ":return`
`;case"KeyK":return"\v";case"KeyL":return"\f";case"KeyM":return"\r";case"KeyN":return"";case"KeyO":return"";case"KeyP":return"";case"KeyQ":return"";case"KeyR":return"";case"KeyS":return"";case"KeyT":return"";case"KeyU":return"";case"KeyV":return"";case"KeyW":return"";case"KeyX":return"";case"KeyY":return"";case"KeyZ":return"";case"BracketLeft":return"\x1B";case"Backslash":return"";case"BracketRight":return"";case"Digit6":if(t.shift)return"";break;case"Minus":return""}return""}if(t.alt)return""};function Kv(r){switch(r){case 0:return"left";case 1:return"middle";case 2:return"right";case 3:return"back";case 4:return"forward";default:return"none"}}function VF(r){const t=r.altitudeAngle??Math.PI/2,e=r.azimuthAngle??0;let n=0,a=0;if(t===0&&((e===0||e===2*Math.PI)&&(n=Math.PI/2),e===Math.PI/2&&(a=Math.PI/2),e===Math.PI&&(n=-Math.PI/2),e===3*Math.PI/2&&(a=-Math.PI/2),e>0&&e<Math.PI/2&&(n=Math.PI/2,a=Math.PI/2),e>Math.PI/2&&e<Math.PI&&(n=-Math.PI/2,a=Math.PI/2),e>Math.PI&&e<3*Math.PI/2&&(n=-Math.PI/2,a=-Math.PI/2),e>3*Math.PI/2&&e<2*Math.PI&&(n=Math.PI/2,a=-Math.PI/2)),t!==0){const s=Math.tan(t);n=Math.atan(Math.cos(e)/s),a=Math.atan(Math.sin(e)/s)}const i=180/Math.PI;return{tiltX:Math.round(n*i),tiltY:Math.round(a*i)}}function qF(r,t){return{radiusX:r?r/2:.5,radiusY:t?t/2:.5}}var Vv={},qv={},Gv={};Object.defineProperty(Gv,"__esModule",{value:!0}),Gv.Mutex=void 0;class KW{constructor(){y(this,Rg);y(this,Qd,!1);y(this,Mg,[])}acquire(){const t={resolved:!1};return o(this,Qd)?new Promise(e=>{o(this,Mg).push(()=>e(F(this,Rg,CS).bind(this,t)))}):(_(this,Qd,!0),Promise.resolve(F(this,Rg,CS).bind(this,t)))}async run(t){const e=await this.acquire();try{return await t()}finally{e()}}}Qd=new WeakMap,Mg=new WeakMap,Rg=new WeakSet,CS=function(t){if(t.resolved)throw new Error("Cannot release more than once.");t.resolved=!0;const e=o(this,Mg).shift();if(!e){_(this,Qd,!1);return}e()},Gv.Mutex=KW,Object.defineProperty(qv,"__esModule",{value:!0}),qv.InputState=void 0;const S_=At,VW=Gv,ip=Aa;class qW{constructor(){H(this,"cancelList",[]);y(this,Wo,new Map);y(this,Zy,new VW.Mutex)}getOrCreate(t,e,n){let a=o(this,Wo).get(t);if(!a){switch(e){case"none":a=new ip.NoneSource;break;case"key":a=new ip.KeySource;break;case"pointer":{let i=n==="mouse"?0:2;const s=new Set;for(const[,c]of o(this,Wo))c.type==="pointer"&&s.add(c.pointerId);for(;s.has(i);)++i;a=new ip.PointerSource(i,n);break}case"wheel":a=new ip.WheelSource;break;default:throw new S_.InvalidArgumentException(`Expected "none", "key", "pointer", or "wheel". Found unknown source type ${e}.`)}return o(this,Wo).set(t,a),a}if(a.type!==e)throw new S_.InvalidArgumentException(`Input source type of ${t} is ${a.type}, but received ${e}.`);return a}get(t){const e=o(this,Wo).get(t);if(!e)throw new S_.UnknownErrorException("Internal error.");return e}getGlobalKeyState(){const t=new ip.KeySource;for(const[,e]of o(this,Wo))if(e.type==="key"){for(const n of e.pressed)t.pressed.add(n);t.alt||(t.alt=e.alt),t.ctrl||(t.ctrl=e.ctrl),t.meta||(t.meta=e.meta),t.shift||(t.shift=e.shift)}return t}get queue(){return o(this,Zy)}}Wo=new WeakMap,Zy=new WeakMap,qv.InputState=qW,Object.defineProperty(Vv,"__esModule",{value:!0}),Vv.InputStateManager=void 0;const GW=zi,XW=qv;class YW extends WeakMap{get(t){return(0,GW.assert)(t.isTopLevelContext()),this.has(t)||this.set(t,new XW.InputState),super.get(t)}}Vv.InputStateManager=YW,Object.defineProperty($v,"__esModule",{value:!0}),$v.InputProcessor=void 0;const $c=At,Xv=zi,Yv=jv,JW=Vv;class ZW{constructor(t){y(this,Qy);y(this,ql);y(this,ef,new JW.InputStateManager);_(this,ql,t)}async performActions(t){const e=o(this,ql).getContext(t.context),n=o(this,ef).get(e.top),a=F(this,Qy,UI).call(this,t,n);return await new Yv.ActionDispatcher(n,e,await Yv.ActionDispatcher.isMacOS(e).catch(()=>!1)).dispatchActions(a),{}}async releaseActions(t){const e=o(this,ql).getContext(t.context),n=e.top,a=o(this,ef).get(n);return await new Yv.ActionDispatcher(a,e,await Yv.ActionDispatcher.isMacOS(e).catch(()=>!1)).dispatchTickActions(a.cancelList.reverse()),o(this,ef).delete(n),{}}async setFiles(t){const n=await o(this,ql).getContext(t.context).getOrCreateSandbox(void 0);let a;try{a=await n.callFunction(String(function(l){if(!(this instanceof HTMLInputElement))return this instanceof Element?1:0;if(this.type!=="file")return 2;if(this.disabled)return 3;if(l>1&&!this.multiple)return 4}),!1,t.element,[{type:"number",value:t.files.length}])}catch{throw new $c.NoSuchNodeException(`Could not find element ${t.element.sharedId}`)}if((0,Xv.assert)(a.type==="success"),a.result.type==="number")switch(a.result.value){case 0:throw new $c.NoSuchElementException(`Could not find element ${t.element.sharedId}`);case 1:throw new $c.UnableToSetFileInputException(`Element ${t.element.sharedId} is not a input`);case 2:throw new $c.UnableToSetFileInputException(`Input element ${t.element.sharedId} is not a file type`);case 3:throw new $c.UnableToSetFileInputException(`Input element ${t.element.sharedId} is disabled`);case 4:throw new $c.UnableToSetFileInputException("Cannot set multiple files on a non-multiple input element")}if(t.files.length===0)return await n.callFunction(String(function(){var l;if(((l=this.files)==null?void 0:l.length)===0){this.dispatchEvent(new Event("cancel",{bubbles:!0}));return}this.files=new DataTransfer().files,this.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0}))}),!1,t.element),{};const i=[];for(let c=0;c<t.files.length;++c){const l=await n.callFunction(String(function(f){var m;return(m=this.files)==null?void 0:m.item(f)}),!1,t.element,[{type:"number",value:0}],"root");if((0,Xv.assert)(l.type==="success"),l.result.type!=="object")break;const{handle:u}=l.result;(0,Xv.assert)(u!==void 0);const{path:h}=await n.cdpClient.sendCommand("DOM.getFileInfo",{objectId:u});i.push(h),n.disown(u).catch(void 0)}i.sort();const s=[...t.files].sort();if(i.length!==t.files.length||s.some((c,l)=>i[l]!==c)){const{objectId:c}=await n.deserializeForCdp(t.element);(0,Xv.assert)(c!==void 0),await n.cdpClient.sendCommand("DOM.setFileInputFiles",{files:t.files,objectId:c})}else await n.callFunction(String(function(){this.dispatchEvent(new Event("cancel",{bubbles:!0}))}),!1,t.element);return{}}}ql=new WeakMap,ef=new WeakMap,Qy=new WeakSet,UI=function(t,e){var a;const n=[];for(const i of t.actions){switch(i.type){case"pointer":{i.parameters??(i.parameters={pointerType:"mouse"}),(a=i.parameters).pointerType??(a.pointerType="mouse");const c=e.getOrCreate(i.id,"pointer",i.parameters.pointerType);if(c.subtype!==i.parameters.pointerType)throw new $c.InvalidArgumentException(`Expected input source ${i.id} to be ${c.subtype}; got ${i.parameters.pointerType}.`);break}default:e.getOrCreate(i.id,i.type)}const s=i.actions.map(c=>({id:i.id,action:c}));for(let c=0;c<s.length;c++)n.length===c&&n.push([]),n[c].push(s[c])}return n},$v.InputProcessor=ZW;var sp={},gh={},C_=Object.defineProperty,QW=Object.getOwnPropertyDescriptor,ez=Object.getOwnPropertyNames,tz=Object.prototype.hasOwnProperty,rz=(r,t)=>{for(var e in t)C_(r,e,{get:t[e],enumerable:!0})},nz=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ez(t))!tz.call(r,a)&&a!==e&&C_(r,a,{get:()=>t[a],enumerable:!(n=QW(t,a))||n.enumerable});return r},az=r=>nz(C_({},"__esModule",{value:!0}),r),GF={};rz(GF,{URLPattern:()=>Iz});var iz=az(GF),op=class{constructor(r,t,e,n,a,i){H(this,"type",3);H(this,"name","");H(this,"prefix","");H(this,"value","");H(this,"suffix","");H(this,"modifier",3);this.type=r,this.name=t,this.prefix=e,this.value=n,this.suffix=a,this.modifier=i}hasCustomName(){return this.name!==""&&typeof this.name!="number"}},sz=/[$_\p{ID_Start}]/u,oz=/[$_\u200C\u200D\p{ID_Continue}]/u,T_=".*";function cz(r,t){return/^[\x00-\x7F]*$/.test(r)}function XF(r,t=!1){let e=[],n=0;for(;n<r.length;){let a=r[n],i=function(s){if(!t)throw new TypeError(s);e.push({type:"INVALID_CHAR",index:n,value:r[n++]})};if(a==="*"){e.push({type:"ASTERISK",index:n,value:r[n++]});continue}if(a==="+"||a==="?"){e.push({type:"OTHER_MODIFIER",index:n,value:r[n++]});continue}if(a==="\\"){e.push({type:"ESCAPED_CHAR",index:n++,value:r[n++]});continue}if(a==="{"){e.push({type:"OPEN",index:n,value:r[n++]});continue}if(a==="}"){e.push({type:"CLOSE",index:n,value:r[n++]});continue}if(a===":"){let s="",c=n+1;for(;c<r.length;){let l=r.substr(c,1);if(c===n+1&&sz.test(l)||c!==n+1&&oz.test(l)){s+=r[c++];continue}break}if(!s){i(`Missing parameter name at ${n}`);continue}e.push({type:"NAME",index:n,value:s}),n=c;continue}if(a==="("){let s=1,c="",l=n+1,u=!1;if(r[l]==="?"){i(`Pattern cannot start with "?" at ${l}`);continue}for(;l<r.length;){if(!cz(r[l])){i(`Invalid character '${r[l]}' at ${l}.`),u=!0;break}if(r[l]==="\\"){c+=r[l++]+r[l++];continue}if(r[l]===")"){if(s--,s===0){l++;break}}else if(r[l]==="("&&(s++,r[l+1]!=="?")){i(`Capturing groups are not allowed at ${l}`),u=!0;break}c+=r[l++]}if(u)continue;if(s){i(`Unbalanced pattern at ${n}`);continue}if(!c){i(`Missing pattern at ${n}`);continue}e.push({type:"REGEX",index:n,value:c}),n=l;continue}e.push({type:"CHAR",index:n,value:r[n++]})}return e.push({type:"END",index:n,value:""}),e}function YF(r,t={}){let e=XF(r);t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./");let n=`[^${ia(t.delimiter)}]+?`,a=[],i=0,s=0,c=new Set,l=k=>{if(s<e.length&&e[s].type===k)return e[s++].value},u=()=>l("OTHER_MODIFIER")??l("ASTERISK"),h=k=>{let x=l(k);if(x!==void 0)return x;let{type:S,index:I}=e[s];throw new TypeError(`Unexpected ${S} at ${I}, expected ${k}`)},d=()=>{let k="",x;for(;x=l("CHAR")??l("ESCAPED_CHAR");)k+=x;return k},f=k=>k,m=t.encodePart||f,w="",p=k=>{w+=k},g=()=>{w.length&&(a.push(new op(3,"","",m(w),"",3)),w="")},v=(k,x,S,I,O)=>{let E=3;switch(O){case"?":E=1;break;case"*":E=0;break;case"+":E=2;break}if(!x&&!S&&E===3){p(k);return}if(g(),!x&&!S){if(!k)return;a.push(new op(3,"","",m(k),"",E));return}let T;S?S==="*"?T=T_:T=S:T=n;let P=2;T===n?(P=1,T=""):T===T_&&(P=0,T="");let W;if(x?W=x:S&&(W=i++),c.has(W))throw new TypeError(`Duplicate name '${W}'.`);c.add(W),a.push(new op(P,W,m(k),T,m(I),E))};for(;s<e.length;){let k=l("CHAR"),x=l("NAME"),S=l("REGEX");if(!x&&!S&&(S=l("ASTERISK")),x||S){let O=k??"";t.prefixes.indexOf(O)===-1&&(p(O),O=""),g();let E=u();v(O,x,S,"",E);continue}let I=k??l("ESCAPED_CHAR");if(I){p(I);continue}if(l("OPEN")){let O=d(),E=l("NAME"),T=l("REGEX");!E&&!T&&(T=l("ASTERISK"));let P=d();h("CLOSE");let W=u();v(O,E,T,P,W);continue}g(),h("END")}return a}function ia(r){return r.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function JF(r){return r&&r.ignoreCase?"ui":"u"}function lz(r,t,e){return ZF(YF(r,e),t,e)}function wh(r){switch(r){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}function ZF(r,t,e={}){e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./"),e.sensitive??(e.sensitive=!1),e.strict??(e.strict=!1),e.end??(e.end=!0),e.start??(e.start=!0),e.endsWith="";let n=e.start?"^":"";for(let c of r){if(c.type===3){c.modifier===3?n+=ia(c.value):n+=`(?:${ia(c.value)})${wh(c.modifier)}`;continue}t&&t.push(c.name);let l=`[^${ia(e.delimiter)}]+?`,u=c.value;if(c.type===1?u=l:c.type===0&&(u=T_),!c.prefix.length&&!c.suffix.length){c.modifier===3||c.modifier===1?n+=`(${u})${wh(c.modifier)}`:n+=`((?:${u})${wh(c.modifier)})`;continue}if(c.modifier===3||c.modifier===1){n+=`(?:${ia(c.prefix)}(${u})${ia(c.suffix)})`,n+=wh(c.modifier);continue}n+=`(?:${ia(c.prefix)}`,n+=`((?:${u})(?:`,n+=ia(c.suffix),n+=ia(c.prefix),n+=`(?:${u}))*)${ia(c.suffix)})`,c.modifier===0&&(n+="?")}let a=`[${ia(e.endsWith)}]|$`,i=`[${ia(e.delimiter)}]`;if(e.end)return e.strict||(n+=`${i}?`),e.endsWith.length?n+=`(?=${a})`:n+="$",new RegExp(n,JF(e));e.strict||(n+=`(?:${i}(?=${a}))?`);let s=!1;if(r.length){let c=r[r.length-1];c.type===3&&c.modifier===3&&(s=e.delimiter.indexOf(c)>-1)}return s||(n+=`(?=${i}|${a})`),new RegExp(n,JF(e))}var Gs={delimiter:"",prefixes:"",sensitive:!0,strict:!0},uz={delimiter:".",prefixes:"",sensitive:!0,strict:!0},hz={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function dz(r,t){return r.length?r[0]==="/"?!0:!t||r.length<2?!1:(r[0]=="\\"||r[0]=="{")&&r[1]=="/":!1}function QF(r,t){return r.startsWith(t)?r.substring(t.length,r.length):r}function fz(r,t){return r.endsWith(t)?r.substr(0,r.length-t.length):r}function e4(r){return!r||r.length<2?!1:r[0]==="["||(r[0]==="\\"||r[0]==="{")&&r[1]==="["}var t4=["ftp","file","http","https","ws","wss"];function r4(r){if(!r)return!0;for(let t of t4)if(r.test(t))return!0;return!1}function pz(r,t){if(r=QF(r,"#"),t||r==="")return r;let e=new URL("https://example.com");return e.hash=r,e.hash?e.hash.substring(1,e.hash.length):""}function mz(r,t){if(r=QF(r,"?"),t||r==="")return r;let e=new URL("https://example.com");return e.search=r,e.search?e.search.substring(1,e.search.length):""}function gz(r,t){return t||r===""?r:e4(r)?i4(r):a4(r)}function wz(r,t){if(t||r==="")return r;let e=new URL("https://example.com");return e.password=r,e.password}function vz(r,t){if(t||r==="")return r;let e=new URL("https://example.com");return e.username=r,e.username}function yz(r,t,e){if(e||r==="")return r;if(t&&!t4.includes(t))return new URL(`${t}:${r}`).pathname;let n=r[0]=="/";return r=new URL(n?r:"/-"+r,"https://example.com").pathname,n||(r=r.substring(2,r.length)),r}function xz(r,t,e){return n4(t)===r&&(r=""),e||r===""?r:s4(r)}function kz(r,t){return r=fz(r,":"),t||r===""?r:A_(r)}function n4(r){switch(r){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function A_(r){if(r==="")return r;if(/^[-+.A-Za-z0-9]*$/.test(r))return r.toLowerCase();throw new TypeError(`Invalid protocol '${r}'.`)}function bz(r){if(r==="")return r;let t=new URL("https://example.com");return t.username=r,t.username}function _z(r){if(r==="")return r;let t=new URL("https://example.com");return t.password=r,t.password}function a4(r){if(r==="")return r;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(r))throw new TypeError(`Invalid hostname '${r}'`);let t=new URL("https://example.com");return t.hostname=r,t.hostname}function i4(r){if(r==="")return r;if(/[^0-9a-fA-F[\]:]/g.test(r))throw new TypeError(`Invalid IPv6 hostname '${r}'`);return r.toLowerCase()}function s4(r){if(r===""||/^[0-9]*$/.test(r)&&parseInt(r)<=65535)return r;throw new TypeError(`Invalid port '${r}'.`)}function Ez(r){if(r==="")return r;let t=new URL("https://example.com");return t.pathname=r[0]!=="/"?"/-"+r:r,r[0]!=="/"?t.pathname.substring(2,t.pathname.length):t.pathname}function Sz(r){return r===""?r:new URL(`data:${r}`).pathname}function Cz(r){if(r==="")return r;let t=new URL("https://example.com");return t.search=r,t.search.substring(1,t.search.length)}function Tz(r){if(r==="")return r;let t=new URL("https://example.com");return t.hash=r,t.hash.substring(1,t.hash.length)}var Az=(fP=class{constructor(r){y(this,_e);y(this,tf);y(this,yn,[]);y(this,Mr,{});y(this,Bt,0);y(this,Gl,1);y(this,rf,0);y(this,Hn,0);y(this,nf,0);y(this,af,0);y(this,sf,!1);_(this,tf,r)}get result(){return o(this,Mr)}parse(){for(_(this,yn,XF(o(this,tf),!0));o(this,Bt)<o(this,yn).length;_(this,Bt,o(this,Bt)+o(this,Gl))){if(_(this,Gl,1),o(this,yn)[o(this,Bt)].type==="END"){if(o(this,Hn)===0){F(this,_e,TS).call(this),F(this,_e,Mu).call(this)?F(this,_e,br).call(this,9,1):F(this,_e,s0).call(this)?F(this,_e,br).call(this,8,1):F(this,_e,br).call(this,7,0);continue}else if(o(this,Hn)===2){F(this,_e,iw).call(this,5);continue}F(this,_e,br).call(this,10,0);break}if(o(this,nf)>0)if(F(this,_e,KI).call(this))_(this,nf,o(this,nf)-1);else continue;if(F(this,_e,zI).call(this)){_(this,nf,o(this,nf)+1);continue}switch(o(this,Hn)){case 0:F(this,_e,AS).call(this)&&F(this,_e,iw).call(this,1);break;case 1:if(F(this,_e,AS).call(this)){F(this,_e,GI).call(this);let r=7,t=1;F(this,_e,jI).call(this)?(r=2,t=3):o(this,sf)&&(r=2),F(this,_e,br).call(this,r,t)}break;case 2:F(this,_e,Nx).call(this)?F(this,_e,iw).call(this,3):(F(this,_e,Lx).call(this)||F(this,_e,s0).call(this)||F(this,_e,Mu).call(this))&&F(this,_e,iw).call(this,5);break;case 3:F(this,_e,HI).call(this)?F(this,_e,br).call(this,4,1):F(this,_e,Nx).call(this)&&F(this,_e,br).call(this,5,1);break;case 4:F(this,_e,Nx).call(this)&&F(this,_e,br).call(this,5,1);break;case 5:F(this,_e,VI).call(this)?_(this,af,o(this,af)+1):F(this,_e,qI).call(this)&&_(this,af,o(this,af)-1),F(this,_e,WI).call(this)&&!o(this,af)?F(this,_e,br).call(this,6,1):F(this,_e,Lx).call(this)?F(this,_e,br).call(this,7,0):F(this,_e,s0).call(this)?F(this,_e,br).call(this,8,1):F(this,_e,Mu).call(this)&&F(this,_e,br).call(this,9,1);break;case 6:F(this,_e,Lx).call(this)?F(this,_e,br).call(this,7,0):F(this,_e,s0).call(this)?F(this,_e,br).call(this,8,1):F(this,_e,Mu).call(this)&&F(this,_e,br).call(this,9,1);break;case 7:F(this,_e,s0).call(this)?F(this,_e,br).call(this,8,1):F(this,_e,Mu).call(this)&&F(this,_e,br).call(this,9,1);break;case 8:F(this,_e,Mu).call(this)&&F(this,_e,br).call(this,9,1);break}}o(this,Mr).hostname!==void 0&&o(this,Mr).port===void 0&&(o(this,Mr).port="")}},tf=new WeakMap,yn=new WeakMap,Mr=new WeakMap,Bt=new WeakMap,Gl=new WeakMap,rf=new WeakMap,Hn=new WeakMap,nf=new WeakMap,af=new WeakMap,sf=new WeakMap,_e=new WeakSet,br=function(r,t){var e,n,a;switch(o(this,Hn)){case 0:break;case 1:o(this,Mr).protocol=F(this,_e,Di).call(this);break;case 2:break;case 3:o(this,Mr).username=F(this,_e,Di).call(this);break;case 4:o(this,Mr).password=F(this,_e,Di).call(this);break;case 5:o(this,Mr).hostname=F(this,_e,Di).call(this);break;case 6:o(this,Mr).port=F(this,_e,Di).call(this);break;case 7:o(this,Mr).pathname=F(this,_e,Di).call(this);break;case 8:o(this,Mr).search=F(this,_e,Di).call(this);break;case 9:o(this,Mr).hash=F(this,_e,Di).call(this);break}o(this,Hn)!==0&&r!==10&&([1,2,3,4].includes(o(this,Hn))&&[6,7,8,9].includes(r)&&((e=o(this,Mr)).hostname??(e.hostname="")),[1,2,3,4,5,6].includes(o(this,Hn))&&[8,9].includes(r)&&((n=o(this,Mr)).pathname??(n.pathname=o(this,sf)?"/":"")),[1,2,3,4,5,6,7].includes(o(this,Hn))&&r===9&&((a=o(this,Mr)).search??(a.search=""))),F(this,_e,$I).call(this,r,t)},$I=function(r,t){_(this,Hn,r),_(this,rf,o(this,Bt)+t),_(this,Bt,o(this,Bt)+t),_(this,Gl,0)},TS=function(){_(this,Bt,o(this,rf)),_(this,Gl,0)},iw=function(r){F(this,_e,TS).call(this),_(this,Hn,r)},Rx=function(r){return r<0&&(r=o(this,yn).length-r),r<o(this,yn).length?o(this,yn)[r]:o(this,yn)[o(this,yn).length-1]},wa=function(r,t){let e=F(this,_e,Rx).call(this,r);return e.value===t&&(e.type==="CHAR"||e.type==="ESCAPED_CHAR"||e.type==="INVALID_CHAR")},AS=function(){return F(this,_e,wa).call(this,o(this,Bt),":")},jI=function(){return F(this,_e,wa).call(this,o(this,Bt)+1,"/")&&F(this,_e,wa).call(this,o(this,Bt)+2,"/")},Nx=function(){return F(this,_e,wa).call(this,o(this,Bt),"@")},HI=function(){return F(this,_e,wa).call(this,o(this,Bt),":")},WI=function(){return F(this,_e,wa).call(this,o(this,Bt),":")},Lx=function(){return F(this,_e,wa).call(this,o(this,Bt),"/")},s0=function(){if(F(this,_e,wa).call(this,o(this,Bt),"?"))return!0;if(o(this,yn)[o(this,Bt)].value!=="?")return!1;let r=F(this,_e,Rx).call(this,o(this,Bt)-1);return r.type!=="NAME"&&r.type!=="REGEX"&&r.type!=="CLOSE"&&r.type!=="ASTERISK"},Mu=function(){return F(this,_e,wa).call(this,o(this,Bt),"#")},zI=function(){return o(this,yn)[o(this,Bt)].type=="OPEN"},KI=function(){return o(this,yn)[o(this,Bt)].type=="CLOSE"},VI=function(){return F(this,_e,wa).call(this,o(this,Bt),"[")},qI=function(){return F(this,_e,wa).call(this,o(this,Bt),"]")},Di=function(){let r=o(this,yn)[o(this,Bt)],t=F(this,_e,Rx).call(this,o(this,rf)).index;return o(this,tf).substring(t,r.index)},GI=function(){let r={};Object.assign(r,Gs),r.encodePart=A_;let t=lz(F(this,_e,Di).call(this),void 0,r);_(this,sf,r4(t))},fP),F_=["protocol","username","password","hostname","port","pathname","search","hash"],Xs="*";function o4(r,t){if(typeof r!="string")throw new TypeError("parameter 1 is not of type 'string'.");let e=new URL(r,t);return{protocol:e.protocol.substring(0,e.protocol.length-1),username:e.username,password:e.password,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search!==""?e.search.substring(1,e.search.length):void 0,hash:e.hash!==""?e.hash.substring(1,e.hash.length):void 0}}function Ki(r,t){return t?lp(r):r}function cp(r,t,e){let n;if(typeof t.baseURL=="string")try{n=new URL(t.baseURL),t.protocol===void 0&&(r.protocol=Ki(n.protocol.substring(0,n.protocol.length-1),e)),!e&&t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.username===void 0&&(r.username=Ki(n.username,e)),!e&&t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.username===void 0&&t.password===void 0&&(r.password=Ki(n.password,e)),t.protocol===void 0&&t.hostname===void 0&&(r.hostname=Ki(n.hostname,e)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&(r.port=Ki(n.port,e)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&(r.pathname=Ki(n.pathname,e)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&t.search===void 0&&(r.search=Ki(n.search.substring(1,n.search.length),e)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&t.search===void 0&&t.hash===void 0&&(r.hash=Ki(n.hash.substring(1,n.hash.length),e))}catch{throw new TypeError(`invalid baseURL '${t.baseURL}'.`)}if(typeof t.protocol=="string"&&(r.protocol=kz(t.protocol,e)),typeof t.username=="string"&&(r.username=vz(t.username,e)),typeof t.password=="string"&&(r.password=wz(t.password,e)),typeof t.hostname=="string"&&(r.hostname=gz(t.hostname,e)),typeof t.port=="string"&&(r.port=xz(t.port,r.protocol,e)),typeof t.pathname=="string"){if(r.pathname=t.pathname,n&&!dz(r.pathname,e)){let a=n.pathname.lastIndexOf("/");a>=0&&(r.pathname=Ki(n.pathname.substring(0,a+1),e)+r.pathname)}r.pathname=yz(r.pathname,r.protocol,e)}return typeof t.search=="string"&&(r.search=mz(t.search,e)),typeof t.hash=="string"&&(r.hash=pz(t.hash,e)),r}function lp(r){return r.replace(/([+*?:{}()\\])/g,"\\$1")}function Fz(r){return r.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function Pz(r,t){t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./"),t.sensitive??(t.sensitive=!1),t.strict??(t.strict=!1),t.end??(t.end=!0),t.start??(t.start=!0),t.endsWith="";let e=".*",n=`[^${Fz(t.delimiter)}]+?`,a=/[$_\u200C\u200D\p{ID_Continue}]/u,i="";for(let s=0;s<r.length;++s){let c=r[s];if(c.type===3){if(c.modifier===3){i+=lp(c.value);continue}i+=`{${lp(c.value)}}${wh(c.modifier)}`;continue}let l=c.hasCustomName(),u=!!c.suffix.length||!!c.prefix.length&&(c.prefix.length!==1||!t.prefixes.includes(c.prefix)),h=s>0?r[s-1]:null,d=s<r.length-1?r[s+1]:null;if(!u&&l&&c.type===1&&c.modifier===3&&d&&!d.prefix.length&&!d.suffix.length)if(d.type===3){let f=d.value.length>0?d.value[0]:"";u=a.test(f)}else u=!d.hasCustomName();if(!u&&!c.prefix.length&&h&&h.type===3){let f=h.value[h.value.length-1];u=t.prefixes.includes(f)}u&&(i+="{"),i+=lp(c.prefix),l&&(i+=`:${c.name}`),c.type===2?i+=`(${c.value})`:c.type===1?l||(i+=`(${n})`):c.type===0&&(!l&&(!h||h.type===3||h.modifier!==3||u||c.prefix!=="")?i+="*":i+=`(${e})`),c.type===1&&l&&c.suffix.length&&a.test(c.suffix[0])&&(i+="\\"),i+=lp(c.suffix),u&&(i+="}"),c.modifier!==3&&(i+=wh(c.modifier))}return i}var Iz=(pP=class{constructor(r={},t,e){y(this,gi);y(this,Xl,{});y(this,of,{});y(this,Rr,{});y(this,Ba,{});y(this,cf,!1);try{let n;if(typeof t=="string"?n=t:e=t,typeof r=="string"){let c=new Az(r);if(c.parse(),r=c.result,n===void 0&&typeof r.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");r.baseURL=n}else{if(!r||typeof r!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(n)throw new TypeError("parameter 1 is not of type 'string'.")}typeof e>"u"&&(e={ignoreCase:!1});let a={ignoreCase:e.ignoreCase===!0};_(this,gi,cp({pathname:Xs,protocol:Xs,username:Xs,password:Xs,hostname:Xs,port:Xs,search:Xs,hash:Xs},r,!0)),n4(o(this,gi).protocol)===o(this,gi).port&&(o(this,gi).port="");let s;for(s of F_){if(!(s in o(this,gi)))continue;let c={},l=o(this,gi)[s];switch(o(this,of)[s]=[],s){case"protocol":Object.assign(c,Gs),c.encodePart=A_;break;case"username":Object.assign(c,Gs),c.encodePart=bz;break;case"password":Object.assign(c,Gs),c.encodePart=_z;break;case"hostname":Object.assign(c,uz),e4(l)?c.encodePart=i4:c.encodePart=a4;break;case"port":Object.assign(c,Gs),c.encodePart=s4;break;case"pathname":r4(o(this,Xl).protocol)?(Object.assign(c,hz,a),c.encodePart=Ez):(Object.assign(c,Gs,a),c.encodePart=Sz);break;case"search":Object.assign(c,Gs,a),c.encodePart=Cz;break;case"hash":Object.assign(c,Gs,a),c.encodePart=Tz;break}try{o(this,Ba)[s]=YF(l,c),o(this,Xl)[s]=ZF(o(this,Ba)[s],o(this,of)[s],c),o(this,Rr)[s]=Pz(o(this,Ba)[s],c),_(this,cf,o(this,cf)||o(this,Ba)[s].some(u=>u.type===2))}catch{throw new TypeError(`invalid ${s} pattern '${o(this,gi)[s]}'.`)}}}catch(n){throw new TypeError(`Failed to construct 'URLPattern': ${n.message}`)}}test(r={},t){let e={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof r!="string"&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof r>"u")return!1;try{typeof r=="object"?e=cp(e,r,!1):e=cp(e,o4(r,t),!1)}catch{return!1}let n;for(n of F_)if(!o(this,Xl)[n].exec(e[n]))return!1;return!0}exec(r={},t){let e={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof r!="string"&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof r>"u")return;try{typeof r=="object"?e=cp(e,r,!1):e=cp(e,o4(r,t),!1)}catch{return null}let n={};t?n.inputs=[r,t]:n.inputs=[r];let a;for(a of F_){let i=o(this,Xl)[a].exec(e[a]);if(!i)return null;let s={};for(let[c,l]of o(this,of)[a].entries())if(typeof l=="string"||typeof l=="number"){let u=i[c+1];s[l]=u}n[a]={input:e[a]??"",groups:s}}return n}static compareComponent(r,t,e){let n=(c,l)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(c[u]<l[u])return-1;if(c[u]!==l[u])return 1}return 0},a=new op(3,"","","","",3),i=new op(0,"","","","",3),s=(c,l)=>{let u=0;for(;u<Math.min(c.length,l.length);++u){let h=n(c[u],l[u]);if(h)return h}return c.length===l.length?0:n(c[u]??a,l[u]??a)};return!o(t,Rr)[r]&&!o(e,Rr)[r]?0:o(t,Rr)[r]&&!o(e,Rr)[r]?s(o(t,Ba)[r],[i]):!o(t,Rr)[r]&&o(e,Rr)[r]?s([i],o(e,Ba)[r]):s(o(t,Ba)[r],o(e,Ba)[r])}get protocol(){return o(this,Rr).protocol}get username(){return o(this,Rr).username}get password(){return o(this,Rr).password}get hostname(){return o(this,Rr).hostname}get port(){return o(this,Rr).port}get pathname(){return o(this,Rr).pathname}get search(){return o(this,Rr).search}get hash(){return o(this,Rr).hash}get hasRegExpGroups(){return o(this,cf)}},gi=new WeakMap,Xl=new WeakMap,of=new WeakMap,Rr=new WeakMap,Ba=new WeakMap,cf=new WeakMap,pP);const{URLPattern:c4}=iz;var Dz={URLPattern:c4};globalThis.URLPattern||(globalThis.URLPattern=c4),Object.defineProperty(gh,"__esModule",{value:!0}),gh.URLPattern=void 0;let l4=Dz.URLPattern;gh.URLPattern=l4,"URLPattern"in globalThis&&(gh.URLPattern=l4=globalThis.URLPattern),Object.defineProperty(sp,"__esModule",{value:!0}),sp.NetworkProcessor=void 0;const wr=At,Oz=gh,ca=class ca{constructor(t,e){y(this,wi);y(this,hs);y(this,zo);_(this,hs,t),_(this,zo,e)}async addIntercept(t){o(this,hs).verifyTopLevelContextsList(t.contexts);const e=t.urlPatterns??[],n=ca.parseUrlPatterns(e),a=o(this,zo).addIntercept({urlPatterns:n,phases:t.phases,contexts:t.contexts});return await Promise.all(o(this,hs).getAllContexts().map(i=>i.cdpTarget.toggleFetchIfNeeded())),{intercept:a}}async continueRequest(t){if(t.url!==void 0&&ca.parseUrlString(t.url),t.method!==void 0&&!ca.isMethodValid(t.method))throw new wr.InvalidArgumentException(`Method '${t.method}' is invalid.`);t.headers&&ca.validateHeaders(t.headers);const e=F(this,wi,sw).call(this,t.request,["beforeRequestSent"]);try{await e.continueRequest(t)}catch(n){throw ca.wrapInterceptionError(n)}return{}}async continueResponse(t){t.headers&&ca.validateHeaders(t.headers);const e=F(this,wi,sw).call(this,t.request,["authRequired","responseStarted"]);try{await e.continueResponse(t)}catch(n){throw ca.wrapInterceptionError(n)}return{}}async continueWithAuth(t){const e=t.request;return await F(this,wi,sw).call(this,e,["authRequired"]).continueWithAuth(t),{}}async failRequest({request:t}){const e=F(this,wi,FS).call(this,t);if(e.interceptPhase==="authRequired")throw new wr.InvalidArgumentException(`Request '${t}' in 'authRequired' phase cannot be failed`);if(!e.interceptPhase)throw new wr.NoSuchRequestException(`No blocked request found for network id '${t}'`);return await e.failRequest("Failed"),{}}async provideResponse(t){t.headers&&ca.validateHeaders(t.headers);const e=F(this,wi,sw).call(this,t.request,["beforeRequestSent","responseStarted","authRequired"]);try{await e.provideResponse(t)}catch(n){throw ca.wrapInterceptionError(n)}return{}}async removeIntercept(t){return o(this,zo).removeIntercept(t.intercept),await Promise.all(o(this,hs).getAllContexts().map(e=>e.cdpTarget.toggleFetchIfNeeded())),{}}async setCacheBehavior(t){const e=o(this,hs).verifyTopLevelContextsList(t.contexts);if(e.size===0)return o(this,zo).defaultCacheBehavior=t.cacheBehavior,await Promise.all(o(this,hs).getAllContexts().map(a=>a.cdpTarget.toggleSetCacheDisabled())),{};const n=t.cacheBehavior==="bypass";return await Promise.all([...e.values()].map(a=>a.cdpTarget.toggleSetCacheDisabled(n))),{}}static validateHeaders(t){for(const e of t){let n;if(e.value.type==="string"?n=e.value.value:n=atob(e.value.value),n!==n.trim()||n.includes(`
`)||n.includes("\0"))throw new wr.InvalidArgumentException(`Header value '${n}' is not acceptable value`)}}static isMethodValid(t){return/^[!#$%&'*+\-.^_`|~a-zA-Z\d]+$/.test(t)}static parseUrlString(t){try{return new URL(t)}catch(e){throw new wr.InvalidArgumentException(`Invalid URL '${t}': ${e}`)}}static parseUrlPatterns(t){return t.map(e=>{var n,a,i;switch(e.type){case"string":return ca.parseUrlString(e.pattern),e;case"pattern":if(e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0)return e;if(e.protocol&&(e.protocol=up(e.protocol),!e.protocol.match(/^[a-zA-Z+-.]+$/)))throw new wr.InvalidArgumentException("Forbidden characters");if(e.hostname&&(e.hostname=up(e.hostname)),e.port&&(e.port=up(e.port)),e.pathname){if(e.pathname=up(e.pathname),e.pathname[0]!=="/"&&(e.pathname=`/${e.pathname}`),e.pathname.includes("#")||e.pathname.includes("?"))throw new wr.InvalidArgumentException("Forbidden characters")}else e.pathname===""&&(e.pathname="/");if(e.search&&(e.search=up(e.search),e.search[0]!=="?"&&(e.search=`?${e.search}`),e.search.includes("#")))throw new wr.InvalidArgumentException("Forbidden characters");if(e.protocol==="")throw new wr.InvalidArgumentException("URL pattern must specify a protocol");if(e.hostname==="")throw new wr.InvalidArgumentException("URL pattern must specify a hostname");if((((n=e.hostname)==null?void 0:n.length)??0)>0){if((a=e.protocol)!=null&&a.match(/^file/i))throw new wr.InvalidArgumentException("URL pattern protocol cannot be 'file'");if((i=e.hostname)!=null&&i.includes(":"))throw new wr.InvalidArgumentException("URL pattern hostname must not contain a colon")}if(e.port==="")throw new wr.InvalidArgumentException("URL pattern must specify a port");try{new Oz.URLPattern(e)}catch(s){throw new wr.InvalidArgumentException(`${s}`)}return e}})}static wrapInterceptionError(t){return t!=null&&t.message.includes("Invalid header")?new wr.InvalidArgumentException("Invalid header"):t}};hs=new WeakMap,zo=new WeakMap,wi=new WeakSet,FS=function(t){const e=o(this,zo).getRequestById(t);if(!e)throw new wr.NoSuchRequestException(`Network request with ID '${t}' doesn't exist`);return e},sw=function(t,e){const n=F(this,wi,FS).call(this,t);if(!n.interceptPhase)throw new wr.NoSuchRequestException(`No blocked request found for network id '${t}'`);if(n.interceptPhase&&!e.includes(n.interceptPhase))throw new wr.InvalidArgumentException(`Blocked request for network id '${t}' is in '${n.interceptPhase}' phase`);return n};let P_=ca;sp.NetworkProcessor=P_;function up(r){const t=new Set(["(",")","*","{","}"]);let e="",n=!1;for(const a of r){if(!n){if(t.has(a))throw new wr.InvalidArgumentException("Forbidden characters");if(a==="\\"){n=!0;continue}}e+=a,n=!1}return e}var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0}),Jv.PermissionsProcessor=void 0;const Mz=At;class Rz{constructor(t){y(this,Ng);_(this,Ng,t)}async setPermissions(t){try{const e=t["goog:userContext"]||t.userContext;await o(this,Ng).sendCommand("Browser.setPermission",{origin:t.origin,browserContextId:e&&e!=="default"?e:void 0,permission:{name:t.descriptor.name},setting:t.state})}catch(e){if(e.message==="Permission can't be granted to opaque origins.")return{};throw new Mz.InvalidArgumentException(e.message)}return{}}}Ng=new WeakMap,Jv.PermissionsProcessor=Rz;var Zv={},Qv={},jc={};Object.defineProperty(jc,"__esModule",{value:!0}),jc.uuidv4=Nz;function hp(r){return r.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),"")}function Nz(){if("crypto"in globalThis&&"randomUUID"in globalThis.crypto)return globalThis.crypto.randomUUID();const r=new Uint8Array(16);return"crypto"in globalThis&&"getRandomValues"in globalThis.crypto?globalThis.crypto.getRandomValues(r):f2.webcrypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,[hp(r.subarray(0,4)),hp(r.subarray(4,6)),hp(r.subarray(6,8)),hp(r.subarray(8,10)),hp(r.subarray(10,16))].join("-")}var dp={};Object.defineProperty(dp,"__esModule",{value:!0}),dp.ChannelProxy=void 0;const Lz=At,u4=Cn,Bz=jc,hf=class hf{constructor(t,e){y(this,Jl);y(this,Yl);y(this,lf,(0,Bz.uuidv4)());y(this,uf);_(this,Yl,t),_(this,uf,e)}async init(t,e){var i,s;const n=await F(i=hf,ds,XI).call(i,t),a=await F(s=hf,ds,YI).call(s,t,n);return F(this,Jl,IS).call(this,t,n,e),a}async startListenerFromWindow(t,e){var n;try{const a=await F(this,Jl,JI).call(this,t);F(this,Jl,IS).call(this,t,a,e)}catch(a){(n=o(this,uf))==null||n.call(this,u4.LogType.debugError,a)}}getEvalInWindowStr(){var n;const t=String((a,i)=>{const s=window;return s[a]===void 0?s[a]=i:(s[a](i),delete s[a]),i.sendMessage}),e=F(n=hf,ds,PS).call(n);return`(${t})('${o(this,lf)}',${e})`}};Yl=new WeakMap,lf=new WeakMap,uf=new WeakMap,ds=new WeakSet,PS=function(){return`(${String(()=>{const e=[];let n=null;return{async getMessage(){return await(e.length>0?Promise.resolve():new Promise(i=>{n=i})),e.shift()},sendMessage(a){e.push(a),n!==null&&(n(),n=null)}}})})()`},XI=async function(t){const e=await t.cdpClient.sendCommand("Runtime.evaluate",{expression:F(this,ds,PS).call(this),contextId:t.executionContextId,serializationOptions:{serialization:"idOnly"}});if(e.exceptionDetails||e.result.objectId===void 0)throw new Error("Cannot create channel");return e.result.objectId},YI=async function(t,e){return(await t.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(a=>a.sendMessage),arguments:[{objectId:e}],executionContextId:t.executionContextId,serializationOptions:{serialization:"idOnly"}})).result.objectId},Jl=new WeakSet,IS=async function(t,e,n){var a,i;for(;;)try{const s=await t.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(async c=>await c.getMessage()),arguments:[{objectId:e}],awaitPromise:!0,executionContextId:t.executionContextId,serializationOptions:{serialization:"deep",maxDepth:((a=o(this,Yl).serializationOptions)==null?void 0:a.maxObjectDepth)??void 0}});if(s.exceptionDetails)throw new Error("Runtime.callFunctionOn in ChannelProxy",{cause:s.exceptionDetails});for(const c of t.associatedBrowsingContexts)n.registerEvent({type:"event",method:Lz.ChromiumBidi.Script.EventNames.Message,params:{channel:o(this,Yl).channel,data:t.cdpToBidiValue(s,o(this,Yl).ownership??"none"),source:t.source}},c.id)}catch(s){(i=o(this,uf))==null||i.call(this,u4.LogType.debugError,s);break}},JI=async function(t){const e=await t.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(n=>{const a=window;if(a[n]===void 0)return new Promise(s=>a[n]=s);const i=a[n];return delete a[n],i}),arguments:[{value:o(this,lf)}],executionContextId:t.executionContextId,awaitPromise:!0,serializationOptions:{serialization:"idOnly"}});if(e.exceptionDetails!==void 0||e.result.objectId===void 0)throw new Error(`ChannelHandle not found in window["${o(this,lf)}"]`);return e.result.objectId},y(hf,ds);let I_=hf;dp.ChannelProxy=I_,Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.PreloadScript=void 0;const Uz=jc,$z=dp;class jz{constructor(t,e){y(this,tx);y(this,ex,(0,Uz.uuidv4)());y(this,Zl,[]);y(this,Lg);y(this,df,new Set);y(this,Bg);y(this,Ug);y(this,$g);var n;_(this,Bg,((n=t.arguments)==null?void 0:n.map(a=>new $z.ChannelProxy(a.value,e)))??[]),_(this,Lg,t.functionDeclaration),_(this,Ug,t.sandbox),_(this,$g,t.contexts)}get id(){return o(this,ex)}get targetIds(){return o(this,df)}get channels(){return o(this,Bg)}get contexts(){return o(this,$g)}async initInTargets(t,e){await Promise.all(Array.from(t).map(n=>this.initInTarget(n,e)))}async initInTarget(t,e){const n=await t.cdpClient.sendCommand("Page.addScriptToEvaluateOnNewDocument",{source:F(this,tx,ZI).call(this),worldName:o(this,Ug),runImmediately:e});o(this,Zl).push({target:t,preloadScriptId:n.identifier}),o(this,df).add(t.id)}async remove(){await Promise.all([o(this,Zl).map(async t=>{const e=t.target,n=t.preloadScriptId;return await e.cdpClient.sendCommand("Page.removeScriptToEvaluateOnNewDocument",{identifier:n})})])}dispose(t){_(this,Zl,o(this,Zl).filter(e=>{var n;return((n=e.target)==null?void 0:n.id)!==t})),o(this,df).delete(t)}}ex=new WeakMap,Zl=new WeakMap,Lg=new WeakMap,df=new WeakMap,Bg=new WeakMap,Ug=new WeakMap,$g=new WeakMap,tx=new WeakSet,ZI=function(){const t=`[${this.channels.map(e=>e.getEvalInWindowStr()).join(", ")}]`;return`(()=>{(${o(this,Lg)})(...${t})})()`},Qv.PreloadScript=jz,Object.defineProperty(Zv,"__esModule",{value:!0}),Zv.ScriptProcessor=void 0;const D_=At,Hz=Qv;class Wz{constructor(t,e,n,a,i){y(this,Ko);y(this,ff);y(this,vi);y(this,Ql);y(this,eu);y(this,jg);_(this,vi,e),_(this,Ql,n),_(this,eu,a),_(this,jg,i),_(this,ff,t),o(this,ff).addSubscribeHook(D_.ChromiumBidi.Script.EventNames.RealmCreated,F(this,Ko,QI).bind(this))}async addPreloadScript(t){const e=o(this,vi).verifyTopLevelContextsList(t.contexts),n=new Hz.PreloadScript(t,o(this,jg));o(this,eu).add(n);const a=e.size===0?new Set(o(this,vi).getTopLevelContexts().map(i=>i.cdpTarget)):new Set([...e.values()].map(i=>i.cdpTarget));return await n.initInTargets(a,!1),{script:n.id}}async removePreloadScript(t){const{script:e}=t,n=o(this,eu).find({id:e});if(n.length===0)throw new D_.NoSuchScriptException(`No preload script with id '${e}'`);return await Promise.all(n.map(a=>a.remove())),o(this,eu).remove({id:e}),{}}async callFunction(t){return await(await F(this,Ko,Bx).call(this,t.target)).callFunction(t.functionDeclaration,t.awaitPromise,t.this,t.arguments,t.resultOwnership,t.serializationOptions,t.userActivation)}async evaluate(t){return await(await F(this,Ko,Bx).call(this,t.target)).evaluate(t.expression,t.awaitPromise,t.resultOwnership,t.serializationOptions,t.userActivation)}async disown(t){const e=await F(this,Ko,Bx).call(this,t.target);return await Promise.all(t.handles.map(async n=>await e.disown(n))),{}}getRealms(t){return t.context!==void 0&&o(this,vi).getContext(t.context),{realms:o(this,Ql).findRealms({browsingContextId:t.context,type:t.type}).map(n=>n.realmInfo)}}}ff=new WeakMap,vi=new WeakMap,Ql=new WeakMap,eu=new WeakMap,jg=new WeakMap,Ko=new WeakSet,QI=function(t){const e=o(this,vi).getContext(t),n=[e,...o(this,vi).getContext(t).allChildren],a=new Set;for(const i of n){const s=o(this,Ql).findRealms({browsingContextId:i.id});for(const c of s)a.add(c)}for(const i of a)o(this,ff).registerEvent({type:"event",method:D_.ChromiumBidi.Script.EventNames.RealmCreated,params:i.realmInfo},e.id);return Promise.resolve()},Bx=async function(t){return"context"in t?await o(this,vi).getContext(t.context).getOrCreateSandbox(t.sandbox):o(this,Ql).getRealm({realmId:t.realm})},Zv.ScriptProcessor=Wz;var ey={};Object.defineProperty(ey,"__esModule",{value:!0}),ey.SessionProcessor=void 0;const O_=At;class zz{constructor(t,e,n){y(this,mf);y(this,pf);y(this,Hg);y(this,Wg);y(this,zg,!1);_(this,pf,t),_(this,Hg,e),_(this,Wg,n)}status(){return{ready:!1,message:"already connected"}}async new(t){if(o(this,zg))throw new Error("Session has been already created.");_(this,zg,!0);const e=F(this,mf,eD).call(this,t.capabilities);await o(this,Wg).call(this,e);const n=await o(this,Hg).sendCommand("Browser.getVersion");return{sessionId:"unknown",capabilities:{...e,acceptInsecureCerts:e.acceptInsecureCerts??!1,browserName:n.product,browserVersion:n.revision,platformName:"",setWindowRect:!1,webSocketUrl:"",userAgent:n.userAgent}}}async subscribe(t,e=null){return await o(this,pf).subscribe(t.events,t.contexts??[null],e),{}}async unsubscribe(t,e=null){return await o(this,pf).unsubscribe(t.events,t.contexts??[null],e),{}}}pf=new WeakMap,Hg=new WeakMap,Wg=new WeakMap,zg=new WeakMap,mf=new WeakSet,eD=function(t){const e=[];for(const a of t.firstMatch??[{}]){const i={...t.alwaysMatch};for(const s of Object.keys(a)){if(i[s]!==void 0)throw new O_.InvalidArgumentException(`Capability ${s} in firstMatch is already defined in alwaysMatch`);i[s]=a[s]}e.push(i)}const n=e.find(a=>a.browserName==="chrome")??e[0]??{};return n.unhandledPromptBehavior=F(this,mf,tD).call(this,n.unhandledPromptBehavior),n},tD=function(t){if(t!==void 0){if(typeof t=="object")return t;if(typeof t!="string")throw new O_.InvalidArgumentException(`Unexpected 'unhandledPromptBehavior' type: ${typeof t}`);switch(t){case"accept":case"accept and notify":return{default:"accept"};case"dismiss":case"dismiss and notify":return{default:"dismiss"};case"ignore":return{default:"ignore"};default:throw new O_.InvalidArgumentException(`Unexpected 'unhandledPromptBehavior' value: ${t}`)}}},ey.SessionProcessor=zz;var ty={},ur={},M_={};Object.defineProperty(M_,"__esModule",{value:!0}),M_.base64ToString=Kz;function Kz(r){return"atob"in globalThis?globalThis.atob(r):Buffer.from(r,"base64").toString("ascii")}Object.defineProperty(ur,"__esModule",{value:!0}),ur.computeHeadersSize=Gz,ur.bidiNetworkHeadersFromCdpNetworkHeaders=Xz,ur.bidiNetworkHeadersFromCdpNetworkHeadersEntries=Yz,ur.cdpNetworkHeadersFromBidiNetworkHeaders=Jz,ur.bidiNetworkHeadersFromCdpFetchHeaders=Zz,ur.cdpFetchHeadersFromBidiNetworkHeaders=Qz,ur.networkHeaderFromCookieHeaders=eK,ur.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction=tK,ur.cdpToBiDiCookie=rK,ur.deserializeByteValue=h4,ur.bidiToCdpCookie=nK,ur.sameSiteBiDiToCdp=d4,ur.isSpecialScheme=iK,ur.matchUrlPattern=sK,ur.bidiBodySizeFromCdpPostDataEntries=oK,ur.getTiming=cK;const Vz=We,qz=M_,R_=gh;function Gz(r){const t=r.reduce((e,n)=>`${e}${n.name}: ${n.value.value}\r
`,"");return new TextEncoder().encode(t).length}function Xz(r){return r?Object.entries(r).map(([t,e])=>({name:t,value:{type:"string",value:e}})):[]}function Yz(r){return r?r.map(({name:t,value:e})=>({name:t,value:{type:"string",value:e}})):[]}function Jz(r){if(r!==void 0)return r.reduce((t,e)=>(t[e.name]=e.value.value,t),{})}function Zz(r){return r?r.map(({name:t,value:e})=>({name:t,value:{type:"string",value:e}})):[]}function Qz(r){if(r!==void 0)return r.map(({name:t,value:e})=>({name:t,value:e.value}))}function eK(r){return r===void 0?void 0:{name:"Cookie",value:{type:"string",value:r.reduce((e,n,a)=>{a>0&&(e+=";");const i=n.value.type==="base64"?btoa(n.value.value):n.value.value;return e+=`${n.name}=${i}`,e},"")}}}function tK(r){switch(r){case"default":return"Default";case"cancel":return"CancelAuth";case"provideCredentials":return"ProvideCredentials"}}function rK(r){const t={name:r.name,value:{type:"string",value:r.value},domain:r.domain,path:r.path,size:r.size,httpOnly:r.httpOnly,secure:r.secure,sameSite:r.sameSite===void 0?"none":aK(r.sameSite),...r.expires>=0?{expiry:r.expires}:void 0};return t["goog:session"]=r.session,t["goog:priority"]=r.priority,t["goog:sameParty"]=r.sameParty,t["goog:sourceScheme"]=r.sourceScheme,t["goog:sourcePort"]=r.sourcePort,r.partitionKey!==void 0&&(t["goog:partitionKey"]=r.partitionKey),r.partitionKeyOpaque!==void 0&&(t["goog:partitionKeyOpaque"]=r.partitionKeyOpaque),t}function h4(r){return r.type==="base64"?(0,qz.base64ToString)(r.value):r.value}function nK(r,t){const e=h4(r.cookie.value),n={name:r.cookie.name,value:e,domain:r.cookie.domain,path:r.cookie.path??"/",secure:r.cookie.secure??!1,httpOnly:r.cookie.httpOnly??!1,...t.sourceOrigin!==void 0&&{partitionKey:{hasCrossSiteAncestor:!1,topLevelSite:t.sourceOrigin}},...r.cookie.expiry!==void 0&&{expires:r.cookie.expiry},...r.cookie.sameSite!==void 0&&{sameSite:d4(r.cookie.sameSite)}};return r.cookie["goog:url"]!==void 0&&(n.url=r.cookie["goog:url"]),r.cookie["goog:priority"]!==void 0&&(n.priority=r.cookie["goog:priority"]),r.cookie["goog:sameParty"]!==void 0&&(n.sameParty=r.cookie["goog:sameParty"]),r.cookie["goog:sourceScheme"]!==void 0&&(n.sourceScheme=r.cookie["goog:sourceScheme"]),r.cookie["goog:sourcePort"]!==void 0&&(n.sourcePort=r.cookie["goog:sourcePort"]),n}function aK(r){switch(r){case"Strict":return"strict";case"None":return"none";case"Lax":return"lax";default:return"lax"}}function d4(r){switch(r){case"strict":return"Strict";case"lax":return"Lax";case"none":return"None"}throw new Vz.InvalidArgumentException(`Unknown 'sameSite' value ${r}`)}function iK(r){return["ftp","file","http","https","ws","wss"].includes(r.replace(/:$/,""))}function sK(r,t){switch(r.type){case"string":{const e=new R_.URLPattern(r.pattern);return new R_.URLPattern({protocol:e.protocol,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search}).test(t)}case"pattern":return new R_.URLPattern(r).test(t)}}function oK(r){let t=0;for(const e of r)t+=atob(e.bytes??"").length;return t}function cK(r){return!r||r<0?0:r}Object.defineProperty(ty,"__esModule",{value:!0}),ty.StorageProcessor=void 0;const ry=At,lK=zi,f4=Cn,uK=sp,fp=ur;class hK{constructor(t,e,n){y(this,Gt);y(this,Vo);y(this,Kg);y(this,gf);_(this,Kg,e),_(this,Vo,t),_(this,gf,n)}async deleteCookies(t){const e=F(this,Gt,$x).call(this,t.partition);let n;try{n=await o(this,Vo).sendCommand("Storage.getCookies",{browserContextId:F(this,Gt,ow).call(this,e)})}catch(i){throw F(this,Gt,Ux).call(this,i)?new ry.NoSuchUserContextException(i.message):i}const a=n.cookies.filter(i=>{var s;return e.sourceOrigin===void 0||((s=i.partitionKey)==null?void 0:s.topLevelSite)===e.sourceOrigin}).filter(i=>{const s=(0,fp.cdpToBiDiCookie)(i);return F(this,Gt,DS).call(this,s,t.filter)}).map(i=>({...i,expires:1}));return await o(this,Vo).sendCommand("Storage.setCookies",{cookies:a,browserContextId:F(this,Gt,ow).call(this,e)}),{partitionKey:e}}async getCookies(t){const e=F(this,Gt,$x).call(this,t.partition);let n;try{n=await o(this,Vo).sendCommand("Storage.getCookies",{browserContextId:F(this,Gt,ow).call(this,e)})}catch(i){throw F(this,Gt,Ux).call(this,i)?new ry.NoSuchUserContextException(i.message):i}return{cookies:n.cookies.filter(i=>{var s;return e.sourceOrigin===void 0||((s=i.partitionKey)==null?void 0:s.topLevelSite)===e.sourceOrigin}).map(i=>(0,fp.cdpToBiDiCookie)(i)).filter(i=>F(this,Gt,DS).call(this,i,t.filter)),partitionKey:e}}async setCookie(t){var a;const e=F(this,Gt,$x).call(this,t.partition),n=(0,fp.bidiToCdpCookie)(t,e);try{await o(this,Vo).sendCommand("Storage.setCookies",{cookies:[n],browserContextId:F(this,Gt,ow).call(this,e)})}catch(i){throw F(this,Gt,Ux).call(this,i)?new ry.NoSuchUserContextException(i.message):((a=o(this,gf))==null||a.call(this,f4.LogType.debugError,i),new ry.UnableToSetCookieException(i.toString()))}return{partitionKey:e}}}Vo=new WeakMap,Kg=new WeakMap,gf=new WeakMap,Gt=new WeakSet,Ux=function(t){var e;return(e=t.message)==null?void 0:e.startsWith("Failed to find browser context for id")},ow=function(t){return t.userContext==="default"?void 0:t.userContext},rD=function(t){const e=t.context;return{userContext:o(this,Kg).getContext(e).userContext}},nD=function(t){var i;const e=new Map;let n=t.sourceOrigin;if(n!==void 0){const s=uK.NetworkProcessor.parseUrlString(n);s.origin==="null"?n=s.origin:n=`${s.protocol}//${s.hostname}`}for(const[s,c]of Object.entries(t))s!==void 0&&c!==void 0&&!["type","sourceOrigin","userContext"].includes(s)&&e.set(s,c);return e.size>0&&((i=o(this,gf))==null||i.call(this,f4.LogType.debugInfo,`Unsupported partition keys: ${JSON.stringify(Object.fromEntries(e))}`)),{userContext:t.userContext??"default",...n===void 0?{}:{sourceOrigin:n}}},$x=function(t){return t===void 0?{userContext:"default"}:t.type==="context"?F(this,Gt,rD).call(this,t):((0,lK.assert)(t.type==="storageKey","Unknown partition type"),F(this,Gt,nD).call(this,t))},DS=function(t,e){return e===void 0?!0:(e.domain===void 0||e.domain===t.domain)&&(e.name===void 0||e.name===t.name)&&(e.value===void 0||(0,fp.deserializeByteValue)(e.value)===(0,fp.deserializeByteValue)(t.value))&&(e.path===void 0||e.path===t.path)&&(e.size===void 0||e.size===t.size)&&(e.httpOnly===void 0||e.httpOnly===t.httpOnly)&&(e.secure===void 0||e.secure===t.secure)&&(e.sameSite===void 0||e.sameSite===t.sameSite)&&(e.expiry===void 0||e.expiry===t.expiry)},ty.StorageProcessor=hK;var vh={};Object.defineProperty(vh,"__esModule",{value:!0}),vh.OutgoingMessage=void 0;const rx=class rx{constructor(t,e=null){y(this,Vg);y(this,qg);_(this,Vg,t),_(this,qg,e)}static createFromPromise(t,e){return t.then(n=>n.kind==="success"?{kind:"success",value:new rx(n.value,e)}:n)}static createResolved(t,e){return Promise.resolve({kind:"success",value:new rx(t,e)})}get message(){return o(this,Vg)}get channel(){return o(this,qg)}};Vg=new WeakMap,qg=new WeakMap;let N_=rx;vh.OutgoingMessage=N_,Object.defineProperty(Rv,"__esModule",{value:!0}),Rv.CommandProcessor=void 0;const pp=At,dK=Uc,fK=Cn,pK=Nv,mK=Lv,gK=Bv,wK=Uv,vK=$v,yK=sp,xK=Jv,kK=Zv,bK=ey,_K=ty,L_=vh;class EK extends dK.EventEmitter{constructor(e,n,a,i,s,c,l,u,h=new pK.BidiNoOpParser,d,f){super();y(this,Xo);y(this,Gg);y(this,qo);y(this,cn);y(this,tu);y(this,ru);y(this,la);y(this,Xg);y(this,yi);y(this,Go);y(this,nu);y(this,Je);y(this,Yg);_(this,Je,h),_(this,Yg,f),_(this,Gg,u),_(this,qo,new mK.BrowserProcessor(n)),_(this,cn,new wK.BrowsingContextProcessor(n,i,a)),_(this,tu,new gK.CdpProcessor(i,s,e,n)),_(this,ru,new vK.InputProcessor(i)),_(this,la,new yK.NetworkProcessor(i,l)),_(this,Xg,new xK.PermissionsProcessor(n)),_(this,yi,new kK.ScriptProcessor(a,i,s,c,f)),_(this,Go,new bK.SessionProcessor(a,n,d)),_(this,nu,new _K.StorageProcessor(n,i,f))}async processCommand(e){var n;try{const a=await F(this,Xo,aD).call(this,e),i={type:"success",id:e.id,result:a};this.emit("response",{message:L_.OutgoingMessage.createResolved(i,e.channel),event:e.method})}catch(a){if(a instanceof pp.Exception)this.emit("response",{message:L_.OutgoingMessage.createResolved(a.toErrorResponse(e.id),e.channel),event:e.method});else{const i=a;(n=o(this,Yg))==null||n.call(this,fK.LogType.bidi,i),this.emit("response",{message:L_.OutgoingMessage.createResolved(new pp.UnknownErrorException(i.message,i.stack).toErrorResponse(e.id),e.channel),event:e.method})}}}}Gg=new WeakMap,qo=new WeakMap,cn=new WeakMap,tu=new WeakMap,ru=new WeakMap,la=new WeakMap,Xg=new WeakMap,yi=new WeakMap,Go=new WeakMap,nu=new WeakMap,Je=new WeakMap,Yg=new WeakMap,Xo=new WeakSet,aD=async function(e){switch(e.method){case"session.end":break;case"bluetooth.handleRequestDevicePrompt":return await o(this,Gg).handleRequestDevicePrompt(o(this,Je).parseHandleRequestDevicePromptParams(e.params));case"browser.close":return o(this,qo).close();case"browser.createUserContext":return await o(this,qo).createUserContext(e.params);case"browser.getClientWindows":throw new pp.UnknownErrorException(`Method ${e.method} is not implemented.`);case"browser.getUserContexts":return await o(this,qo).getUserContexts();case"browser.removeUserContext":return await o(this,qo).removeUserContext(o(this,Je).parseRemoveUserContextParams(e.params));case"browser.setClientWindowState":throw new pp.UnknownErrorException(`Method ${e.method} is not implemented.`);case"browsingContext.activate":return await o(this,cn).activate(o(this,Je).parseActivateParams(e.params));case"browsingContext.captureScreenshot":return await o(this,cn).captureScreenshot(o(this,Je).parseCaptureScreenshotParams(e.params));case"browsingContext.close":return await o(this,cn).close(o(this,Je).parseCloseParams(e.params));case"browsingContext.create":return await o(this,cn).create(o(this,Je).parseCreateParams(e.params));case"browsingContext.getTree":return o(this,cn).getTree(o(this,Je).parseGetTreeParams(e.params));case"browsingContext.handleUserPrompt":return await o(this,cn).handleUserPrompt(o(this,Je).parseHandleUserPromptParams(e.params));case"browsingContext.locateNodes":return await o(this,cn).locateNodes(o(this,Je).parseLocateNodesParams(e.params));case"browsingContext.navigate":return await o(this,cn).navigate(o(this,Je).parseNavigateParams(e.params));case"browsingContext.print":return await o(this,cn).print(o(this,Je).parsePrintParams(e.params));case"browsingContext.reload":return await o(this,cn).reload(o(this,Je).parseReloadParams(e.params));case"browsingContext.setViewport":return await o(this,cn).setViewport(o(this,Je).parseSetViewportParams(e.params));case"browsingContext.traverseHistory":return await o(this,cn).traverseHistory(o(this,Je).parseTraverseHistoryParams(e.params));case"cdp.getSession":return o(this,tu).getSession(o(this,Je).parseGetSessionParams(e.params));case"cdp.resolveRealm":return o(this,tu).resolveRealm(o(this,Je).parseResolveRealmParams(e.params));case"cdp.sendCommand":return await o(this,tu).sendCommand(o(this,Je).parseSendCommandParams(e.params));case"input.performActions":return await o(this,ru).performActions(o(this,Je).parsePerformActionsParams(e.params));case"input.releaseActions":return await o(this,ru).releaseActions(o(this,Je).parseReleaseActionsParams(e.params));case"input.setFiles":return await o(this,ru).setFiles(o(this,Je).parseSetFilesParams(e.params));case"network.addIntercept":return await o(this,la).addIntercept(o(this,Je).parseAddInterceptParams(e.params));case"network.continueRequest":return await o(this,la).continueRequest(o(this,Je).parseContinueRequestParams(e.params));case"network.continueResponse":return await o(this,la).continueResponse(o(this,Je).parseContinueResponseParams(e.params));case"network.continueWithAuth":return await o(this,la).continueWithAuth(o(this,Je).parseContinueWithAuthParams(e.params));case"network.failRequest":return await o(this,la).failRequest(o(this,Je).parseFailRequestParams(e.params));case"network.provideResponse":return await o(this,la).provideResponse(o(this,Je).parseProvideResponseParams(e.params));case"network.removeIntercept":return await o(this,la).removeIntercept(o(this,Je).parseRemoveInterceptParams(e.params));case"network.setCacheBehavior":return await o(this,la).setCacheBehavior(o(this,Je).parseSetCacheBehavior(e.params));case"permissions.setPermission":return await o(this,Xg).setPermissions(o(this,Je).parseSetPermissionsParams(e.params));case"script.addPreloadScript":return await o(this,yi).addPreloadScript(o(this,Je).parseAddPreloadScriptParams(e.params));case"script.callFunction":return await o(this,yi).callFunction(o(this,Je).parseCallFunctionParams(F(this,Xo,jx).call(this,e.params)));case"script.disown":return await o(this,yi).disown(o(this,Je).parseDisownParams(F(this,Xo,jx).call(this,e.params)));case"script.evaluate":return await o(this,yi).evaluate(o(this,Je).parseEvaluateParams(F(this,Xo,jx).call(this,e.params)));case"script.getRealms":return o(this,yi).getRealms(o(this,Je).parseGetRealmsParams(e.params));case"script.removePreloadScript":return await o(this,yi).removePreloadScript(o(this,Je).parseRemovePreloadScriptParams(e.params));case"session.new":return await o(this,Go).new(e.params);case"session.status":return o(this,Go).status();case"session.subscribe":return await o(this,Go).subscribe(o(this,Je).parseSubscribeParams(e.params),e.channel);case"session.unsubscribe":return await o(this,Go).unsubscribe(o(this,Je).parseSubscribeParams(e.params),e.channel);case"storage.deleteCookies":return await o(this,nu).deleteCookies(o(this,Je).parseDeleteCookiesParams(e.params));case"storage.getCookies":return await o(this,nu).getCookies(o(this,Je).parseGetCookiesParams(e.params));case"storage.setCookie":return await o(this,nu).setCookie(o(this,Je).parseSetCookieParams(e.params))}throw new pp.UnknownCommandException(`Unknown command '${e.method}'.`)},jx=function(e){return typeof e=="object"&&e&&"target"in e&&typeof e.target=="object"&&e.target&&"context"in e.target&&delete e.target.realm,e},Rv.CommandProcessor=EK;var ny={};Object.defineProperty(ny,"__esModule",{value:!0}),ny.BluetoothProcessor=void 0;class SK{constructor(t,e){y(this,Jg);y(this,Zg);_(this,Jg,t),_(this,Zg,e)}onCdpTargetCreated(t){t.cdpClient.on("DeviceAccess.deviceRequestPrompted",e=>{o(this,Jg).registerEvent({type:"event",method:"bluetooth.requestDevicePromptUpdated",params:{context:t.id,prompt:e.id,devices:e.devices}},t.id)})}async handleRequestDevicePrompt(t){const e=o(this,Zg).getContext(t.context);return t.accept?await e.cdpTarget.cdpClient.sendCommand("DeviceAccess.selectPrompt",{id:t.prompt,deviceId:t.device}):await e.cdpTarget.cdpClient.sendCommand("DeviceAccess.cancelPrompt",{id:t.prompt}),{}}}Jg=new WeakMap,Zg=new WeakMap,ny.BluetoothProcessor=SK;var ay={},yh={},xh={};Object.defineProperty(xh,"__esModule",{value:!0}),xh.Deferred=void 0,mP=Symbol.toStringTag;class CK{constructor(){y(this,fs,!1);y(this,Yo);y(this,Qg);y(this,e1);y(this,t1);H(this,mP,"Promise");_(this,Yo,new Promise((t,e)=>{_(this,e1,t),_(this,t1,e)})),o(this,Yo).catch(t=>{})}get isFinished(){return o(this,fs)}get result(){if(!o(this,fs))throw new Error("Deferred is not finished yet");return o(this,Qg)}then(t,e){return o(this,Yo).then(t,e)}catch(t){return o(this,Yo).catch(t)}resolve(t){_(this,Qg,t),o(this,fs)||(_(this,fs,!0),o(this,e1).call(this,t))}reject(t){o(this,fs)||(_(this,fs,!0),o(this,t1).call(this,t))}finally(t){return o(this,Yo).finally(t)}}fs=new WeakMap,Yo=new WeakMap,Qg=new WeakMap,e1=new WeakMap,t1=new WeakMap,xh.Deferred=CK;var B_={};Object.defineProperty(B_,"__esModule",{value:!0}),B_.inchesFromCm=TK;function TK(r){return r/2.54}var mp={},gp={};Object.defineProperty(gp,"__esModule",{value:!0}),gp.Realm=void 0;const iy=At,AK=Cn,FK=jc,PK=dp;let IK=($a=class{constructor(t,e,n,a,i,s,c){y(this,yr);y(this,r1);y(this,au);y(this,n1);y(this,wf);y(this,a1);y(this,i1);y(this,Jo);_(this,r1,t),_(this,au,e),_(this,n1,n),_(this,wf,a),_(this,a1,i),_(this,i1,s),_(this,Jo,c),o(this,Jo).addRealm(this)}cdpToBidiValue(t,e){const n=this.serializeForBiDi(t.result.deepSerializedValue,new Map);if(t.result.objectId){const a=t.result.objectId;e==="root"?(n.handle=a,o(this,Jo).knownHandlesToRealmMap.set(a,this.realmId)):F(this,yr,BS).call(this,a).catch(i=>{var s;return(s=o(this,wf))==null?void 0:s.call(this,AK.LogType.debugError,i)})}return n}serializeForBiDi(t,e){if(Object.hasOwn(t,"weakLocalObjectReference")){const a=t.weakLocalObjectReference;e.has(a)||e.set(a,(0,FK.uuidv4)()),t.internalId=e.get(a),delete t.weakLocalObjectReference}if(t.type==="node"&&Object.hasOwn(t==null?void 0:t.value,"frameId")&&delete t.value.frameId,t.type==="platformobject")return{type:"object"};const n=t.value;if(n===void 0)return t;if(["array","set","htmlcollection","nodelist"].includes(t.type))for(const a in n)n[a]=this.serializeForBiDi(n[a],e);if(["object","map"].includes(t.type))for(const a in n)n[a]=[this.serializeForBiDi(n[a][0],e),this.serializeForBiDi(n[a][1],e)];return t}get realmId(){return o(this,i1)}get executionContextId(){return o(this,n1)}get origin(){return o(this,a1)}get source(){return{realm:this.realmId}}get cdpClient(){return o(this,r1)}get baseInfo(){return{realm:this.realmId,origin:this.origin}}async evaluate(t,e,n="none",a={},i=!1,s=!1){var l;const c=await this.cdpClient.sendCommand("Runtime.evaluate",{contextId:this.executionContextId,expression:t,awaitPromise:e,serializationOptions:F(l=$a,Ua,LS).call(l,"deep",a),userGesture:i,includeCommandLineAPI:s});return c.exceptionDetails?await F(this,yr,NS).call(this,c.exceptionDetails,0,n):{realm:this.realmId,result:this.cdpToBidiValue(c,n),type:"success"}}initialize(){F(this,yr,OS).call(this,{type:"event",method:iy.ChromiumBidi.Script.EventNames.RealmCreated,params:this.realmInfo})}async serializeCdpObject(t,e){var i;const n=F(i=$a,Ua,iD).call(i,t),a=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(s=>s),awaitPromise:!1,arguments:[n],serializationOptions:{serialization:"deep"},executionContextId:this.executionContextId});return this.cdpToBidiValue(a,e)}async stringifyObject(t){const{result:e}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(n=>String(n)),awaitPromise:!1,arguments:[t],returnByValue:!0,executionContextId:this.executionContextId});return e.value}async callFunction(t,e,n={type:"undefined"},a=[],i="none",s={},c=!1){var d;const l=`(...args) => {
      function callFunction(f, args) {
        const deserializedThis = args.shift();
        const deserializedArgs = args;
        return f.apply(deserializedThis, deserializedArgs);
      }
      return callFunction((
        ${t}
      ), args);
    }`,u=[await this.deserializeForCdp(n),...await Promise.all(a.map(async f=>await this.deserializeForCdp(f)))];let h;try{h=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:l,awaitPromise:e,arguments:u,serializationOptions:F(d=$a,Ua,LS).call(d,"deep",s),executionContextId:this.executionContextId,userGesture:c})}catch(f){throw f.code===-32e3&&["Could not find object with given id","Argument should belong to the same JavaScript world as target object","Invalid remote object id"].includes(f.message)?new iy.NoSuchHandleException("Handle was not found."):f}return h.exceptionDetails?await F(this,yr,NS).call(this,h.exceptionDetails,1,i):{type:"success",result:this.cdpToBidiValue(h,i),realm:this.realmId}}async deserializeForCdp(t){if("handle"in t&&t.handle)return{objectId:t.handle};if("handle"in t||"sharedId"in t)throw new iy.NoSuchHandleException("Handle was not found.");switch(t.type){case"undefined":return{unserializableValue:"undefined"};case"null":return{unserializableValue:"null"};case"string":return{value:t.value};case"number":return t.value==="NaN"?{unserializableValue:"NaN"}:t.value==="-0"?{unserializableValue:"-0"}:t.value==="Infinity"?{unserializableValue:"Infinity"}:t.value==="-Infinity"?{unserializableValue:"-Infinity"}:{value:t.value};case"boolean":return{value:!!t.value};case"bigint":return{unserializableValue:`BigInt(${JSON.stringify(t.value)})`};case"date":return{unserializableValue:`new Date(Date.parse(${JSON.stringify(t.value)}))`};case"regexp":return{unserializableValue:`new RegExp(${JSON.stringify(t.value.pattern)}, ${JSON.stringify(t.value.flags)})`};case"map":{const e=await F(this,yr,MS).call(this,t.value),{result:n}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...a)=>{const i=new Map;for(let s=0;s<a.length;s+=2)i.set(a[s],a[s+1]);return i}),awaitPromise:!1,arguments:e,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:n.objectId}}case"object":{const e=await F(this,yr,MS).call(this,t.value),{result:n}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...a)=>{const i={};for(let s=0;s<a.length;s+=2){const c=a[s];i[c]=a[s+1]}return i}),awaitPromise:!1,arguments:e,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:n.objectId}}case"array":{const e=await F(this,yr,RS).call(this,t.value),{result:n}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...a)=>a),awaitPromise:!1,arguments:e,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:n.objectId}}case"set":{const e=await F(this,yr,RS).call(this,t.value),{result:n}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...a)=>new Set(a)),awaitPromise:!1,arguments:e,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:n.objectId}}case"channel":return{objectId:await new PK.ChannelProxy(t.value,o(this,wf)).init(this,o(this,au))}}throw new Error(`Value ${JSON.stringify(t)} is not deserializable.`)}async disown(t){o(this,Jo).knownHandlesToRealmMap.get(t)===this.realmId&&(await F(this,yr,BS).call(this,t),o(this,Jo).knownHandlesToRealmMap.delete(t))}dispose(){F(this,yr,OS).call(this,{type:"event",method:iy.ChromiumBidi.Script.EventNames.RealmDestroyed,params:{realm:this.realmId}})}},r1=new WeakMap,au=new WeakMap,n1=new WeakMap,wf=new WeakMap,a1=new WeakMap,i1=new WeakMap,Jo=new WeakMap,yr=new WeakSet,OS=function(t){if(this.associatedBrowsingContexts.length===0)o(this,au).registerEvent(t,null);else for(const e of this.associatedBrowsingContexts)o(this,au).registerEvent(t,e.id)},Ua=new WeakSet,iD=function(t){return t.objectId!==void 0?{objectId:t.objectId}:t.unserializableValue!==void 0?{unserializableValue:t.unserializableValue}:{value:t.value}},MS=async function(t){return(await Promise.all(t.map(async([n,a])=>{let i;typeof n=="string"?i={value:n}:i=await this.deserializeForCdp(n);const s=await this.deserializeForCdp(a);return[i,s]}))).flat()},RS=async function(t){return await Promise.all(t.map(e=>this.deserializeForCdp(e)))},sD=async function(t,e,n){var s;const a=((s=t.stackTrace)==null?void 0:s.callFrames.map(c=>({url:c.url,functionName:c.functionName,lineNumber:c.lineNumber-e,columnNumber:c.columnNumber})))??[],i=t.exception;return{exception:await this.serializeCdpObject(i,n),columnNumber:t.columnNumber,lineNumber:t.lineNumber-e,stackTrace:{callFrames:a},text:await this.stringifyObject(i)||t.text}},NS=async function(t,e,n){return{exceptionDetails:await F(this,yr,sD).call(this,t,e,n),realm:this.realmId,type:"exception"}},LS=function(t,e){var n,a;return{serialization:t,additionalParameters:F(n=$a,Ua,oD).call(n,e),...F(a=$a,Ua,cD).call(a,e)}},oD=function(t){const e={};return t.maxDomDepth!==void 0&&(e.maxNodeDepth=t.maxDomDepth===null?1e3:t.maxDomDepth),t.includeShadowTree!==void 0&&(e.includeShadowTree=t.includeShadowTree),e},cD=function(t){return t.maxObjectDepth===void 0||t.maxObjectDepth===null?{}:{maxDepth:t.maxObjectDepth}},BS=async function(t){try{await this.cdpClient.sendCommand("Runtime.releaseObject",{objectId:t})}catch(e){if(!(e.code===-32e3&&e.message==="Invalid remote object id"))throw e}},y($a,Ua),$a);gp.Realm=IK;var sy={};Object.defineProperty(sy,"__esModule",{value:!0}),sy.getSharedId=OK,sy.parseSharedId=RK;const DK="_element_";function OK(r,t,e){return`f.${r}.d.${t}.e.${e}`}function MK(r){const t=r.match(new RegExp(`(.*)${DK}(.*)`));if(!t)return null;const e=t[1],n=t[2];if(e===void 0||n===void 0)return null;const a=parseInt(n??"");return isNaN(a)?null:{documentId:e,backendNodeId:a}}function RK(r){const t=MK(r);if(t!==null)return{...t,frameId:void 0};const e=r.match(/f\.(.*)\.d\.(.*)\.e\.([0-9]*)/);if(!e)return null;const n=e[1],a=e[2],i=e[3];if(n===void 0||a===void 0||i===void 0)return null;const s=parseInt(i??"");return isNaN(s)?null:{frameId:n,documentId:a,backendNodeId:s}}Object.defineProperty(mp,"__esModule",{value:!0}),mp.WindowRealm=void 0;const oy=At,NK=gp,p4=sy;let LK=(gP=class extends NK.Realm{constructor(e,n,a,i,s,c,l,u,h,d){super(a,i,s,c,l,u,h);y(this,nx);y(this,Zo);y(this,Qo);H(this,"sandbox");_(this,Zo,e),_(this,Qo,n),this.sandbox=d,this.initialize()}get browsingContext(){return o(this,Qo).getContext(o(this,Zo))}get associatedBrowsingContexts(){return[this.browsingContext]}get realmType(){return"window"}get realmInfo(){return{...this.baseInfo,type:this.realmType,context:o(this,Zo),sandbox:this.sandbox}}get source(){return{realm:this.realmId,context:this.browsingContext.id}}serializeForBiDi(e,n){const a=e.value;if(e.type==="node"&&a!==void 0){if(Object.hasOwn(a,"backendNodeId")){let i=this.browsingContext.navigableId??"UNKNOWN";Object.hasOwn(a,"loaderId")&&(i=a.loaderId,delete a.loaderId),e.sharedId=(0,p4.getSharedId)(F(this,nx,lD).call(this,i),i,a.backendNodeId),delete a.backendNodeId}if(Object.hasOwn(a,"children"))for(const i in a.children)a.children[i]=this.serializeForBiDi(a.children[i],n);Object.hasOwn(a,"shadowRoot")&&a.shadowRoot!==null&&(a.shadowRoot=this.serializeForBiDi(a.shadowRoot,n)),a.namespaceURI===""&&(a.namespaceURI=null)}return super.serializeForBiDi(e,n)}async deserializeForCdp(e){if("sharedId"in e&&e.sharedId){const n=(0,p4.parseSharedId)(e.sharedId);if(n===null)throw new oy.NoSuchNodeException(`SharedId "${e.sharedId}" was not found.`);const{documentId:a,backendNodeId:i}=n;if(this.browsingContext.navigableId!==a)throw new oy.NoSuchNodeException(`SharedId "${e.sharedId}" belongs to different document. Current document is ${this.browsingContext.navigableId}.`);try{const{object:s}=await this.cdpClient.sendCommand("DOM.resolveNode",{backendNodeId:i,executionContextId:this.executionContextId});return{objectId:s.objectId}}catch(s){throw s.code===-32e3&&s.message==="No node with given id found"?new oy.NoSuchNodeException(`SharedId "${e.sharedId}" was not found.`):new oy.UnknownErrorException(s.message,s.stack)}}return await super.deserializeForCdp(e)}async evaluate(e,n,a,i,s,c){return await o(this,Qo).getContext(o(this,Zo)).targetUnblockedOrThrow(),await super.evaluate(e,n,a,i,s,c)}async callFunction(e,n,a,i,s,c,l){return await o(this,Qo).getContext(o(this,Zo)).targetUnblockedOrThrow(),await super.callFunction(e,n,a,i,s,c,l)}},Zo=new WeakMap,Qo=new WeakMap,nx=new WeakSet,lD=function(e){const n=o(this,Qo).getAllContexts().find(a=>a.navigableId===e);return(n==null?void 0:n.id)??"UNKNOWN"},gP);mp.WindowRealm=LK;var Fa;Object.defineProperty(yh,"__esModule",{value:!0}),yh.BrowsingContextImpl=void 0,yh.serializeOrigin=m4;const ct=At,wp=zi,ai=xh,cy=Cn,kh=B_,U_=jc,BK=mp;class ly{constructor(t,e,n,a,i,s,c,l,u,h,d){y(this,Tt);y(this,vf);H(this,"userContext");y(this,ps,null);y(this,yf,new Set);y(this,ec);y(this,Nr,{DOMContentLoaded:new ai.Deferred,load:new ai.Deferred});y(this,iu,{withinDocument:new ai.Deferred});y(this,ua);y(this,xn);y(this,xi);y(this,ki);y(this,nt);y(this,kn,new ai.Deferred);y(this,ha);y(this,su,{width:0,height:0});y(this,bi);y(this,_i,(0,U_.uuidv4)());y(this,xf);y(this,da);y(this,s1);y(this,ou);y(this,fa);_(this,nt,a),_(this,vf,t),_(this,ps,e),this.userContext=n,_(this,xn,i),_(this,ec,s),_(this,xi,c),_(this,fa,h),_(this,ha,d),_(this,ua,l),_(this,s1,u)}static create(t,e,n,a,i,s,c,l,u,h,d){var m;const f=new Fa(t,e,n,a,i,s,c,l,u,h,d);return F(m=f,Tt,US).call(m),s.addContext(f),f.isTopLevelContext()||f.parent.addChild(f.id),i.registerPromiseEvent(f.targetUnblockedOrThrow().then(()=>({kind:"success",value:{type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.ContextCreated,params:f.serializeToBidiValue()}}),w=>({kind:"error",error:w})),f.id,ct.ChromiumBidi.BrowsingContext.EventNames.ContextCreated),f}static getTimestamp(){return new Date().getTime()}get navigableId(){return o(this,ki)}get navigationId(){return o(this,_i)}dispose(t){var e;(e=o(this,da))==null||e.reject(new ct.UnknownErrorException("navigation canceled by context disposal")),F(this,Tt,Hx).call(this),o(this,xi).deleteRealms({browsingContextId:this.id}),this.isTopLevelContext()||o(this.parent,yf).delete(this.id),F(this,Tt,dD).call(this),t&&o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.ContextDestroyed,params:this.serializeToBidiValue()},this.id),o(this,xn).clearBufferedEvents(this.id),o(this,ec).deleteContextById(this.id)}get id(){return o(this,vf)}get parentId(){return o(this,ps)}set parentId(t){var e;if(o(this,ps)!==null){(e=o(this,ha))==null||e.call(this,cy.LogType.debugError,"Parent context already set");return}_(this,ps,t),this.isTopLevelContext()||this.parent.addChild(this.id)}get parent(){return this.parentId===null?null:o(this,ec).getContext(this.parentId)}get directChildren(){return[...o(this,yf)].map(t=>o(this,ec).getContext(t))}get allChildren(){const t=this.directChildren;return t.concat(...t.map(e=>e.allChildren))}isTopLevelContext(){return o(this,ps)===null}get top(){let t=this,e=t.parent;for(;e;)t=e,e=t.parent;return t}addChild(t){o(this,yf).add(t)}get cdpTarget(){return o(this,nt)}updateCdpTarget(t){_(this,nt,t),F(this,Tt,US).call(this)}get url(){return o(this,ua)}async lifecycleLoaded(){await o(this,Nr).load}async targetUnblockedOrThrow(){const t=await o(this,nt).unblocked;if(t.kind==="error")throw t.error}async getOrCreateSandbox(t){if(t===void 0||t==="")return await o(this,kn);let e=o(this,xi).findRealms({browsingContextId:this.id,sandbox:t});return e.length===0&&(await o(this,nt).cdpClient.sendCommand("Page.createIsolatedWorld",{frameId:this.id,worldName:t}),e=o(this,xi).findRealms({browsingContextId:this.id,sandbox:t}),(0,wp.assert)(e.length!==0)),e[0]}serializeToBidiValue(t=0,e=!0){return{context:o(this,vf),url:this.url,userContext:this.userContext,originalOpener:o(this,s1)??null,clientWindow:"",children:t>0?this.directChildren.map(n=>n.serializeToBidiValue(t-1,!1)):null,...e?{parent:o(this,ps)}:{}}}onTargetInfoChanged(t){_(this,ua,t.targetInfo.url)}async navigate(t,e){var s;try{new URL(t)}catch{throw new ct.InvalidArgumentException(`Invalid URL: ${t}`)}(s=o(this,da))==null||s.reject(new ct.UnknownErrorException("navigation canceled by concurrent navigation")),await this.targetUnblockedOrThrow(),_(this,bi,t);const n=(0,U_.uuidv4)();_(this,xf,n),_(this,da,new ai.Deferred);const a=(async()=>{const c=await o(this,nt).cdpClient.sendCommand("Page.navigate",{url:t,frameId:this.id});if(c.errorText)throw _(this,bi,void 0),o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.NavigationFailed,params:{context:this.id,navigation:n,timestamp:Fa.getTimestamp(),url:t}},this.id),new ct.UnknownErrorException(c.errorText);return F(this,Tt,$S).call(this,c.loaderId),c})();if(e==="none")return o(this,da).resolve(),_(this,da,void 0),{navigation:n,url:t};const i=await a;return await Promise.race([F(this,Tt,fD).call(this,e,i.loaderId===void 0),o(this,da)]),o(this,da).resolve(),_(this,da,void 0),{navigation:n,url:o(this,ua)}}async reload(t,e){switch(await this.targetUnblockedOrThrow(),F(this,Tt,jS).call(this),await o(this,nt).cdpClient.sendCommand("Page.reload",{ignoreCache:t}),e){case"none":break;case"interactive":await o(this,Nr).DOMContentLoaded;break;case"complete":await o(this,Nr).load;break}return{navigation:o(this,_i),url:this.url}}async setViewport(t,e){if(t===null&&e===null)await o(this,nt).cdpClient.sendCommand("Emulation.clearDeviceMetricsOverride");else try{let n;t===void 0?n=o(this,su):t===null?n={width:0,height:0}:n=t,_(this,su,n),await o(this,nt).cdpClient.sendCommand("Emulation.setDeviceMetricsOverride",{width:o(this,su).width,height:o(this,su).height,deviceScaleFactor:e||0,mobile:!1,dontSetVisibleSize:!0})}catch(n){throw n.message.startsWith("Width and height values must be positive")?new ct.UnsupportedOperationException("Provided viewport dimensions are not supported"):n}}async handleUserPrompt(t,e){await o(this,nt).cdpClient.sendCommand("Page.handleJavaScriptDialog",{accept:t??!0,promptText:e})}async activate(){await o(this,nt).cdpClient.sendCommand("Page.bringToFront")}async captureScreenshot(t){if(!this.isTopLevelContext())throw new ct.UnsupportedOperationException(`Non-top-level 'context' (${t.context}) is currently not supported`);const e=UK(t);await o(this,nt).cdpClient.sendCommand("Page.bringToFront");let n=!1,a;switch(t.origin??(t.origin="viewport"),t.origin){case"document":{a=String(()=>{const u=document.documentElement;return{x:0,y:0,width:u.scrollWidth,height:u.scrollHeight}}),n=!0;break}case"viewport":{a=String(()=>{const u=window.visualViewport;return{x:u.pageLeft,y:u.pageTop,width:u.width,height:u.height}});break}}const s=await(await this.getOrCreateSandbox(void 0)).callFunction(a,!1);(0,wp.assert)(s.type==="success");const c=g4(s.result);(0,wp.assert)(c);let l=c;if(t.clip){const u=t.clip;t.origin==="viewport"&&u.type==="box"&&(u.x+=c.x,u.y+=c.y),l=$K(await F(this,Tt,pD).call(this,u),c)}if(l.width===0||l.height===0)throw new ct.UnableToCaptureScreenException(`Unable to capture screenshot with zero dimensions: width=${l.width}, height=${l.height}`);return await o(this,nt).cdpClient.sendCommand("Page.captureScreenshot",{clip:{...l,scale:1},...e,captureBeyondViewport:n})}async print(t){var n,a,i,s,c,l;const e={};if(t.background!==void 0&&(e.printBackground=t.background),((n=t.margin)==null?void 0:n.bottom)!==void 0&&(e.marginBottom=(0,kh.inchesFromCm)(t.margin.bottom)),((a=t.margin)==null?void 0:a.left)!==void 0&&(e.marginLeft=(0,kh.inchesFromCm)(t.margin.left)),((i=t.margin)==null?void 0:i.right)!==void 0&&(e.marginRight=(0,kh.inchesFromCm)(t.margin.right)),((s=t.margin)==null?void 0:s.top)!==void 0&&(e.marginTop=(0,kh.inchesFromCm)(t.margin.top)),t.orientation!==void 0&&(e.landscape=t.orientation==="landscape"),((c=t.page)==null?void 0:c.height)!==void 0&&(e.paperHeight=(0,kh.inchesFromCm)(t.page.height)),((l=t.page)==null?void 0:l.width)!==void 0&&(e.paperWidth=(0,kh.inchesFromCm)(t.page.width)),t.pageRanges!==void 0){for(const u of t.pageRanges){if(typeof u=="number")continue;const h=u.split("-");if(h.length<1||h.length>2)throw new ct.InvalidArgumentException(`Invalid page range: ${u} is not a valid integer range.`);if(h.length===1){$_(h[0]??"");continue}let d,f;const[m="",w=""]=h;if(m===""?d=1:d=$_(m),w===""?f=Number.MAX_SAFE_INTEGER:f=$_(w),d>f)throw new ct.InvalidArgumentException(`Invalid page range: ${m} > ${w}`)}e.pageRanges=t.pageRanges.join(",")}t.scale!==void 0&&(e.scale=t.scale),t.shrinkToFit!==void 0&&(e.preferCSSPageSize=!t.shrinkToFit);try{return{data:(await o(this,nt).cdpClient.sendCommand("Page.printToPDF",e)).data}}catch(u){throw u.message==="invalid print parameters: content area is empty"?new ct.UnsupportedOperationException(u.message):u}}async close(){await o(this,nt).cdpClient.sendCommand("Page.close")}async traverseHistory(t){if(t===0)return;const e=await o(this,nt).cdpClient.sendCommand("Page.getNavigationHistory"),n=e.entries[e.currentIndex+t];if(!n)throw new ct.NoSuchHistoryEntryException(`No history entry at delta ${t}`);await o(this,nt).cdpClient.sendCommand("Page.navigateToHistoryEntry",{entryId:n.id})}async toggleModulesIfNeeded(){await Promise.all([o(this,nt).toggleNetworkIfNeeded(),o(this,nt).toggleDeviceAccessIfNeeded()])}async locateNodes(t){return await F(this,Tt,gD).call(this,await o(this,kn),t.locator,t.startNodes??[],t.maxNodeCount,t.serializationOptions)}}vf=new WeakMap,ps=new WeakMap,yf=new WeakMap,ec=new WeakMap,Nr=new WeakMap,iu=new WeakMap,ua=new WeakMap,xn=new WeakMap,xi=new WeakMap,ki=new WeakMap,nt=new WeakMap,kn=new WeakMap,ha=new WeakMap,su=new WeakMap,bi=new WeakMap,_i=new WeakMap,xf=new WeakMap,da=new WeakMap,s1=new WeakMap,ou=new WeakMap,fa=new WeakMap,Tt=new WeakSet,Hx=function(t=!1){this.directChildren.map(e=>e.dispose(t))},US=function(){o(this,nt).cdpClient.on("Page.frameNavigated",t=>{this.id===t.frame.id&&(_(this,ua,t.frame.url+(t.frame.urlFragment??"")),_(this,bi,void 0),F(this,Tt,Hx).call(this))}),o(this,nt).cdpClient.on("Page.navigatedWithinDocument",t=>{if(this.id!==t.frameId)return;_(this,bi,void 0);const e=Fa.getTimestamp();_(this,ua,t.url),o(this,iu).withinDocument.resolve(),o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.FragmentNavigated,params:{context:this.id,navigation:o(this,_i),timestamp:e,url:o(this,ua)}},this.id)}),o(this,nt).cdpClient.on("Page.frameStartedLoading",t=>{this.id===t.frameId&&(_(this,_i,o(this,xf)??(0,U_.uuidv4)()),_(this,xf,void 0),o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.NavigationStarted,params:{context:this.id,navigation:o(this,_i),timestamp:Fa.getTimestamp(),url:o(this,bi)??"UNKNOWN"}},this.id))}),o(this,nt).cdpClient.on("Page.frameScheduledNavigation",t=>{this.id===t.frameId&&_(this,bi,t.url)}),o(this,nt).cdpClient.on("Page.frameRequestedNavigation",t=>{var e;this.id===t.frameId&&((e=o(this,da))==null||e.reject(new ct.UnknownErrorException(`navigation canceled, as new navigation is requested by ${t.reason}`)),_(this,bi,t.url))}),o(this,nt).cdpClient.on("Page.lifecycleEvent",t=>{if(this.id!==t.frameId)return;if(t.name==="init"){F(this,Tt,$S).call(this,t.loaderId);return}if(t.name==="commit"){_(this,ki,t.loaderId);return}if(o(this,ki)||_(this,ki,t.loaderId),t.loaderId!==o(this,ki))return;const e=Fa.getTimestamp();switch(t.name){case"DOMContentLoaded":o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.DomContentLoaded,params:{context:this.id,navigation:o(this,_i),timestamp:e,url:o(this,ua)}},this.id),o(this,Nr).DOMContentLoaded.resolve();break;case"load":o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.Load,params:{context:this.id,navigation:o(this,_i),timestamp:e,url:o(this,ua)}},this.id),o(this,Nr).load.resolve();break}}),o(this,nt).cdpClient.on("Runtime.executionContextCreated",t=>{var u;const{auxData:e,name:n,uniqueId:a,id:i}=t.context;if(!e||e.frameId!==this.id)return;let s,c;switch(e.type){case"isolated":c=n,o(this,kn).isFinished||(u=o(this,ha))==null||u.call(this,cy.LogType.debugError,"Unexpectedly, isolated realm created before the default one"),s=o(this,kn).isFinished?o(this,kn).result.origin:"";break;case"default":s=m4(t.context.origin);break;default:return}const l=new BK.WindowRealm(this.id,o(this,ec),o(this,nt).cdpClient,o(this,xn),i,o(this,ha),s,a,o(this,xi),c);e.isDefault&&(o(this,kn).resolve(l),Promise.all(o(this,nt).getChannels().map(h=>h.startListenerFromWindow(l,o(this,xn)))))}),o(this,nt).cdpClient.on("Runtime.executionContextDestroyed",t=>{o(this,kn).isFinished&&o(this,kn).result.executionContextId===t.executionContextId&&_(this,kn,new ai.Deferred),o(this,xi).deleteRealms({cdpSessionId:o(this,nt).cdpSessionId,executionContextId:t.executionContextId})}),o(this,nt).cdpClient.on("Runtime.executionContextsCleared",()=>{o(this,kn).isFinished||o(this,kn).reject(new ct.UnknownErrorException("execution contexts cleared")),_(this,kn,new ai.Deferred),o(this,xi).deleteRealms({cdpSessionId:o(this,nt).cdpSessionId})}),o(this,nt).cdpClient.on("Page.javascriptDialogClosed",t=>{var n;const e=t.result;o(this,ou)===void 0&&((n=o(this,ha))==null||n.call(this,cy.LogType.debugError,"Unexpectedly no opening prompt event before closing one")),o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.UserPromptClosed,params:{context:this.id,accepted:e,type:o(this,ou)??"UNKNOWN",userText:e&&t.userInput?t.userInput:void 0}},this.id),_(this,ou,void 0)}),o(this,nt).cdpClient.on("Page.javascriptDialogOpening",t=>{var a;const e=F(a=Fa,ax,uD).call(a,t.type);_(this,ou,e);const n=F(this,Tt,hD).call(this,e);switch(o(this,xn).registerEvent({type:"event",method:ct.ChromiumBidi.BrowsingContext.EventNames.UserPromptOpened,params:{context:this.id,handler:n,type:e,message:t.message,...t.type==="prompt"?{defaultValue:t.defaultPrompt}:{}}},this.id),n){case"accept":this.handleUserPrompt(!0);break;case"dismiss":this.handleUserPrompt(!1);break}})},ax=new WeakSet,uD=function(t){switch(t){case"alert":return"alert";case"beforeunload":return"beforeunload";case"confirm":return"confirm";case"prompt":return"prompt"}},hD=function(t){var n,a,i,s,c,l,u,h;const e="dismiss";switch(t){case"alert":return((n=o(this,fa))==null?void 0:n.alert)??((a=o(this,fa))==null?void 0:a.default)??e;case"beforeunload":return((i=o(this,fa))==null?void 0:i.beforeUnload)??((s=o(this,fa))==null?void 0:s.default)??"accept";case"confirm":return((c=o(this,fa))==null?void 0:c.confirm)??((l=o(this,fa))==null?void 0:l.default)??e;case"prompt":return((u=o(this,fa))==null?void 0:u.prompt)??((h=o(this,fa))==null?void 0:h.default)??e}},$S=function(t){var e;if(t===void 0||o(this,ki)===t){o(this,iu).withinDocument.isFinished?o(this,iu).withinDocument=new ai.Deferred:(e=o(this,ha))==null||e.call(this,Fa.LOGGER_PREFIX,"Document changed (navigatedWithinDocument)");return}F(this,Tt,jS).call(this),_(this,ki,t),F(this,Tt,Hx).call(this,!0)},jS=function(){var t,e;o(this,Nr).DOMContentLoaded.isFinished?o(this,Nr).DOMContentLoaded=new ai.Deferred:(t=o(this,ha))==null||t.call(this,Fa.LOGGER_PREFIX,"Document changed (DOMContentLoaded)"),o(this,Nr).load.isFinished?o(this,Nr).load=new ai.Deferred:(e=o(this,ha))==null||e.call(this,Fa.LOGGER_PREFIX,"Document changed (load)")},dD=function(){o(this,Nr).DOMContentLoaded.isFinished||o(this,Nr).DOMContentLoaded.reject(new ct.UnknownErrorException("navigation canceled")),o(this,Nr).load.isFinished||o(this,Nr).load.reject(new ct.UnknownErrorException("navigation canceled"))},fD=async function(t,e){if(e){await o(this,iu).withinDocument;return}switch(t){case"none":return;case"interactive":await o(this,Nr).DOMContentLoaded;return;case"complete":await o(this,Nr).load;return}},pD=async function(t){switch(t.type){case"box":return{x:t.x,y:t.y,width:t.width,height:t.height};case"element":{const e=await this.getOrCreateSandbox(void 0),n=await e.callFunction(String(a=>a instanceof Element),!1,{type:"undefined"},[t.element]);if(n.type==="exception")throw new ct.NoSuchElementException(`Element '${t.element.sharedId}' was not found`);if((0,wp.assert)(n.result.type==="boolean"),!n.result.value)throw new ct.NoSuchElementException(`Node '${t.element.sharedId}' is not an Element`);{const a=await e.callFunction(String(s=>{const c=s.getBoundingClientRect();return{x:c.x,y:c.y,height:c.height,width:c.width}}),!1,{type:"undefined"},[t.element]);(0,wp.assert)(a.type==="success");const i=g4(a.result);if(!i)throw new ct.UnableToCaptureScreenException(`Could not get bounding box for Element '${t.element.sharedId}'`);return i}}}},mD=async function(t,e,n,a){switch(e.type){case"css":return{functionDeclaration:String((i,s,...c)=>{const l=h=>{if(!(h instanceof HTMLElement||h instanceof Document||h instanceof DocumentFragment))throw new Error("startNodes in css selector should be HTMLElement, Document or DocumentFragment");return[...h.querySelectorAll(i)]};c=c.length>0?c:[document];const u=c.map(h=>l(h)).flat(1);return s===0?u:u.slice(0,s)}),argumentsLocalValues:[{type:"string",value:e.value},{type:"number",value:n??0},...a]};case"xpath":return{functionDeclaration:String((i,s,...c)=>{const u=new XPathEvaluator().createExpression(i),h=f=>{const m=u.evaluate(f,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE),w=[];for(let p=0;p<m.snapshotLength;p++)w.push(m.snapshotItem(p));return w};c=c.length>0?c:[document];const d=c.map(f=>h(f)).flat(1);return s===0?d:d.slice(0,s)}),argumentsLocalValues:[{type:"string",value:e.value},{type:"number",value:n??0},...a]};case"innerText":if(e.value==="")throw new ct.InvalidSelectorException("innerText locator cannot be empty");return{functionDeclaration:String((i,s,c,l,u,...h)=>{const d=c?i.toUpperCase():i,f=(w,p)=>{var S;const g=[];if(w instanceof DocumentFragment||w instanceof Document)return[...w.children].forEach(O=>g.push(...f(O,p))),g;if(!(w instanceof HTMLElement))return[];const v=w,k=c?(S=v.innerText)==null?void 0:S.toUpperCase():v.innerText;if(!k.includes(d))return[];const x=[];for(const I of v.children)I instanceof HTMLElement&&x.push(I);if(x.length===0)s&&k===d?g.push(v):s||g.push(v);else{const I=p<=0?[]:x.map(O=>f(O,p-1)).flat(1);I.length===0?(!s||k===d)&&g.push(v):g.push(...I)}return g};h=h.length>0?h:[document];const m=h.map(w=>f(w,u)).flat(1);return l===0?m:m.slice(0,l)}),argumentsLocalValues:[{type:"string",value:e.value},{type:"boolean",value:e.matchType!=="partial"},{type:"boolean",value:e.ignoreCase===!0},{type:"number",value:n??0},{type:"number",value:e.maxDepth??1e3},...a]};case"accessibility":{if(!e.value.name&&!e.value.role)throw new ct.InvalidSelectorException("Either name or role has to be specified");await Promise.all([o(this,nt).cdpClient.sendCommand("Accessibility.enable"),o(this,nt).cdpClient.sendCommand("Accessibility.getRootAXNode")]);const i=await t.evaluate("({getAccessibleName, getAccessibleRole})",!1,"root",void 0,!1,!0);if(i.type!=="success")throw new Error("Could not get bindings");if(i.result.type!=="object")throw new Error("Could not get bindings");return{functionDeclaration:String((s,c,l,u,...h)=>{const d=[];let f=!1;function m(w,p){if(!f)for(const g of w){let v=!0;if(p.role){const x=l.getAccessibleRole(g);p.role!==x&&(v=!1)}if(p.name){const x=l.getAccessibleName(g);p.name!==x&&(v=!1)}if(v){if(u!==0&&d.length===u){f=!0;break}d.push(g)}const k=[];for(const x of g.children)x instanceof HTMLElement&&k.push(x);m(k,p)}}return h=h.length>0?h:Array.from(document.documentElement.children).filter(w=>w instanceof HTMLElement),m(h,{role:c,name:s}),d}),argumentsLocalValues:[{type:"string",value:e.value.name||""},{type:"string",value:e.value.role||""},{handle:i.result.handle},{type:"number",value:n??0},...a]}}}},gD=async function(t,e,n,a,i){var u,h,d;const s=await F(this,Tt,mD).call(this,t,e,a,n);i={...i,maxObjectDepth:1};const c=await t.callFunction(s.functionDeclaration,!1,{type:"undefined"},s.argumentsLocalValues,"none",i);if(c.type!=="success")throw(u=o(this,ha))==null||u.call(this,Fa.LOGGER_PREFIX,"Failed locateNodesByLocator",c),(h=c.exceptionDetails.text)!=null&&h.endsWith("is not a valid selector.")||(d=c.exceptionDetails.text)!=null&&d.endsWith("is not a valid XPath expression.")?new ct.InvalidSelectorException(`Not valid selector ${typeof e.value=="string"?e.value:JSON.stringify(e.value)}`):c.exceptionDetails.text==="Error: startNodes in css selector should be HTMLElement, Document or DocumentFragment"?new ct.InvalidArgumentException("startNodes in css selector should be HTMLElement, Document or DocumentFragment"):new ct.UnknownErrorException(`Unexpected error in selector script: ${c.exceptionDetails.text}`);if(c.result.type!=="array")throw new ct.UnknownErrorException(`Unexpected selector script result type: ${c.result.type}`);return{nodes:c.result.value.map(f=>{if(f.type!=="node")throw new ct.UnknownErrorException(`Unexpected selector script result element: ${f.type}`);return f})}},y(ly,ax),H(ly,"LOGGER_PREFIX",`${cy.LogType.debug}:browsingContext`),yh.BrowsingContextImpl=ly,Fa=ly;function m4(r){return["://",""].includes(r)&&(r="null"),r}function UK(r){const{quality:t,type:e}=r.format??{type:"image/png"};switch(e){case"image/png":return{format:"png"};case"image/jpeg":return{format:"jpeg",...t===void 0?{}:{quality:Math.round(t*100)}};case"image/webp":return{format:"webp",...t===void 0?{}:{quality:Math.round(t*100)}}}throw new ct.InvalidArgumentException(`Image format '${e}' is not a supported format`)}function g4(r){var i,s,c,l;if(r.type!=="object"||r.value===void 0)return;const t=(i=r.value.find(([u])=>u==="x"))==null?void 0:i[1],e=(s=r.value.find(([u])=>u==="y"))==null?void 0:s[1],n=(c=r.value.find(([u])=>u==="height"))==null?void 0:c[1],a=(l=r.value.find(([u])=>u==="width"))==null?void 0:l[1];if(!((t==null?void 0:t.type)!=="number"||(e==null?void 0:e.type)!=="number"||(n==null?void 0:n.type)!=="number"||(a==null?void 0:a.type)!=="number"))return{x:t.value,y:e.value,width:a.value,height:n.value}}function w4(r){return{...r.width<0?{x:r.x+r.width,width:-r.width}:{x:r.x,width:r.width},...r.height<0?{y:r.y+r.height,height:-r.height}:{y:r.y,height:r.height}}}function $K(r,t){r=w4(r),t=w4(t);const e=Math.max(r.x,t.x),n=Math.max(r.y,t.y);return{x:e,y:n,width:Math.max(Math.min(r.x+r.width,t.x+t.width)-e,0),height:Math.max(Math.min(r.y+r.height,t.y+t.height)-n,0)}}function $_(r){if(r=r.trim(),!/^[0-9]+$/.test(r))throw new ct.InvalidArgumentException(`Invalid integer: ${r}`);return parseInt(r)}var uy={};Object.defineProperty(uy,"__esModule",{value:!0}),uy.WorkerRealm=void 0;const jK=gp;class HK extends jK.Realm{constructor(e,n,a,i,s,c,l,u,h){super(e,n,a,i,s,l,u);y(this,o1);y(this,kf);_(this,kf,c),_(this,o1,h),this.initialize()}get associatedBrowsingContexts(){return o(this,kf).flatMap(e=>e.associatedBrowsingContexts)}get realmType(){return o(this,o1)}get source(){var e;return{realm:this.realmId,context:(e=this.associatedBrowsingContexts[0])==null?void 0:e.id}}get realmInfo(){const e=o(this,kf).map(a=>a.realmId),{realmType:n}=this;switch(n){case"dedicated-worker":{const a=e[0];if(a===void 0||e.length!==1)throw new Error("Dedicated worker must have exactly one owner");return{...this.baseInfo,type:n,owners:[a]}}case"service-worker":case"shared-worker":return{...this.baseInfo,type:n}}}}o1=new WeakMap,kf=new WeakMap,uy.WorkerRealm=HK;var hy={},dy={},fy={};Object.defineProperty(fy,"__esModule",{value:!0}),fy.logMessageFormatter=x4,fy.getRemoteValuesText=W_;const WK=zi,v4=["%s","%d","%i","%f","%o","%O","%c"];function y4(r){return v4.some(t=>r.includes(t))}function x4(r){let t="";const e=r[0].value.toString(),n=r.slice(1,void 0),a=e.split(new RegExp(v4.map(i=>`(${i})`).join("|"),"g"));for(const i of a)if(!(i===void 0||i===""))if(y4(i)){const s=n.shift();(0,WK.assert)(s,`Less value is provided: "${W_(r,!1)}"`),i==="%s"?t+=H_(s):i==="%d"||i==="%i"?s.type==="bigint"||s.type==="number"||s.type==="string"?t+=parseInt(s.value.toString(),10):t+="NaN":i==="%f"?s.type==="bigint"||s.type==="number"||s.type==="string"?t+=parseFloat(s.value.toString()):t+="NaN":t+=j_(s)}else t+=i;if(n.length>0)throw new Error(`More value is provided: "${W_(r,!1)}"`);return t}function j_(r){var t;if(r.type!=="array"&&r.type!=="bigint"&&r.type!=="date"&&r.type!=="number"&&r.type!=="object"&&r.type!=="string")return H_(r);if(r.type==="bigint")return`${r.value.toString()}n`;if(r.type==="number")return r.value.toString();if(["date","string"].includes(r.type))return JSON.stringify(r.value);if(r.type==="object")return`{${r.value.map(e=>`${JSON.stringify(e[0])}:${j_(e[1])}`).join(",")}}`;if(r.type==="array")return`[${((t=r.value)==null?void 0:t.map(e=>j_(e)).join(","))??""}]`;throw Error(`Invalid value type: ${r}`)}function H_(r){var t,e,n,a;if(!Object.hasOwn(r,"value"))return r.type;switch(r.type){case"string":case"number":case"boolean":case"bigint":return String(r.value);case"regexp":return`/${r.value.pattern}/${r.value.flags??""}`;case"date":return new Date(r.value).toString();case"object":return`Object(${((t=r.value)==null?void 0:t.length)??""})`;case"array":return`Array(${((e=r.value)==null?void 0:e.length)??""})`;case"map":return`Map(${(n=r.value)==null?void 0:n.length})`;case"set":return`Set(${(a=r.value)==null?void 0:a.length})`;default:return r.type}}function W_(r,t){const e=r[0];return e?e.type==="string"&&y4(e.value.toString())&&t?x4(r):r.map(n=>H_(n)).join(" "):""}var z_;Object.defineProperty(dy,"__esModule",{value:!0}),dy.LogManager=void 0;const py=At,k4=Cn,zK=fy;function b4(r){const t=r==null?void 0:r.callFrames.map(e=>({columnNumber:e.columnNumber,functionName:e.functionName,lineNumber:e.lineNumber,url:e.url}));return t?{callFrames:t}:void 0}function KK(r){return["error","assert"].includes(r)?"error":["debug","trace"].includes(r)?"debug":["warn","warning"].includes(r)?"warn":"info"}function VK(r){switch(r){case"warning":return"warn";case"startGroup":return"group";case"startGroupCollapsed":return"groupCollapsed";case"endGroup":return"groupEnd"}return r}class K_{constructor(t,e,n,a){y(this,Sf);y(this,bf);y(this,_f);y(this,tc);y(this,Ef);_(this,tc,t),_(this,_f,e),_(this,bf,n),_(this,Ef,a)}static create(t,e,n,a){var s;const i=new z_(t,e,n,a);return F(s=i,Sf,vD).call(s),i}}bf=new WeakMap,_f=new WeakMap,tc=new WeakMap,Ef=new WeakMap,Sf=new WeakSet,wD=async function(t,e){switch(t.type){case"undefined":return{type:"undefined"};case"boolean":return{type:"boolean",value:t.value};case"string":return{type:"string",value:t.value};case"number":return{type:"number",value:t.unserializableValue??t.value};case"bigint":if(t.unserializableValue!==void 0&&t.unserializableValue[t.unserializableValue.length-1]==="n")return{type:t.type,value:t.unserializableValue.slice(0,-1)};break;case"object":if(t.subtype==="null")return{type:"null"};break}return await e.serializeCdpObject(t,"none")},vD=function(){o(this,tc).cdpClient.on("Runtime.consoleAPICalled",t=>{var a;const e=o(this,_f).findRealm({cdpSessionId:o(this,tc).cdpSessionId,executionContextId:t.executionContextId});if(e===void 0){(a=o(this,Ef))==null||a.call(this,k4.LogType.cdp,t);return}const n=Promise.all(t.args.map(i=>F(this,Sf,wD).call(this,i,e)));for(const i of e.associatedBrowsingContexts)o(this,bf).registerPromiseEvent(n.then(s=>({kind:"success",value:{type:"event",method:py.ChromiumBidi.Log.EventNames.LogEntryAdded,params:{level:KK(t.type),source:e.source,text:(0,zK.getRemoteValuesText)(s,!0),timestamp:Math.round(t.timestamp),stackTrace:b4(t.stackTrace),type:"console",method:VK(t.type),args:s}}}),s=>({kind:"error",error:s})),i.id,py.ChromiumBidi.Log.EventNames.LogEntryAdded)}),o(this,tc).cdpClient.on("Runtime.exceptionThrown",t=>{var n,a;const e=o(this,_f).findRealm({cdpSessionId:o(this,tc).cdpSessionId,executionContextId:t.exceptionDetails.executionContextId});if(e===void 0){(n=o(this,Ef))==null||n.call(this,k4.LogType.cdp,t);return}for(const i of e.associatedBrowsingContexts)o(this,bf).registerPromiseEvent(F(a=z_,ix,yD).call(a,t,e).then(s=>({kind:"success",value:{type:"event",method:py.ChromiumBidi.Log.EventNames.LogEntryAdded,params:{level:"error",source:e.source,text:s,timestamp:Math.round(t.timestamp),stackTrace:b4(t.exceptionDetails.stackTrace),type:"javascript"}}}),s=>({kind:"error",error:s})),i.id,py.ChromiumBidi.Log.EventNames.LogEntryAdded)})},ix=new WeakSet,yD=async function(t,e){return t.exceptionDetails.exception?e===void 0?JSON.stringify(t.exceptionDetails.exception):await e.stringifyObject(t.exceptionDetails.exception):t.exceptionDetails.text},y(K_,ix),dy.LogManager=K_,z_=K_,Object.defineProperty(hy,"__esModule",{value:!0}),hy.CdpTarget=void 0;const _4=Kr,qK=xh,my=Cn,GK=yh,XK=dy,_E=class _E{constructor(t,e,n,a,i,s,c,l,u,h){y(this,bn);y(this,c1);y(this,xr);y(this,l1);y(this,u1);y(this,cu);y(this,Cf);y(this,rc);y(this,Tf);y(this,Af,new qK.Deferred);y(this,h1);y(this,ms);y(this,Ff,!1);y(this,Pf,!1);y(this,nc,!1);y(this,lu,{request:!1,response:!1,auth:!1});_(this,c1,t),_(this,xr,e),_(this,l1,n),_(this,cu,a),_(this,u1,i),_(this,Cf,s),_(this,Tf,l),_(this,rc,c),_(this,h1,u),_(this,ms,h)}static create(t,e,n,a,i,s,c,l,u,h){var f,m;const d=new _E(t,e,n,i,a,s,c,l,u,h);return XK.LogManager.create(d,a,i,h),F(f=d,bn,kD).call(f),F(m=d,bn,xD).call(m),d}get unblocked(){return o(this,Af)}get id(){return o(this,c1)}get cdpClient(){return o(this,xr)}get browserCdpClient(){return o(this,l1)}get cdpSessionId(){return o(this,xr).sessionId}async toggleFetchIfNeeded(){const t=o(this,Tf).getInterceptionStages(this.topLevelId);if(!o(this,nc)||o(this,lu).request===t.request&&o(this,lu).response===t.response&&o(this,lu).auth===t.auth)return;const e=[];_(this,lu,t),(t.request||t.auth)&&e.push({urlPattern:"*",requestStage:"Request"}),t.response&&e.push({urlPattern:"*",requestStage:"Response"}),e.length?await o(this,xr).sendCommand("Fetch.enable",{patterns:e,handleAuthRequests:t.auth}):await o(this,xr).sendCommand("Fetch.disable")}async toggleNetworkIfNeeded(){var e;const t=this.isSubscribedTo(_4.BiDiModule.Network);if(t!==o(this,nc)){_(this,nc,t);try{await Promise.all([o(this,xr).sendCommand(t?"Network.enable":"Network.disable").then(async()=>await this.toggleSetCacheDisabled()),this.toggleFetchIfNeeded()])}catch(n){if((e=o(this,ms))==null||e.call(this,my.LogType.debugError,n),_(this,nc,!t),!F(this,bn,Wx).call(this,n))throw n}}}async toggleSetCacheDisabled(t){var a;const e=o(this,Tf).defaultCacheBehavior==="bypass",n=t??e;if(!(!o(this,nc)||o(this,Pf)===n)){_(this,Pf,n);try{await o(this,xr).sendCommand("Network.setCacheDisabled",{cacheDisabled:n})}catch(i){if((a=o(this,ms))==null||a.call(this,my.LogType.debugError,i),_(this,Pf,!n),!F(this,bn,Wx).call(this,i))throw i}}}async toggleDeviceAccessIfNeeded(){var e;const t=this.isSubscribedTo(_4.BiDiModule.Bluetooth);if(o(this,Ff)!==t){_(this,Ff,t);try{await o(this,xr).sendCommand(t?"DeviceAccess.enable":"DeviceAccess.disable")}catch(n){if((e=o(this,ms))==null||e.call(this,my.LogType.debugError,n),_(this,Ff,!t),!F(this,bn,Wx).call(this,n))throw n}}}getChannels(){return o(this,Cf).find().flatMap(t=>t.channels)}get topLevelId(){return o(this,rc).findTopLevelContextId(this.id)??this.id}isSubscribedTo(t){return o(this,cu).subscriptionManager.isSubscribedTo(t,this.topLevelId)}};c1=new WeakMap,xr=new WeakMap,l1=new WeakMap,u1=new WeakMap,cu=new WeakMap,Cf=new WeakMap,rc=new WeakMap,Tf=new WeakMap,Af=new WeakMap,h1=new WeakMap,ms=new WeakMap,Ff=new WeakMap,Pf=new WeakMap,nc=new WeakMap,lu=new WeakMap,bn=new WeakSet,xD=async function(){var t;try{await Promise.all([o(this,xr).sendCommand("Page.enable"),o(this,xr).sendCommand("Page.getFrameTree").then(e=>F(this,bn,HS).call(this,e.frameTree)),o(this,xr).sendCommand("Runtime.enable"),o(this,xr).sendCommand("Page.setLifecycleEventsEnabled",{enabled:!0}),this.toggleNetworkIfNeeded(),o(this,xr).sendCommand("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),F(this,bn,bD).call(this),o(this,xr).sendCommand("Runtime.runIfWaitingForDebugger"),this.toggleDeviceAccessIfNeeded()])}catch(e){if((t=o(this,ms))==null||t.call(this,my.LogType.debugError,"Failed to unblock target",e),!o(this,xr).isCloseError(e)){o(this,Af).resolve({kind:"error",error:e});return}}o(this,Af).resolve({kind:"success",value:void 0})},HS=function(t){var a;const e=t.frame,n=o(this,rc).findContext(e.id);if(n!==void 0&&n.parentId===null&&e.parentId!==null&&e.parentId!==void 0&&(n.parentId=e.parentId),n===void 0&&e.parentId!==void 0){const i=o(this,rc).getContext(e.parentId);GK.BrowsingContextImpl.create(e.id,e.parentId,i.userContext,i.cdpTarget,o(this,cu),o(this,rc),o(this,u1),e.url,void 0,o(this,h1),o(this,ms))}(a=t.childFrames)==null||a.map(i=>F(this,bn,HS).call(this,i))},Wx=function(t){const e=t;return e.code===-32001&&e.message==="Session with given id not found."},kD=function(){o(this,xr).on("*",(t,e)=>{typeof t=="string"&&o(this,cu).registerEvent({type:"event",method:`cdp.${t}`,params:{event:t,params:e,session:this.cdpSessionId}},this.id)})},bD=async function(){await Promise.all(o(this,Cf).find({targetId:this.topLevelId,global:!0}).map(t=>t.initInTarget(this,!0)))};let V_=_E;hy.CdpTarget=V_,Object.defineProperty(ay,"__esModule",{value:!0}),ay.CdpTargetManager=void 0;const YK=Cn,q_=yh,JK=uy,ZK=hy,E4={service_worker:"service-worker",shared_worker:"shared-worker",worker:"dedicated-worker"};class QK{constructor(t,e,n,a,i,s,c,l,u,h,d,f){y(this,Pt);y(this,d1);y(this,f1);y(this,If,new Set);y(this,Df);y(this,ac);y(this,Wn);y(this,Of);y(this,p1);y(this,Mf);y(this,ja);y(this,m1);y(this,gs);y(this,uu);y(this,g1,new Map);_(this,f1,t),_(this,d1,e),o(this,If).add(n),_(this,Df,n),_(this,ac,a),_(this,Wn,i),_(this,Mf,u),_(this,Of,c),_(this,p1,l),_(this,ja,s),_(this,m1,h),_(this,uu,d),_(this,gs,f),F(this,Pt,WS).call(this,e)}}d1=new WeakMap,f1=new WeakMap,If=new WeakMap,Df=new WeakMap,ac=new WeakMap,Wn=new WeakMap,Of=new WeakMap,p1=new WeakMap,Mf=new WeakMap,ja=new WeakMap,m1=new WeakMap,gs=new WeakMap,uu=new WeakMap,Pt=new WeakSet,WS=function(t){t.on("Target.attachedToTarget",e=>{F(this,Pt,CD).call(this,e,t)}),t.on("Target.detachedFromTarget",F(this,Pt,TD).bind(this)),t.on("Target.targetInfoChanged",F(this,Pt,AD).bind(this)),t.on("Inspector.targetCrashed",()=>{F(this,Pt,FD).call(this,t)}),t.on("Page.frameAttached",F(this,Pt,_D).bind(this)),t.on("Page.frameDetached",F(this,Pt,ED).bind(this)),t.on("Page.frameSubtreeWillBeDetached",F(this,Pt,SD).bind(this))},_D=function(t){const e=o(this,Wn).findContext(t.parentFrameId);e!==void 0&&q_.BrowsingContextImpl.create(t.frameId,t.parentFrameId,e.userContext,e.cdpTarget,o(this,ac),o(this,Wn),o(this,ja),"about:blank",void 0,o(this,uu),o(this,gs))},ED=function(t){var e;t.reason!=="swap"&&((e=o(this,Wn).findContext(t.frameId))==null||e.dispose(!0))},SD=function(t){var e;(e=o(this,Wn).findContext(t.frameId))==null||e.dispose(!0)},CD=function(t,e){const{sessionId:n,targetInfo:a}=t,i=o(this,f1).getCdpClient(n),s=async()=>{await i.sendCommand("Runtime.runIfWaitingForDebugger").then(()=>e.sendCommand("Target.detachFromTarget",t)).catch(c=>{var l;return(l=o(this,gs))==null?void 0:l.call(this,YK.LogType.debugError,c)})};if(o(this,Df)!==a.targetId){const c=a.type==="service_worker"?`${e.sessionId}_${a.targetId}`:a.targetId;if(o(this,If).has(c))return;o(this,If).add(c)}switch(a.type){case"page":case"iframe":{if(o(this,Df)===a.targetId){s();return}const c=F(this,Pt,zx).call(this,i,a),l=o(this,Wn).findContext(a.targetId);if(l&&a.type==="iframe")l.updateCdpTarget(c);else{const u=a.browserContextId&&a.browserContextId!==o(this,m1)?a.browserContextId:"default";q_.BrowsingContextImpl.create(a.targetId,null,u,c,o(this,ac),o(this,Wn),o(this,ja),a.url===""?"about:blank":a.url,a.openerFrameId??a.openerId,o(this,uu),o(this,gs))}return}case"service_worker":case"worker":{const c=o(this,ja).findRealm({cdpSessionId:e.sessionId});if(!c){s();return}const l=F(this,Pt,zx).call(this,i,a);F(this,Pt,zS).call(this,E4[a.type],l,c);return}case"shared_worker":{const c=F(this,Pt,zx).call(this,i,a);F(this,Pt,zS).call(this,E4[a.type],c);return}}s()},zx=function(t,e){F(this,Pt,WS).call(this,t);const n=ZK.CdpTarget.create(e.targetId,t,o(this,d1),o(this,ja),o(this,ac),o(this,Mf),o(this,Wn),o(this,Of),o(this,uu),o(this,gs));return o(this,Of).onCdpTargetCreated(n),o(this,p1).onCdpTargetCreated(n),n},g1=new WeakMap,zS=function(t,e,n){e.cdpClient.on("Runtime.executionContextCreated",a=>{const{uniqueId:i,id:s,origin:c}=a.context,l=new JK.WorkerRealm(e.cdpClient,o(this,ac),s,o(this,gs),(0,q_.serializeOrigin)(c),n?[n]:[],i,o(this,ja),t);o(this,g1).set(e.cdpSessionId,l)})},TD=function({sessionId:t,targetId:e}){e&&o(this,Mf).find({targetId:e}).map(i=>{i.dispose(e)});const n=o(this,Wn).findContextBySession(t);if(n){n.dispose(!0);return}const a=o(this,g1).get(t);a&&o(this,ja).deleteRealms({cdpSessionId:a.cdpClient.sessionId})},AD=function(t){const e=o(this,Wn).findContext(t.targetInfo.targetId);e&&e.onTargetInfoChanged(t)},FD=function(t){const e=o(this,ja).findRealms({cdpSessionId:t.sessionId});for(const n of e)n.dispose()},ay.CdpTargetManager=QK;var gy={};Object.defineProperty(gy,"__esModule",{value:!0}),gy.BrowsingContextStorage=void 0;const S4=At;class eV{constructor(){y(this,Ei,new Map)}getTopLevelContexts(){return this.getAllContexts().filter(t=>t.isTopLevelContext())}getAllContexts(){return Array.from(o(this,Ei).values())}deleteContextById(t){o(this,Ei).delete(t)}deleteContext(t){o(this,Ei).delete(t.id)}addContext(t){o(this,Ei).set(t.id,t)}hasContext(t){return o(this,Ei).has(t)}findContext(t){return o(this,Ei).get(t)}findTopLevelContextId(t){if(t===null)return null;const e=this.findContext(t),n=(e==null?void 0:e.parentId)??null;return n===null?t:this.findTopLevelContextId(n)}findContextBySession(t){for(const e of o(this,Ei).values())if(e.cdpTarget.cdpSessionId===t)return e}getContext(t){const e=this.findContext(t);if(e===void 0)throw new S4.NoSuchFrameException(`Context ${t} not found`);return e}verifyTopLevelContextsList(t){const e=new Set;if(!t)return e;for(const n of t){const a=this.getContext(n);if(a.isTopLevelContext())e.add(a);else throw new S4.InvalidArgumentException(`Non top-level context '${n}' given.`)}return e}}Ei=new WeakMap,gy.BrowsingContextStorage=eV;var wy={},vy={},yy;Object.defineProperty(vy,"__esModule",{value:!0}),vy.NetworkRequest=void 0;const Nn=At,bh=zi,C4=xh,tV=Cn,Rt=ur,rV=new RegExp('(?<=realm=").*(?=")');class xy{constructor(t,e,n,a,i=0,s){y(this,Se);y(this,Rf);y(this,kr);y(this,zn);y(this,ic,!1);y(this,Nf);y(this,Ge,{});y(this,Si);y(this,Lf);y(this,ze,{});y(this,w1);y(this,hu);y(this,du);y(this,v1);y(this,fu,{[Nn.ChromiumBidi.Network.EventNames.AuthRequired]:!1,[Nn.ChromiumBidi.Network.EventNames.BeforeRequestSent]:!1,[Nn.ChromiumBidi.Network.EventNames.FetchError]:!1,[Nn.ChromiumBidi.Network.EventNames.ResponseCompleted]:!1,[Nn.ChromiumBidi.Network.EventNames.ResponseStarted]:!1});H(this,"waitNextPhase",new C4.Deferred);_(this,Rf,t),_(this,w1,e),_(this,hu,n),_(this,du,a),_(this,Nf,i),_(this,v1,s)}get id(){return o(this,Rf)}get fetchId(){return o(this,kr)}get interceptPhase(){return o(this,zn)}get url(){var n,a,i,s,c,l,u,h;const t=((n=o(this,Ge).info)==null?void 0:n.request.urlFragment)??((a=o(this,Ge).paused)==null?void 0:a.request.urlFragment)??"";return`${((i=o(this,ze).info)==null?void 0:i.url)??((s=o(this,ze).paused)==null?void 0:s.request.url)??((c=o(this,Si))==null?void 0:c.url)??((l=o(this,Ge).auth)==null?void 0:l.request.url)??((u=o(this,Ge).info)==null?void 0:u.request.url)??((h=o(this,Ge).paused)==null?void 0:h.request.url)??yy.unknownParameter}${t}`}get redirectCount(){return o(this,Nf)}get cdpTarget(){return o(this,du)}get cdpClient(){return o(this,du).cdpClient}isRedirecting(){return!!o(this,Ge).info}handleRedirect(t){o(this,ze).hasExtraInfo=!1,o(this,ze).info=t.redirectResponse,F(this,Se,As).call(this,{wasRedirected:!0})}onRequestWillBeSentEvent(t){o(this,Ge).info=t,F(this,Se,As).call(this)}onRequestWillBeSentExtraInfoEvent(t){o(this,Ge).extraInfo=t,F(this,Se,As).call(this)}onResponseReceivedExtraInfoEvent(t){t.statusCode>=300&&t.statusCode<=399&&o(this,Ge).info&&t.headers.location===o(this,Ge).info.request.url||(o(this,ze).extraInfo=t,F(this,Se,As).call(this))}onResponseReceivedEvent(t){o(this,ze).hasExtraInfo=t.hasExtraInfo,o(this,ze).info=t.response,F(this,Se,As).call(this)}onServedFromCache(){_(this,ic,!0),F(this,Se,As).call(this)}onLoadingFailedEvent(t){F(this,Se,As).call(this,{hasFailed:!0}),F(this,Se,u0).call(this,()=>({method:Nn.ChromiumBidi.Network.EventNames.FetchError,params:{...F(this,Se,h0).call(this),errorText:t.errorText}}))}async failRequest(t){(0,bh.assert)(o(this,kr),"Network Interception not set-up."),await this.cdpClient.sendCommand("Fetch.failRequest",{requestId:o(this,kr),errorReason:t}),_(this,zn,void 0)}onRequestPaused(t){_(this,kr,t.requestId),t.responseStatusCode||t.responseErrorReason?(o(this,ze).paused=t,F(this,Se,c0).call(this,"responseStarted")&&!o(this,fu)[Nn.ChromiumBidi.Network.EventNames.ResponseStarted]&&o(this,kr)!==this.id?_(this,zn,"responseStarted"):F(this,Se,GS).call(this)):(o(this,Ge).paused=t,F(this,Se,c0).call(this,"beforeRequestSent")&&!o(this,fu)[Nn.ChromiumBidi.Network.EventNames.BeforeRequestSent]&&o(this,kr)!==this.id?_(this,zn,"beforeRequestSent"):F(this,Se,Vx).call(this)),F(this,Se,As).call(this)}onAuthRequired(t){_(this,kr,t.requestId),o(this,Ge).auth=t,F(this,Se,c0).call(this,"authRequired")&&o(this,kr)!==this.id?_(this,zn,"authRequired"):F(this,Se,l0).call(this,{response:"Default"}),F(this,Se,u0).call(this,()=>({method:Nn.ChromiumBidi.Network.EventNames.AuthRequired,params:{...F(this,Se,h0).call(this,"authRequired"),response:F(this,Se,qx).call(this)}}))}async continueRequest(t={}){const e=F(this,Se,Gx).call(this,t.headers,t.cookies),n=(0,Rt.cdpFetchHeadersFromBidiNetworkHeaders)(e),a=T4(t.body);await F(this,Se,Vx).call(this,{url:t.url,method:t.method,headers:n,postData:a}),_(this,Si,{url:t.url,method:t.method,headers:t.headers,cookies:t.cookies,bodySize:nV(t.body)})}async continueResponse(t={}){var e,n,a;if(this.interceptPhase==="authRequired")if(t.credentials)await Promise.all([this.waitNextPhase,await F(this,Se,l0).call(this,{response:"ProvideCredentials",username:t.credentials.username,password:t.credentials.password})]);else return await F(this,Se,l0).call(this,{response:"ProvideCredentials"});if(o(this,zn)==="responseStarted"){const i=F(this,Se,Gx).call(this,t.headers,t.cookies),s=(0,Rt.cdpFetchHeadersFromBidiNetworkHeaders)(i);await F(this,Se,GS).call(this,{responseCode:t.statusCode??((e=o(this,ze).paused)==null?void 0:e.responseStatusCode),responsePhrase:t.reasonPhrase??((n=o(this,ze).paused)==null?void 0:n.responseStatusText),responseHeaders:s??((a=o(this,ze).paused)==null?void 0:a.responseHeaders)}),_(this,Lf,{statusCode:t.statusCode,headers:i})}}async continueWithAuth(t){let e,n;if(t.action==="provideCredentials"){const{credentials:i}=t;e=i.username,n=i.password}const a=(0,Rt.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction)(t.action);await F(this,Se,l0).call(this,{response:a,username:e,password:n})}async provideResponse(t){if((0,bh.assert)(o(this,kr),"Network Interception not set-up."),this.interceptPhase==="authRequired")return await F(this,Se,l0).call(this,{response:"ProvideCredentials"});if(!t.body&&!t.headers)return await F(this,Se,Vx).call(this);const e=F(this,Se,Gx).call(this,t.headers,t.cookies),n=(0,Rt.cdpFetchHeadersFromBidiNetworkHeaders)(e),a=t.statusCode??o(this,Se,o0)??200;await this.cdpClient.sendCommand("Fetch.fulfillRequest",{requestId:o(this,kr),responseCode:a,responsePhrase:t.reasonPhrase,responseHeaders:n,body:T4(t.body)}),_(this,zn,void 0)}}Rf=new WeakMap,kr=new WeakMap,zn=new WeakMap,ic=new WeakMap,Nf=new WeakMap,Ge=new WeakMap,Si=new WeakMap,Lf=new WeakMap,ze=new WeakMap,w1=new WeakMap,hu=new WeakMap,du=new WeakMap,v1=new WeakMap,fu=new WeakMap,Se=new WeakSet,KS=function(){return this.url.startsWith("data:")},PD=function(){var t,e,n,a,i;return((t=o(this,Si))==null?void 0:t.method)??((e=o(this,Ge).info)==null?void 0:e.request.method)??((n=o(this,Ge).paused)==null?void 0:n.request.method)??((a=o(this,Ge).auth)==null?void 0:a.request.method)??((i=o(this,ze).paused)==null?void 0:i.request.method)},ID=function(){return!o(this,Ge).info||!o(this,Ge).info.loaderId||o(this,Ge).info.loaderId!==o(this,Ge).info.requestId?null:o(this,hu).getNavigationId(o(this,Se,Kx)??void 0)},DD=function(){let t=[];return o(this,Ge).extraInfo&&(t=o(this,Ge).extraInfo.associatedCookies.filter(({blockedReasons:e})=>!Array.isArray(e)||e.length===0).map(({cookie:e})=>(0,Rt.cdpToBiDiCookie)(e))),t},OD=function(){var e,n;let t=0;return typeof((e=o(this,Si))==null?void 0:e.bodySize)=="number"?t=o(this,Si).bodySize:t=(0,Rt.bidiBodySizeFromCdpPostDataEntries)(((n=o(this,Ge).info)==null?void 0:n.request.postDataEntries)??[]),t},Kx=function(){var t,e,n,a;return((t=o(this,ze).paused)==null?void 0:t.frameId)??((e=o(this,Ge).info)==null?void 0:e.frameId)??((n=o(this,Ge).paused)==null?void 0:n.frameId)??((a=o(this,Ge).auth)==null?void 0:a.frameId)??null},o0=function(){var t,e,n,a;return((t=o(this,Lf))==null?void 0:t.statusCode)??((e=o(this,ze).paused)==null?void 0:e.responseStatusCode)??((n=o(this,ze).extraInfo)==null?void 0:n.statusCode)??((a=o(this,ze).info)==null?void 0:a.status)},VS=function(){var e,n,a;let t=[];return(e=o(this,Si))!=null&&e.headers?t=o(this,Si).headers:t=[...(0,Rt.bidiNetworkHeadersFromCdpNetworkHeaders)((n=o(this,Ge).info)==null?void 0:n.request.headers),...(0,Rt.bidiNetworkHeadersFromCdpNetworkHeaders)((a=o(this,Ge).extraInfo)==null?void 0:a.headers)],t},MD=function(){var n;if(!o(this,ze).info||!(o(this,Se,o0)===401||o(this,Se,o0)===407))return;const t=o(this,Se,o0)===401?"WWW-Authenticate":"Proxy-Authenticate",e=[];for(const[a,i]of Object.entries(o(this,ze).info.headers))a.localeCompare(t,void 0,{sensitivity:"base"})===0&&e.push({scheme:i.split(" ").at(0)??"",realm:((n=i.match(rV))==null?void 0:n.at(0))??""});return e},RD=function(){var t,e,n,a,i,s,c,l,u,h,d,f,m,w,p,g,v,k,x,S,I,O;return{timeOrigin:(0,Rt.getTiming)((e=(t=o(this,ze).info)==null?void 0:t.timing)==null?void 0:e.requestTime),requestTime:(0,Rt.getTiming)((a=(n=o(this,ze).info)==null?void 0:n.timing)==null?void 0:a.requestTime),redirectStart:0,redirectEnd:0,fetchStart:(0,Rt.getTiming)((s=(i=o(this,ze).info)==null?void 0:i.timing)==null?void 0:s.requestTime),dnsStart:(0,Rt.getTiming)((l=(c=o(this,ze).info)==null?void 0:c.timing)==null?void 0:l.dnsStart),dnsEnd:(0,Rt.getTiming)((h=(u=o(this,ze).info)==null?void 0:u.timing)==null?void 0:h.dnsEnd),connectStart:(0,Rt.getTiming)((f=(d=o(this,ze).info)==null?void 0:d.timing)==null?void 0:f.connectStart),connectEnd:(0,Rt.getTiming)((w=(m=o(this,ze).info)==null?void 0:m.timing)==null?void 0:w.connectEnd),tlsStart:(0,Rt.getTiming)((g=(p=o(this,ze).info)==null?void 0:p.timing)==null?void 0:g.sslStart),requestStart:(0,Rt.getTiming)((k=(v=o(this,ze).info)==null?void 0:v.timing)==null?void 0:k.sendStart),responseStart:(0,Rt.getTiming)((S=(x=o(this,ze).info)==null?void 0:x.timing)==null?void 0:S.receiveHeadersStart),responseEnd:(0,Rt.getTiming)((O=(I=o(this,ze).info)==null?void 0:I.timing)==null?void 0:O.receiveHeadersEnd)}},ND=function(){this.waitNextPhase.resolve(),this.waitNextPhase=new C4.Deferred},qS=function(t){return o(this,du).isSubscribedTo(`network.${t}`)?o(this,hu).getInterceptsForPhase(this,t):new Set},c0=function(t){return F(this,Se,qS).call(this,t).size>0},As=function(t={}){const e=t.wasRedirected||t.hasFailed||F(this,Se,KS).call(this)||!!o(this,Ge).extraInfo||o(this,ic)||!!(o(this,ze).info&&!o(this,ze).hasExtraInfo),n=F(this,Se,KS).call(this)||o(this,ic),a=!n&&F(this,Se,c0).call(this,"beforeRequestSent"),i=!a||a&&!!o(this,Ge).paused;o(this,Ge).info&&(a?i:e)&&F(this,Se,u0).call(this,F(this,Se,BD).bind(this));const s=!!o(this,ze).extraInfo||o(this,ic)||!!(o(this,ze).info&&!o(this,ze).hasExtraInfo),c=!n&&F(this,Se,c0).call(this,"responseStarted");(o(this,ze).info||c&&o(this,ze).paused)&&F(this,Se,u0).call(this,F(this,Se,UD).bind(this));const l=!c||c&&!!o(this,ze).paused;o(this,ze).info&&s&&l&&(F(this,Se,u0).call(this,F(this,Se,$D).bind(this)),o(this,hu).deleteRequest(this.id))},Vx=async function(t={}){(0,bh.assert)(o(this,kr),"Network Interception not set-up."),await this.cdpClient.sendCommand("Fetch.continueRequest",{requestId:o(this,kr),url:t.url,method:t.method,headers:t.headers,postData:t.postData}),_(this,zn,void 0)},GS=async function({responseCode:t,responsePhrase:e,responseHeaders:n}={}){(0,bh.assert)(o(this,kr),"Network Interception not set-up."),await this.cdpClient.sendCommand("Fetch.continueResponse",{requestId:o(this,kr),responseCode:t,responsePhrase:e,responseHeaders:n}),_(this,zn,void 0)},l0=async function(t){(0,bh.assert)(o(this,kr),"Network Interception not set-up."),await this.cdpClient.sendCommand("Fetch.continueWithAuth",{requestId:o(this,kr),authChallengeResponse:t}),_(this,zn,void 0)},u0=function(t){var n;let e;try{e=t()}catch(a){(n=o(this,v1))==null||n.call(this,tV.LogType.debugError,a);return}F(this,Se,jD).call(this)||o(this,fu)[e.method]&&e.method!==Nn.ChromiumBidi.Network.EventNames.AuthRequired||(F(this,Se,ND).call(this),o(this,fu)[e.method]=!0,o(this,w1).registerEvent(Object.assign(e,{type:"event"}),o(this,Se,Kx)))},h0=function(t){var n;const e={isBlocked:!1};if(t){const a=F(this,Se,qS).call(this,t);e.isBlocked=a.size>0,e.isBlocked&&(e.intercepts=[...a])}return{context:o(this,Se,Kx),navigation:o(this,Se,ID),redirectCount:o(this,Nf),request:F(this,Se,LD).call(this),timestamp:Math.round((0,Rt.getTiming)((n=o(this,Ge).info)==null?void 0:n.wallTime)*1e3),...e}},qx=function(){var n,a,i,s,c,l,u,h,d,f,m,w;(n=o(this,ze).info)!=null&&n.fromDiskCache&&(o(this,ze).extraInfo=void 0);const t=[...(0,Rt.bidiNetworkHeadersFromCdpNetworkHeaders)((a=o(this,ze).info)==null?void 0:a.headers),...(0,Rt.bidiNetworkHeadersFromCdpNetworkHeaders)((i=o(this,ze).extraInfo)==null?void 0:i.headers)],e=o(this,Se,MD);return{url:this.url,protocol:((s=o(this,ze).info)==null?void 0:s.protocol)??"",status:o(this,Se,o0)??-1,statusText:((c=o(this,ze).info)==null?void 0:c.statusText)||((l=o(this,ze).paused)==null?void 0:l.responseStatusText)||"",fromCache:((u=o(this,ze).info)==null?void 0:u.fromDiskCache)||((h=o(this,ze).info)==null?void 0:h.fromPrefetchCache)||o(this,ic),headers:((d=o(this,Lf))==null?void 0:d.headers)??t,mimeType:((f=o(this,ze).info)==null?void 0:f.mimeType)||"",bytesReceived:((m=o(this,ze).info)==null?void 0:m.encodedDataLength)||0,headersSize:(0,Rt.computeHeadersSize)(t),bodySize:0,content:{size:0},...e?{authChallenges:e}:{},"goog:securityDetails":(w=o(this,ze).info)==null?void 0:w.securityDetails}},LD=function(){var e,n,a,i,s;const t=o(this,Se,VS);return{request:o(this,Rf),url:this.url,method:o(this,Se,PD)??yy.unknownParameter,headers:t,cookies:o(this,Se,DD),headersSize:(0,Rt.computeHeadersSize)(t),bodySize:o(this,Se,OD),timings:o(this,Se,RD),"goog:postData":(n=(e=o(this,Ge).info)==null?void 0:e.request)==null?void 0:n.postData,"goog:hasPostData":(i=(a=o(this,Ge).info)==null?void 0:a.request)==null?void 0:i.hasPostData,"goog:resourceType":(s=o(this,Ge).info)==null?void 0:s.type}},BD=function(){var t;return(0,bh.assert)(o(this,Ge).info,"RequestWillBeSentEvent is not set"),{method:Nn.ChromiumBidi.Network.EventNames.BeforeRequestSent,params:{...F(this,Se,h0).call(this,"beforeRequestSent"),initiator:{type:F(t=yy,sx,HD).call(t,o(this,Ge).info.initiator.type),columnNumber:o(this,Ge).info.initiator.columnNumber,lineNumber:o(this,Ge).info.initiator.lineNumber,stackTrace:o(this,Ge).info.initiator.stack,request:o(this,Ge).info.initiator.requestId}}}},UD=function(){return{method:Nn.ChromiumBidi.Network.EventNames.ResponseStarted,params:{...F(this,Se,h0).call(this,"responseStarted"),response:F(this,Se,qx).call(this)}}},$D=function(){return{method:Nn.ChromiumBidi.Network.EventNames.ResponseCompleted,params:{...F(this,Se,h0).call(this),response:F(this,Se,qx).call(this)}}},jD=function(){var e,n;const t="/favicon.ico";return((e=o(this,Ge).paused)==null?void 0:e.request.url.endsWith(t))??((n=o(this,Ge).info)==null?void 0:n.request.url.endsWith(t))??!1},Gx=function(t,e){if(!t&&!e)return;let n=t;const a=(0,Rt.networkHeaderFromCookieHeaders)(e);return a&&!n&&(n=o(this,Se,VS)),a&&n&&(n.filter(i=>i.name.localeCompare("cookie",void 0,{sensitivity:"base"})!==0),n.push(a)),n},sx=new WeakSet,HD=function(t){switch(t){case"parser":case"script":case"preflight":return t;default:return"other"}},y(xy,sx),H(xy,"unknownParameter","UNKNOWN"),vy.NetworkRequest=xy,yy=xy;function T4(r){let t;return(r==null?void 0:r.type)==="string"?t=btoa(r.value):(r==null?void 0:r.type)==="base64"&&(t=r.value),t}function nV(r){return(r==null?void 0:r.type)==="string"?r.value.length:(r==null?void 0:r.type)==="base64"?atob(r.value).length:0}Object.defineProperty(wy,"__esModule",{value:!0}),wy.NetworkStorage=void 0;const aV=At,iV=jc,A4=vy,sV=ur;class oV{constructor(t,e,n,a){y(this,pa);y(this,y1);y(this,x1);y(this,k1);y(this,ws,new Map);y(this,sc,new Map);y(this,b1,"default");_(this,y1,e),_(this,x1,t),n.on("Target.detachedFromTarget",({sessionId:i})=>{this.disposeRequestMap(i)}),_(this,k1,a)}onCdpTargetCreated(t){const e=t.cdpClient,n=[["Network.requestWillBeSent",a=>{const i=this.getRequestById(a.requestId);i&&i.isRedirecting()?(i.handleRedirect(a),this.deleteRequest(a.requestId),F(this,pa,Oi).call(this,a.requestId,t,i.redirectCount+1).onRequestWillBeSentEvent(a)):F(this,pa,Oi).call(this,a.requestId,t).onRequestWillBeSentEvent(a)}],["Network.requestWillBeSentExtraInfo",a=>{F(this,pa,Oi).call(this,a.requestId,t).onRequestWillBeSentExtraInfoEvent(a)}],["Network.responseReceived",a=>{F(this,pa,Oi).call(this,a.requestId,t).onResponseReceivedEvent(a)}],["Network.responseReceivedExtraInfo",a=>{F(this,pa,Oi).call(this,a.requestId,t).onResponseReceivedExtraInfoEvent(a)}],["Network.requestServedFromCache",a=>{F(this,pa,Oi).call(this,a.requestId,t).onServedFromCache()}],["Network.loadingFailed",a=>{F(this,pa,Oi).call(this,a.requestId,t).onLoadingFailedEvent(a)}],["Fetch.requestPaused",a=>{F(this,pa,Oi).call(this,a.networkId??a.requestId,t).onRequestPaused(a)}],["Fetch.authRequired",a=>{let i=this.getRequestByFetchId(a.requestId);i||(i=F(this,pa,Oi).call(this,a.requestId,t)),i.onAuthRequired(a)}]];for(const[a,i]of n)e.on(a,i)}getInterceptionStages(t){const e={request:!1,response:!1,auth:!1};for(const n of o(this,sc).values())n.contexts&&!n.contexts.includes(t)||(e.request||(e.request=n.phases.includes("beforeRequestSent")),e.response||(e.response=n.phases.includes("responseStarted")),e.auth||(e.auth=n.phases.includes("authRequired")));return e}getInterceptsForPhase(t,e){if(t.url===A4.NetworkRequest.unknownParameter)return new Set;const n=new Set;for(const[a,i]of o(this,sc).entries())if(!(!i.phases.includes(e)||i.contexts&&!i.contexts.includes(t.cdpTarget.topLevelId))){if(i.urlPatterns.length===0){n.add(a);continue}for(const s of i.urlPatterns)if((0,sV.matchUrlPattern)(s,t.url)){n.add(a);break}}return n}disposeRequestMap(t){for(const e of o(this,ws).values())e.cdpClient.sessionId===t&&o(this,ws).delete(e.id)}addIntercept(t){const e=(0,iV.uuidv4)();return o(this,sc).set(e,t),e}removeIntercept(t){if(!o(this,sc).has(t))throw new aV.NoSuchInterceptException(`Intercept '${t}' does not exist.`);o(this,sc).delete(t)}getRequestById(t){return o(this,ws).get(t)}getRequestByFetchId(t){for(const e of o(this,ws).values())if(e.fetchId===t)return e}addRequest(t){o(this,ws).set(t.id,t)}deleteRequest(t){o(this,ws).delete(t)}getNavigationId(t){var e;return t===void 0?null:((e=o(this,y1).findContext(t))==null?void 0:e.navigationId)??null}set defaultCacheBehavior(t){_(this,b1,t)}get defaultCacheBehavior(){return o(this,b1)}}y1=new WeakMap,x1=new WeakMap,k1=new WeakMap,ws=new WeakMap,sc=new WeakMap,b1=new WeakMap,pa=new WeakSet,Oi=function(t,e,n){let a=this.getRequestById(t);return a||(a=new A4.NetworkRequest(t,o(this,x1),this,e,n,o(this,k1)),this.addRequest(a),a)},wy.NetworkStorage=oV;var ky={};Object.defineProperty(ky,"__esModule",{value:!0}),ky.PreloadScriptStorage=void 0;class cV{constructor(){y(this,pu,new Set)}find(t){return t?[...o(this,pu)].filter(e=>!!(t.id!==void 0&&t.id===e.id||t.targetId!==void 0&&e.targetIds.has(t.targetId)||t.global!==void 0&&(t.global&&e.contexts===void 0||!t.global&&e.contexts!==void 0))):[...o(this,pu)]}add(t){o(this,pu).add(t)}remove(t){for(const e of this.find(t))o(this,pu).delete(e)}}pu=new WeakMap,ky.PreloadScriptStorage=cV;var by={};Object.defineProperty(by,"__esModule",{value:!0}),by.RealmStorage=void 0;const lV=At,uV=mp;class hV{constructor(){y(this,ox,new Map);y(this,Bf,new Map)}get knownHandlesToRealmMap(){return o(this,ox)}addRealm(t){o(this,Bf).set(t.realmId,t)}findRealms(t){return Array.from(o(this,Bf).values()).filter(e=>!(t.realmId!==void 0&&t.realmId!==e.realmId||t.browsingContextId!==void 0&&!e.associatedBrowsingContexts.map(n=>n.id).includes(t.browsingContextId)||t.sandbox!==void 0&&(!(e instanceof uV.WindowRealm)||t.sandbox!==e.sandbox)||t.executionContextId!==void 0&&t.executionContextId!==e.executionContextId||t.origin!==void 0&&t.origin!==e.origin||t.type!==void 0&&t.type!==e.realmType||t.cdpSessionId!==void 0&&t.cdpSessionId!==e.cdpClient.sessionId))}findRealm(t){const e=this.findRealms(t);if(e.length===1)return e[0]}getRealm(t){const e=this.findRealm(t);if(e===void 0)throw new lV.NoSuchFrameException(`Realm ${JSON.stringify(t)} not found`);return e}deleteRealms(t){this.findRealms(t).map(e=>{e.dispose(),o(this,Bf).delete(e.realmId),Array.from(this.knownHandlesToRealmMap.entries()).filter(([,n])=>n===e.realmId).map(([n])=>this.knownHandlesToRealmMap.delete(n))})}}ox=new WeakMap,Bf=new WeakMap,by.RealmStorage=hV;var _y={},Ey={};Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.Buffer=void 0;let dV=(wP=class{constructor(t,e){y(this,_1);y(this,mu,[]);y(this,E1);_(this,_1,t),_(this,E1,e)}get(){return o(this,mu)}add(t){var e;for(o(this,mu).push(t);o(this,mu).length>o(this,_1);){const n=o(this,mu).shift();n!==void 0&&((e=o(this,E1))==null||e.call(this,n))}}},_1=new WeakMap,mu=new WeakMap,E1=new WeakMap,wP);Ey.Buffer=dV;var Sy={};Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.DefaultMap=void 0;class fV extends Map{constructor(e,n){super(n);y(this,S1);_(this,S1,e)}get(e){return this.has(e)||this.set(e,o(this,S1).call(this,e)),super.get(e)}}S1=new WeakMap,Sy.DefaultMap=fV;var Cy={};Object.defineProperty(Cy,"__esModule",{value:!0}),Cy.distinctValues=pV,Cy.deterministicJSONStringify=F4;function pV(r){const t=new Map;for(const e of r)t.set(F4(e),e);return Array.from(t.values())}function F4(r){return JSON.stringify(P4(r))}function P4(r){if(r==null||Array.isArray(r)||typeof r!="object")return r;const t={};for(const e of Object.keys(r).sort()){const n=r[e];t[e]=P4(n)}return t}var Ty={};Object.defineProperty(Ty,"__esModule",{value:!0}),Ty.IdWrapper=void 0;const lx=class lx{constructor(){y(this,C1);_(this,C1,++Du(lx,cx)._)}get id(){return o(this,C1)}};cx=new WeakMap,C1=new WeakMap,y(lx,cx,0);let G_=lx;Ty.IdWrapper=G_;var vp={};Object.defineProperty(vp,"__esModule",{value:!0}),vp.isCdpEvent=I4,vp.assertSupportedEvent=mV;const X_=At;function I4(r){var t;return((t=r.split(".").at(0))==null?void 0:t.startsWith(X_.ChromiumBidi.BiDiModule.Cdp))??!1}function mV(r){if(!X_.ChromiumBidi.EVENT_NAMES.has(r)&&!I4(r))throw new X_.InvalidArgumentException(`Unknown event: ${r}`)}var _h={};Object.defineProperty(_h,"__esModule",{value:!0}),_h.SubscriptionManager=void 0,_h.cartesianProduct=D4,_h.unrollEvents=O4;const jt=At,gV=vp;function D4(...r){return r.reduce((t,e)=>t.flatMap(n=>e.map(a=>[n,a].flat())))}function O4(r){const t=new Set;function e(n){for(const a of n)t.add(a)}for(const n of r)switch(n){case jt.ChromiumBidi.BiDiModule.Bluetooth:e(Object.values(jt.ChromiumBidi.Bluetooth.EventNames));break;case jt.ChromiumBidi.BiDiModule.BrowsingContext:e(Object.values(jt.ChromiumBidi.BrowsingContext.EventNames));break;case jt.ChromiumBidi.BiDiModule.Log:e(Object.values(jt.ChromiumBidi.Log.EventNames));break;case jt.ChromiumBidi.BiDiModule.Network:e(Object.values(jt.ChromiumBidi.Network.EventNames));break;case jt.ChromiumBidi.BiDiModule.Script:e(Object.values(jt.ChromiumBidi.Script.EventNames));break;default:t.add(n)}return[...t.values()]}class wV{constructor(t){y(this,Uf);y(this,ux,0);y(this,ma,new Map);y(this,Ci);_(this,Ci,t)}getChannelsSubscribedToEvent(t,e){return Array.from(o(this,ma).keys()).map(a=>({priority:F(this,Uf,WD).call(this,t,e,a),channel:a})).filter(({priority:a})=>a!==null).sort((a,i)=>a.priority-i.priority).map(({channel:a})=>a)}isSubscribedTo(t,e=null){const n=o(this,Ci).findTopLevelContextId(e);for(const a of o(this,ma).values())for(const[i,s]of a.entries())if(!(n!==i&&i!==null)){for(const c of s.keys())if(c===t||c===t.split(".").at(0)||c.split(".").at(0)===t)return!0}return!1}subscribe(t,e,n){switch(e=o(this,Ci).findTopLevelContextId(e),t){case jt.ChromiumBidi.BiDiModule.BrowsingContext:return Object.values(jt.ChromiumBidi.BrowsingContext.EventNames).map(c=>this.subscribe(c,e,n)).flat();case jt.ChromiumBidi.BiDiModule.Log:return Object.values(jt.ChromiumBidi.Log.EventNames).map(c=>this.subscribe(c,e,n)).flat();case jt.ChromiumBidi.BiDiModule.Network:return Object.values(jt.ChromiumBidi.Network.EventNames).map(c=>this.subscribe(c,e,n)).flat();case jt.ChromiumBidi.BiDiModule.Script:return Object.values(jt.ChromiumBidi.Script.EventNames).map(c=>this.subscribe(c,e,n)).flat();case jt.ChromiumBidi.BiDiModule.Bluetooth:return Object.values(jt.ChromiumBidi.Bluetooth.EventNames).map(c=>this.subscribe(c,e,n)).flat()}o(this,ma).has(n)||o(this,ma).set(n,new Map);const a=o(this,ma).get(n);a.has(e)||a.set(e,new Map);const i=a.get(e),s=(e===null?o(this,Ci).getTopLevelContexts().map(c=>c.id):[e]).filter(c=>!this.isSubscribedTo(t,c));return i.has(t)||i.set(t,Du(this,ux)._++),s.map(c=>({event:t,contextId:c}))}unsubscribeAll(t,e,n){for(const i of e)i!==null&&o(this,Ci).getContext(i);D4(O4(t),e).map(([i,s])=>F(this,Uf,zD).call(this,i,s,n)).forEach(i=>i())}unsubscribe(t,e,n){this.unsubscribeAll([t],[e],n)}}ux=new WeakMap,ma=new WeakMap,Ci=new WeakMap,Uf=new WeakSet,WD=function(t,e,n){const a=o(this,ma).get(n);if(a===void 0)return null;const i=o(this,Ci).findTopLevelContextId(e),c=[...new Set([null,i])].map(l=>{var h,d;const u=(h=a.get(l))==null?void 0:h.get(t);if((0,gV.isCdpEvent)(t)){const f=(d=a.get(l))==null?void 0:d.get(jt.ChromiumBidi.BiDiModule.Cdp);return u&&f?Math.min(u,f):u??f}return u}).filter(l=>l!==void 0);return c.length===0?null:Math.min(...c)},zD=function(t,e,n){if(e=o(this,Ci).findTopLevelContextId(e),!o(this,ma).has(n))throw new jt.InvalidArgumentException(`Cannot unsubscribe from ${t}, ${e===null?"null":e}. No subscription found.`);const a=o(this,ma).get(n);if(!a.has(e))throw new jt.InvalidArgumentException(`Cannot unsubscribe from ${t}, ${e===null?"null":e}. No subscription found.`);const i=a.get(e);if(!i.has(t))throw new jt.InvalidArgumentException(`Cannot unsubscribe from ${t}, ${e===null?"null":e}. No subscription found.`);return()=>{i.delete(t),i.size===0&&a.delete(t),a.size===0&&o(this,ma).delete(n)}},_h.SubscriptionManager=wV;var yp;Object.defineProperty(_y,"__esModule",{value:!0}),_y.EventManager=void 0;const vV=At,yV=Ey,M4=Sy,xV=Cy,kV=Uc,bV=Ty,R4=vh,N4=vp,_V=_h;class EV{constructor(t,e){y(this,hx,new bV.IdWrapper);y(this,T1);y(this,A1);_(this,A1,t),_(this,T1,e)}get id(){return o(this,hx).id}get contextId(){return o(this,T1)}get event(){return o(this,A1)}}hx=new WeakMap,T1=new WeakMap,A1=new WeakMap;const Ay=new Map([[vV.ChromiumBidi.Log.EventNames.LogEntryAdded,100]]);class Y_ extends kV.EventEmitter{constructor(e){super();y(this,Ti);y(this,F1,new M4.DefaultMap(()=>new Set));y(this,oc,new Map);y(this,gu,new Map);y(this,cc);y(this,wu);y(this,$f);_(this,wu,e),_(this,cc,new _V.SubscriptionManager(e)),_(this,$f,new M4.DefaultMap(()=>[]))}get subscriptionManager(){return o(this,cc)}addSubscribeHook(e,n){o(this,$f).get(e).push(n)}registerEvent(e,n){this.registerPromiseEvent(Promise.resolve({kind:"success",value:e}),n,e.method)}registerPromiseEvent(e,n,a){const i=new EV(e,n),s=o(this,cc).getChannelsSubscribedToEvent(a,n);F(this,Ti,KD).call(this,i,a);for(const c of s)this.emit("event",{message:R4.OutgoingMessage.createFromPromise(e,c),event:a}),F(this,Ti,XS).call(this,i,c,a)}async subscribe(e,n,a){for(const s of e)(0,N4.assertSupportedEvent)(s);for(const s of n)s!==null&&o(this,wu).getContext(s);const i=[];for(const s of e)for(const c of n){i.push(...o(this,cc).subscribe(s,c,a));for(const l of F(this,Ti,YS).call(this,s,c,a))this.emit("event",{message:R4.OutgoingMessage.createFromPromise(l.event,a),event:s}),F(this,Ti,XS).call(this,l,a,s)}(0,xV.distinctValues)(i).forEach(({contextId:s,event:c})=>{o(this,$f).get(c).forEach(l=>l(s))}),await this.toggleModulesIfNeeded()}async unsubscribe(e,n,a){for(const i of e)(0,N4.assertSupportedEvent)(i);o(this,cc).unsubscribeAll(e,n,a),await this.toggleModulesIfNeeded()}async toggleModulesIfNeeded(){await Promise.all(o(this,wu).getAllContexts().map(async e=>await e.toggleModulesIfNeeded()))}clearBufferedEvents(e){var n;for(const a of Ay.keys()){const i=F(n=yp,vu,cw).call(n,a,e);o(this,oc).delete(i)}}}F1=new WeakMap,oc=new WeakMap,gu=new WeakMap,cc=new WeakMap,wu=new WeakMap,$f=new WeakMap,vu=new WeakSet,cw=function(e,n){return JSON.stringify({eventName:e,browsingContext:n})},Ti=new WeakSet,KD=function(e,n){var i;if(!Ay.has(n))return;const a=F(i=yp,vu,cw).call(i,n,e.contextId);o(this,oc).has(a)||o(this,oc).set(a,new yV.Buffer(Ay.get(n))),o(this,oc).get(a).add(e),o(this,F1).get(n).add(e.contextId)},XS=function(e,n,a){var l,u;if(!Ay.has(a))return;const i=F(l=yp,vu,cw).call(l,a,e.contextId),s=Math.max(((u=o(this,gu).get(i))==null?void 0:u.get(n))??0,e.id),c=o(this,gu).get(i);c?c.set(n,s):o(this,gu).set(i,new Map([[n,s]]))},YS=function(e,n,a){var l,u,h;const i=F(l=yp,vu,cw).call(l,e,n),s=((u=o(this,gu).get(i))==null?void 0:u.get(a))??-1/0,c=((h=o(this,oc).get(i))==null?void 0:h.get().filter(d=>d.id>s))??[];return n===null&&Array.from(o(this,F1).get(e).keys()).filter(d=>d!==null&&o(this,wu).hasContext(d)).map(d=>F(this,Ti,YS).call(this,e,d,a)).forEach(d=>c.push(...d)),c.sort((d,f)=>d.id-f.id)},y(Y_,vu),_y.EventManager=Y_,yp=Y_,Object.defineProperty(Ov,"__esModule",{value:!0}),Ov.BidiServer=void 0;const SV=Uc,CV=Cn,TV=Mv,AV=Rv,FV=ny,PV=ay,IV=gy,DV=wy,OV=ky,MV=by,RV=_y,EE=class EE extends SV.EventEmitter{constructor(e,n,a,i,s,c,l){super();y(this,px);y(this,P1);y(this,yu);y(this,jf);y(this,vs);y(this,ys,new IV.BrowsingContextStorage);y(this,I1,new MV.RealmStorage);y(this,D1,new OV.PreloadScriptStorage);y(this,Hf);y(this,xu);y(this,dx,e=>{o(this,jf).processCommand(e).catch(n=>{var a;(a=o(this,xu))==null||a.call(this,CV.LogType.debugError,n)})});y(this,fx,async e=>{const n=e.message;e.channel!==null&&(n.channel=e.channel),await o(this,yu).sendMessage(n)});_(this,xu,l),_(this,P1,new TV.ProcessingQueue(o(this,fx),o(this,xu))),_(this,yu,e),o(this,yu).setOnMessage(o(this,dx)),_(this,vs,new RV.EventManager(o(this,ys)));const u=new DV.NetworkStorage(o(this,vs),o(this,ys),a,l);_(this,Hf,new FV.BluetoothProcessor(o(this,vs),o(this,ys))),_(this,jf,new AV.CommandProcessor(n,a,o(this,vs),o(this,ys),o(this,I1),o(this,D1),u,o(this,Hf),c,async h=>{await a.sendCommand("Security.setIgnoreCertificateErrors",{ignore:h.acceptInsecureCerts??!1}),new PV.CdpTargetManager(n,a,i,o(this,vs),o(this,ys),o(this,I1),u,o(this,Hf),o(this,D1),s,h==null?void 0:h.unhandledPromptBehavior,l),await a.sendCommand("Target.setDiscoverTargets",{discover:!0}),await a.sendCommand("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),await F(this,px,VD).call(this)},o(this,xu))),o(this,vs).on("event",({message:h,event:d})=>{this.emitOutgoingMessage(h,d)}),o(this,jf).on("response",({message:h,event:d})=>{this.emitOutgoingMessage(h,d)})}static async createAndStart(e,n,a,i,s,c){const[{browserContextIds:l},{targetInfos:u}]=await Promise.all([a.sendCommand("Target.getBrowserContexts"),a.sendCommand("Target.getTargets")]);let h="default";for(const f of u)if(f.browserContextId&&!l.includes(f.browserContextId)){h=f.browserContextId;break}return new EE(e,n,a,i,h,s,c)}emitOutgoingMessage(e,n){o(this,P1).add(e,n)}close(){o(this,yu).close()}};P1=new WeakMap,yu=new WeakMap,jf=new WeakMap,vs=new WeakMap,ys=new WeakMap,I1=new WeakMap,D1=new WeakMap,Hf=new WeakMap,xu=new WeakMap,dx=new WeakMap,fx=new WeakMap,px=new WeakSet,VD=async function(){await Promise.all(o(this,ys).getTopLevelContexts().map(e=>e.lifecycleLoaded()))};let J_=EE;Ov.BidiServer=J_,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.OutgoingMessage=r.EventEmitter=r.BidiServer=void 0;var t=Ov;Object.defineProperty(r,"BidiServer",{enumerable:!0,get:function(){return t.BidiServer}});var e=Uc;Object.defineProperty(r,"EventEmitter",{enumerable:!0,get:function(){return e.EventEmitter}});var n=vh;Object.defineProperty(r,"OutgoingMessage",{enumerable:!0,get:function(){return n.OutgoingMessage}})}(Dv);const ku=class ku extends k0{constructor(e,n){super();y(this,Wf,!1);y(this,lc);y(this,xs,Et.create());H(this,"frame");H(this,"onClose",()=>{ku.sessions.delete(this.id()),_(this,Wf,!0)});if(this.frame=e,!this.frame.page().browser().cdpSupported)return;const a=this.frame.page().browser().connection;_(this,lc,a),n?(o(this,xs).resolve(n),ku.sessions.set(n,this)):(async()=>{try{const{result:i}=await a.send("cdp.getSession",{context:e._id});o(this,xs).resolve(i.session),ku.sessions.set(i.session,this)}catch(i){o(this,xs).reject(i)}})(),ku.sessions.set(o(this,xs).value(),this)}connection(){}async send(e,n,a){if(o(this,lc)===void 0)throw new et("CDP support is required for this feature. The current browser does not support CDP.");if(o(this,Wf))throw new ya(`Protocol error (${e}): Session closed. Most likely the page has been closed.`);const i=await o(this,xs).valueOrThrow(),{result:s}=await o(this,lc).send("cdp.sendCommand",{method:e,params:n,session:i},a==null?void 0:a.timeout);return s.result}async detach(){if(!(o(this,lc)===void 0||o(this,lc).closed||o(this,Wf)))try{await this.frame.client.send("Target.detachFromTarget",{sessionId:this.id()})}finally{this.onClose()}}id(){const e=o(this,xs).value();return typeof e=="string"?e:""}};Wf=new WeakMap,lc=new WeakMap,xs=new WeakMap,H(ku,"sessions",new Map);let xp=ku;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const NV=Ku("puppeteer:webDriverBiDi:SEND ►"),LV=Ku("puppeteer:webDriverBiDi:RECV ◀");class L4 extends Ue{constructor(e,n,a=0,i){super();y(this,O1);y(this,Ai);y(this,zf);y(this,M1,0);y(this,bu,!1);y(this,ks,new zk);y(this,R1,[]);_(this,O1,e),_(this,zf,a),_(this,M1,i??18e4),_(this,Ai,n),o(this,Ai).onmessage=this.onMessage.bind(this),o(this,Ai).onclose=this.unbind.bind(this)}get closed(){return o(this,bu)}get url(){return o(this,O1)}pipeTo(e){o(this,R1).push(e)}emit(e,n){for(const a of o(this,R1))a.emit(e,n);return super.emit(e,n)}send(e,n,a){return Ee(!o(this,bu),"Protocol error: Connection closed."),o(this,ks).create(e,a??o(this,M1),i=>{const s=JSON.stringify({id:i,method:e,params:n});NV(s),o(this,Ai).send(s)})}async onMessage(e){var a;o(this,zf)&&await new Promise(i=>setTimeout(i,o(this,zf))),LV(e);const n=JSON.parse(e);if("type"in n)switch(n.type){case"success":o(this,ks).resolve(n.id,n);return;case"error":if(n.id===null)break;o(this,ks).reject(n.id,BV(n),`${n.error}: ${n.message}`);return;case"event":if(UV(n)){(a=xp.sessions.get(n.params.session))==null||a.emit(n.params.event,n.params.params);return}this.emit(n.method,n.params);return}"id"in n&&o(this,ks).reject(n.id,`Protocol Error. Message is not in BiDi protocol format: '${e}'`,n.message),Re(n)}unbind(){o(this,bu)||(_(this,bu,!0),o(this,Ai).onmessage=()=>{},o(this,Ai).onclose=()=>{},o(this,ks).clear())}dispose(){this.unbind(),o(this,Ai).close()}getPendingProtocolErrors(){return o(this,ks).getPendingProtocolErrors()}}O1=new WeakMap,Ai=new WeakMap,zf=new WeakMap,M1=new WeakMap,bu=new WeakMap,ks=new WeakMap,R1=new WeakMap;function BV(r){let t=`${r.error} ${r.message}`;return r.stacktrace&&(t+=` ${r.stacktrace}`),t}function UV(r){return r.method.startsWith("cdp.")}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const $V=(r,...t)=>{Ku(`bidi:${r}`)(t)};async function jV(r){const t=new WV,e=new HV(r),n={send(s){t.emitMessage(JSON.parse(s))},close(){i.close(),e.close(),r.dispose()},onmessage(s){}};t.on("bidiResponse",s=>{n.onmessage(JSON.stringify(s))});const a=new L4(r.url(),n,r.delay,r.timeout),i=await Dv.BidiServer.createAndStart(t,e,e.browserClient(),"",void 0,$V);return a}class HV{constructor(t){y(this,N1);y(this,_u,new Map);y(this,Eu);_(this,N1,t),_(this,Eu,new B4(t))}browserClient(){return o(this,Eu)}getCdpClient(t){const e=o(this,N1).session(t);if(!e)throw new Error(`Unknown CDP session with id ${t}`);if(!o(this,_u).has(e)){const n=new B4(e,t,o(this,Eu));return o(this,_u).set(e,n),n}return o(this,_u).get(e)}close(){o(this,Eu).close();for(const t of o(this,_u).values())t.close()}}N1=new WeakMap,_u=new WeakMap,Eu=new WeakMap;class B4 extends Dv.EventEmitter{constructor(e,n,a){super();y(this,Kf,!1);y(this,Su);H(this,"sessionId");y(this,L1);y(this,B1,(e,n)=>{this.emit(e,n)});_(this,Su,e),this.sessionId=n,_(this,L1,a),o(this,Su).on("*",o(this,B1))}browserClient(){return o(this,L1)}async sendCommand(e,...n){if(!o(this,Kf))try{return await o(this,Su).send(e,...n)}catch(a){if(o(this,Kf))return;throw a}}close(){o(this,Su).off("*",o(this,B1)),_(this,Kf,!0)}isCloseError(e){return e instanceof ya}}Kf=new WeakMap,Su=new WeakMap,L1=new WeakMap,B1=new WeakMap;class WV extends Dv.EventEmitter{constructor(){super(...arguments);y(this,Vf,async e=>{})}emitMessage(e){o(this,Vf).call(this,e)}setOnMessage(e){_(this,Vf,e)}async sendMessage(e){this.emit("bidiResponse",e)}close(){_(this,Vf,async e=>{})}}Vf=new WeakMap;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var zV=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},KV=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let VV=(()=>{var n,a,i,s,c,l,qD,Xx,GD,f;let r=Ue,t=[],e;return f=class extends r{constructor(p){super();y(this,l);y(this,n,zV(this,t));y(this,a);y(this,i);y(this,s,new rr);y(this,c);_(this,i,p)}static from(p){var v;const g=new f(p);return F(v=g,l,qD).call(v),g}get disposed(){return o(this,s).disposed}get request(){return o(this,n)}get navigation(){return o(this,a)}dispose(){this[He]()}[(e=[Ds],He)](){o(this,s).dispose(),super[He]()}},n=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakSet,qD=function(){const p=o(this,s).use(new Ue(o(this,i)));p.once("closed",()=>{this.emit("failed",{url:o(this,i).url,timestamp:new Date}),this.dispose()}),p.on("request",({request:v})=>{if(v.navigation===void 0||!F(this,l,Xx).call(this,v.navigation))return;_(this,n,v),this.emit("request",v),o(this,s).use(new Ue(o(this,n))).on("redirect",x=>{_(this,n,x)})});const g=o(this,s).use(new Ue(o(this,l,GD)));g.on("browsingContext.navigationStarted",v=>{v.context!==o(this,i).id||o(this,a)!==void 0||_(this,a,f.from(o(this,i)))});for(const v of["browsingContext.domContentLoaded","browsingContext.load"])g.on(v,k=>{k.context!==o(this,i).id||k.navigation===null||!F(this,l,Xx).call(this,k.navigation)||this.dispose()});for(const[v,k]of[["browsingContext.fragmentNavigated","fragment"],["browsingContext.navigationFailed","failed"],["browsingContext.navigationAborted","aborted"]])g.on(v,x=>{x.context!==o(this,i).id||!F(this,l,Xx).call(this,x.navigation)||(this.emit(k,{url:x.url,timestamp:new Date(x.timestamp)}),this.dispose())})},Xx=function(p){return o(this,a)!==void 0&&!o(this,a).disposed?!1:o(this,c)===void 0?(_(this,c,p),!0):o(this,c)===p},GD=function(){return o(this,i).userContext.browser.session},(()=>{const p=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;KV(f,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:g=>"dispose"in g,get:g=>g.dispose},metadata:p},null,t),p&&Object.defineProperty(f,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p})})(),f})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var qV=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},kp=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},Z_;let Q_=(()=>{var c,l;let r=Ue,t=[],e,n,a,i,s;return l=class extends r{constructor(d,f){super();y(this,c,qV(this,t));H(this,"disposables",new rr);H(this,"id");H(this,"origin");H(this,"executionContextId");this.id=d,this.origin=f}get disposed(){return o(this,c)!==void 0}get target(){return{realm:this.id}}dispose(d){_(this,c,d),this[He]()}async disown(d){await this.session.send("script.disown",{target:this.target,handles:d})}async callFunction(d,f,m={}){const{result:w}=await this.session.send("script.callFunction",{functionDeclaration:d,awaitPromise:f,target:this.target,...m});return w}async evaluate(d,f,m={}){const{result:w}=await this.session.send("script.evaluate",{expression:d,awaitPromise:f,target:this.target,...m});return w}async resolveExecutionContextId(){if(!this.executionContextId){const{result:d}=await this.session.connection.send("cdp.resolveRealm",{realm:this.id});this.executionContextId=d.executionContextId}return this.executionContextId}[(e=[Ds],n=[Fe(d=>o(d,c))],a=[Fe(d=>o(d,c))],i=[Fe(d=>o(d,c))],s=[Fe(d=>o(d,c))],He)](){o(this,c)??_(this,c,"Realm already destroyed, probably because all associated browsing contexts closed."),this.emit("destroyed",{reason:o(this,c)}),this.disposables.dispose(),super[He]()}},c=new WeakMap,(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;kp(l,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:f=>"dispose"in f,get:f=>f.dispose},metadata:d},null,t),kp(l,null,n,{kind:"method",name:"disown",static:!1,private:!1,access:{has:f=>"disown"in f,get:f=>f.disown},metadata:d},null,t),kp(l,null,a,{kind:"method",name:"callFunction",static:!1,private:!1,access:{has:f=>"callFunction"in f,get:f=>f.callFunction},metadata:d},null,t),kp(l,null,i,{kind:"method",name:"evaluate",static:!1,private:!1,access:{has:f=>"evaluate"in f,get:f=>f.evaluate},metadata:d},null,t),kp(l,null,s,{kind:"method",name:"resolveExecutionContextId",static:!1,private:!1,access:{has:f=>"resolveExecutionContextId"in f,get:f=>f.resolveExecutionContextId},metadata:d},null,t),d&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d})})(),l})();const SE=class SE extends Q_{constructor(e,n){super("","");y(this,mx);H(this,"browsingContext");H(this,"sandbox");y(this,U1,new Map);this.browsingContext=e,this.sandbox=n}static from(e,n){var i;const a=new SE(e,n);return F(i=a,mx,XD).call(i),a}get session(){return this.browsingContext.userContext.browser.session}get target(){return{context:this.browsingContext.id,sandbox:this.sandbox}}};U1=new WeakMap,mx=new WeakSet,XD=function(){this.disposables.use(new Ue(this.browsingContext)).on("closed",({reason:a})=>{this.dispose(a)});const n=this.disposables.use(new Ue(this.session));n.on("script.realmCreated",a=>{a.type!=="window"||a.context!==this.browsingContext.id||a.sandbox!==this.sandbox||(this.id=a.realm,this.origin=a.origin,this.executionContextId=void 0,this.emit("updated",this))}),n.on("script.realmCreated",a=>{if(a.type!=="dedicated-worker"||!a.owners.includes(this.id))return;const i=tE.from(this,a.realm,a.origin);o(this,U1).set(i.id,i);const s=this.disposables.use(new Ue(i));s.once("destroyed",()=>{s.removeAllListeners(),o(this,U1).delete(i.id)}),this.emit("worker",i)})};let eE=SE;class tE extends Q_{constructor(e,n,a){super(n,a);y(this,gx);y(this,$1,new Map);H(this,"owners");this.owners=new Set([e])}static from(e,n,a){var s;const i=new Z_(e,n,a);return F(s=i,gx,YD).call(s),i}get session(){return this.owners.values().next().value.session}}$1=new WeakMap,gx=new WeakSet,YD=function(){const e=this.disposables.use(new Ue(this.session));e.on("script.realmDestroyed",n=>{n.realm===this.id&&this.dispose("Realm already destroyed.")}),e.on("script.realmCreated",n=>{if(n.type!=="dedicated-worker"||!n.owners.includes(this.id))return;const a=Z_.from(this,n.realm,n.origin);o(this,$1).set(a.id,a),this.disposables.use(new Ue(a)).once("destroyed",()=>{o(this,$1).delete(a.id)}),this.emit("worker",a)})},Z_=tE;const CE=class CE extends Q_{constructor(e,n,a){super(n,a);y(this,wx);y(this,j1,new Map);H(this,"browser");this.browser=e}static from(e,n,a){var s;const i=new CE(e,n,a);return F(s=i,wx,JD).call(s),i}get session(){return this.browser.session}};j1=new WeakMap,wx=new WeakSet,JD=function(){const e=this.disposables.use(new Ue(this.session));e.on("script.realmDestroyed",n=>{n.realm===this.id&&this.dispose("Realm already destroyed.")}),e.on("script.realmCreated",n=>{if(n.type!=="dedicated-worker"||!n.owners.includes(this.id))return;const a=tE.from(this,n.realm,n.origin);o(this,j1).set(a.id,a),this.disposables.use(new Ue(a)).once("destroyed",()=>{o(this,j1).delete(a.id)}),this.emit("worker",a)})};let rE=CE;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var GV=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},XV=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let YV=(()=>{var n,a,i,s,c,l,u,ZD,Ru,f;let r=Ue,t=[],e;return f=class extends r{constructor(p,g){super();y(this,u);y(this,n,GV(this,t));y(this,a);y(this,i);y(this,s);y(this,c,new rr);y(this,l);_(this,s,p),_(this,l,g)}static from(p,g){var k;const v=new f(p,g);return F(k=v,u,ZD).call(k),v}get disposed(){return o(this,c).disposed}get error(){return o(this,n)}get headers(){return o(this,l).request.headers}get id(){return o(this,l).request.request}get initiator(){return o(this,l).initiator}get method(){return o(this,l).request.method}get navigation(){return o(this,l).navigation??void 0}get redirect(){return o(this,a)}get lastRedirect(){let p=o(this,a);for(;p;){if(p&&!o(p,a))return p;p=o(p,a)}return p}get response(){return o(this,i)}get url(){return o(this,l).request.url}get isBlocked(){return o(this,l).isBlocked}get resourceType(){return o(this,l).request["goog:resourceType"]??void 0}get postData(){return o(this,l).request["goog:postData"]??void 0}get hasPostData(){return o(this,l).request["goog:hasPostData"]??!1}async continueRequest({url:p,method:g,headers:v,cookies:k,body:x}){await o(this,u,Ru).send("network.continueRequest",{request:this.id,url:p,method:g,headers:v,body:x,cookies:k})}async failRequest(){await o(this,u,Ru).send("network.failRequest",{request:this.id})}async provideResponse({statusCode:p,reasonPhrase:g,headers:v,body:k}){await o(this,u,Ru).send("network.provideResponse",{request:this.id,statusCode:p,reasonPhrase:g,headers:v,body:k})}async continueWithAuth(p){p.action==="provideCredentials"?await o(this,u,Ru).send("network.continueWithAuth",{request:this.id,action:p.action,credentials:p.credentials}):await o(this,u,Ru).send("network.continueWithAuth",{request:this.id,action:p.action})}dispose(){this[He]()}[(e=[Ds],He)](){o(this,c).dispose(),super[He]()}timing(){return o(this,l).request.timings}},n=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakSet,ZD=function(){o(this,c).use(new Ue(o(this,s))).once("closed",({reason:v})=>{_(this,n,v),this.emit("error",o(this,n)),this.dispose()});const g=o(this,c).use(new Ue(o(this,u,Ru)));g.on("network.beforeRequestSent",v=>{v.context!==o(this,s).id||v.request.request!==this.id||v.redirectCount!==o(this,l).redirectCount+1||(_(this,a,f.from(o(this,s),v)),this.emit("redirect",o(this,a)),this.dispose())}),g.on("network.authRequired",v=>{v.context!==o(this,s).id||v.request.request!==this.id||!v.isBlocked||this.emit("authenticate",void 0)}),g.on("network.fetchError",v=>{v.context!==o(this,s).id||v.request.request!==this.id||o(this,l).redirectCount!==v.redirectCount||(_(this,n,v.errorText),this.emit("error",o(this,n)),this.dispose())}),g.on("network.responseCompleted",v=>{v.context!==o(this,s).id||v.request.request!==this.id||o(this,l).redirectCount!==v.redirectCount||(_(this,i,v.response),o(this,l).request.timings=v.request.timings,this.emit("success",o(this,i)),!(o(this,i).status>=300&&o(this,i).status<400)&&this.dispose())})},Ru=function(){return o(this,s).userContext.browser.session},(()=>{const p=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;XV(f,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:g=>"dispose"in g,get:g=>g.dispose},metadata:p},null,t),p&&Object.defineProperty(f,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p})})(),f})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var JV=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},U4=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let ZV=(()=>{var a,i,s,c,QD,JS,h;let r=Ue,t=[],e,n;return h=class extends r{constructor(m,w){super();y(this,c);y(this,a,JV(this,t));y(this,i);y(this,s,new rr);H(this,"browsingContext");H(this,"info");this.browsingContext=m,this.info=w}static from(m,w){var g;const p=new h(m,w);return F(g=p,c,QD).call(g),p}get closed(){return o(this,a)!==void 0}get disposed(){return this.closed}get handled(){return this.info.handler==="accept"||this.info.handler==="dismiss"?!0:o(this,i)!==void 0}get result(){return o(this,i)}dispose(m){_(this,a,m),this[He]()}async handle(m={}){return await o(this,c,JS).send("browsingContext.handleUserPrompt",{...m,context:this.info.context}),o(this,i)}[(e=[Ds],n=[Fe(m=>o(m,a))],He)](){o(this,a)??_(this,a,"User prompt already closed, probably because the associated browsing context was destroyed."),this.emit("closed",{reason:o(this,a)}),o(this,s).dispose(),super[He]()}},a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakSet,QD=function(){o(this,s).use(new Ue(this.browsingContext)).once("closed",({reason:p})=>{this.dispose(`User prompt already closed: ${p}`)}),o(this,s).use(new Ue(o(this,c,JS))).on("browsingContext.userPromptClosed",p=>{p.context===this.browsingContext.id&&(_(this,i,p),this.emit("handled",p),this.dispose("User prompt already handled."))})},JS=function(){return this.browsingContext.userContext.browser.session},(()=>{const m=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;U4(h,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:w=>"dispose"in w,get:w=>w.dispose},metadata:m},null,t),U4(h,null,n,{kind:"method",name:"handle",static:!1,private:!1,access:{has:w=>"handle"in w,get:w=>w.handle},metadata:m},null,t),m&&Object.defineProperty(h,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:m})})(),h})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var QV=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Ht=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let eq=(()=>{var W,U,A,N,C,K,ne,X,eO,er,ZS,Q;let r=Ue,t=[],e,n,a,i,s,c,l,u,h,d,f,m,w,p,g,v,k,x,S,I,O,E,T,P;return Q=class extends r{constructor(L,M,ce,ke,ue){super();y(this,X);y(this,W,QV(this,t));y(this,U);y(this,A);y(this,N,new Map);y(this,C,new rr);y(this,K,new Map);y(this,ne,new Map);H(this,"defaultRealm");H(this,"id");H(this,"parent");H(this,"userContext");H(this,"originalOpener");_(this,A,ke),this.id=ce,this.parent=M,this.userContext=L,this.originalOpener=ue,this.defaultRealm=F(this,X,ZS).call(this)}static from(L,M,ce,ke,ue){var ge;const ve=new Q(L,M,ce,ke,ue);return F(ge=ve,X,eO).call(ge),ve}get children(){return o(this,N).values()}get closed(){return o(this,U)!==void 0}get disposed(){return this.closed}get realms(){const L=this;return function*(){yield L.defaultRealm,yield*o(L,K).values()}()}get top(){let L=this;for(let{parent:M}=L;M;{parent:M}=L)L=M;return L}get url(){return o(this,A)}dispose(L){_(this,U,L);for(const M of o(this,N).values())M.dispose("Parent browsing context was disposed");this[He]()}async activate(){await o(this,X,er).send("browsingContext.activate",{context:this.id})}async captureScreenshot(L={}){const{result:{data:M}}=await o(this,X,er).send("browsingContext.captureScreenshot",{context:this.id,...L});return M}async close(L){await Promise.all([...o(this,N).values()].map(async M=>{await M.close(L)})),await o(this,X,er).send("browsingContext.close",{context:this.id,promptUnload:L})}async traverseHistory(L){await o(this,X,er).send("browsingContext.traverseHistory",{context:this.id,delta:L})}async navigate(L,M){await o(this,X,er).send("browsingContext.navigate",{context:this.id,url:L,wait:M})}async reload(L={}){await o(this,X,er).send("browsingContext.reload",{context:this.id,...L})}async setCacheBehavior(L){await o(this,X,er).send("network.setCacheBehavior",{contexts:[this.id],cacheBehavior:L})}async print(L={}){const{result:{data:M}}=await o(this,X,er).send("browsingContext.print",{context:this.id,...L});return M}async handleUserPrompt(L={}){await o(this,X,er).send("browsingContext.handleUserPrompt",{context:this.id,...L})}async setViewport(L={}){await o(this,X,er).send("browsingContext.setViewport",{context:this.id,...L})}async performActions(L){await o(this,X,er).send("input.performActions",{context:this.id,actions:L})}async releaseActions(){await o(this,X,er).send("input.releaseActions",{context:this.id})}createWindowRealm(L){return F(this,X,ZS).call(this,L)}async addPreloadScript(L,M={}){return await this.userContext.browser.addPreloadScript(L,{...M,contexts:[this]})}async addIntercept(L){const{result:{intercept:M}}=await this.userContext.browser.session.send("network.addIntercept",{...L,contexts:[this.id]});return M}async removePreloadScript(L){await this.userContext.browser.removePreloadScript(L)}async getCookies(L={}){const{result:{cookies:M}}=await o(this,X,er).send("storage.getCookies",{...L,partition:{type:"context",context:this.id}});return M}async setCookie(L){await o(this,X,er).send("storage.setCookie",{cookie:L,partition:{type:"context",context:this.id}})}async setFiles(L,M){await o(this,X,er).send("input.setFiles",{context:this.id,element:L,files:M})}async subscribe(L){await o(this,X,er).subscribe(L,[this.id])}async addInterception(L){await o(this,X,er).subscribe(L,[this.id])}[(e=[Ds],n=[Fe(L=>o(L,U))],a=[Fe(L=>o(L,U))],i=[Fe(L=>o(L,U))],s=[Fe(L=>o(L,U))],c=[Fe(L=>o(L,U))],l=[Fe(L=>o(L,U))],u=[Fe(L=>o(L,U))],h=[Fe(L=>o(L,U))],d=[Fe(L=>o(L,U))],f=[Fe(L=>o(L,U))],m=[Fe(L=>o(L,U))],w=[Fe(L=>o(L,U))],p=[Fe(L=>o(L,U))],g=[Fe(L=>o(L,U))],v=[Fe(L=>o(L,U))],k=[Fe(L=>o(L,U))],x=[Fe(L=>o(L,U))],S=[Fe(L=>o(L,U))],I=[Fe(L=>o(L,U))],O=[Fe(L=>o(L,U))],E=[Fe(L=>o(L,U))],He)](){o(this,U)??_(this,U,"Browsing context already closed, probably because the user context closed."),this.emit("closed",{reason:o(this,U)}),o(this,C).dispose(),super[He]()}async deleteCookie(...L){await Promise.all(L.map(async M=>{await o(this,X,er).send("storage.deleteCookies",{filter:M,partition:{type:"context",context:this.id}})}))}async locateNodes(L,M){return(await o(this,X,er).send("browsingContext.locateNodes",{context:this.id,locator:L,startNodes:M.length?M:void 0})).result.nodes}},W=new WeakMap,U=new WeakMap,A=new WeakMap,N=new WeakMap,C=new WeakMap,K=new WeakMap,ne=new WeakMap,X=new WeakSet,eO=function(){o(this,C).use(new Ue(this.userContext)).once("closed",({reason:ce})=>{this.dispose(`Browsing context already closed: ${ce}`)});const M=o(this,C).use(new Ue(o(this,X,er)));M.on("browsingContext.contextCreated",ce=>{if(ce.parent!==this.id)return;const ke=Q.from(this.userContext,this,ce.context,ce.url,ce.originalOpener);o(this,N).set(ce.context,ke);const ue=o(this,C).use(new Ue(ke));ue.once("closed",()=>{ue.removeAllListeners(),o(this,N).delete(ke.id)}),this.emit("browsingcontext",{browsingContext:ke})}),M.on("browsingContext.contextDestroyed",ce=>{ce.context===this.id&&this.dispose("Browsing context already closed.")}),M.on("browsingContext.domContentLoaded",ce=>{ce.context===this.id&&(_(this,A,ce.url),this.emit("DOMContentLoaded",void 0))}),M.on("browsingContext.load",ce=>{ce.context===this.id&&(_(this,A,ce.url),this.emit("load",void 0))}),M.on("browsingContext.navigationStarted",ce=>{if(ce.context!==this.id)return;for(const[ue,ve]of o(this,ne))ve.disposed&&o(this,ne).delete(ue);if(o(this,W)!==void 0&&!o(this,W).disposed)return;_(this,W,VV.from(this));const ke=o(this,C).use(new Ue(o(this,W)));for(const ue of["fragment","failed","aborted"])ke.once(ue,({url:ve})=>{ke[He](),_(this,A,ve)});this.emit("navigation",{navigation:o(this,W)})}),M.on("network.beforeRequestSent",ce=>{if(ce.context!==this.id||o(this,ne).has(ce.request.request))return;const ke=YV.from(this,ce);o(this,ne).set(ke.id,ke),this.emit("request",{request:ke})}),M.on("log.entryAdded",ce=>{ce.source.context===this.id&&this.emit("log",{entry:ce})}),M.on("browsingContext.userPromptOpened",ce=>{if(ce.context!==this.id)return;const ke=ZV.from(this,ce);this.emit("userprompt",{userPrompt:ke})})},er=function(){return this.userContext.browser.session},ZS=function(L){const M=eE.from(this,L);return M.on("worker",ce=>{this.emit("worker",{realm:ce})}),M},(()=>{const L=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;T=[Fe(M=>o(M,U))],P=[Fe(M=>o(M,U))],Ht(Q,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:M=>"dispose"in M,get:M=>M.dispose},metadata:L},null,t),Ht(Q,null,n,{kind:"method",name:"activate",static:!1,private:!1,access:{has:M=>"activate"in M,get:M=>M.activate},metadata:L},null,t),Ht(Q,null,a,{kind:"method",name:"captureScreenshot",static:!1,private:!1,access:{has:M=>"captureScreenshot"in M,get:M=>M.captureScreenshot},metadata:L},null,t),Ht(Q,null,i,{kind:"method",name:"close",static:!1,private:!1,access:{has:M=>"close"in M,get:M=>M.close},metadata:L},null,t),Ht(Q,null,s,{kind:"method",name:"traverseHistory",static:!1,private:!1,access:{has:M=>"traverseHistory"in M,get:M=>M.traverseHistory},metadata:L},null,t),Ht(Q,null,c,{kind:"method",name:"navigate",static:!1,private:!1,access:{has:M=>"navigate"in M,get:M=>M.navigate},metadata:L},null,t),Ht(Q,null,l,{kind:"method",name:"reload",static:!1,private:!1,access:{has:M=>"reload"in M,get:M=>M.reload},metadata:L},null,t),Ht(Q,null,u,{kind:"method",name:"setCacheBehavior",static:!1,private:!1,access:{has:M=>"setCacheBehavior"in M,get:M=>M.setCacheBehavior},metadata:L},null,t),Ht(Q,null,h,{kind:"method",name:"print",static:!1,private:!1,access:{has:M=>"print"in M,get:M=>M.print},metadata:L},null,t),Ht(Q,null,d,{kind:"method",name:"handleUserPrompt",static:!1,private:!1,access:{has:M=>"handleUserPrompt"in M,get:M=>M.handleUserPrompt},metadata:L},null,t),Ht(Q,null,f,{kind:"method",name:"setViewport",static:!1,private:!1,access:{has:M=>"setViewport"in M,get:M=>M.setViewport},metadata:L},null,t),Ht(Q,null,m,{kind:"method",name:"performActions",static:!1,private:!1,access:{has:M=>"performActions"in M,get:M=>M.performActions},metadata:L},null,t),Ht(Q,null,w,{kind:"method",name:"releaseActions",static:!1,private:!1,access:{has:M=>"releaseActions"in M,get:M=>M.releaseActions},metadata:L},null,t),Ht(Q,null,p,{kind:"method",name:"createWindowRealm",static:!1,private:!1,access:{has:M=>"createWindowRealm"in M,get:M=>M.createWindowRealm},metadata:L},null,t),Ht(Q,null,g,{kind:"method",name:"addPreloadScript",static:!1,private:!1,access:{has:M=>"addPreloadScript"in M,get:M=>M.addPreloadScript},metadata:L},null,t),Ht(Q,null,v,{kind:"method",name:"addIntercept",static:!1,private:!1,access:{has:M=>"addIntercept"in M,get:M=>M.addIntercept},metadata:L},null,t),Ht(Q,null,k,{kind:"method",name:"removePreloadScript",static:!1,private:!1,access:{has:M=>"removePreloadScript"in M,get:M=>M.removePreloadScript},metadata:L},null,t),Ht(Q,null,x,{kind:"method",name:"getCookies",static:!1,private:!1,access:{has:M=>"getCookies"in M,get:M=>M.getCookies},metadata:L},null,t),Ht(Q,null,S,{kind:"method",name:"setCookie",static:!1,private:!1,access:{has:M=>"setCookie"in M,get:M=>M.setCookie},metadata:L},null,t),Ht(Q,null,I,{kind:"method",name:"setFiles",static:!1,private:!1,access:{has:M=>"setFiles"in M,get:M=>M.setFiles},metadata:L},null,t),Ht(Q,null,O,{kind:"method",name:"subscribe",static:!1,private:!1,access:{has:M=>"subscribe"in M,get:M=>M.subscribe},metadata:L},null,t),Ht(Q,null,E,{kind:"method",name:"addInterception",static:!1,private:!1,access:{has:M=>"addInterception"in M,get:M=>M.addInterception},metadata:L},null,t),Ht(Q,null,T,{kind:"method",name:"deleteCookie",static:!1,private:!1,access:{has:M=>"deleteCookie"in M,get:M=>M.deleteCookie},metadata:L},null,t),Ht(Q,null,P,{kind:"method",name:"locateNodes",static:!1,private:!1,access:{has:M=>"locateNodes"in M,get:M=>M.locateNodes},metadata:L},null,t),L&&Object.defineProperty(Q,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:L})})(),Q})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var tq=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Eh=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let Fy=(()=>{var l,u,h,d,f,m,tO,Nu;let r=Ue,t=[],e,n,a,i,s,c;return l=class extends r{constructor(k,x){super();y(this,m);y(this,u,tq(this,t));y(this,h,new Map);y(this,d,new rr);y(this,f);H(this,"browser");_(this,f,x),this.browser=k}static create(k,x){var I;const S=new l(k,x);return F(I=S,m,tO).call(I),S}get browsingContexts(){return o(this,h).values()}get closed(){return o(this,u)!==void 0}get disposed(){return this.closed}get id(){return o(this,f)}dispose(k){_(this,u,k),this[He]()}async createBrowsingContext(k,x={}){var O;const{result:{context:S}}=await o(this,m,Nu).send("browsingContext.create",{type:k,...x,referenceContext:(O=x.referenceContext)==null?void 0:O.id,userContext:o(this,f)}),I=o(this,h).get(S);return Ee(I,"The WebDriver BiDi implementation is failing to create a browsing context correctly."),I}async remove(){try{await o(this,m,Nu).send("browser.removeUserContext",{userContext:o(this,f)})}finally{this.dispose("User context already closed.")}}async getCookies(k={},x=void 0){const{result:{cookies:S}}=await o(this,m,Nu).send("storage.getCookies",{...k,partition:{type:"storageKey",userContext:o(this,f),sourceOrigin:x}});return S}async setCookie(k,x){await o(this,m,Nu).send("storage.setCookie",{cookie:k,partition:{type:"storageKey",sourceOrigin:x,userContext:this.id}})}async setPermissions(k,x,S){await o(this,m,Nu).send("permissions.setPermission",{origin:k,descriptor:x,state:S,userContext:o(this,f)})}[(e=[Ds],n=[Fe(k=>o(k,u))],a=[Fe(k=>o(k,u))],i=[Fe(k=>o(k,u))],s=[Fe(k=>o(k,u))],c=[Fe(k=>o(k,u))],He)](){o(this,u)??_(this,u,"User context already closed, probably because the browser disconnected/closed."),this.emit("closed",{reason:o(this,u)}),o(this,d).dispose(),super[He]()}},u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakSet,tO=function(){const k=o(this,d).use(new Ue(this.browser));k.once("closed",({reason:S})=>{this.dispose(`User context was closed: ${S}`)}),k.once("disconnected",({reason:S})=>{this.dispose(`User context was closed: ${S}`)}),o(this,d).use(new Ue(o(this,m,Nu))).on("browsingContext.contextCreated",S=>{if(S.parent||S.userContext!==o(this,f))return;const I=eq.from(this,void 0,S.context,S.url,S.originalOpener);o(this,h).set(I.id,I);const O=o(this,d).use(new Ue(I));O.on("closed",()=>{O.removeAllListeners(),o(this,h).delete(I.id)}),this.emit("browsingcontext",{browsingContext:I})})},Nu=function(){return this.browser.session},(()=>{const k=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;Eh(l,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:x=>"dispose"in x,get:x=>x.dispose},metadata:k},null,t),Eh(l,null,n,{kind:"method",name:"createBrowsingContext",static:!1,private:!1,access:{has:x=>"createBrowsingContext"in x,get:x=>x.createBrowsingContext},metadata:k},null,t),Eh(l,null,a,{kind:"method",name:"remove",static:!1,private:!1,access:{has:x=>"remove"in x,get:x=>x.remove},metadata:k},null,t),Eh(l,null,i,{kind:"method",name:"getCookies",static:!1,private:!1,access:{has:x=>"getCookies"in x,get:x=>x.getCookies},metadata:k},null,t),Eh(l,null,s,{kind:"method",name:"setCookie",static:!1,private:!1,access:{has:x=>"setCookie"in x,get:x=>x.setCookie},metadata:k},null,t),Eh(l,null,c,{kind:"method",name:"setPermissions",static:!1,private:!1,access:{has:x=>"setPermissions"in x,get:x=>x.setPermissions},metadata:k},null,t),k&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k})})(),H(l,"DEFAULT","default"),l})();/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class bp{static deserialize(t){var e,n,a,i;if(!t){Re("Service did not produce a result.");return}switch(t.type){case"array":return(e=t.value)==null?void 0:e.map(s=>this.deserialize(s));case"set":return(n=t.value)==null?void 0:n.reduce((s,c)=>s.add(this.deserialize(c)),new Set);case"object":return(a=t.value)==null?void 0:a.reduce((s,c)=>{const{key:l,value:u}=F(this,Cu,QS).call(this,c);return s[l]=u,s},{});case"map":return(i=t.value)==null?void 0:i.reduce((s,c)=>{const{key:l,value:u}=F(this,Cu,QS).call(this,c);return s.set(l,u)},new Map);case"promise":return{};case"regexp":return new RegExp(t.value.pattern,t.value.flags);case"date":return new Date(t.value);case"undefined":return;case"null":return null;case"number":return F(this,Cu,rO).call(this,t.value);case"bigint":return BigInt(t.value);case"boolean":return!!t.value;case"string":return t.value}Re(`Deserialization of type ${t.type} not supported.`)}}Cu=new WeakSet,rO=function(t){switch(t){case"-0":return-0;case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:return t}},QS=function([t,e]){const n=typeof t=="string"?t:this.deserialize(t),a=this.deserialize(e);return{key:n,value:a}},y(bp,Cu);/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const TE=class TE extends kC{constructor(e){super(e.info.type,e.info.message,e.info.defaultValue);y(this,H1);_(this,H1,e),this.handled=e.handled}static from(e){return new TE(e)}async handle(e){await o(this,H1).handle({accept:e.accept,userText:e.text})}};H1=new WeakMap;let nE=TE;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const AE=class AE extends bc{constructor(e,n){super();y(this,Fi);H(this,"realm");y(this,qf,!1);_(this,Fi,e),this.realm=n}static from(e,n){return new AE(e,n)}get disposed(){return o(this,qf)}async jsonValue(){return await this.evaluate(e=>e)}asElement(){return null}async dispose(){o(this,qf)||(_(this,qf,!0),await this.realm.destroyHandles([this]))}get isPrimitiveValue(){switch(o(this,Fi).type){case"string":case"number":case"bigint":case"boolean":case"undefined":case"null":return!0;default:return!1}}toString(){return this.isPrimitiveValue?"JSHandle:"+bp.deserialize(o(this,Fi)):"JSHandle@"+o(this,Fi).type}get id(){return"handle"in o(this,Fi)?o(this,Fi).handle:void 0}remoteValue(){return o(this,Fi)}remoteObject(){throw new et("Not available in WebDriver BiDi")}};Fi=new WeakMap,qf=new WeakMap;let Ys=AE;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var rq=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},$4=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},nq=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},aq=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});let _p=(()=>{var a;let r=FC,t=[],e,n;return a=class extends r{static from(s,c){return new a(s,c)}constructor(s,c){super(Ys.from(s,c)),rq(this,t)}get realm(){return this.handle.realm}get frame(){return this.realm.environment}remoteValue(){return this.handle.remoteValue()}async autofill(s){const c=this.frame.client,u=(await c.send("DOM.describeNode",{objectId:this.handle.id})).node.backendNodeId,h=this.frame._id;await c.send("Autofill.trigger",{fieldId:u,frameId:h,card:s.creditCard})}async contentFrame(){const s={stack:[],error:void 0,hasError:!1};try{const l=nq(s,await this.evaluateHandle(u=>{if(u instanceof HTMLIFrameElement||u instanceof HTMLFrameElement)return u.contentWindow}),!1).remoteValue();return l.type==="window"?this.frame.page().frames().find(u=>u._id===l.value.context)??null:null}catch(c){s.error=c,s.hasError=!0}finally{aq(s)}}async uploadFile(...s){const c=Is.value.path;s=s.map(l=>c.win32.isAbsolute(l)||c.posix.isAbsolute(l)?l:c.resolve(l)),await this.frame.setFiles(this,s)}async*queryAXTree(s,c){const l=await this.frame.locateNodes(this,{type:"accessibility",value:{role:c,name:s}});return yield*Gu.map(l,u=>Promise.resolve(a.from(u,this.realm)))}},(()=>{const s=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e=[Fe()],n=[Fe(),ft],$4(a,null,e,{kind:"method",name:"autofill",static:!1,private:!1,access:{has:c=>"autofill"in c,get:c=>c.autofill},metadata:s},null,t),$4(a,null,n,{kind:"method",name:"contentFrame",static:!1,private:!1,access:{has:c=>"contentFrame"in c,get:c=>c.contentFrame},metadata:s},null,t),s&&Object.defineProperty(a,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})})(),a})();/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var aE=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},iq=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});const FE=class FE{constructor(t,e,n,a=!1){y(this,Pi);y(this,uc);H(this,"name");y(this,W1);y(this,Gf);y(this,Xf);y(this,z1,[]);y(this,K1,new rr);y(this,vx,async t=>{const e={stack:[],error:void 0,hasError:!1};try{if(t.channel!==o(this,Xf))return;const n=F(this,Pi,iO).call(this,t.source);if(!n)return;const a=aE(e,Ys.from(t.data,n),!1),i=aE(e,await a.evaluateHandle(([,,u])=>u),!1),s=aE(e,new rr,!1),c=[];for(const[u,h]of await i.getProperties()){if(s.use(h),h instanceof _p){c[+u]=h,s.use(h);continue}c[+u]=h.jsonValue()}let l;try{l=await o(this,W1).call(this,...await Promise.all(c))}catch(u){try{u instanceof Error?await a.evaluate(([,h],d,f,m)=>{const w=new Error(f);w.name=d,m&&(w.stack=m),h(w)},u.name,u.message,u.stack):await a.evaluate(([,h],d)=>{h(d)},u)}catch(h){Re(h)}return}try{await a.evaluate(([u],h)=>{u(h)},l)}catch(u){Re(u)}}catch(n){e.error=n,e.hasError=!0}finally{iq(e)}});_(this,uc,t),this.name=e,_(this,W1,n),_(this,Gf,a),_(this,Xf,`__puppeteer__${o(this,uc)._id}_page_exposeFunction_${this.name}`)}static async from(t,e,n,a=!1){var s;const i=new FE(t,e,n,a);return await F(s=i,Pi,nO).call(s),i}[Symbol.dispose](){this[Symbol.asyncDispose]().catch(Re)}async[Symbol.asyncDispose](){o(this,K1).dispose(),await Promise.all(o(this,z1).map(async([t,e])=>{const n=o(this,Gf)?t.isolatedRealm():t.mainRealm();try{await Promise.all([n.evaluate(a=>{delete globalThis[a]},this.name),...t.childFrames().map(a=>a.evaluate(i=>{delete globalThis[i]},this.name)),t.browsingContext.removePreloadScript(e)])}catch(a){Re(a)}}))}};uc=new WeakMap,W1=new WeakMap,Gf=new WeakMap,Xf=new WeakMap,z1=new WeakMap,K1=new WeakMap,Pi=new WeakSet,nO=async function(){const t=o(this,Pi,aO),e={type:"channel",value:{channel:o(this,Xf),ownership:"root"}};o(this,K1).use(new Ue(t)).on(At.ChromiumBidi.Script.EventNames.Message,o(this,vx));const a=Va(qu(s=>{Object.assign(globalThis,{[PLACEHOLDER("name")]:function(...c){return new Promise((l,u)=>{s([l,u,c])})}})},{name:JSON.stringify(this.name)})),i=[o(this,uc)];for(const s of i)i.push(...s.childFrames());await Promise.all(i.map(async s=>{const c=o(this,Gf)?s.isolatedRealm():s.mainRealm();try{const[l]=await Promise.all([s.browsingContext.addPreloadScript(a,{arguments:[e],sandbox:c.sandbox}),c.realm.callFunction(a,!1,{arguments:[e]})]);o(this,z1).push([s,l])}catch(l){Re(l)}}))},aO=function(){return o(this,uc).page().browser().connection},vx=new WeakMap,iO=function(t){const e=F(this,Pi,sO).call(this,t.context);if(e)return e.realm(t.realm)},sO=function(t){const e=[o(this,uc)];for(const n of e){if(n._id===t)return n;e.push(...n.childFrames())}};let Ep=FE;var sq=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},oq=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let j4=(()=>{var n,a,i,s,c,oO,u;let r=MC,t=[],e;return u=class extends r{constructor(f,m,w){super();y(this,c);y(this,n,sq(this,t));y(this,a);y(this,i);y(this,s,!1);_(this,n,f),_(this,a,m),_(this,s,w);const p=f["goog:securityDetails"];w&&p&&_(this,i,new aT(p))}static from(f,m,w){var g;const p=new u(f,m,w);return F(g=p,c,oO).call(g),p}remoteAddress(){return{ip:"",port:-1}}url(){return o(this,n).url}status(){return o(this,n).status}statusText(){return o(this,n).statusText}headers(){const f={};for(const m of o(this,n).headers)m.value.type==="string"&&(f[m.name.toLowerCase()]=m.value.value);return f}request(){return o(this,a)}fromCache(){return o(this,n).fromCache}timing(){const f=o(this,a).timing();return{requestTime:f.requestTime,proxyStart:-1,proxyEnd:-1,dnsStart:f.dnsStart,dnsEnd:f.dnsEnd,connectStart:f.connectStart,connectEnd:f.connectEnd,sslStart:f.tlsStart,sslEnd:-1,workerStart:-1,workerReady:-1,workerFetchStart:-1,workerRespondWithSettled:-1,workerRouterEvaluationStart:-1,workerCacheLookupStart:-1,sendStart:f.requestStart,sendEnd:-1,pushStart:-1,pushEnd:-1,receiveHeadersStart:f.responseStart,receiveHeadersEnd:f.responseEnd}}frame(){return o(this,a).frame()}fromServiceWorker(){return!1}securityDetails(){if(!o(this,s))throw new et;return o(this,i)??null}content(){throw new et}},n=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakSet,oO=function(){var f,m;o(this,n).fromCache&&(o(this,a)._fromMemoryCache=!0,(f=o(this,a).frame())==null||f.page().trustedEmitter.emit("requestservedfromcache",o(this,a))),(m=o(this,a).frame())==null||m.page().trustedEmitter.emit("response",this)},(()=>{const f=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e=[xa],oq(u,null,e,{kind:"method",name:"remoteAddress",static:!1,private:!1,access:{has:m=>"remoteAddress"in m,get:m=>m.remoteAddress},metadata:f},null,t),f&&Object.defineProperty(u,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f})})(),u})();var iE;const sE=new WeakMap;class oE extends Hw{constructor(e,n,a){super();y(this,Kn);y(this,Tu);y(this,V1,null);H(this,"id");y(this,Lr);y(this,Wt);y(this,q1,!1);y(this,yx,async()=>{if(!o(this,Lr))return;const e=o(this,Lr).page()._credentials;e&&!o(this,q1)?(_(this,q1,!0),o(this,Wt).continueWithAuth({action:"provideCredentials",credentials:{type:"password",username:e.username,password:e.password}})):o(this,Wt).continueWithAuth({action:"cancel"})});sE.set(e,this),this.interception.enabled=e.isBlocked,_(this,Wt,e),_(this,Lr,n),_(this,Tu,a?o(a,Tu):[]),this.id=e.id}static from(e,n,a){var s;const i=new iE(e,n,a);return F(s=i,Kn,cO).call(s),i}get client(){return o(this,Lr).client}url(){return o(this,Wt).url}resourceType(){if(!o(this,Lr).page().browser().cdpSupported)throw new et;return(o(this,Wt).resourceType||"other").toLowerCase()}method(){return o(this,Wt).method}postData(){if(!o(this,Lr).page().browser().cdpSupported)throw new et;return o(this,Wt).postData}hasPostData(){if(!o(this,Lr).page().browser().cdpSupported)throw new et;return o(this,Wt).hasPostData}async fetchPostData(){throw new et}headers(){const e={};for(const n of o(this,Wt).headers)e[n.name.toLowerCase()]=n.value.value;return{...e,...o(this,Kn,t2),...o(this,Kn,r2)}}response(){return o(this,V1)}failure(){return o(this,Wt).error===void 0?null:{errorText:o(this,Wt).error}}isNavigationRequest(){return o(this,Wt).navigation!==void 0}initiator(){return o(this,Wt).initiator}redirectChain(){return o(this,Tu).slice()}frame(){return o(this,Lr)}async continue(e,n){return await super.continue({headers:o(this,Kn,e2)?this.headers():void 0,...e},n)}async _continue(e={}){const n=H4(e.headers);return this.interception.handled=!0,await o(this,Wt).continueRequest({url:e.url,method:e.method,body:e.postData?{type:"base64",value:uC(e.postData)}:void 0,headers:n.length>0?n:void 0}).catch(a=>(this.interception.handled=!1,Ww(a)))}async _abort(){return this.interception.handled=!0,await o(this,Wt).failRequest().catch(e=>{throw this.interception.handled=!1,e})}async _respond(e,n){this.interception.handled=!0;let a;e.body&&(a=Hw.getResponse(e.body));const i=H4(e.headers),s=i.some(l=>l.name==="content-length");e.contentType&&i.push({name:"content-type",value:{type:"string",value:e.contentType}}),a!=null&&a.contentLength&&!s&&i.push({name:"content-length",value:{type:"string",value:String(a.contentLength)}});const c=e.status||200;return await o(this,Wt).provideResponse({statusCode:c,headers:i.length>0?i:void 0,reasonPhrase:OC[c],body:a!=null&&a.base64?{type:"base64",value:a==null?void 0:a.base64}:void 0}).catch(l=>{throw this.interception.handled=!1,l})}timing(){return o(this,Wt).timing()}}Tu=new WeakMap,V1=new WeakMap,Lr=new WeakMap,Wt=new WeakMap,Kn=new WeakSet,cO=function(){o(this,Wt).on("redirect",e=>{const n=iE.from(e,o(this,Lr),this);o(this,Tu).push(this),e.once("success",()=>{o(this,Lr).page().trustedEmitter.emit("requestfinished",n)}),e.once("error",()=>{o(this,Lr).page().trustedEmitter.emit("requestfailed",n)}),n.finalizeInterceptions()}),o(this,Wt).once("success",e=>{_(this,V1,j4.from(e,this,o(this,Lr).page().browser().cdpSupported))}),o(this,Wt).on("authenticate",o(this,yx)),o(this,Lr).page().trustedEmitter.emit("request",this),o(this,Kn,e2)&&this.interception.handlers.push(async()=>{await this.continue({headers:this.headers()},0)})},e2=function(){return!!(Object.keys(o(this,Kn,t2)).length||Object.keys(o(this,Kn,r2)).length)},t2=function(){var e;return((e=o(this,Lr))==null?void 0:e.page()._extraHTTPHeaders)??{}},r2=function(){var e;return((e=o(this,Lr))==null?void 0:e.page()._userAgentHeaders)??{}},q1=new WeakMap,yx=new WeakMap,iE=oE;function H4(r){const t=[];for(const[e,n]of Object.entries(r??[]))if(!Object.is(n,void 0)){const a=Array.isArray(n)?n:[n];for(const i of a)t.push({name:e.toLowerCase(),value:{type:"string",value:String(i)}})}return t}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class W4 extends Error{}class z4{static serialize(t){switch(typeof t){case"symbol":case"function":throw new W4(`Unable to serializable ${typeof t}`);case"object":return F(this,Yf,uO).call(this,t);case"undefined":return{type:"undefined"};case"number":return F(this,Yf,lO).call(this,t);case"bigint":return{type:"bigint",value:t.toString()};case"string":return{type:"string",value:t};case"boolean":return{type:"boolean",value:t}}}}Yf=new WeakSet,lO=function(t){let e;return Object.is(t,-0)?e="-0":Object.is(t,1/0)?e="Infinity":Object.is(t,-1/0)?e="-Infinity":Object.is(t,NaN)?e="NaN":e=t,{type:"number",value:e}},uO=function(t){if(t===null)return{type:"null"};if(Array.isArray(t))return{type:"array",value:t.map(n=>this.serialize(n))};if(OR(t)){try{JSON.stringify(t)}catch(n){throw n instanceof TypeError&&n.message.startsWith("Converting circular structure to JSON")&&(n.message+=" Recursive objects are not allowed."),n}const e=[];for(const n in t)e.push([this.serialize(n),this.serialize(t[n])]);return{type:"object",value:e}}else{if(MR(t))return{type:"regexp",value:{pattern:t.source,flags:t.flags}};if(RR(t))return{type:"date",value:t.toISOString()}}throw new W4("Custom object serialization not possible. Use plain objects instead.")},y(z4,Yf);/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function cq(r){if(r.exception.type!=="error")return bp.deserialize(r.exception);const[t="",...e]=r.text.split(": "),n=e.join(": "),a=new Error(n);a.name=t;const i=[];if(r.stackTrace&&i.length<Error.stackTraceLimit)for(const s of r.stackTrace.callFrames.reverse()){if(In.isPuppeteerURL(s.url)&&s.url!==In.INTERNAL_URL){const c=In.parse(s.url);i.unshift(`    at ${s.functionName||c.functionName} (${c.functionName} at ${c.siteString}, <anonymous>:${s.lineNumber}:${s.columnNumber})`)}else i.push(`    at ${s.functionName||"<anonymous>"} (${s.url}:${s.lineNumber}:${s.columnNumber})`);if(i.length>=Error.stackTraceLimit)break}return a.stack=[r.text,...i].join(`
`),a}function K4(r,t){return e=>{throw e instanceof yc?e.message+=` at ${r}`:e instanceof Sw&&(e.message=`Navigation timeout of ${t} ms exceeded`),e}}var lq=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},uq=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});class cE extends WC{constructor(e,n){super(n);y(this,G1);H(this,"realm");H(this,"internalPuppeteerUtil");this.realm=e}initialize(){this.realm.on("destroyed",({reason:e})=>{this.taskManager.terminateAll(new Error(e)),this.dispose()}),this.realm.on("updated",()=>{this.internalPuppeteerUtil=void 0,this.taskManager.rerunAll()})}get puppeteerUtil(){const e=Promise.resolve();return b0.inject(n=>{this.internalPuppeteerUtil&&this.internalPuppeteerUtil.then(a=>{a.dispose()}),this.internalPuppeteerUtil=e.then(()=>this.evaluateHandle(n))},!this.internalPuppeteerUtil),this.internalPuppeteerUtil}async evaluateHandle(e,...n){return await F(this,G1,n2).call(this,!1,e,...n)}async evaluate(e,...n){return await F(this,G1,n2).call(this,!0,e,...n)}createHandle(e){return(e.type==="node"||e.type==="window")&&this instanceof Js?_p.from(e,this):Ys.from(e,this)}async serializeAsync(e){return e instanceof Dn&&(e=await e.get(this)),this.serialize(e)}serialize(e){if(e instanceof Ys||e instanceof _p){if(e.realm!==this){if(!(e.realm instanceof Js)||!(this instanceof Js))throw new Error("Trying to evaluate JSHandle from different global types. Usually this means you're using a handle from a worker in a page or vice versa.");if(e.realm.environment!==this.environment)throw new Error("Trying to evaluate JSHandle from different frames. Usually this means you're using a handle from a page on a different page.")}if(e.disposed)throw new Error("JSHandle is disposed!");return e.remoteValue()}return z4.serialize(e)}async destroyHandles(e){if(this.disposed)return;const n=e.map(({id:a})=>a).filter(a=>a!==void 0);n.length!==0&&await this.realm.disown(n).catch(a=>{Re(a)})}async adoptHandle(e){return await this.evaluateHandle(n=>n,e)}async transferHandle(e){if(e.realm===this)return e;const n=this.adoptHandle(e);return await e.dispose(),await n}}G1=new WeakSet,n2=async function(e,n,...a){var h;const i=wC(((h=fC(n))==null?void 0:h.toString())??In.INTERNAL_URL);let s;const c=e?"none":"root",l=e?{}:{maxObjectDepth:0,maxDomDepth:0};if(Ni(n)){const d=Tw.test(n)?n:`${n}
${i}
`;s=this.realm.evaluate(d,!0,{resultOwnership:c,userActivation:!0,serializationOptions:l})}else{let d=Va(n);d=Tw.test(d)?d:`${d}
${i}
`,s=this.realm.callFunction(d,!0,{arguments:a.some(f=>f instanceof Dn)?await Promise.all(a.map(f=>this.serializeAsync(f))):a.map(f=>this.serialize(f)),resultOwnership:c,userActivation:!0,serializationOptions:l})}const u=await s;if("type"in u&&u.type==="exception")throw cq(u.exceptionDetails);return e?bp.deserialize(u.result):this.createHandle(u.result)};const kx=class kx extends cE{constructor(e,n){super(e,n.timeoutSettings);y(this,xx);y(this,Jf);y(this,Zf,!1);_(this,Jf,n)}static from(e,n){var i;const a=new kx(e,n);return F(i=a,xx,hO).call(i),a}get puppeteerUtil(){let e=Promise.resolve();return o(this,Zf)||(e=Promise.all([Ep.from(this.environment,"__ariaQuerySelector",kc.queryOne,!!this.sandbox),Ep.from(this.environment,"__ariaQuerySelectorAll",async(n,a)=>{const i=kc.queryAll(n,a);return await n.realm.evaluateHandle((...s)=>s,...await Gu.collect(i))},!!this.sandbox)]),_(this,Zf,!0)),e.then(()=>super.puppeteerUtil)}get sandbox(){return this.realm.sandbox}get environment(){return o(this,Jf)}async adoptBackendNode(e){const n={stack:[],error:void 0,hasError:!1};try{const{object:a}=await o(this,Jf).client.send("DOM.resolveNode",{backendNodeId:e,executionContextId:await this.realm.resolveExecutionContextId()});return await lq(n,_p.from({handle:a.objectId,type:"node"},this),!1).evaluateHandle(s=>s)}catch(a){n.error=a,n.hasError=!0}finally{uq(n)}}};Jf=new WeakMap,xx=new WeakSet,hO=function(){vP(kx.prototype,this,"initialize").call(this),this.realm.on("updated",()=>{this.environment.clearDocumentHandle(),_(this,Zf,!1)})},Zf=new WeakMap;let Js=kx;const PE=class PE extends cE{constructor(e,n){super(e,n.timeoutSettings);y(this,X1);_(this,X1,n)}static from(e,n){const a=new PE(e,n);return a.initialize(),a}get environment(){return o(this,X1)}async adoptBackendNode(){throw new Error("Cannot adopt DOM nodes into a worker.")}};X1=new WeakMap;let Py=PE;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const IE=class IE extends zC{constructor(e,n){super(n.origin);y(this,Y1);y(this,J1);_(this,Y1,e),_(this,J1,Py.from(n,this))}static from(e,n){return new IE(e,n)}get frame(){return o(this,Y1)}mainRealm(){return o(this,J1)}get client(){throw new et}};Y1=new WeakMap,J1=new WeakMap;let lE=IE;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var hq=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Hc=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},V4=function(r,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:e?"".concat(e," ",t):t})};function dq(r){switch(r){case"group":return"startGroup";case"groupCollapsed":return"startGroupCollapsed";case"groupEnd":return"endGroup";default:return r}}let q4=(()=>{var d,f,m,dO,a2,Yx,v,Jx,Zx,S;let r=IC,t=[],e,n,a,i,s,c,l,u,h;return S=class extends r{constructor(E,T){super();y(this,m);y(this,d,hq(this,t));H(this,"browsingContext");y(this,f,new WeakMap);H(this,"realms");H(this,"_id");H(this,"client");H(this,"accessibility");y(this,v,new Map);_(this,d,E),this.browsingContext=T,this._id=T.id,this.client=new xp(this),this.realms={default:Js.from(this.browsingContext.defaultRealm,this),internal:Js.from(this.browsingContext.createWindowRealm(`__puppeteer_internal_${Math.ceil(Math.random()*1e4)}`),this)},this.accessibility=new KC(this.realms.default)}static from(E,T){var W;const P=new S(E,T);return F(W=P,m,dO).call(W),P}get timeoutSettings(){return this.page()._timeoutSettings}mainRealm(){return this.realms.default}isolatedRealm(){return this.realms.internal}realm(E){for(const T of Object.values(this.realms))if(T.realm.id===E)return T}page(){let E=o(this,d);for(;E instanceof S;)E=o(E,d);return E}url(){return this.browsingContext.url}parentFrame(){return o(this,d)instanceof S?o(this,d):null}childFrames(){return[...this.browsingContext.children].map(E=>o(this,f).get(E))}async goto(E,T={}){const[P]=await Promise.all([this.waitForNavigation(T),this.browsingContext.navigate(E,"interactive").catch(W=>{if(!(Yn(W)&&W.message.includes("net::ERR_HTTP_RESPONSE_CODE_FAILURE")))throw W})]).catch(K4(E,T.timeout??this.timeoutSettings.navigationTimeout()));return P}async setContent(E,T={}){await Promise.all([this.setFrameContent(E),Er(vw([o(this,m,Jx).call(this,T),o(this,m,Zx).call(this,T)]))])}async waitForNavigation(E={}){const{timeout:T=this.timeoutSettings.navigationTimeout(),signal:P}=E,W=this.childFrames().map(U=>{var A;return F(A=U,m,Yx).call(A)});return await Er(vw([_t(this.browsingContext,"navigation").pipe(zu()).pipe(bw(({navigation:U})=>o(this,m,Jx).call(this,E).pipe(_R(()=>W.length===0?Ps(void 0):vw(W)),jr(_t(U,"fragment"),_t(U,"failed"),_t(U,"aborted").pipe(tr(({url:A})=>{throw new Error(`Navigation aborted: ${A}`)}))),bw(()=>{if(U.request){let A=function(N){return N.response||N.error?Ps(U):N.redirect?A(N.redirect):_t(N,"success").pipe(jr(_t(N,"error")),jr(_t(N,"redirect"))).pipe(bw(()=>A(N)))};return A(U.request)}return Ps(U)})))),o(this,m,Zx).call(this,E)]).pipe(tr(([U])=>{const A=U.request;if(!A)return null;const N=A.lastRedirect??A;return sE.get(N).response()}),jr(En(T),xc(P),F(this,m,Yx).call(this).pipe(tr(()=>{throw new ya("Frame detached.")})))))}waitForDevicePrompt(){throw new et}get detached(){return this.browsingContext.closed}async exposeFunction(E,T){if(o(this,v).has(E))throw new Error(`Failed to add page binding with name ${E}: globalThis['${E}'] already exists!`);const P=await Ep.from(this,E,T);o(this,v).set(E,P)}async removeExposedFunction(E){const T=o(this,v).get(E);if(!T)throw new Error(`Failed to remove page binding with name ${E}: window['${E}'] does not exists!`);o(this,v).delete(E),await T[Symbol.asyncDispose]()}async createCDPSession(){if(!this.page().browser().cdpSupported)throw new et;return await this.page().browser().cdpConnection._createSession({targetId:this._id})}async setFiles(E,T){await this.browsingContext.setFiles(E.remoteValue(),T)}async locateNodes(E,T){return await this.browsingContext.locateNodes(T,[E.remoteValue()])}},d=new WeakMap,f=new WeakMap,m=new WeakSet,dO=function(){for(const E of this.browsingContext.children)F(this,m,a2).call(this,E);this.browsingContext.on("browsingcontext",({browsingContext:E})=>{F(this,m,a2).call(this,E)}),this.browsingContext.on("closed",()=>{for(const E of xp.sessions.values())E.frame===this&&E.onClose();this.page().trustedEmitter.emit("framedetached",this)}),this.browsingContext.on("request",({request:E})=>{const T=oE.from(E,this);E.once("success",()=>{this.page().trustedEmitter.emit("requestfinished",T)}),E.once("error",()=>{this.page().trustedEmitter.emit("requestfailed",T)}),T.finalizeInterceptions()}),this.browsingContext.on("navigation",({navigation:E})=>{E.once("fragment",()=>{this.page().trustedEmitter.emit("framenavigated",this)})}),this.browsingContext.on("load",()=>{this.page().trustedEmitter.emit("load",void 0)}),this.browsingContext.on("DOMContentLoaded",()=>{this._hasStartedLoading=!0,this.page().trustedEmitter.emit("domcontentloaded",void 0),this.page().trustedEmitter.emit("framenavigated",this)}),this.browsingContext.on("userprompt",({userPrompt:E})=>{this.page().trustedEmitter.emit("dialog",nE.from(E))}),this.browsingContext.on("log",({entry:E})=>{if(this._id===E.source.context)if(fq(E)){const T=E.args.map(W=>this.mainRealm().createHandle(W)),P=T.reduce((W,U)=>{const A=U instanceof Ys&&U.isPrimitiveValue?bp.deserialize(U.remoteValue()):U.toString();return`${W} ${A}`},"").slice(1);this.page().trustedEmitter.emit("console",new Kk(dq(E.method),P,T,mq(E.stackTrace)))}else if(pq(E)){const T=new Error(E.text??""),P=T.message.split(`
`).length,W=T.stack.split(`
`).splice(0,P),U=[];if(E.stackTrace){for(const A of E.stackTrace.callFrames)if(U.push(`    at ${A.functionName||"<anonymous>"} (${A.url}:${A.lineNumber+1}:${A.columnNumber+1})`),U.length>=Error.stackTraceLimit)break}T.stack=[...W,...U].join(`
`),this.page().trustedEmitter.emit("pageerror",T)}else Re(`Unhandled LogEntry with type "${E.type}", text "${E.text}" and level "${E.level}"`)}),this.browsingContext.on("worker",({realm:E})=>{const T=lE.from(this,E);E.on("destroyed",()=>{this.page().trustedEmitter.emit("workerdestroyed",T)}),this.page().trustedEmitter.emit("workercreated",T)})},a2=function(E){const T=S.from(this,E);return o(this,f).set(E,T),this.page().trustedEmitter.emit("frameattached",T),E.on("closed",()=>{o(this,f).delete(E)}),T},Yx=function(){return wc(()=>this.detached?Ps(this):_t(this.page().trustedEmitter,"framedetached").pipe(vc(E=>E===this)))},v=new WeakMap,Jx=function(){return s.value},Zx=function(){return l.value},(()=>{const E=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e=[ut],n=[ut],a=[ut],i=[ut],c=[ut],u=[ut],h=[ut],Hc(S,null,e,{kind:"method",name:"goto",static:!1,private:!1,access:{has:T=>"goto"in T,get:T=>T.goto},metadata:E},null,t),Hc(S,null,n,{kind:"method",name:"setContent",static:!1,private:!1,access:{has:T=>"setContent"in T,get:T=>T.setContent},metadata:E},null,t),Hc(S,null,a,{kind:"method",name:"waitForNavigation",static:!1,private:!1,access:{has:T=>"waitForNavigation"in T,get:T=>T.waitForNavigation},metadata:E},null,t),Hc(S,s={value:V4(function(T={}){let{waitUntil:P="load"}=T;const{timeout:W=this.timeoutSettings.navigationTimeout()}=T;Array.isArray(P)||(P=[P]);const U=new Set;for(const A of P)switch(A){case"load":{U.add("load");break}case"domcontentloaded":{U.add("DOMContentLoaded");break}}return U.size===0?Ps(void 0):vw([...U].map(A=>_t(this.browsingContext,A))).pipe(tr(()=>{}),zu(),jr(En(W),F(this,m,Yx).call(this).pipe(tr(()=>{throw new Error("Frame detached.")}))))},"#waitForLoad$")},i,{kind:"method",name:"#waitForLoad$",static:!1,private:!0,access:{has:T=>_n(m,T),get:T=>o(T,m,Jx)},metadata:E},null,t),Hc(S,l={value:V4(function(T={}){let{waitUntil:P="load"}=T;Array.isArray(P)||(P=[P]);let W=1/0;for(const U of P)switch(U){case"networkidle0":{W=Math.min(0,W);break}case"networkidle2":{W=Math.min(2,W);break}}return W===1/0?Ps(void 0):this.page().waitForNetworkIdle$({idleTime:500,timeout:T.timeout??this.timeoutSettings.timeout(),concurrency:W})},"#waitForNetworkIdle$")},c,{kind:"method",name:"#waitForNetworkIdle$",static:!1,private:!0,access:{has:T=>_n(m,T),get:T=>o(T,m,Zx)},metadata:E},null,t),Hc(S,null,u,{kind:"method",name:"setFiles",static:!1,private:!1,access:{has:T=>"setFiles"in T,get:T=>T.setFiles},metadata:E},null,t),Hc(S,null,h,{kind:"method",name:"locateNodes",static:!1,private:!1,access:{has:T=>"locateNodes"in T,get:T=>T.locateNodes},metadata:E},null,t),E&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:E})})(),S})();function fq(r){return r.type==="console"}function pq(r){return r.type==="javascript"}function mq(r){const t=[];if(r)for(const e of r.callFrames)t.push({url:e.url,lineNumber:e.lineNumber,columnNumber:e.columnNumber});return t}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Tn;(function(r){r.None="none",r.Key="key",r.Pointer="pointer",r.Wheel="wheel"})(Tn||(Tn={}));var Nt;(function(r){r.Pause="pause",r.KeyDown="keyDown",r.KeyUp="keyUp",r.PointerUp="pointerUp",r.PointerDown="pointerDown",r.PointerMove="pointerMove",r.Scroll="scroll"})(Nt||(Nt={}));const Sp=r=>{switch(r){case"\r":case`
`:r="Enter";break}if([...r].length===1)return r;switch(r){case"Cancel":return"";case"Help":return"";case"Backspace":return"";case"Tab":return"";case"Clear":return"";case"Enter":return"";case"Shift":case"ShiftLeft":return"";case"Control":case"ControlLeft":return"";case"Alt":case"AltLeft":return"";case"Pause":return"";case"Escape":return"";case"PageUp":return"";case"PageDown":return"";case"End":return"";case"Home":return"";case"ArrowLeft":return"";case"ArrowUp":return"";case"ArrowRight":return"";case"ArrowDown":return"";case"Insert":return"";case"Delete":return"";case"NumpadEqual":return"";case"Numpad0":return"";case"Numpad1":return"";case"Numpad2":return"";case"Numpad3":return"";case"Numpad4":return"";case"Numpad5":return"";case"Numpad6":return"";case"Numpad7":return"";case"Numpad8":return"";case"Numpad9":return"";case"NumpadMultiply":return"";case"NumpadAdd":return"";case"NumpadSubtract":return"";case"NumpadDecimal":return"";case"NumpadDivide":return"";case"F1":return"";case"F2":return"";case"F3":return"";case"F4":return"";case"F5":return"";case"F6":return"";case"F7":return"";case"F8":return"";case"F9":return"";case"F10":return"";case"F11":return"";case"F12":return"";case"Meta":case"MetaLeft":return"";case"ShiftRight":return"";case"ControlRight":return"";case"AltRight":return"";case"MetaRight":return"";case"Digit0":return"0";case"Digit1":return"1";case"Digit2":return"2";case"Digit3":return"3";case"Digit4":return"4";case"Digit5":return"5";case"Digit6":return"6";case"Digit7":return"7";case"Digit8":return"8";case"Digit9":return"9";case"KeyA":return"a";case"KeyB":return"b";case"KeyC":return"c";case"KeyD":return"d";case"KeyE":return"e";case"KeyF":return"f";case"KeyG":return"g";case"KeyH":return"h";case"KeyI":return"i";case"KeyJ":return"j";case"KeyK":return"k";case"KeyL":return"l";case"KeyM":return"m";case"KeyN":return"n";case"KeyO":return"o";case"KeyP":return"p";case"KeyQ":return"q";case"KeyR":return"r";case"KeyS":return"s";case"KeyT":return"t";case"KeyU":return"u";case"KeyV":return"v";case"KeyW":return"w";case"KeyX":return"x";case"KeyY":return"y";case"KeyZ":return"z";case"Semicolon":return";";case"Equal":return"=";case"Comma":return",";case"Minus":return"-";case"Period":return".";case"Slash":return"/";case"Backquote":return"`";case"BracketLeft":return"[";case"Backslash":return"\\";case"BracketRight":return"]";case"Quote":return'"';default:throw new Error(`Unknown key: "${r}"`)}};class G4 extends RC{constructor(e){super();y(this,bs);_(this,bs,e)}async down(e,n){await o(this,bs).mainFrame().browsingContext.performActions([{type:Tn.Key,id:"__puppeteer_keyboard",actions:[{type:Nt.KeyDown,value:Sp(e)}]}])}async up(e){await o(this,bs).mainFrame().browsingContext.performActions([{type:Tn.Key,id:"__puppeteer_keyboard",actions:[{type:Nt.KeyUp,value:Sp(e)}]}])}async press(e,n={}){const{delay:a=0}=n,i=[{type:Nt.KeyDown,value:Sp(e)}];a>0&&i.push({type:Nt.Pause,duration:a}),i.push({type:Nt.KeyUp,value:Sp(e)}),await o(this,bs).mainFrame().browsingContext.performActions([{type:Tn.Key,id:"__puppeteer_keyboard",actions:i}])}async type(e,n={}){const{delay:a=0}=n,i=[...e].map(Sp),s=[];if(a<=0)for(const c of i)s.push({type:Nt.KeyDown,value:c},{type:Nt.KeyUp,value:c});else for(const c of i)s.push({type:Nt.KeyDown,value:c},{type:Nt.Pause,duration:a},{type:Nt.KeyUp,value:c});await o(this,bs).mainFrame().browsingContext.performActions([{type:Tn.Key,id:"__puppeteer_keyboard",actions:s}])}async sendCharacter(e){if([...e].length>1)throw new Error("Cannot send more than 1 character.");await(await o(this,bs).focusedFrame()).isolatedRealm().evaluate(async a=>{document.execCommand("insertText",!1,a)},e)}}bs=new WeakMap;const uE=r=>{switch(r){case It.Left:return 0;case It.Middle:return 1;case It.Right:return 2;case It.Back:return 3;case It.Forward:return 4}};class X4 extends NC{constructor(e){super();y(this,Ii);y(this,Au,{x:0,y:0});_(this,Ii,e)}async reset(){_(this,Au,{x:0,y:0}),await o(this,Ii).mainFrame().browsingContext.releaseActions()}async move(e,n,a={}){const i=o(this,Au),s={x:Math.round(e),y:Math.round(n)},c=[],l=a.steps??0;for(let u=0;u<l;++u)c.push({type:Nt.PointerMove,x:i.x+(s.x-i.x)*(u/l),y:i.y+(s.y-i.y)*(u/l),origin:a.origin});c.push({type:Nt.PointerMove,...s,origin:a.origin}),_(this,Au,s),await o(this,Ii).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_mouse",actions:c}])}async down(e={}){await o(this,Ii).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_mouse",actions:[{type:Nt.PointerDown,button:uE(e.button??It.Left)}]}])}async up(e={}){await o(this,Ii).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_mouse",actions:[{type:Nt.PointerUp,button:uE(e.button??It.Left)}]}])}async click(e,n,a={}){const i=[{type:Nt.PointerMove,x:Math.round(e),y:Math.round(n),origin:a.origin}],s={type:Nt.PointerDown,button:uE(a.button??It.Left)},c={type:Nt.PointerUp,button:s.button};for(let l=1;l<(a.count??1);++l)i.push(s,c);i.push(s),a.delay&&i.push({type:Nt.Pause,duration:a.delay}),i.push(c),await o(this,Ii).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_mouse",actions:i}])}async wheel(e={}){await o(this,Ii).mainFrame().browsingContext.performActions([{type:Tn.Wheel,id:"__puppeteer_wheel",actions:[{type:Nt.Scroll,...o(this,Au)??{x:0,y:0},deltaX:e.deltaX??0,deltaY:e.deltaY??0}]}])}drag(){throw new et}dragOver(){throw new et}dragEnter(){throw new et}drop(){throw new et}dragAndDrop(){throw new et}}Ii=new WeakMap,Au=new WeakMap;class Y4 extends LC{constructor(e){super();y(this,Fu);_(this,Fu,e)}async touchStart(e,n,a={}){await o(this,Fu).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_finger",parameters:{pointerType:"touch"},actions:[{type:Nt.PointerMove,x:Math.round(e),y:Math.round(n),origin:a.origin},{type:Nt.PointerDown,button:0,width:.5*2,height:.5*2,pressure:.5,altitudeAngle:Math.PI/2}]}])}async touchMove(e,n,a={}){await o(this,Fu).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_finger",parameters:{pointerType:"touch"},actions:[{type:Nt.PointerMove,x:Math.round(e),y:Math.round(n),origin:a.origin,width:.5*2,height:.5*2,pressure:.5,altitudeAngle:Math.PI/2}]}])}async touchEnd(){await o(this,Fu).mainFrame().browsingContext.performActions([{type:Tn.Pointer,id:"__puppeteer_finger",parameters:{pointerType:"touch"},actions:[{type:Nt.PointerUp,button:0}]}])}}Fu=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var gq=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},J4=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Z4=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Q4=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});let Cp=(()=>{var a,i,s,c,l,u,h,d,fO,m,w,p,g,v,lw,i2,s2,I;let r=$C,t,e=[],n=[];return I=class extends r{constructor(T,P){super();y(this,d);y(this,a,J4(this,e,new Ue));y(this,i,J4(this,n));y(this,s);y(this,c,null);y(this,l,new Set);H(this,"keyboard");H(this,"mouse");H(this,"touchscreen");H(this,"tracing");H(this,"coverage");y(this,u);y(this,h);H(this,"_userAgentHeaders",{});y(this,m);y(this,w);y(this,p);H(this,"_extraHTTPHeaders",{});y(this,g);H(this,"_credentials",null);y(this,v);_(this,i,T),_(this,s,q4.from(this,P)),_(this,u,new XC(o(this,s).client)),this.tracing=new cT(o(this,s).client),this.coverage=new qC(o(this,s).client),this.keyboard=new G4(this),this.mouse=new X4(this),this.touchscreen=new Y4(this)}static from(T,P){var U;const W=new I(T,P);return F(U=W,d,fO).call(U),W}get trustedEmitter(){return o(this,a)}set trustedEmitter(T){_(this,a,T)}_client(){return o(this,s).client}async setUserAgent(T,P){if(!o(this,i).browser().cdpSupported&&P)throw new et("Current Browser does not support `userAgentMetadata`");if(o(this,i).browser().cdpSupported&&P)return await this._client().send("Network.setUserAgentOverride",{userAgent:T,userAgentMetadata:P});const W=T!=="";T=T??await o(this,i).browser().userAgent(),this._userAgentHeaders=W?{"User-Agent":T}:{},_(this,m,await F(this,d,lw).call(this,["beforeRequestSent"],o(this,m),W));const U=C=>{Object.defineProperty(navigator,"userAgent",{value:C})},A=[o(this,s)];for(const C of A)A.push(...C.childFrames());o(this,w)&&await this.removeScriptToEvaluateOnNewDocument(o(this,w));const[N]=await Promise.all([W?this.evaluateOnNewDocument(U,T):void 0,A.map(C=>C.evaluate(U,T))]);_(this,w,N==null?void 0:N.identifier)}async setBypassCSP(T){await this._client().send("Page.setBypassCSP",{enabled:T})}async queryObjects(T){Ee(!T.disposed,"Prototype JSHandle is disposed!"),Ee(T.id,"Prototype JSHandle must not be referencing primitive value");const P=await o(this,s).client.send("Runtime.queryObjects",{prototypeObjectId:T.id});return o(this,s).mainRealm().createHandle({type:"array",handle:P.objects.objectId})}browser(){return this.browserContext().browser()}browserContext(){return o(this,i)}mainFrame(){return o(this,s)}async focusedFrame(){const T={stack:[],error:void 0,hasError:!1};try{const W=Z4(T,await this.mainFrame().isolatedRealm().evaluateHandle(()=>{let A=window;for(;(A.document.activeElement instanceof A.HTMLIFrameElement||A.document.activeElement instanceof A.HTMLFrameElement)&&A.document.activeElement.contentWindow!==null;)A=A.document.activeElement.contentWindow;return A}),!1).remoteValue();Ee(W.type==="window");const U=this.frames().find(A=>A._id===W.value.context);return Ee(U),U}catch(P){T.error=P,T.hasError=!0}finally{Q4(T)}}frames(){const T=[o(this,s)];for(const P of T)T.push(...P.childFrames());return T}isClosed(){return o(this,s).detached}async close(T){const P={stack:[],error:void 0,hasError:!1};try{const W=Z4(P,await o(this,i).waitForScreenshotOperations(),!1);try{await o(this,s).browsingContext.close(T==null?void 0:T.runBeforeUnload)}catch{return}}catch(W){P.error=W,P.hasError=!0}finally{Q4(P)}}async reload(T={}){const[P]=await Promise.all([o(this,s).waitForNavigation(T),o(this,s).browsingContext.reload()]).catch(K4(this.url(),T.timeout??this._timeoutSettings.navigationTimeout()));return P}setDefaultNavigationTimeout(T){this._timeoutSettings.setDefaultNavigationTimeout(T)}setDefaultTimeout(T){this._timeoutSettings.setDefaultTimeout(T)}getDefaultTimeout(){return this._timeoutSettings.timeout()}isJavaScriptEnabled(){return o(this,u).javascriptEnabled}async setGeolocation(T){return await o(this,u).setGeolocation(T)}async setJavaScriptEnabled(T){return await o(this,u).setJavaScriptEnabled(T)}async emulateMediaType(T){return await o(this,u).emulateMediaType(T)}async emulateCPUThrottling(T){return await o(this,u).emulateCPUThrottling(T)}async emulateMediaFeatures(T){return await o(this,u).emulateMediaFeatures(T)}async emulateTimezone(T){return await o(this,u).emulateTimezone(T)}async emulateIdleState(T){return await o(this,u).emulateIdleState(T)}async emulateVisionDeficiency(T){return await o(this,u).emulateVisionDeficiency(T)}async setViewport(T){if(!this.browser().cdpSupported){await o(this,s).browsingContext.setViewport({viewport:T!=null&&T.width&&(T!=null&&T.height)?{width:T.width,height:T.height}:null,devicePixelRatio:T!=null&&T.deviceScaleFactor?T.deviceScaleFactor:null}),_(this,c,T);return}const P=await o(this,u).emulateViewport(T);_(this,c,T),P&&await this.reload()}viewport(){return o(this,c)}async pdf(T={}){const{timeout:P=this._timeoutSettings.timeout(),path:W=void 0}=T,{printBackground:U,margin:A,landscape:N,width:C,height:K,pageRanges:ne,scale:X,preferCSSPageSize:oe}=vC(T,"cm"),q=ne?ne.split(", "):[];await Er(dt(this.mainFrame().isolatedRealm().evaluate(()=>document.fonts.ready)).pipe(jr(En(P))));const se=await Er(dt(o(this,s).browsingContext.print({background:U,margin:A,orientation:N?"landscape":"portrait",page:{width:C,height:K},pageRanges:q,scale:X,shrinkToFit:!oe})).pipe(jr(En(P)))),Q=Ck(se,!0);return await this._maybeWriteTypedArrayToFile(W,Q),Q}async createPDFStream(T){const P=await this.pdf(T);return new ReadableStream({start(W){W.enqueue(P),W.close()}})}async _screenshot(T){const{clip:P,type:W,captureBeyondViewport:U,quality:A}=T;if(T.omitBackground!==void 0&&T.omitBackground)throw new et("BiDi does not support 'omitBackground'.");if(T.optimizeForSpeed!==void 0&&T.optimizeForSpeed)throw new et("BiDi does not support 'optimizeForSpeed'.");if(T.fromSurface!==void 0&&!T.fromSurface)throw new et("BiDi does not support 'fromSurface'.");if(P!==void 0&&P.scale!==void 0&&P.scale!==1)throw new et("BiDi does not support 'scale' in 'clip'.");let N;if(P)if(U)N=P;else{const[K,ne]=await this.evaluate(()=>{if(!window.visualViewport)throw new Error("window.visualViewport is not supported.");return[window.visualViewport.pageLeft,window.visualViewport.pageTop]});N={...P,x:P.x-K,y:P.y-ne}}return await o(this,s).browsingContext.captureScreenshot({origin:U?"document":"viewport",format:{type:`image/${W}`,...A!==void 0?{quality:A/100}:{}},...N?{clip:{type:"box",...N}}:{}})}async createCDPSession(){return await o(this,s).createCDPSession()}async bringToFront(){await o(this,s).browsingContext.activate()}async evaluateOnNewDocument(T,...P){const W=wq(T,...P);return{identifier:await o(this,s).browsingContext.addPreloadScript(W)}}async removeScriptToEvaluateOnNewDocument(T){await o(this,s).browsingContext.removePreloadScript(T)}async exposeFunction(T,P){return await this.mainFrame().exposeFunction(T,"default"in P?P.default:P)}isDragInterceptionEnabled(){return!1}async setCacheEnabled(T){if(!o(this,i).browser().cdpSupported){await o(this,s).browsingContext.setCacheBehavior(T?"default":"bypass");return}await this._client().send("Network.setCacheDisabled",{cacheDisabled:!T})}async cookies(...T){const P=(T.length?T:[this.url()]).map(U=>new URL(U));return(await o(this,s).browsingContext.getCookies()).map(U=>kq(U)).filter(U=>P.some(A=>xq(U,A)))}isServiceWorkerBypassed(){throw new et}target(){throw new et}waitForFileChooser(){throw new et}workers(){return[...o(this,l)]}async setRequestInterception(T){_(this,p,await F(this,d,lw).call(this,["beforeRequestSent"],o(this,p),T))}async setExtraHTTPHeaders(T){const P={};for(const[W,U]of Object.entries(T))Ee(Ni(U),`Expected value of header "${W}" to be String, but "${typeof U}" is found.`),P[W.toLowerCase()]=U;this._extraHTTPHeaders=P,_(this,g,await F(this,d,lw).call(this,["beforeRequestSent"],o(this,g),!!Object.keys(this._extraHTTPHeaders).length))}async authenticate(T){_(this,v,await F(this,d,lw).call(this,["authRequired"],o(this,v),!!T)),this._credentials=T}setDragInterception(){throw new et}setBypassServiceWorker(){throw new et}async setOfflineMode(T){if(!o(this,i).browser().cdpSupported)throw new et;return o(this,h)||_(this,h,{offline:!1,upload:-1,download:-1,latency:0}),o(this,h).offline=T,await F(this,d,i2).call(this)}async emulateNetworkConditions(T){if(!o(this,i).browser().cdpSupported)throw new et;return o(this,h)||_(this,h,{offline:!1,upload:-1,download:-1,latency:0}),o(this,h).upload=T?T.upload:-1,o(this,h).download=T?T.download:-1,o(this,h).latency=T?T.latency:0,await F(this,d,i2).call(this)}async setCookie(...T){const P=this.url(),W=P.startsWith("http");for(const U of T){let A=U.url||"";!A&&W&&(A=P),Ee(A!=="about:blank",`Blank page can not have cookie "${U.name}"`),Ee(!String.prototype.startsWith.call(A||"","data:"),`Data URL page can not have cookie "${U.name}"`);const N=URL.canParse(A)?new URL(A):void 0,C=U.domain??(N==null?void 0:N.hostname);Ee(C!==void 0,"At least one of the url and domain needs to be specified");const K={domain:C,name:U.name,value:{type:"string",value:U.value},...U.path!==void 0?{path:U.path}:{},...U.httpOnly!==void 0?{httpOnly:U.httpOnly}:{},...U.secure!==void 0?{secure:U.secure}:{},...U.sameSite!==void 0?{sameSite:Sq(U.sameSite)}:{},...U.expires!==void 0?{expiry:U.expires}:{},..._q(U,"sameParty","sourceScheme","priority","url")};U.partitionKey!==void 0?await this.browserContext().userContext.setCookie(K,U.partitionKey):await o(this,s).browsingContext.setCookie(K)}}async deleteCookie(...T){await Promise.all(T.map(async P=>{const W=P.url??this.url(),U=URL.canParse(W)?new URL(W):void 0,A=P.domain??(U==null?void 0:U.hostname);Ee(A!==void 0,"At least one of the url and domain needs to be specified");const N={domain:A,name:P.name,...P.path!==void 0?{path:P.path}:{}};await o(this,s).browsingContext.deleteCookie(N)}))}async removeExposedFunction(T){await o(this,s).removeExposedFunction(T)}metrics(){throw new et}async goBack(T={}){return await F(this,d,s2).call(this,-1,T)}async goForward(T={}){return await F(this,d,s2).call(this,1,T)}waitForDevicePrompt(){throw new et}},a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakSet,fO=function(){o(this,s).browsingContext.on("closed",()=>{this.trustedEmitter.emit("close",void 0),this.trustedEmitter.removeAllListeners()}),this.trustedEmitter.on("workercreated",T=>{o(this,l).add(T)}),this.trustedEmitter.on("workerdestroyed",T=>{o(this,l).delete(T)})},m=new WeakMap,w=new WeakMap,p=new WeakMap,g=new WeakMap,v=new WeakMap,lw=async function(T,P,W){if(W&&!P)return await o(this,s).browsingContext.addIntercept({phases:T});if(!W&&P){await o(this,s).browsingContext.userContext.browser.removeIntercept(P);return}return P},i2=async function(){o(this,h)&&await this._client().send("Network.emulateNetworkConditions",{offline:o(this,h).offline,latency:o(this,h).latency,uploadThroughput:o(this,h).upload,downloadThroughput:o(this,h).download})},s2=async function(T,P){const W=new AbortController;try{const[U]=await Promise.all([this.waitForNavigation({...P,signal:W.signal}),o(this,s).browsingContext.traverseHistory(T)]);return U}catch(U){if(W.abort(),Yn(U)&&U.message.includes("no such history entry"))return null;throw U}},(()=>{const T=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t=[Nw()],gq(I,null,t,{kind:"accessor",name:"trustedEmitter",static:!1,private:!1,access:{has:P=>"trustedEmitter"in P,get:P=>P.trustedEmitter,set:(P,W)=>{P.trustedEmitter=W}},metadata:T},e,n),T&&Object.defineProperty(I,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:T})})(),I})();function wq(r,...t){return`() => {${Fk(r,...t)}}`}function vq(r,t){const e=r.domain.toLowerCase(),n=t.hostname.toLowerCase();return e===n}function yq(r,t){const e=t.pathname,n=r.path;return!!(e===n||e.startsWith(n)&&(n.endsWith("/")||e[n.length]==="/"))}function xq(r,t){const e=new URL(t);return Ee(r!==void 0),vq(r,e)?yq(r,e):!1}function kq(r){const t=r[Iy+"partitionKey"];function e(){return typeof t=="string"?{partitionKey:t}:typeof t=="object"&&t!==null?{partitionKey:t.topLevelSite}:{}}return{name:r.name,value:r.value.value,domain:r.domain,path:r.path,size:r.size,httpOnly:r.httpOnly,secure:r.secure,sameSite:Eq(r.sameSite),expires:r.expiry??-1,session:r.expiry===void 0||r.expiry<=0,...bq(r,"sameParty","sourceScheme","partitionKeyOpaque","priority"),...e()}}const Iy="goog:";function bq(r,...t){const e={};for(const n of t)r[Iy+n]!==void 0&&(e[n]=r[Iy+n]);return e}function _q(r,...t){const e={};for(const n of t)r[n]!==void 0&&(e[Iy+n]=r[n]);return e}function Eq(r){return r==="strict"?"Strict":r==="lax"?"Lax":"None"}function Sq(r){return r==="Strict"?"strict":r==="Lax"?"lax":"none"}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Cq extends T0{constructor(e){super();y(this,Qf);_(this,Qf,e)}asPage(){throw new et}url(){return""}createCDPSession(){throw new et}type(){return Wr.BROWSER}browser(){return o(this,Qf)}browserContext(){return o(this,Qf).defaultBrowserContext()}opener(){throw new et}}Qf=new WeakMap;class Tq extends T0{constructor(e){super();y(this,_s);_(this,_s,e)}async page(){return o(this,_s)}async asPage(){return Cp.from(this.browserContext(),o(this,_s).mainFrame().browsingContext)}url(){return o(this,_s).url()}createCDPSession(){return o(this,_s).createCDPSession()}type(){return Wr.PAGE}browser(){return this.browserContext().browser()}browserContext(){return o(this,_s).browserContext()}opener(){throw new et}}_s=new WeakMap;class Aq extends T0{constructor(e){super();y(this,Es);y(this,e0);_(this,Es,e)}async page(){return o(this,e0)===void 0&&_(this,e0,Cp.from(this.browserContext(),o(this,Es).browsingContext)),o(this,e0)}async asPage(){return Cp.from(this.browserContext(),o(this,Es).browsingContext)}url(){return o(this,Es).url()}createCDPSession(){return o(this,Es).createCDPSession()}type(){return Wr.PAGE}browser(){return this.browserContext().browser()}browserContext(){return o(this,Es).page().browserContext()}opener(){throw new et}}Es=new WeakMap,e0=new WeakMap;class Fq extends T0{constructor(e){super();y(this,t0);_(this,t0,e)}async page(){throw new et}async asPage(){throw new et}url(){return o(this,t0).url()}createCDPSession(){throw new et}type(){return Wr.OTHER}browser(){return this.browserContext().browser()}browserContext(){return o(this,t0).frame.page().browserContext()}opener(){throw new et}}t0=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Pq=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},eP=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Iq=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Dq=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});let tP=(()=>{var a,i,s,c,l,u,h,pO,o2,m;let r=xC,t,e=[],n=[];return m=class extends r{constructor(g,v,k){super();y(this,h);y(this,a,eP(this,e,new Ue));y(this,i,eP(this,n));y(this,s);H(this,"userContext");y(this,c,new WeakMap);y(this,l,new Map);y(this,u,[]);_(this,i,g),this.userContext=v,_(this,s,k.defaultViewport)}static from(g,v,k){var S;const x=new m(g,v,k);return F(S=x,h,pO).call(S),x}get trustedEmitter(){return o(this,a)}set trustedEmitter(g){_(this,a,g)}targets(){return[...o(this,l).values()].flatMap(([g,v])=>[g,...v.values()])}async newPage(){const g={stack:[],error:void 0,hasError:!1};try{const v=Iq(g,await this.waitForScreenshotOperations(),!1),k=await this.userContext.createBrowsingContext("tab"),x=o(this,c).get(k);if(!x)throw new Error("Page is not found");if(o(this,s))try{await x.setViewport(o(this,s))}catch{}return x}catch(v){g.error=v,g.hasError=!0}finally{Dq(g)}}async close(){Ee(this.userContext.id!==Fy.DEFAULT,"Default BrowserContext cannot be closed!");try{await this.userContext.remove()}catch(g){Re(g)}o(this,l).clear()}browser(){return o(this,i)}async pages(){return[...this.userContext.browsingContexts].map(g=>o(this,c).get(g))}async overridePermissions(g,v){const k=new Set(v.map(x=>{if(!Ik.get(x))throw new Error("Unknown permission: "+x);return x}));await Promise.all(Array.from(Ik.keys()).map(x=>{const S=this.userContext.setPermissions(g,{name:x},k.has(x)?"granted":"denied");return o(this,u).push({origin:g,permission:x}),k.has(x)?S:S.catch(Re)}))}async clearPermissionOverrides(){const g=o(this,u).map(({permission:v,origin:k})=>this.userContext.setPermissions(k,{name:v},"prompt").catch(Re));_(this,u,[]),await Promise.all(g)}get id(){if(this.userContext.id!==Fy.DEFAULT)return this.userContext.id}},a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,h=new WeakSet,pO=function(){for(const g of this.userContext.browsingContexts)F(this,h,o2).call(this,g);this.userContext.on("browsingcontext",({browsingContext:g})=>{const v=F(this,h,o2).call(this,g);g.once("DOMContentLoaded",()=>{if(g.originalOpener)for(const k of this.userContext.browsingContexts)k.id===g.originalOpener&&o(this,c).get(k).trustedEmitter.emit("popup",v)})}),this.userContext.on("closed",()=>{this.trustedEmitter.removeAllListeners()})},o2=function(g){const v=Cp.from(this,g);o(this,c).set(g,v),v.trustedEmitter.on("close",()=>{o(this,c).delete(g)});const k=new Tq(v),x=new Map;return o(this,l).set(v,[k,x]),v.trustedEmitter.on("frameattached",S=>{const I=S,O=new Aq(I);x.set(I,O),this.trustedEmitter.emit("targetcreated",O)}),v.trustedEmitter.on("framenavigated",S=>{const I=S,O=x.get(I);O===void 0?this.trustedEmitter.emit("targetchanged",k):this.trustedEmitter.emit("targetchanged",O)}),v.trustedEmitter.on("framedetached",S=>{const I=S,O=x.get(I);O!==void 0&&(x.delete(I),this.trustedEmitter.emit("targetdestroyed",O))}),v.trustedEmitter.on("workercreated",S=>{const I=S,O=new Fq(I);x.set(I,O),this.trustedEmitter.emit("targetcreated",O)}),v.trustedEmitter.on("workerdestroyed",S=>{const I=S,O=x.get(I);O!==void 0&&(x.delete(S),this.trustedEmitter.emit("targetdestroyed",O))}),v.trustedEmitter.on("close",()=>{o(this,l).delete(v),this.trustedEmitter.emit("targetdestroyed",k)}),this.trustedEmitter.emit("targetcreated",k),v},(()=>{const g=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t=[Nw()],Pq(m,null,t,{kind:"accessor",name:"trustedEmitter",static:!1,private:!1,access:{has:v=>"trustedEmitter"in v,get:v=>v.trustedEmitter,set:(v,k)=>{v.trustedEmitter=k}},metadata:g},e,n),g&&Object.defineProperty(m,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:g})})(),m})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Oq=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Sh=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},Mq=function(r,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");r.stack.push({value:t,dispose:n,async:e})}else e&&r.stack.push({async:!0});return t},Rq=function(r){return function(t){function e(a){t.error=t.hasError?new r(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}function n(){for(;t.stack.length;){var a=t.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(n,function(s){return e(s),n()})}catch(s){e(s)}}if(t.hasError)throw t.error}return n()}}(typeof SuppressedError=="function"?SuppressedError:function(r,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=r,n.suppressed=t,n});let Nq=(()=>{var l,u,h,d,f,m,mO,gO,wO,c2,k;let r=Ue,t=[],e,n,a,i,s,c;return k=class extends r{constructor(I){super();y(this,m);y(this,l,(Oq(this,t),!1));y(this,u);y(this,h,new rr);y(this,d,new Map);H(this,"session");y(this,f,new Map);this.session=I}static async from(I){var E;const O=new k(I);return await F(E=O,m,mO).call(E),O}get closed(){return o(this,l)}get defaultUserContext(){return o(this,d).get(Fy.DEFAULT)}get disconnected(){return o(this,u)!==void 0}get disposed(){return this.disconnected}get userContexts(){return o(this,d).values()}dispose(I,O=!1){_(this,l,O),_(this,u,I),this[He]()}async close(){try{await this.session.send("browser.close",{})}finally{this.dispose("Browser already closed.",!0)}}async addPreloadScript(I,O={}){var T;const{result:{script:E}}=await this.session.send("script.addPreloadScript",{functionDeclaration:I,...O,contexts:(T=O.contexts)==null?void 0:T.map(P=>P.id)});return E}async removeIntercept(I){await this.session.send("network.removeIntercept",{intercept:I})}async removePreloadScript(I){await this.session.send("script.removePreloadScript",{script:I})}async createUserContext(){const{result:{userContext:I}}=await this.session.send("browser.createUserContext",{});return F(this,m,c2).call(this,I)}[(e=[Ds],n=[Fe(I=>o(I,u))],a=[Fe(I=>o(I,u))],i=[Fe(I=>o(I,u))],s=[Fe(I=>o(I,u))],c=[Fe(I=>o(I,u))],He)](){o(this,u)??_(this,u,"Browser was disconnected, probably because the session ended."),this.closed&&this.emit("closed",{reason:o(this,u)}),this.emit("disconnected",{reason:o(this,u)}),o(this,h).dispose(),super[He]()}},l=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakSet,mO=async function(){const I=o(this,h).use(new Ue(this.session));I.once("ended",({reason:O})=>{this.dispose(O)}),I.on("script.realmCreated",O=>{O.type==="shared-worker"&&o(this,f).set(O.realm,rE.from(this,O.realm,O.origin))}),await F(this,m,gO).call(this),await F(this,m,wO).call(this)},gO=async function(){const{result:{userContexts:I}}=await this.session.send("browser.getUserContexts",{});for(const O of I)F(this,m,c2).call(this,O.userContext)},wO=async function(){const I=new Set;let O;{const E={stack:[],error:void 0,hasError:!1};try{Mq(E,new Ue(this.session),!1).on("browsingContext.contextCreated",W=>{I.add(W.context)});const{result:P}=await this.session.send("browsingContext.getTree",{});O=P.contexts}catch(T){E.error=T,E.hasError=!0}finally{Rq(E)}}for(const E of O)I.has(E.context)||this.session.emit("browsingContext.contextCreated",E),E.children&&O.push(...E.children)},c2=function(I){const O=Fy.create(this,I);o(this,d).set(O.id,O);const E=o(this,h).use(new Ue(O));return E.once("closed",()=>{E.removeAllListeners(),o(this,d).delete(O.id)}),O},(()=>{const I=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;Sh(k,null,e,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:O=>"dispose"in O,get:O=>O.dispose},metadata:I},null,t),Sh(k,null,n,{kind:"method",name:"close",static:!1,private:!1,access:{has:O=>"close"in O,get:O=>O.close},metadata:I},null,t),Sh(k,null,a,{kind:"method",name:"addPreloadScript",static:!1,private:!1,access:{has:O=>"addPreloadScript"in O,get:O=>O.addPreloadScript},metadata:I},null,t),Sh(k,null,i,{kind:"method",name:"removeIntercept",static:!1,private:!1,access:{has:O=>"removeIntercept"in O,get:O=>O.removeIntercept},metadata:I},null,t),Sh(k,null,s,{kind:"method",name:"removePreloadScript",static:!1,private:!1,access:{has:O=>"removePreloadScript"in O,get:O=>O.removePreloadScript},metadata:I},null,t),Sh(k,null,c,{kind:"method",name:"createUserContext",static:!1,private:!1,access:{has:O=>"createUserContext"in O,get:O=>O.createUserContext},metadata:I},null,t),I&&Object.defineProperty(k,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:I})})(),k})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var hE=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},Ch=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0};let Lq=(()=>{var h,d,f,m,w,vO,g;let r=Ue,t=[],e,n=[],a=[],i,s,c,l,u;return g=class extends r{constructor(x,S){super();y(this,w);y(this,h,hE(this,t));y(this,d,new rr);y(this,f);H(this,"browser");y(this,m,hE(this,n,void 0));hE(this,a),_(this,f,S),this.connection=x}static async from(x,S){var E;const{result:I}=await x.send("session.new",{capabilities:S}),O=new g(x,I);return await F(E=O,w,vO).call(E),O}get connection(){return o(this,m)}set connection(x){_(this,m,x)}get capabilities(){return o(this,f).capabilities}get disposed(){return this.ended}get ended(){return o(this,h)!==void 0}get id(){return o(this,f).sessionId}dispose(x){_(this,h,x),this[He]()}async send(x,S){return await this.connection.send(x,S)}async subscribe(x,S){await this.send("session.subscribe",{events:x,contexts:S})}async addIntercepts(x,S){await this.send("session.subscribe",{events:x,contexts:S})}async end(){try{await this.send("session.end",{})}finally{this.dispose("Session already ended.")}}[(e=[Nw()],i=[Ds],s=[Fe(x=>o(x,h))],c=[Fe(x=>o(x,h))],l=[Fe(x=>o(x,h))],u=[Fe(x=>o(x,h))],He)](){o(this,h)??_(this,h,"Session already destroyed, probably because the connection broke."),this.emit("ended",{reason:o(this,h)}),o(this,d).dispose(),super[He]()}},h=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,w=new WeakSet,vO=async function(){this.browser=await Nq.from(this),o(this,d).use(this.browser).once("closed",({reason:I})=>{this.dispose(I)});const S=new WeakSet;this.on("browsingContext.fragmentNavigated",I=>{S.has(I)||(S.add(I),this.emit("browsingContext.navigationStarted",I),this.emit("browsingContext.fragmentNavigated",I))})},(()=>{const x=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;Ch(g,null,e,{kind:"accessor",name:"connection",static:!1,private:!1,access:{has:S=>"connection"in S,get:S=>S.connection,set:(S,I)=>{S.connection=I}},metadata:x},n,a),Ch(g,null,i,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:S=>"dispose"in S,get:S=>S.dispose},metadata:x},null,t),Ch(g,null,s,{kind:"method",name:"send",static:!1,private:!1,access:{has:S=>"send"in S,get:S=>S.send},metadata:x},null,t),Ch(g,null,c,{kind:"method",name:"subscribe",static:!1,private:!1,access:{has:S=>"subscribe"in S,get:S=>S.subscribe},metadata:x},null,t),Ch(g,null,l,{kind:"method",name:"addIntercepts",static:!1,private:!1,access:{has:S=>"addIntercepts"in S,get:S=>S.addIntercepts},metadata:x},null,t),Ch(g,null,u,{kind:"method",name:"end",static:!1,private:!1,access:{has:S=>"end"in S,get:S=>S.end},metadata:x},null,t),x&&Object.defineProperty(g,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:x})})(),g})();/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Bq=function(r,t,e,n,a,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&r?n.static?r:r.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,f=!1,m=e.length-1;m>=0;m--){var w={};for(var p in n)w[p]=p==="access"?{}:n[p];for(var p in n.access)w.access[p]=n.access[p];w.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var g=(0,e[m])(c==="accessor"?{get:h.get,set:h.set}:h[l],w);if(c==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=s(g.get))&&(h.get=d),(d=s(g.set))&&(h.set=d),(d=s(g.init))&&a.unshift(d)}else(d=s(g))&&(c==="field"?a.unshift(d):h[l]=d)}u&&Object.defineProperty(u,n.name,h),f=!0},rP=function(r,t,e){for(var n=arguments.length>2,a=0;a<t.length;a++)e=n?t[a].call(r,e):t[a].call(r);return n?e:void 0},nP=function(r,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:e?"".concat(e," ",t):t})};let Uq=(()=>{var i,s,c,Lu,yO,h,d,f,m,w,p,g,xO,kO,bO,l2;let r=yC,t,e=[],n=[],a;return i=class extends r{constructor(E,T){super();y(this,c);H(this,"protocol","webDriverBiDi");y(this,s,rP(this,e,new Ue));y(this,h,rP(this,n));y(this,d);y(this,f);y(this,m);y(this,w,new WeakMap);y(this,p,new Cq(this));y(this,g);_(this,h,T.process),_(this,d,T.closeCallback),_(this,f,E),_(this,m,T.defaultViewport),_(this,g,T.cdpConnection)}static async create(E){var W,U,A;const T=await Lq.from(E.connection,{firstMatch:(W=E.capabilities)==null?void 0:W.firstMatch,alwaysMatch:{...(U=E.capabilities)==null?void 0:U.alwaysMatch,acceptInsecureCerts:E.acceptInsecureCerts,unhandledPromptBehavior:{default:"ignore"},webSocketUrl:!0}});await T.subscribe(T.capabilities.browserName.toLocaleLowerCase().includes("firefox")?i.subscribeModules:[...i.subscribeModules,...i.subscribeCdpEvents]);const P=new i(T.browser,E);return F(A=P,c,xO).call(A),P}get cdpSupported(){return o(this,g)!==void 0}get cdpConnection(){return o(this,g)}async userAgent(){return o(this,f).session.capabilities.userAgent}get connection(){return o(this,f).session.connection}wsEndpoint(){return this.connection.url}async close(){var E;if(!this.connection.closed)try{await o(this,f).close(),await((E=o(this,d))==null?void 0:E.call(null))}catch(T){Re(T)}finally{this.connection.dispose()}}get connected(){return!o(this,f).disconnected}process(){return o(this,h)??null}async createBrowserContext(E){const T=await o(this,f).createUserContext();return F(this,c,l2).call(this,T)}async version(){return`${o(this,c,kO)}/${o(this,c,bO)}`}browserContexts(){return[...o(this,f).userContexts].map(E=>o(this,w).get(E))}defaultBrowserContext(){return o(this,w).get(o(this,f).defaultUserContext)}newPage(){return this.defaultBrowserContext().newPage()}targets(){return[o(this,p),...this.browserContexts().flatMap(E=>E.targets())]}target(){return o(this,p)}async disconnect(){try{await o(this,f).session.end()}catch(E){Re(E)}finally{this.connection.dispose()}}get debugInfo(){return{pendingProtocolErrors:this.connection.getPendingProtocolErrors()}}},s=new WeakMap,c=new WeakSet,Lu=function(){return a.get.call(this)},yO=function(E){return a.set.call(this,E)},h=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,w=new WeakMap,p=new WeakMap,g=new WeakMap,xO=function(){var E;for(const T of o(this,f).userContexts)F(this,c,l2).call(this,T);o(this,f).once("disconnected",()=>{o(this,c,Lu).emit("disconnected",void 0),o(this,c,Lu).removeAllListeners()}),(E=o(this,h))==null||E.once("close",()=>{o(this,f).dispose("Browser process exited.",!0),this.connection.dispose()})},kO=function(){return o(this,f).session.capabilities.browserName},bO=function(){return o(this,f).session.capabilities.browserVersion},l2=function(E){const T=tP.from(this,E,{defaultViewport:o(this,m)});return o(this,w).set(E,T),T.trustedEmitter.on("targetcreated",P=>{o(this,c,Lu).emit("targetcreated",P)}),T.trustedEmitter.on("targetchanged",P=>{o(this,c,Lu).emit("targetchanged",P)}),T.trustedEmitter.on("targetdestroyed",P=>{o(this,c,Lu).emit("targetdestroyed",P)}),T},(()=>{const E=typeof Symbol=="function"&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t=[Nw()],Bq(i,a={get:nP(function(){return o(this,s)},"#trustedEmitter","get"),set:nP(function(T){_(this,s,T)},"#trustedEmitter","set")},t,{kind:"accessor",name:"#trustedEmitter",static:!1,private:!0,access:{has:T=>_n(c,T),get:T=>o(T,c,Lu),set:(T,P)=>{_(T,c,P,yO)}},metadata:E},e,n),E&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:E})})(),H(i,"subscribeModules",["browsingContext","network","log","script"]),H(i,"subscribeCdpEvents",["cdp.Debugger.scriptParsed","cdp.CSS.styleSheetAdded","cdp.Runtime.executionContextsCleared","cdp.Tracing.tracingComplete","cdp.Network.requestWillBeSent","cdp.Debugger.scriptParsed","cdp.Page.screencastFrame"]),i})();/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const aP=Object.freeze(Object.defineProperty({__proto__:null,BidiBrowser:Uq,BidiBrowserContext:tP,BidiConnection:L4,BidiElementHandle:_p,BidiFrame:q4,BidiFrameRealm:Js,BidiHTTPRequest:oE,BidiHTTPResponse:j4,BidiJSHandle:Ys,BidiKeyboard:G4,BidiMouse:X4,BidiPage:Cp,BidiRealm:cE,BidiTouchscreen:Y4,BidiWorkerRealm:Py,connectBidiOverCdp:jV,requests:sE},Symbol.toStringTag,{value:"Module"}));var $q=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")};const jq=at($q);/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const DE=class DE{constructor(t){y(this,Ss);H(this,"onmessage");H(this,"onclose");_(this,Ss,t),o(this,Ss).addEventListener("message",e=>{this.onmessage&&this.onmessage.call(null,e.data)}),o(this,Ss).addEventListener("close",()=>{this.onclose&&this.onclose.call(null)}),o(this,Ss).addEventListener("error",()=>{})}static create(t,e){return new Promise((n,a)=>{const i=new jq(t,[],{followRedirects:!0,perMessageDeflate:!1,allowSynchronousEvents:!1,maxPayload:268435456,headers:{"User-Agent":`Puppeteer ${lC}`,...e}});i.addEventListener("open",()=>n(new DE(i))),i.addEventListener("error",a)})}send(t){o(this,Ss).send(t)}close(){o(this,Ss).close()}};Ss=new WeakMap;let dE=DE;const Hq=Object.freeze(Object.defineProperty({__proto__:null,NodeWebSocketTransport:dE},Symbol.toStringTag,{value:"Module"}))})();
