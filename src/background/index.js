(function(){"use strict";var ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dt(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var q={exports:{}};(function(o,s){(function(m,e){o.exports=e()})(ct,function(){var m=1e3,e=6e4,w=36e5,j="millisecond",k="second",E="minute",d="hour",M="day",N="week",S="month",it="quarter",U="year",J="date",at="Invalid Date",Mt=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,St=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,It={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var r=["th","st","nd","rd"],t=a%100;return"["+a+(r[(t-20)%10]||r[t]||r[0])+"]"}},z=function(a,r,t){var i=String(a);return!i||i.length>=r?a:""+Array(r+1-i.length).join(t)+a},Et={s:z,z:function(a){var r=-a.utcOffset(),t=Math.abs(r),i=Math.floor(t/60),n=t%60;return(r<=0?"+":"-")+z(i,2,"0")+":"+z(n,2,"0")},m:function a(r,t){if(r.date()<t.date())return-a(t,r);var i=12*(t.year()-r.year())+(t.month()-r.month()),n=r.clone().add(i,S),u=t-n<0,c=r.clone().add(i+(u?-1:1),S);return+(-(i+(t-n)/(u?n-c:c-n))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:S,y:U,w:N,d:M,D:J,h:d,m:E,s:k,ms:j,Q:it}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},L="en",B={};B[L]=It;var st="$isDayjsObject",K=function(a){return a instanceof P||!(!a||!a[st])},F=function a(r,t,i){var n;if(!r)return L;if(typeof r=="string"){var u=r.toLowerCase();B[u]&&(n=u),t&&(B[u]=t,n=u);var c=r.split("-");if(!n&&c.length>1)return a(c[0])}else{var f=r.name;B[f]=r,n=f}return!i&&n&&(L=n),n||!i&&L},v=function(a,r){if(K(a))return a.clone();var t=typeof r=="object"?r:{};return t.date=a,t.args=arguments,new P(t)},l=Et;l.l=F,l.i=K,l.w=function(a,r){return v(a,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var P=function(){function a(t){this.$L=F(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[st]=!0}var r=a.prototype;return r.parse=function(t){this.$d=function(i){var n=i.date,u=i.utc;if(n===null)return new Date(NaN);if(l.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var c=n.match(Mt);if(c){var f=c[2]-1||0,h=(c[7]||"0").substring(0,3);return u?new Date(Date.UTC(c[1],f,c[3]||1,c[4]||0,c[5]||0,c[6]||0,h)):new Date(c[1],f,c[3]||1,c[4]||0,c[5]||0,c[6]||0,h)}}return new Date(n)}(t),this.init()},r.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},r.$utils=function(){return l},r.isValid=function(){return this.$d.toString()!==at},r.isSame=function(t,i){var n=v(t);return this.startOf(i)<=n&&n<=this.endOf(i)},r.isAfter=function(t,i){return v(t)<this.startOf(i)},r.isBefore=function(t,i){return this.endOf(i)<v(t)},r.$g=function(t,i,n){return l.u(t)?this[i]:this.set(n,t)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(t,i){var n=this,u=!!l.u(i)||i,c=l.p(t),f=function(T,p){var _=l.w(n.$u?Date.UTC(n.$y,p,T):new Date(n.$y,p,T),n);return u?_:_.endOf(M)},h=function(T,p){return l.w(n.toDate()[T].apply(n.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(p)),n)},$=this.$W,y=this.$M,D=this.$D,C="set"+(this.$u?"UTC":"");switch(c){case U:return u?f(1,0):f(31,11);case S:return u?f(1,y):f(0,y+1);case N:var H=this.$locale().weekStart||0,A=($<H?$+7:$)-H;return f(u?D-A:D+(6-A),y);case M:case J:return h(C+"Hours",0);case d:return h(C+"Minutes",1);case E:return h(C+"Seconds",2);case k:return h(C+"Milliseconds",3);default:return this.clone()}},r.endOf=function(t){return this.startOf(t,!1)},r.$set=function(t,i){var n,u=l.p(t),c="set"+(this.$u?"UTC":""),f=(n={},n[M]=c+"Date",n[J]=c+"Date",n[S]=c+"Month",n[U]=c+"FullYear",n[d]=c+"Hours",n[E]=c+"Minutes",n[k]=c+"Seconds",n[j]=c+"Milliseconds",n)[u],h=u===M?this.$D+(i-this.$W):i;if(u===S||u===U){var $=this.clone().set(J,1);$.$d[f](h),$.init(),this.$d=$.set(J,Math.min(this.$D,$.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},r.set=function(t,i){return this.clone().$set(t,i)},r.get=function(t){return this[l.p(t)]()},r.add=function(t,i){var n,u=this;t=Number(t);var c=l.p(i),f=function(y){var D=v(u);return l.w(D.date(D.date()+Math.round(y*t)),u)};if(c===S)return this.set(S,this.$M+t);if(c===U)return this.set(U,this.$y+t);if(c===M)return f(1);if(c===N)return f(7);var h=(n={},n[E]=e,n[d]=w,n[k]=m,n)[c]||1,$=this.$d.getTime()+t*h;return l.w($,this)},r.subtract=function(t,i){return this.add(-1*t,i)},r.format=function(t){var i=this,n=this.$locale();if(!this.isValid())return n.invalidDate||at;var u=t||"YYYY-MM-DDTHH:mm:ssZ",c=l.z(this),f=this.$H,h=this.$m,$=this.$M,y=n.weekdays,D=n.months,C=n.meridiem,H=function(p,_,x,W){return p&&(p[_]||p(i,u))||x[_].slice(0,W)},A=function(p){return l.s(f%12||12,p,"0")},T=C||function(p,_,x){var W=p<12?"AM":"PM";return x?W.toLowerCase():W};return u.replace(St,function(p,_){return _||function(x){switch(x){case"YY":return String(i.$y).slice(-2);case"YYYY":return l.s(i.$y,4,"0");case"M":return $+1;case"MM":return l.s($+1,2,"0");case"MMM":return H(n.monthsShort,$,D,3);case"MMMM":return H(D,$);case"D":return i.$D;case"DD":return l.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return H(n.weekdaysMin,i.$W,y,2);case"ddd":return H(n.weekdaysShort,i.$W,y,3);case"dddd":return y[i.$W];case"H":return String(f);case"HH":return l.s(f,2,"0");case"h":return A(1);case"hh":return A(2);case"a":return T(f,h,!0);case"A":return T(f,h,!1);case"m":return String(h);case"mm":return l.s(h,2,"0");case"s":return String(i.$s);case"ss":return l.s(i.$s,2,"0");case"SSS":return l.s(i.$ms,3,"0");case"Z":return c}return null}(p)||c.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(t,i,n){var u,c=this,f=l.p(i),h=v(t),$=(h.utcOffset()-this.utcOffset())*e,y=this-h,D=function(){return l.m(c,h)};switch(f){case U:u=D()/12;break;case S:u=D();break;case it:u=D()/3;break;case N:u=(y-$)/6048e5;break;case M:u=(y-$)/864e5;break;case d:u=y/w;break;case E:u=y/e;break;case k:u=y/m;break;default:u=y}return n?u:l.a(u)},r.daysInMonth=function(){return this.endOf(S).$D},r.$locale=function(){return B[this.$L]},r.locale=function(t,i){if(!t)return this.$L;var n=this.clone(),u=F(t,i,!0);return u&&(n.$L=u),n},r.clone=function(){return l.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},a}(),ut=P.prototype;return v.prototype=ut,[["$ms",j],["$s",k],["$m",E],["$H",d],["$W",M],["$M",S],["$y",U],["$D",J]].forEach(function(a){ut[a[1]]=function(r){return this.$g(r,a[0],a[1])}}),v.extend=function(a,r){return a.$i||(a(r,P,v),a.$i=!0),v},v.locale=F,v.isDayjs=K,v.unix=function(a){return v(1e3*a)},v.en=B[L],v.Ls=B,v.p={},v})})(q);var lt=q.exports;const Q=dt(lt),X="YYYY-MM-DD HH:mm:ss.SSS";function tt(o){console.log(`${Q(new Date).format(X)} ${o}`)}function Ot(o){}function et(o){console.error(`${Q(new Date).format(X)} ${o}`),console.error(o)}const O="CONTENT_SCRIPT",I="BACKGROUND",V="OFFSCREEN";function ft(o){let s=new URL(o);return s.origin+s.pathname}for(var b=[],G=0;G<256;++G)b.push((G+256).toString(16).slice(1));function ht(o,s=0){return(b[o[s+0]]+b[o[s+1]]+b[o[s+2]]+b[o[s+3]]+"-"+b[o[s+4]]+b[o[s+5]]+"-"+b[o[s+6]]+b[o[s+7]]+"-"+b[o[s+8]]+b[o[s+9]]+"-"+b[o[s+10]]+b[o[s+11]]+b[o[s+12]]+b[o[s+13]]+b[o[s+14]]+b[o[s+15]]).toLowerCase()}var Y,vt=new Uint8Array(16);function $t(){if(!Y&&(Y=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Y(vt)}var bt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const nt={randomUUID:bt};function yt(o,s,m){if(nt.randomUUID&&!s&&!o)return nt.randomUUID();o=o||{};var e=o.random||(o.rng||$t)();return e[6]=e[6]&15|64,e[8]=e[8]&63|128,ht(e)}const mt="EVENT_BRIDGE",Z=new Map;function g(o,s,{onMessageCallback:m,invokeEnv:e}={invokeEnv:O}){let w=kt();return new Promise((k,E)=>{try{pt(w,{resolve:k,reject:E});let d={action:o,callbackId:w,param:s,from:O,to:I,invokeEnv:e};if(m&&m(d),e==O)""+d.from+d.to+d.action+d.invokeEnv+d.callbackId+d.error,chrome.runtime.sendMessage(d);else if(e==I){d.from=I,d.to=V,""+d.from+d.to+d.action+d.invokeEnv+d.callbackId+d.error,chrome.runtime.sendMessage(d);try{if(window){const M=new CustomEvent(mt,{detail:d});window.dispatchEvent(M)}}catch{}}else E(`unknow invokeEnv = ${e}`)}catch(d){et(d),E(d)}})}function pt(o,s){Z.set(o,s)}function wt(o){let s=Z.get(o);return Z.delete(o),s}function kt(){return yt()}const rt={batchAddOrUpdateJobBrowse:async function(o){return await g(this.batchAddOrUpdateJobBrowse.name,o)},addOrUpdateJobBrowse:async function(o){return await g(this.addOrUpdateJobBrowse.name,o)},searchJob:async function(o){return(await g(this.searchJob.name,o)).data},getJobBrowseInfoByIds:async function(o){return(await g(this.getJobBrowseInfoByIds.name,o)).data},statisticJobBrowse:async function(){return(await g(this.statisticJobBrowse.name,{})).data},statisticJobSearchGroupByAvgSalary:async function(o){return(await g(this.statisticJobSearchGroupByAvgSalary.name,o)).data},getJobByDetailUrl:async function(o,{invokeEnv:s}={invokeEnv:O}){return(await g(this.getJobByDetailUrl.name,o,{invokeEnv:s})).data},addJobBrowseDetailHistory:async function(o,{invokeEnv:s}={invokeEnv:O}){return await g(this.addJobBrowseDetailHistory.name,o,{invokeEnv:s})}},ot=()=>setInterval(chrome.runtime.getPlatformInfo,2e4);chrome.runtime.onStartup.addListener(ot),ot(),chrome.action.onClicked.addListener(()=>{chrome.tabs.create({url:"src/sidepanel/index.html"})}),chrome.tabs.onUpdated.addListener(async(o,s,m)=>{if((s==null?void 0:s.status)=="complete"&&m.url){let e=ft(m.url),w=await rt.getJobByDetailUrl(e,{invokeEnv:I});w&&(tt(`save jobBrowseDetailHistory start jobId = ${w.jobId}`),await rt.addJobBrowseDetailHistory(w.jobId,{invokeEnv:I}),tt(`save jobBrowseDetailHistory success jobId = ${w.jobId}`))}});let R;async function Dt(o){var s,m;await((m=(s=chrome.offscreen).hasDocument)==null?void 0:m.call(s))||(R?await R:(R=chrome.offscreen.createDocument({url:chrome.runtime.getURL(o),reasons:[chrome.offscreen.Reason.WORKERS||chrome.offscreen.Reason.BLOBS],justification:"To run web worker to run sqlite"}),await R,R=null),chrome.runtime.onMessage.addListener(async function(e,w,j){if(e){if(e.from==O&&e.to==I)w.tab&&(e.tabId=w.tab.id),""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,e.from=I,e.to=V,""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,chrome.runtime.sendMessage(e);else if(e.from==V&&e.to==I){if(""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,e.invokeEnv==O)e.from=I,e.to=O,""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,e.tabId?chrome.tabs.sendMessage(e.tabId,e):chrome.runtime.sendMessage(e);else if(e.invokeEnv==I){let k=wt(e.callbackId);k?e.error?(e.message=e.error,k.reject(e)):k.resolve(e):et(`callbackId = ${e.callbackId} lost callback promiseHook`)}}}}))}Dt("src/offscreen/offscreen.html")})();
