(function(){"use strict";var Q=typeof document<"u"?document.currentScript:null;const I="CONTENT_SCRIPT",g="BACKGROUND",J="OFFSCREEN",V="WEB_WORKER";var ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ht(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var X={exports:{}};(function(e,t){(function(h,v){e.exports=v()})(ft,function(){var h=1e3,v=6e4,M=36e5,Y="millisecond",O="second",E="minute",u="hour",w="day",N="week",D="month",ct="quarter",U="year",R="date",ut="Invalid Date",It=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,St=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Ot={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var o=["th","st","nd","rd"],n=a%100;return"["+a+(o[(n-20)%10]||o[n]||o[0])+"]"}},Z=function(a,o,n){var i=String(a);return!i||i.length>=o?a:""+Array(o+1-i.length).join(n)+a},Ut={s:Z,z:function(a){var o=-a.utcOffset(),n=Math.abs(o),i=Math.floor(n/60),r=n%60;return(o<=0?"+":"-")+Z(i,2,"0")+":"+Z(r,2,"0")},m:function a(o,n){if(o.date()<n.date())return-a(n,o);var i=12*(n.year()-o.year())+(n.month()-o.month()),r=o.clone().add(i,D),s=n-r<0,c=o.clone().add(i+(s?-1:1),D);return+(-(i+(n-r)/(s?r-c:c-r))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:D,y:U,w:N,d:w,D:R,h:u,m:E,s:O,ms:Y,Q:ct}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},j="en",B={};B[j]=Ot;var dt="$isDayjsObject",q=function(a){return a instanceof F||!(!a||!a[dt])},W=function a(o,n,i){var r;if(!o)return j;if(typeof o=="string"){var s=o.toLowerCase();B[s]&&(r=s),n&&(B[s]=n,r=s);var c=o.split("-");if(!r&&c.length>1)return a(c[0])}else{var l=o.name;B[l]=o,r=l}return!i&&r&&(j=r),r||!i&&j},m=function(a,o){if(q(a))return a.clone();var n=typeof o=="object"?o:{};return n.date=a,n.args=arguments,new F(n)},d=Ut;d.l=W,d.i=q,d.w=function(a,o){return m(a,{locale:o.$L,utc:o.$u,x:o.$x,$offset:o.$offset})};var F=function(){function a(n){this.$L=W(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[dt]=!0}var o=a.prototype;return o.parse=function(n){this.$d=function(i){var r=i.date,s=i.utc;if(r===null)return new Date(NaN);if(d.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var c=r.match(It);if(c){var l=c[2]-1||0,f=(c[7]||"0").substring(0,3);return s?new Date(Date.UTC(c[1],l,c[3]||1,c[4]||0,c[5]||0,c[6]||0,f)):new Date(c[1],l,c[3]||1,c[4]||0,c[5]||0,c[6]||0,f)}}return new Date(r)}(n),this.init()},o.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},o.$utils=function(){return d},o.isValid=function(){return this.$d.toString()!==ut},o.isSame=function(n,i){var r=m(n);return this.startOf(i)<=r&&r<=this.endOf(i)},o.isAfter=function(n,i){return m(n)<this.startOf(i)},o.isBefore=function(n,i){return this.endOf(i)<m(n)},o.$g=function(n,i,r){return d.u(n)?this[i]:this.set(r,n)},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this.$d.getTime()},o.startOf=function(n,i){var r=this,s=!!d.u(i)||i,c=d.p(n),l=function(H,$){var _=d.w(r.$u?Date.UTC(r.$y,$,H):new Date(r.$y,$,H),r);return s?_:_.endOf(w)},f=function(H,$){return d.w(r.toDate()[H].apply(r.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice($)),r)},b=this.$W,k=this.$M,p=this.$D,C="set"+(this.$u?"UTC":"");switch(c){case U:return s?l(1,0):l(31,11);case D:return s?l(1,k):l(0,k+1);case N:var T=this.$locale().weekStart||0,L=(b<T?b+7:b)-T;return l(s?p-L:p+(6-L),k);case w:case R:return f(C+"Hours",0);case u:return f(C+"Minutes",1);case E:return f(C+"Seconds",2);case O:return f(C+"Milliseconds",3);default:return this.clone()}},o.endOf=function(n){return this.startOf(n,!1)},o.$set=function(n,i){var r,s=d.p(n),c="set"+(this.$u?"UTC":""),l=(r={},r[w]=c+"Date",r[R]=c+"Date",r[D]=c+"Month",r[U]=c+"FullYear",r[u]=c+"Hours",r[E]=c+"Minutes",r[O]=c+"Seconds",r[Y]=c+"Milliseconds",r)[s],f=s===w?this.$D+(i-this.$W):i;if(s===D||s===U){var b=this.clone().set(R,1);b.$d[l](f),b.init(),this.$d=b.set(R,Math.min(this.$D,b.daysInMonth())).$d}else l&&this.$d[l](f);return this.init(),this},o.set=function(n,i){return this.clone().$set(n,i)},o.get=function(n){return this[d.p(n)]()},o.add=function(n,i){var r,s=this;n=Number(n);var c=d.p(i),l=function(k){var p=m(s);return d.w(p.date(p.date()+Math.round(k*n)),s)};if(c===D)return this.set(D,this.$M+n);if(c===U)return this.set(U,this.$y+n);if(c===w)return l(1);if(c===N)return l(7);var f=(r={},r[E]=v,r[u]=M,r[O]=h,r)[c]||1,b=this.$d.getTime()+n*f;return d.w(b,this)},o.subtract=function(n,i){return this.add(-1*n,i)},o.format=function(n){var i=this,r=this.$locale();if(!this.isValid())return r.invalidDate||ut;var s=n||"YYYY-MM-DDTHH:mm:ssZ",c=d.z(this),l=this.$H,f=this.$m,b=this.$M,k=r.weekdays,p=r.months,C=r.meridiem,T=function($,_,x,P){return $&&($[_]||$(i,s))||x[_].slice(0,P)},L=function($){return d.s(l%12||12,$,"0")},H=C||function($,_,x){var P=$<12?"AM":"PM";return x?P.toLowerCase():P};return s.replace(St,function($,_){return _||function(x){switch(x){case"YY":return String(i.$y).slice(-2);case"YYYY":return d.s(i.$y,4,"0");case"M":return b+1;case"MM":return d.s(b+1,2,"0");case"MMM":return T(r.monthsShort,b,p,3);case"MMMM":return T(p,b);case"D":return i.$D;case"DD":return d.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return T(r.weekdaysMin,i.$W,k,2);case"ddd":return T(r.weekdaysShort,i.$W,k,3);case"dddd":return k[i.$W];case"H":return String(l);case"HH":return d.s(l,2,"0");case"h":return L(1);case"hh":return L(2);case"a":return H(l,f,!0);case"A":return H(l,f,!1);case"m":return String(f);case"mm":return d.s(f,2,"0");case"s":return String(i.$s);case"ss":return d.s(i.$s,2,"0");case"SSS":return d.s(i.$ms,3,"0");case"Z":return c}return null}($)||c.replace(":","")})},o.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},o.diff=function(n,i,r){var s,c=this,l=d.p(i),f=m(n),b=(f.utcOffset()-this.utcOffset())*v,k=this-f,p=function(){return d.m(c,f)};switch(l){case U:s=p()/12;break;case D:s=p();break;case ct:s=p()/3;break;case N:s=(k-b)/6048e5;break;case w:s=(k-b)/864e5;break;case u:s=k/M;break;case E:s=k/v;break;case O:s=k/h;break;default:s=k}return r?s:d.a(s)},o.daysInMonth=function(){return this.endOf(D).$D},o.$locale=function(){return B[this.$L]},o.locale=function(n,i){if(!n)return this.$L;var r=this.clone(),s=W(n,i,!0);return s&&(r.$L=s),r},o.clone=function(){return d.w(this.$d,this)},o.toDate=function(){return new Date(this.valueOf())},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toISOString=function(){return this.$d.toISOString()},o.toString=function(){return this.$d.toUTCString()},a}(),lt=F.prototype;return m.prototype=lt,[["$ms",Y],["$s",O],["$m",E],["$H",u],["$W",w],["$M",D],["$y",U],["$D",R]].forEach(function(a){lt[a[1]]=function(o){return this.$g(o,a[0],a[1])}}),m.extend=function(a,o){return a.$i||(a(o,F,m),a.$i=!0),m},m.locale=W,m.isDayjs=q,m.unix=function(a){return m(1e3*a)},m.en=B[j],m.Ls=B,m.p={},m})})(X);var vt=X.exports;const tt=ht(vt),et="YYYY-MM-DD HH:mm:ss.SSS";function nt(e){console.log(`${tt(new Date).format(et)} ${e}`)}function _t(e){}function rt(e){console.error(`${tt(new Date).format(et)} ${e}`),console.error(e)}function mt(e){let t=new URL(e);return t.origin+t.pathname}for(var y=[],G=0;G<256;++G)y.push((G+256).toString(16).slice(1));function bt(e,t=0){return(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase()}var A,yt=new Uint8Array(16);function kt(){if(!A&&(A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!A))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(yt)}var $t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const ot={randomUUID:$t};function pt(e,t,h){if(ot.randomUUID&&!t&&!e)return ot.randomUUID();e=e||{};var v=e.random||(e.rng||kt)();return v[6]=v[6]&15|64,v[8]=v[8]&63|128,bt(v)}const it="EVENT_BRIDGE",z=new Map;function S(e,t,{onMessageCallback:h,invokeEnv:v}={invokeEnv:I}){let M=gt();return new Promise((O,E)=>{try{wt(M,{resolve:O,reject:E});let u={action:e,callbackId:M,param:t,from:I,to:g,invokeEnv:v};if(h&&h(u),v==I)""+u.from+u.to+u.action+u.invokeEnv+u.callbackId+u.error,chrome.runtime.sendMessage(u);else if(v==g){u.from=g,u.to=J,""+u.from+u.to+u.action+u.invokeEnv+u.callbackId+u.error,chrome.runtime.sendMessage(u);try{if(window){const w=new CustomEvent(it,{detail:u});window.dispatchEvent(w)}}catch{}}else E(`unknow invokeEnv = ${v}`)}catch(u){rt(u),E(u)}})}function wt(e,t){z.set(e,t)}function Dt(e){let t=z.get(e);return z.delete(e),t}function gt(){return pt()}const at={batchAddOrUpdateJobBrowse:async function(e){return await S(this.batchAddOrUpdateJobBrowse.name,e)},addOrUpdateJobBrowse:async function(e){return await S(this.addOrUpdateJobBrowse.name,e)},searchJob:async function(e){return(await S(this.searchJob.name,e)).data},getJobBrowseInfoByIds:async function(e){return(await S(this.getJobBrowseInfoByIds.name,e)).data},statisticJobBrowse:async function(){return(await S(this.statisticJobBrowse.name,{})).data},statisticJobSearchGroupByAvgSalary:async function(e){return(await S(this.statisticJobSearchGroupByAvgSalary.name,e)).data},getJobByDetailUrl:async function(e,{invokeEnv:t}={invokeEnv:I}){return(await S(this.getJobByDetailUrl.name,e,{invokeEnv:t})).data},addJobBrowseDetailHistory:async function(e,{invokeEnv:t}={invokeEnv:I}){return await S(this.addJobBrowseDetailHistory.name,e,{invokeEnv:t})}};browser.browserAction.onClicked.addListener(()=>{browser.tabs.create({url:"src/sidepanel/index.html"})});const st=new Map;browser.tabs.onUpdated.addListener(async(e,t,h)=>{if((t==null?void 0:t.status)=="complete"&&!Mt(h.id)&&h.url){let v=mt(h.url),M=await at.getJobByDetailUrl(v,{invokeEnv:g});M&&(nt(`save jobBrowseDetailHistory start jobId = ${M.jobId}`),await at.addJobBrowseDetailHistory(M.jobId,{invokeEnv:g}),nt(`save jobBrowseDetailHistory success jobId = ${M.jobId}`),Et(h.id))}});function Mt(e){return st.has(e)}function Et(e){st.set(e,null)}const K=new Worker(new URL("/assets/worker-7I7yzB0W.js",Q&&Q.src||new URL("src/background/indexFirefox.js",document.baseURI).href),{type:"module"});K.onmessage=function(e){let t=e.data.data;if(t&&t.from==V&&t.to==J)if(""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.from=J,t.to=g,t.invokeEnv==I)""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.from=g,t.to=I,""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.tabId?chrome.tabs.sendMessage(t.tabId,t):chrome.runtime.sendMessage(t);else if(t.invokeEnv==g){let h=Dt(t.callbackId);h?t.error?(t.message=t.error,h.reject(t)):h.resolve(t):rt(`callbackId = ${t.callbackId} lost callback promiseHook`)}else throw`not support invokeEnv = ${t.invokeEnv}`},window.addEventListener(it,e=>{let t=e.detail;""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,t.from=J,t.to=V,""+t.from+t.to+t.action+t.invokeEnv+t.callbackId+t.error,K.postMessage(t)}),chrome.runtime.onMessage.addListener((e,t,h)=>{e&&e.from==I&&e.to==g&&(t.tab&&(e.tabId=t.tab.id),""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,e.from=g,e.to=J,""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,e.from=J,e.to=V,""+e.from+e.to+e.action+e.invokeEnv+e.callbackId+e.error,K.postMessage(e))})})();
